2021-04-07 08:00:50,217 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='PATH_TO_DATA_DIR/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='PATH_TO_OUTPUT_DIR/rte', overwrite_output_dir=False, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-07 08:00:50,218 - INFO - task_processors - Creating features from dataset file at PATH_TO_DATA_DIR/RTE (num_examples=-1, set_type=train)
2021-04-07 08:05:36,579 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='PATH_TO_DATA_DIR/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='PATH_TO_OUTPUT_DIR/rte', overwrite_output_dir=False, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-07 08:05:36,580 - INFO - task_processors - Creating features from dataset file at PATH_TO_DATA_DIR/RTE (num_examples=-1, set_type=train)
2021-04-07 08:05:53,634 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='PATH_TO_DATA_DIR/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='PATH_TO_OUTPUT_DIR/rte', overwrite_output_dir=False, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-07 08:05:53,635 - INFO - task_processors - Creating features from dataset file at PATH_TO_DATA_DIR/RTE (num_examples=-1, set_type=train)
2021-04-07 08:08:50,122 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='PATH_TO_DATA_DIR/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='PATH_TO_OUTPUT_DIR/rte', overwrite_output_dir=False, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-07 08:08:50,122 - INFO - task_processors - Creating features from dataset file at PATH_TO_DATA_DIR/RTE (num_examples=-1, set_type=train)
2021-04-07 08:09:38,079 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=False, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-07 08:09:38,080 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=train)
2021-04-07 08:09:38,081 - INFO - task_processors - Returning 32 train examples with label dist.: [('not_entailment', 19), ('entailment', 13)]
2021-04-07 08:09:38,081 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev)
2021-04-07 08:09:38,084 - INFO - task_processors - Returning 277 dev examples with label dist.: [('not_entailment', 131), ('entailment', 146)]
2021-04-07 08:09:38,085 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev32)
2021-04-07 08:09:38,085 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('entailment', 21), ('not_entailment', 11)]
2021-04-07 08:11:49,946 - INFO - wrapper - Writing example 0
2021-04-07 08:11:54,233 - INFO - wrapper - Writing example 0
2021-04-07 08:11:54,309 - INFO - wrapper - dev32_data performance before training.
2021-04-07 08:11:54,309 - INFO - wrapper - Writing example 0
2021-04-07 08:11:58,423 - INFO - wrapper - {'acc': 0.71875}
2021-04-07 08:11:58,424 - INFO - wrapper - eval_data performance before training.
2021-04-07 08:11:58,424 - INFO - wrapper - Writing example 0
2021-04-07 08:12:34,819 - INFO - wrapper - {'acc': 0.5848375451263538}
2021-04-07 08:12:52,196 - INFO - wrapper - Writing example 0
2021-04-07 08:12:56,502 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i0...
2021-04-07 08:12:56,502 - INFO - wrapper - best_dev32_acc: 0.7812 | best_global_step: 20
2021-04-07 08:12:56,502 - INFO - wrapper - Saving models.
2021-04-07 08:13:02,980 - INFO - wrapper - eval_data performance:
2021-04-07 08:13:02,980 - INFO - wrapper - Writing example 0
2021-04-07 08:13:39,886 - INFO - wrapper - {'acc': 0.7436823104693141}
2021-04-07 08:13:57,227 - INFO - wrapper - Writing example 0
2021-04-07 08:14:01,541 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i0...
2021-04-07 08:14:01,541 - INFO - wrapper - best_dev32_acc: 0.8750 | best_global_step: 40
2021-04-07 08:14:01,542 - INFO - wrapper - Saving models.
2021-04-07 08:14:14,937 - INFO - wrapper - eval_data performance:
2021-04-07 08:14:14,937 - INFO - wrapper - Writing example 0
2021-04-07 08:14:51,578 - INFO - wrapper - {'acc': 0.7653429602888087}
2021-04-07 08:15:09,219 - INFO - wrapper - Writing example 0
2021-04-07 08:15:13,387 - INFO - wrapper - {'acc': 0.8125}
2021-04-07 08:15:13,388 - INFO - wrapper - 1
2021-04-07 08:15:30,964 - INFO - wrapper - Writing example 0
2021-04-07 08:15:35,187 - INFO - wrapper - {'acc': 0.6875}
2021-04-07 08:15:35,188 - INFO - wrapper - 2
2021-04-07 08:15:52,347 - INFO - wrapper - Writing example 0
2021-04-07 08:15:55,927 - INFO - wrapper - {'acc': 0.6875}
2021-04-07 08:15:55,927 - INFO - wrapper - 3
2021-04-07 08:16:10,116 - INFO - wrapper - Writing example 0
2021-04-07 08:16:13,712 - INFO - wrapper - {'acc': 0.78125}
2021-04-07 08:16:13,712 - INFO - wrapper - 4
2021-04-07 08:16:27,924 - INFO - wrapper - Writing example 0
2021-04-07 08:16:31,517 - INFO - wrapper - {'acc': 0.84375}
2021-04-07 08:16:31,518 - INFO - wrapper - 5
2021-04-07 08:16:45,723 - INFO - wrapper - Writing example 0
2021-04-07 08:16:49,334 - INFO - wrapper - {'acc': 0.84375}
2021-04-07 08:16:49,335 - INFO - wrapper - 6
2021-04-07 08:17:03,523 - INFO - wrapper - Writing example 0
2021-04-07 08:17:07,120 - INFO - wrapper - {'acc': 0.84375}
2021-04-07 08:17:07,120 - INFO - wrapper - 7
2021-04-07 08:17:21,327 - INFO - wrapper - Writing example 0
2021-04-07 08:17:24,914 - INFO - wrapper - {'acc': 0.84375}
2021-04-07 08:17:24,915 - INFO - wrapper - 8
2021-04-07 08:17:39,077 - INFO - wrapper - Writing example 0
2021-04-07 08:17:42,673 - INFO - wrapper - {'acc': 0.84375}
2021-04-07 08:17:42,673 - INFO - wrapper - 9
2021-04-07 08:17:56,858 - INFO - wrapper - Writing example 0
2021-04-07 08:18:00,439 - INFO - wrapper - {'acc': 0.84375}
2021-04-07 08:18:00,439 - INFO - wrapper - 10
2021-04-07 08:18:35,720 - INFO - wrapper - Writing example 0
2021-04-07 08:18:39,258 - INFO - modeling - Saving complete
2021-04-07 08:18:39,258 - INFO - modeling - Starting evaluation...
2021-04-07 08:19:12,613 - INFO - wrapper - Writing example 0
2021-04-07 08:19:43,259 - INFO - wrapper - Writing example 0
2021-04-07 08:19:46,803 - INFO - modeling - --- RESULT (pattern_id=1, iteration=0) ---
2021-04-07 08:19:46,803 - INFO - modeling - eval_results:
2021-04-07 08:19:46,803 - INFO - modeling - {'acc': 0.7653429602888087}
2021-04-07 08:19:46,803 - INFO - modeling - dev32_results:
2021-04-07 08:19:46,804 - INFO - modeling - {'acc': 0.875}
2021-04-07 08:20:06,540 - INFO - wrapper - Writing example 0
2021-04-07 08:20:10,217 - INFO - wrapper - Writing example 0
2021-04-07 08:20:10,292 - INFO - wrapper - dev32_data performance before training.
2021-04-07 08:20:10,293 - INFO - wrapper - Writing example 0
2021-04-07 08:20:13,845 - INFO - wrapper - {'acc': 0.71875}
2021-04-07 08:20:13,845 - INFO - wrapper - eval_data performance before training.
2021-04-07 08:20:13,845 - INFO - wrapper - Writing example 0
2021-04-07 08:20:44,682 - INFO - wrapper - {'acc': 0.5884476534296029}
2021-04-07 08:20:58,994 - INFO - wrapper - Writing example 0
2021-04-07 08:21:02,601 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i1...
2021-04-07 08:21:02,601 - INFO - wrapper - best_dev32_acc: 0.7188 | best_global_step: 20
2021-04-07 08:21:02,601 - INFO - wrapper - Saving models.
2021-04-07 08:21:09,074 - INFO - wrapper - eval_data performance:
2021-04-07 08:21:09,075 - INFO - wrapper - Writing example 0
2021-04-07 08:21:40,082 - INFO - wrapper - {'acc': 0.7256317689530686}
2021-04-07 08:21:54,285 - INFO - wrapper - Writing example 0
2021-04-07 08:21:57,876 - INFO - wrapper - {'acc': 0.625}
2021-04-07 08:21:57,876 - INFO - wrapper - 1
2021-04-07 08:22:12,032 - INFO - wrapper - Writing example 0
2021-04-07 08:22:15,616 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i1...
2021-04-07 08:22:15,616 - INFO - wrapper - best_dev32_acc: 0.8438 | best_global_step: 60
2021-04-07 08:22:15,617 - INFO - wrapper - Saving models.
2021-04-07 08:22:28,171 - INFO - wrapper - eval_data performance:
2021-04-07 08:22:28,172 - INFO - wrapper - Writing example 0
2021-04-07 08:22:58,909 - INFO - wrapper - {'acc': 0.7328519855595668}
2021-04-07 08:23:13,072 - INFO - wrapper - Writing example 0
2021-04-07 08:23:16,640 - INFO - wrapper - {'acc': 0.6875}
2021-04-07 08:23:16,640 - INFO - wrapper - 1
2021-04-07 08:23:30,830 - INFO - wrapper - Writing example 0
2021-04-07 08:23:34,388 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:23:34,389 - INFO - wrapper - 2
2021-04-07 08:23:48,587 - INFO - wrapper - Writing example 0
2021-04-07 08:23:52,169 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:23:52,170 - INFO - wrapper - 3
2021-04-07 08:24:06,349 - INFO - wrapper - Writing example 0
2021-04-07 08:24:09,923 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:24:09,923 - INFO - wrapper - 4
2021-04-07 08:24:24,108 - INFO - wrapper - Writing example 0
2021-04-07 08:24:27,677 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:24:27,678 - INFO - wrapper - 5
2021-04-07 08:24:41,862 - INFO - wrapper - Writing example 0
2021-04-07 08:24:45,466 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:24:45,466 - INFO - wrapper - 6
2021-04-07 08:24:59,647 - INFO - wrapper - Writing example 0
2021-04-07 08:25:03,229 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:25:03,230 - INFO - wrapper - 7
2021-04-07 08:25:17,398 - INFO - wrapper - Writing example 0
2021-04-07 08:25:20,995 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:25:20,995 - INFO - wrapper - 8
2021-04-07 08:25:35,159 - INFO - wrapper - Writing example 0
2021-04-07 08:25:38,748 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:25:38,748 - INFO - wrapper - 9
2021-04-07 08:25:52,944 - INFO - wrapper - Writing example 0
2021-04-07 08:25:56,527 - INFO - wrapper - {'acc': 0.75}
2021-04-07 08:25:56,527 - INFO - wrapper - 10
2021-04-07 08:26:31,615 - INFO - wrapper - Writing example 0
2021-04-07 08:26:35,135 - INFO - modeling - Saving complete
2021-04-07 08:26:35,135 - INFO - modeling - Starting evaluation...
2021-04-07 08:27:08,743 - INFO - wrapper - Writing example 0
2021-04-07 08:27:39,497 - INFO - wrapper - Writing example 0
2021-04-07 08:27:43,082 - INFO - modeling - --- RESULT (pattern_id=1, iteration=1) ---
2021-04-07 08:27:43,082 - INFO - modeling - eval_results:
2021-04-07 08:27:43,082 - INFO - modeling - {'acc': 0.7328519855595668}
2021-04-07 08:27:43,082 - INFO - modeling - dev32_results:
2021-04-07 08:27:43,082 - INFO - modeling - {'acc': 0.84375}
2021-04-07 08:28:02,580 - INFO - wrapper - Writing example 0
2021-04-07 08:28:06,247 - INFO - wrapper - Writing example 0
2021-04-07 08:28:06,325 - INFO - wrapper - dev32_data performance before training.
2021-04-07 08:28:06,326 - INFO - wrapper - Writing example 0
2021-04-07 08:28:09,878 - INFO - wrapper - {'acc': 0.71875}
2021-04-07 08:28:09,878 - INFO - wrapper - eval_data performance before training.
2021-04-07 08:28:09,878 - INFO - wrapper - Writing example 0
2021-04-07 08:28:40,692 - INFO - wrapper - {'acc': 0.5848375451263538}
2021-04-07 08:28:54,973 - INFO - wrapper - Writing example 0
2021-04-07 08:28:58,578 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i2...
2021-04-07 08:28:58,578 - INFO - wrapper - best_dev32_acc: 0.7500 | best_global_step: 20
2021-04-07 08:28:58,578 - INFO - wrapper - Saving models.
2021-04-07 08:29:05,054 - INFO - wrapper - eval_data performance:
2021-04-07 08:29:05,055 - INFO - wrapper - Writing example 0
2021-04-07 08:29:35,919 - INFO - wrapper - {'acc': 0.740072202166065}
2021-04-07 08:29:50,108 - INFO - wrapper - Writing example 0
2021-04-07 08:29:53,679 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i2...
2021-04-07 08:29:53,679 - INFO - wrapper - best_dev32_acc: 0.8125 | best_global_step: 40
2021-04-07 08:29:53,679 - INFO - wrapper - Saving models.
2021-04-07 08:30:07,174 - INFO - wrapper - eval_data performance:
2021-04-07 08:30:07,174 - INFO - wrapper - Writing example 0
2021-04-07 08:30:37,915 - INFO - wrapper - {'acc': 0.7364620938628159}
2021-04-07 08:30:52,061 - INFO - wrapper - Writing example 0
2021-04-07 08:30:55,647 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i2...
2021-04-07 08:30:55,647 - INFO - wrapper - best_dev32_acc: 0.8438 | best_global_step: 60
2021-04-07 08:30:55,647 - INFO - wrapper - Saving models.
2021-04-07 08:31:06,503 - INFO - wrapper - eval_data performance:
2021-04-07 08:31:06,504 - INFO - wrapper - Writing example 0
2021-04-07 08:31:37,362 - INFO - wrapper - {'acc': 0.7256317689530686}
2021-04-07 08:31:51,566 - INFO - wrapper - Writing example 0
2021-04-07 08:31:55,156 - INFO - wrapper - {'acc': 0.65625}
2021-04-07 08:31:55,157 - INFO - wrapper - 1
2021-04-07 08:32:09,399 - INFO - wrapper - Writing example 0
2021-04-07 08:32:13,006 - INFO - wrapper - {'acc': 0.625}
2021-04-07 08:32:13,006 - INFO - wrapper - 2
2021-04-07 08:32:27,170 - INFO - wrapper - Writing example 0
2021-04-07 08:32:30,765 - INFO - wrapper - {'acc': 0.65625}
2021-04-07 08:32:30,766 - INFO - wrapper - 3
2021-04-07 08:32:44,941 - INFO - wrapper - Writing example 0
2021-04-07 08:32:48,520 - INFO - wrapper - {'acc': 0.65625}
2021-04-07 08:32:48,520 - INFO - wrapper - 4
2021-04-07 08:33:02,666 - INFO - wrapper - Writing example 0
2021-04-07 08:33:06,233 - INFO - wrapper - {'acc': 0.65625}
2021-04-07 08:33:06,234 - INFO - wrapper - 5
2021-04-07 08:33:20,372 - INFO - wrapper - Writing example 0
2021-04-07 08:33:23,942 - INFO - wrapper - {'acc': 0.65625}
2021-04-07 08:33:23,943 - INFO - wrapper - 6
2021-04-07 08:33:38,100 - INFO - wrapper - Writing example 0
2021-04-07 08:33:41,671 - INFO - wrapper - {'acc': 0.65625}
2021-04-07 08:33:41,672 - INFO - wrapper - 7
2021-04-07 08:33:55,804 - INFO - wrapper - Writing example 0
2021-04-07 08:33:59,383 - INFO - wrapper - {'acc': 0.65625}
2021-04-07 08:33:59,383 - INFO - wrapper - 8
2021-04-07 08:34:13,517 - INFO - wrapper - Writing example 0
2021-04-07 08:34:17,084 - INFO - wrapper - {'acc': 0.6875}
2021-04-07 08:34:17,084 - INFO - wrapper - 9
2021-04-07 08:34:31,235 - INFO - wrapper - Writing example 0
2021-04-07 08:34:34,810 - INFO - wrapper - {'acc': 0.6875}
2021-04-07 08:34:34,811 - INFO - wrapper - 10
2021-04-07 08:35:08,479 - INFO - wrapper - Writing example 0
2021-04-07 08:35:12,001 - INFO - modeling - Saving complete
2021-04-07 08:35:12,001 - INFO - modeling - Starting evaluation...
2021-04-07 08:35:45,777 - INFO - wrapper - Writing example 0
2021-04-07 08:36:16,360 - INFO - wrapper - Writing example 0
2021-04-07 08:36:19,906 - INFO - modeling - --- RESULT (pattern_id=1, iteration=2) ---
2021-04-07 08:36:19,906 - INFO - modeling - eval_results:
2021-04-07 08:36:19,906 - INFO - modeling - {'acc': 0.7256317689530686}
2021-04-07 08:36:19,906 - INFO - modeling - dev32_results:
2021-04-07 08:36:19,906 - INFO - modeling - {'acc': 0.84375}
2021-04-07 08:36:19,943 - INFO - modeling - === OVERALL RESULTS ===
2021-04-07 08:36:19,944 - INFO - modeling - eval_results:
2021-04-07 08:36:19,948 - INFO - modeling - acc-p1: 0.7412755716004813 +- 0.02115330424939465
2021-04-07 08:36:19,949 - INFO - modeling - acc-all-p: 0.7412755716004813 +- 0.02115330424939465
2021-04-07 08:36:19,949 - INFO - modeling - dev32_results:
2021-04-07 08:36:19,949 - INFO - modeling - acc-p1: 0.8541666666666666 +- 0.018042195912175804
2021-04-07 08:36:19,950 - INFO - modeling - acc-all-p: 0.8541666666666666 +- 0.018042195912175804
2021-04-07 08:58:02,488 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=False, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-07 08:59:17,374 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-07 08:59:17,375 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=train)
2021-04-07 08:59:17,376 - INFO - task_processors - Returning 32 train examples with label dist.: [('not_entailment', 19), ('entailment', 13)]
2021-04-07 08:59:17,376 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev)
2021-04-07 08:59:17,379 - INFO - task_processors - Returning 277 dev examples with label dist.: [('not_entailment', 131), ('entailment', 146)]
2021-04-07 08:59:17,379 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev32)
2021-04-07 08:59:17,380 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('entailment', 21), ('not_entailment', 11)]
2021-04-07 08:59:17,381 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i0 already exists, skipping it...
2021-04-07 08:59:17,381 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i1 already exists, skipping it...
2021-04-07 08:59:17,382 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i2 already exists, skipping it...
2021-04-07 08:59:17,382 - INFO - modeling - === OVERALL RESULTS ===
2021-04-07 08:59:17,382 - INFO - modeling - eval_results:
2021-04-07 08:59:17,382 - INFO - modeling - dev32_results:
2021-04-07 09:00:46,412 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-07 09:00:46,413 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=train)
2021-04-07 09:00:46,414 - INFO - task_processors - Returning 32 train examples with label dist.: [('not_entailment', 19), ('entailment', 13)]
2021-04-07 09:00:46,414 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev)
2021-04-07 09:00:46,417 - INFO - task_processors - Returning 277 dev examples with label dist.: [('not_entailment', 131), ('entailment', 146)]
2021-04-07 09:00:46,417 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev32)
2021-04-07 09:00:46,418 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('entailment', 21), ('not_entailment', 11)]
2021-04-07 09:00:46,419 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i0 already exists, skipping it...
2021-04-07 09:00:46,420 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i1 already exists, skipping it...
2021-04-07 09:00:46,420 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i2 already exists, skipping it...
2021-04-07 09:00:46,420 - INFO - modeling - === OVERALL RESULTS ===
2021-04-07 09:00:46,420 - INFO - modeling - eval_results:
2021-04-07 09:00:46,420 - INFO - modeling - dev32_results:
2021-04-10 05:34:11,281 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 05:36:52,703 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 05:40:15,387 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 05:45:32,830 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 05:47:50,742 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 05:50:25,526 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 05:54:20,272 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 05:54:29,732 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 06:00:54,275 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 06:05:04,755 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 06:13:11,888 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 06:13:28,997 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 06:13:28,997 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=train)
2021-04-10 06:13:29,013 - INFO - task_processors - Returning 32 train examples with label dist.: [('not_entailment', 19), ('entailment', 13)]
2021-04-10 06:13:29,013 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev)
2021-04-10 06:13:29,018 - INFO - task_processors - Returning 277 dev examples with label dist.: [('not_entailment', 131), ('entailment', 146)]
2021-04-10 06:13:29,018 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev32)
2021-04-10 06:13:29,021 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('entailment', 21), ('not_entailment', 11)]
2021-04-10 06:13:29,040 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i0 already exists, skipping it...
2021-04-10 06:13:29,040 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i1 already exists, skipping it...
2021-04-10 06:13:29,040 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte/p1-i2 already exists, skipping it...
2021-04-10 06:13:29,040 - INFO - modeling - === OVERALL RESULTS ===
2021-04-10 06:13:29,052 - INFO - modeling - eval_results:
2021-04-10 06:13:29,052 - INFO - modeling - dev32_results:
2021-04-10 06:13:57,605 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:17:08,782 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:22:14,662 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:22:14,663 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:23:26,145 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:23:26,145 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:32:56,438 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:32:56,439 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:38:08,802 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:38:48,038 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:38:48,038 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:38:48,043 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:38:48,043 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:38:48,046 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:40:44,572 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:40:44,572 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:40:44,578 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:40:44,578 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:40:44,581 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:40:44,581 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1 already exists, skipping it...
2021-04-10 06:41:00,421 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:41:00,421 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:41:00,428 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:41:00,428 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:41:00,431 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:41:00,431 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1 already exists, skipping it...
2021-04-10 06:43:51,805 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:43:51,805 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:43:51,810 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:43:51,810 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:43:51,813 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:43:51,814 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1 already exists, skipping it...
2021-04-10 06:44:45,007 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:44:45,008 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:44:45,014 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:44:45,014 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:44:45,018 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:44:45,018 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1 already exists, skipping it...
2021-04-10 06:45:48,570 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:45:48,571 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:45:48,575 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:45:48,576 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:45:48,580 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:45:48,580 - WARNING - modeling - Path /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1 already exists, skipping it...
2021-04-10 06:46:29,744 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:46:29,744 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:46:29,749 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:46:29,749 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:46:29,753 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:46:59,559 - INFO - wrapper - Writing example 0
2021-04-10 06:49:20,124 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:49:20,124 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:49:20,129 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:49:20,129 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:49:20,133 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:49:42,783 - INFO - wrapper - Writing example 0
2021-04-10 06:52:28,539 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:52:28,539 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:52:28,545 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:52:28,546 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:52:28,549 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:52:52,518 - INFO - wrapper - Writing example 0
2021-04-10 06:57:51,789 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 06:57:51,789 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 06:57:51,795 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 06:57:51,795 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 06:57:51,798 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:02:08,421 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:02:08,422 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 07:02:08,427 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:02:08,427 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 07:02:08,431 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:02:33,286 - INFO - wrapper - Writing example 0
2021-04-10 07:02:58,558 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='albert-xxlarge-v2', model_type='albert', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 07:02:58,559 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=train)
2021-04-10 07:02:58,560 - INFO - task_processors - Returning 32 train examples with label dist.: [('not_entailment', 19), ('entailment', 13)]
2021-04-10 07:02:58,560 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev)
2021-04-10 07:02:58,564 - INFO - task_processors - Returning 277 dev examples with label dist.: [('not_entailment', 131), ('entailment', 146)]
2021-04-10 07:02:58,564 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev32)
2021-04-10 07:02:58,564 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('entailment', 21), ('not_entailment', 11)]
2021-04-10 07:03:31,141 - INFO - wrapper - Writing example 0
2021-04-10 07:03:34,862 - INFO - wrapper - Writing example 0
2021-04-10 07:05:15,709 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE', dev32_examples=-1, do_eval=True, do_train=True, embed_size=128, eval_every_step=20, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/rte', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=3500, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='rte', task_type='single_task', train_examples=-1, warmup_steps=150, weight_decay=0.1)
2021-04-10 07:05:15,709 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=train)
2021-04-10 07:05:15,710 - INFO - task_processors - Returning 32 train examples with label dist.: [('not_entailment', 19), ('entailment', 13)]
2021-04-10 07:05:15,710 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev)
2021-04-10 07:05:15,714 - INFO - task_processors - Returning 277 dev examples with label dist.: [('not_entailment', 131), ('entailment', 146)]
2021-04-10 07:05:15,714 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/P-tuning/FewGLUE_32dev/RTE (num_examples=-1, set_type=dev32)
2021-04-10 07:05:15,715 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('entailment', 21), ('not_entailment', 11)]
2021-04-10 07:05:40,700 - INFO - wrapper - Writing example 0
2021-04-10 07:23:55,212 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:23:55,213 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 07:23:55,219 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:23:55,219 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 07:23:55,222 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:24:18,363 - INFO - wrapper - Writing example 0
2021-04-10 07:24:19,696 - INFO - wrapper - Writing example 0
2021-04-10 07:31:52,058 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:31:52,058 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 07:31:52,063 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:31:52,064 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 07:31:52,067 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:32:28,531 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:32:28,532 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 07:32:28,537 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:32:28,537 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 07:32:28,541 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:32:52,984 - INFO - wrapper - Writing example 0
2021-04-10 07:32:54,287 - INFO - wrapper - Writing example 0
2021-04-10 07:33:04,125 - INFO - wrapper - Writing example 0
2021-04-10 07:33:05,395 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-10 07:33:05,395 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-10 07:33:05,395 - INFO - wrapper - Saving models.
2021-04-10 07:33:18,392 - INFO - wrapper - Writing example 0
2021-04-10 07:33:19,608 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-10 07:33:19,609 - INFO - wrapper - best_dev_acc: 0.9167 | best_global_step: 200
2021-04-10 07:33:19,609 - INFO - wrapper - Saving models.
2021-04-10 07:33:35,261 - INFO - wrapper - Writing example 0
2021-04-10 07:33:36,420 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-10 07:33:36,421 - INFO - wrapper - 1
2021-04-10 07:33:45,696 - INFO - wrapper - Writing example 0
2021-04-10 07:33:46,931 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 07:33:46,931 - INFO - wrapper - 2
2021-04-10 07:33:55,911 - INFO - wrapper - Writing example 0
2021-04-10 07:33:57,073 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 07:33:57,073 - INFO - wrapper - 3
2021-04-10 07:34:06,060 - INFO - wrapper - Writing example 0
2021-04-10 07:34:07,230 - INFO - wrapper - {'acc': 0.8854166666666666}
2021-04-10 07:34:07,230 - INFO - wrapper - 4
2021-04-10 07:34:16,389 - INFO - wrapper - Writing example 0
2021-04-10 07:34:17,556 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-10 07:34:17,556 - INFO - wrapper - 5
2021-04-10 07:34:26,751 - INFO - wrapper - Writing example 0
2021-04-10 07:34:27,931 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 07:34:27,931 - INFO - wrapper - 6
2021-04-10 07:34:37,144 - INFO - wrapper - Writing example 0
2021-04-10 07:34:38,360 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-10 07:34:38,361 - INFO - wrapper - 7
2021-04-10 07:34:47,317 - INFO - wrapper - Writing example 0
2021-04-10 07:34:48,472 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-10 07:34:48,472 - INFO - wrapper - 8
2021-04-10 07:35:14,704 - INFO - wrapper - Writing example 0
2021-04-10 07:35:15,911 - INFO - modeling - Saving complete
2021-04-10 07:35:15,911 - INFO - modeling - Starting evaluation...
2021-04-10 07:37:16,466 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:37:16,466 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 07:37:16,472 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:37:16,472 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 07:37:16,475 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:37:40,820 - INFO - modeling - Starting evaluation...
2021-04-10 07:39:22,778 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:39:22,778 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 07:39:22,783 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:39:22,783 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 07:39:22,787 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:39:46,798 - INFO - modeling - Starting evaluation...
2021-04-10 07:40:13,184 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-10 07:43:17,633 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:46:03,888 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:46:03,888 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 07:46:03,893 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:46:03,893 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 07:46:03,897 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:46:27,435 - INFO - modeling - Starting evaluation...
2021-04-10 07:46:53,762 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-10 07:50:20,163 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 07:50:20,163 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 07:50:20,168 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:50:20,168 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 07:50:20,171 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 07:50:43,187 - INFO - modeling - Starting evaluation...
2021-04-10 07:51:09,479 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-10 07:51:09,486 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-10 07:51:09,486 - INFO - wrapper - Writing example 0
2021-04-10 08:00:36,232 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:00:36,233 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 08:00:36,238 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:00:36,238 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 08:00:36,241 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:00:59,566 - INFO - modeling - Starting evaluation...
2021-04-10 08:01:26,229 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-10 08:01:26,235 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-10 08:01:26,236 - INFO - wrapper - Writing example 0
2021-04-10 08:02:06,300 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:02:06,301 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 08:02:06,306 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:02:06,306 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 08:02:06,310 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:02:29,605 - INFO - modeling - Starting evaluation...
2021-04-10 08:02:56,512 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-10 08:02:56,518 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-10 08:02:56,519 - INFO - wrapper - Writing example 0
2021-04-10 08:03:07,389 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=SST-2) ---
2021-04-10 08:03:07,390 - INFO - modeling - eval_results:
2021-04-10 08:03:07,390 - INFO - modeling - {'acc': 0.9048165137614679}
2021-04-10 08:03:07,390 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-10 08:03:07,410 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-10 08:03:07,411 - INFO - wrapper - Writing example 0
2021-04-10 08:03:31,960 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-10 08:03:31,961 - INFO - modeling - eval_results:
2021-04-10 08:03:31,961 - INFO - modeling - {'acc': 0.8575}
2021-04-10 08:03:31,961 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-10 08:03:31,982 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-10 08:03:31,984 - INFO - wrapper - Writing example 0
2021-04-10 08:03:56,592 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-10 08:03:56,593 - INFO - modeling - eval_results:
2021-04-10 08:03:56,593 - INFO - modeling - {'acc': 0.8975}
2021-04-10 08:22:33,421 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='SST-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:31:23,054 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:31:23,054 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 08:31:23,056 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:31:23,056 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 08:31:23,056 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:31:23,056 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 08:31:23,057 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:32:17,153 - INFO - wrapper - Writing example 0
2021-04-10 08:39:29,271 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:39:29,272 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 08:39:29,273 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:39:29,273 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 08:39:29,273 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:39:29,274 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 08:39:29,274 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:40:18,587 - INFO - wrapper - Writing example 0
2021-04-10 08:41:15,759 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:41:15,760 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 08:41:15,765 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:41:15,765 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 08:41:15,769 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:41:38,354 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:41:38,355 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 08:41:38,360 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:41:38,361 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 08:41:38,364 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:42:06,420 - INFO - wrapper - Writing example 0
2021-04-10 08:42:09,207 - INFO - wrapper - Writing example 0
2021-04-10 08:48:18,341 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:48:18,342 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 08:48:18,343 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:48:18,344 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 08:48:18,344 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:48:18,344 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 08:48:18,345 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 08:49:04,041 - INFO - wrapper - Writing example 0
2021-04-10 08:55:04,015 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 08:55:04,015 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-10 08:55:04,020 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:55:04,021 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-10 08:55:04,024 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-10 08:55:31,644 - INFO - wrapper - Writing example 0
2021-04-10 09:11:03,806 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:11:03,807 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:11:03,808 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:11:03,808 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:11:03,809 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:11:03,809 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:11:03,809 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:11:46,148 - INFO - wrapper - Writing example 0
2021-04-10 09:12:50,642 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:12:50,643 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:12:50,644 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:12:50,644 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:12:50,645 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:12:50,645 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:12:50,645 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:13:34,363 - INFO - wrapper - Writing example 0
2021-04-10 09:17:14,034 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:17:14,034 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:17:14,035 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:17:14,035 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:17:14,036 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:17:14,036 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:17:14,036 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:17:55,767 - INFO - wrapper - Writing example 0
2021-04-10 09:18:12,074 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:18:12,074 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:18:12,075 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:18:12,076 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:18:12,076 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:18:12,076 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:18:12,076 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:18:54,660 - INFO - wrapper - Writing example 0
2021-04-10 09:18:55,346 - INFO - wrapper - Writing example 0
2021-04-10 09:19:13,512 - INFO - wrapper - Writing example 0
2021-04-10 09:19:31,799 - INFO - wrapper - Writing example 0
2021-04-10 09:19:50,513 - INFO - wrapper - Writing example 0
2021-04-10 09:20:08,907 - INFO - wrapper - Writing example 0
2021-04-10 09:20:27,454 - INFO - wrapper - Writing example 0
2021-04-10 09:20:45,762 - INFO - wrapper - Writing example 0
2021-04-10 09:21:03,923 - INFO - wrapper - Writing example 0
2021-04-10 09:21:22,369 - INFO - wrapper - Writing example 0
2021-04-10 09:21:40,526 - INFO - wrapper - Writing example 0
2021-04-10 09:21:58,839 - INFO - wrapper - Writing example 0
2021-04-10 09:33:41,156 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:33:41,156 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:33:41,157 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:33:41,157 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:33:41,158 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:33:41,158 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:33:41,158 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:35:32,224 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:35:32,224 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:35:32,225 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:35:32,226 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:35:32,226 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:35:32,226 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:35:32,227 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:36:15,303 - INFO - wrapper - Writing example 0
2021-04-10 09:36:15,942 - INFO - wrapper - Writing example 0
2021-04-10 09:36:34,058 - INFO - wrapper - Writing example 0
2021-04-10 09:36:52,178 - INFO - wrapper - Writing example 0
2021-04-10 09:37:10,261 - INFO - wrapper - Writing example 0
2021-04-10 09:37:28,327 - INFO - wrapper - Writing example 0
2021-04-10 09:37:46,406 - INFO - wrapper - Writing example 0
2021-04-10 09:38:04,444 - INFO - wrapper - Writing example 0
2021-04-10 09:38:22,587 - INFO - wrapper - Writing example 0
2021-04-10 09:38:40,756 - INFO - wrapper - Writing example 0
2021-04-10 09:38:58,856 - INFO - wrapper - Writing example 0
2021-04-10 09:39:16,944 - INFO - wrapper - Writing example 0
2021-04-10 09:44:02,836 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:44:02,837 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:44:02,838 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:44:02,838 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:44:02,838 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:44:02,838 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:44:02,839 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [('0', 16), ('1', 16)]
2021-04-10 09:44:46,889 - INFO - wrapper - Writing example 0
2021-04-10 09:44:47,548 - INFO - wrapper - Writing example 0
2021-04-10 09:45:06,353 - INFO - wrapper - Writing example 0
2021-04-10 09:45:06,999 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:45:07,000 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-10 09:45:07,000 - INFO - wrapper - Saving models.
2021-04-10 09:45:35,003 - INFO - wrapper - Writing example 0
2021-04-10 09:45:35,650 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:45:35,650 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-10 09:45:35,650 - INFO - wrapper - Saving models.
2021-04-10 09:46:13,809 - INFO - wrapper - Writing example 0
2021-04-10 09:46:14,449 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:46:14,449 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-10 09:46:14,449 - INFO - wrapper - Saving models.
2021-04-10 09:46:52,833 - INFO - wrapper - Writing example 0
2021-04-10 09:46:53,464 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:46:53,464 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 400
2021-04-10 09:46:53,464 - INFO - wrapper - Saving models.
2021-04-10 09:47:30,871 - INFO - wrapper - Writing example 0
2021-04-10 09:47:31,508 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:47:31,508 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 500
2021-04-10 09:47:31,509 - INFO - wrapper - Saving models.
2021-04-10 09:48:08,547 - INFO - wrapper - Writing example 0
2021-04-10 09:48:09,170 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:48:09,171 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 600
2021-04-10 09:48:09,171 - INFO - wrapper - Saving models.
2021-04-10 09:48:46,347 - INFO - wrapper - Writing example 0
2021-04-10 09:48:46,972 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:48:46,973 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 700
2021-04-10 09:48:46,973 - INFO - wrapper - Saving models.
2021-04-10 09:49:24,327 - INFO - wrapper - Writing example 0
2021-04-10 09:49:24,949 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:49:24,949 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 800
2021-04-10 09:49:24,949 - INFO - wrapper - Saving models.
2021-04-10 09:50:02,156 - INFO - wrapper - Writing example 0
2021-04-10 09:50:02,777 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:50:02,777 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 900
2021-04-10 09:50:02,777 - INFO - wrapper - Saving models.
2021-04-10 09:50:39,843 - INFO - wrapper - Writing example 0
2021-04-10 09:50:40,459 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-10 09:50:40,460 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 1000
2021-04-10 09:50:40,460 - INFO - wrapper - Saving models.
2021-04-10 09:52:10,366 - INFO - wrapper - Writing example 0
2021-04-10 09:52:11,013 - INFO - modeling - Saving complete
2021-04-10 09:52:11,013 - INFO - modeling - Starting evaluation...
2021-04-10 09:53:22,443 - INFO - wrapper - Writing example 0
2021-04-10 09:53:23,082 - INFO - wrapper - Writing example 0
2021-04-10 09:53:23,701 - INFO - modeling - --- RESULT (pattern_id=1, Task=sst-2) ---
2021-04-10 09:53:23,701 - INFO - modeling - eval_results:
2021-04-10 09:53:23,701 - INFO - modeling - {'acc': 0.9375}
2021-04-10 09:55:14,091 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:55:14,092 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:55:14,096 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 09:55:14,096 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:55:14,099 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 09:55:14,099 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:59:16,716 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 09:59:16,716 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=train)
2021-04-10 09:59:16,721 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 09:59:16,721 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev)
2021-04-10 09:59:16,724 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 09:59:16,724 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 09:59:16,727 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 10:00:00,849 - INFO - wrapper - Writing example 0
2021-04-10 10:00:01,517 - INFO - wrapper - Writing example 0
2021-04-10 10:00:20,001 - INFO - wrapper - Writing example 0
2021-04-10 10:00:20,675 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-10 10:00:20,675 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-10 10:00:20,676 - INFO - wrapper - Saving models.
2021-04-10 10:00:48,013 - INFO - wrapper - Writing example 0
2021-04-10 10:00:48,652 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-10 10:00:48,652 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-10 10:00:48,652 - INFO - wrapper - Saving models.
2021-04-10 10:01:26,978 - INFO - wrapper - Writing example 0
2021-04-10 10:01:27,796 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-10 10:01:27,796 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 300
2021-04-10 10:01:27,797 - INFO - wrapper - Saving models.
2021-04-10 10:02:05,242 - INFO - wrapper - Writing example 0
2021-04-10 10:02:05,878 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:02:05,878 - INFO - wrapper - 1
2021-04-10 10:02:23,678 - INFO - wrapper - Writing example 0
2021-04-10 10:02:24,349 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:02:24,350 - INFO - wrapper - 2
2021-04-10 10:02:42,781 - INFO - wrapper - Writing example 0
2021-04-10 10:02:43,406 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:02:43,406 - INFO - wrapper - 3
2021-04-10 10:03:01,673 - INFO - wrapper - Writing example 0
2021-04-10 10:03:02,340 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:03:02,340 - INFO - wrapper - 4
2021-04-10 10:03:19,285 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='cr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 10:03:19,286 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=train)
2021-04-10 10:03:19,290 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 10:03:19,291 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=dev)
2021-04-10 10:03:19,293 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 10:03:19,293 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=dev32)
2021-04-10 10:03:19,296 - INFO - task_processors - Returning 32 dev32 examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 10:03:20,671 - INFO - wrapper - Writing example 0
2021-04-10 10:03:21,320 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:03:21,320 - INFO - wrapper - 5
2021-04-10 10:03:39,003 - INFO - wrapper - Writing example 0
2021-04-10 10:03:39,633 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:03:39,633 - INFO - wrapper - 6
2021-04-10 10:03:58,707 - INFO - wrapper - Writing example 0
2021-04-10 10:03:59,330 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:03:59,331 - INFO - wrapper - 7
2021-04-10 10:04:03,228 - INFO - wrapper - Writing example 0
2021-04-10 10:04:03,864 - INFO - wrapper - Writing example 0
2021-04-10 10:04:21,826 - INFO - wrapper - Writing example 0
2021-04-10 10:04:22,451 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-10 10:04:22,451 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-10 10:04:22,452 - INFO - wrapper - Saving models.
2021-04-10 10:04:51,423 - INFO - wrapper - Writing example 0
2021-04-10 10:04:52,038 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-10 10:04:52,038 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-10 10:04:52,038 - INFO - wrapper - Saving models.
2021-04-10 10:05:06,538 - INFO - wrapper - Writing example 0
2021-04-10 10:05:09,877 - INFO - modeling - Saving complete
2021-04-10 10:05:09,877 - INFO - modeling - Starting evaluation...
2021-04-10 10:05:30,298 - INFO - wrapper - Writing example 0
2021-04-10 10:05:30,917 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:05:30,918 - INFO - wrapper - 1
2021-04-10 10:05:48,483 - INFO - wrapper - Writing example 0
2021-04-10 10:05:49,095 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:05:49,095 - INFO - wrapper - 2
2021-04-10 10:06:06,516 - INFO - wrapper - Writing example 0
2021-04-10 10:06:07,129 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:06:07,129 - INFO - wrapper - 3
2021-04-10 10:06:15,260 - INFO - wrapper - Writing example 0
2021-04-10 10:06:16,555 - INFO - wrapper - Writing example 0
2021-04-10 10:06:17,848 - INFO - modeling - --- RESULT (pattern_id=1, Task=mr) ---
2021-04-10 10:06:17,848 - INFO - modeling - eval_results:
2021-04-10 10:06:17,848 - INFO - modeling - {'acc': 0.96875}
2021-04-10 10:06:25,399 - INFO - wrapper - Writing example 0
2021-04-10 10:06:26,011 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:06:26,012 - INFO - wrapper - 4
2021-04-10 10:06:43,411 - INFO - wrapper - Writing example 0
2021-04-10 10:06:44,026 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:06:44,026 - INFO - wrapper - 5
2021-04-10 10:07:01,468 - INFO - wrapper - Writing example 0
2021-04-10 10:07:02,080 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:07:02,080 - INFO - wrapper - 6
2021-04-10 10:07:19,494 - INFO - wrapper - Writing example 0
2021-04-10 10:07:20,127 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:07:20,128 - INFO - wrapper - 7
2021-04-10 10:07:37,528 - INFO - wrapper - Writing example 0
2021-04-10 10:07:38,146 - INFO - wrapper - {'acc': 0.90625}
2021-04-10 10:07:38,146 - INFO - wrapper - 8
2021-04-10 10:08:43,753 - INFO - wrapper - Writing example 0
2021-04-10 10:08:44,402 - INFO - modeling - Saving complete
2021-04-10 10:08:44,402 - INFO - modeling - Starting evaluation...
2021-04-10 10:09:50,539 - INFO - wrapper - Writing example 0
2021-04-10 10:09:51,170 - INFO - wrapper - Writing example 0
2021-04-10 10:09:51,777 - INFO - modeling - --- RESULT (pattern_id=1, Task=cr) ---
2021-04-10 10:09:51,777 - INFO - modeling - eval_results:
2021-04-10 10:09:51,777 - INFO - modeling - {'acc': 0.9375}
2021-04-10 10:48:50,360 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 10:48:50,360 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=train)
2021-04-10 10:48:50,371 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 10:48:50,371 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=test)
2021-04-10 10:48:50,390 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-10 10:48:50,391 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev)
2021-04-10 10:48:50,394 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 10:48:53,154 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='cr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-10 10:48:53,154 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=train)
2021-04-10 10:48:53,158 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 10:48:53,159 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=test)
2021-04-10 10:48:53,178 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-10 10:48:53,178 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=dev)
2021-04-10 10:48:53,181 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-10 10:49:42,538 - INFO - wrapper - Writing example 0
2021-04-10 10:49:43,678 - INFO - wrapper - Writing example 0
2021-04-10 10:49:44,170 - INFO - wrapper - Writing example 0
2021-04-10 10:49:45,361 - INFO - wrapper - Writing example 0
2021-04-11 12:24:39,934 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-11 12:24:39,934 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-11 12:24:39,936 - INFO - task_processors - Returning 32 train examples with label dist.: [('0', 16), ('1', 16)]
2021-04-11 12:24:39,936 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-11 12:24:39,941 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-11 12:24:39,941 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-11 12:24:39,942 - INFO - task_processors - Returning 32 dev examples with label dist.: [('0', 16), ('1', 16)]
2021-04-11 12:25:30,637 - INFO - wrapper - Writing example 0
2021-04-11 12:25:32,177 - INFO - wrapper - Writing example 0
2021-04-11 12:26:07,025 - INFO - wrapper - Writing example 0
2021-04-11 12:26:08,563 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:26:08,563 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-11 12:26:08,563 - INFO - wrapper - Saving models.
2021-04-11 12:27:06,301 - INFO - wrapper - Writing example 0
2021-04-11 12:27:07,799 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:27:07,800 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-11 12:27:07,800 - INFO - wrapper - Saving models.
2021-04-11 12:28:01,698 - INFO - wrapper - Writing example 0
2021-04-11 12:28:03,212 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:28:03,212 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-11 12:28:03,212 - INFO - wrapper - Saving models.
2021-04-11 12:28:57,181 - INFO - wrapper - Writing example 0
2021-04-11 12:28:58,691 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:28:58,691 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 400
2021-04-11 12:28:58,691 - INFO - wrapper - Saving models.
2021-04-11 12:29:52,755 - INFO - wrapper - Writing example 0
2021-04-11 12:29:54,266 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:29:54,266 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 500
2021-04-11 12:29:54,267 - INFO - wrapper - Saving models.
2021-04-11 12:30:48,447 - INFO - wrapper - Writing example 0
2021-04-11 12:30:49,957 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:30:49,957 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 600
2021-04-11 12:30:49,957 - INFO - wrapper - Saving models.
2021-04-11 12:31:44,053 - INFO - wrapper - Writing example 0
2021-04-11 12:31:45,566 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:31:45,567 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 700
2021-04-11 12:31:45,567 - INFO - wrapper - Saving models.
2021-04-11 12:32:39,504 - INFO - wrapper - Writing example 0
2021-04-11 12:32:41,011 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:32:41,011 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 800
2021-04-11 12:32:41,011 - INFO - wrapper - Saving models.
2021-04-11 12:33:35,112 - INFO - wrapper - Writing example 0
2021-04-11 12:33:36,625 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:33:36,625 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 900
2021-04-11 12:33:36,625 - INFO - wrapper - Saving models.
2021-04-11 12:34:30,705 - INFO - wrapper - Writing example 0
2021-04-11 12:34:32,252 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-11 12:34:32,253 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 1000
2021-04-11 12:34:32,253 - INFO - wrapper - Saving models.
2021-04-11 12:36:03,809 - INFO - wrapper - Writing example 0
2021-04-11 12:36:05,335 - INFO - modeling - Saving complete
2021-04-11 12:36:05,335 - INFO - modeling - Starting evaluation...
2021-04-11 12:37:16,791 - INFO - wrapper - Writing example 0
2021-04-11 12:37:58,453 - INFO - wrapper - Writing example 0
2021-04-11 12:38:00,015 - INFO - modeling - --- RESULT (pattern_id=1, Task=sst-2) ---
2021-04-11 12:38:00,016 - INFO - modeling - eval_results:
2021-04-11 12:38:00,016 - INFO - modeling - {'acc': 0.9185779816513762}
2021-04-11 13:00:40,598 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-11 13:00:40,598 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=train)
2021-04-11 13:00:40,603 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-11 13:00:40,603 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=test)
2021-04-11 13:00:40,624 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-11 13:00:40,624 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev)
2021-04-11 13:00:40,627 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-11 13:01:31,528 - INFO - wrapper - Writing example 0
2021-04-11 13:01:33,099 - INFO - wrapper - Writing example 0
2021-04-11 13:02:08,010 - INFO - wrapper - Writing example 0
2021-04-11 13:02:09,549 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:02:09,549 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-11 13:02:09,549 - INFO - wrapper - Saving models.
2021-04-11 13:03:03,177 - INFO - wrapper - Writing example 0
2021-04-11 13:03:04,685 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:03:04,685 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-11 13:03:04,685 - INFO - wrapper - Saving models.
2021-04-11 13:04:00,061 - INFO - wrapper - Writing example 0
2021-04-11 13:04:01,558 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:04:01,559 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 300
2021-04-11 13:04:01,559 - INFO - wrapper - Saving models.
2021-04-11 13:04:56,265 - INFO - wrapper - Writing example 0
2021-04-11 13:04:57,776 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:04:57,777 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 400
2021-04-11 13:04:57,777 - INFO - wrapper - Saving models.
2021-04-11 13:05:52,690 - INFO - wrapper - Writing example 0
2021-04-11 13:05:54,193 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:05:54,193 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 500
2021-04-11 13:05:54,193 - INFO - wrapper - Saving models.
2021-04-11 13:06:49,703 - INFO - wrapper - Writing example 0
2021-04-11 13:06:51,214 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:06:51,215 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 600
2021-04-11 13:06:51,215 - INFO - wrapper - Saving models.
2021-04-11 13:07:46,591 - INFO - wrapper - Writing example 0
2021-04-11 13:07:48,088 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:07:48,088 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 700
2021-04-11 13:07:48,088 - INFO - wrapper - Saving models.
2021-04-11 13:08:43,630 - INFO - wrapper - Writing example 0
2021-04-11 13:08:45,135 - INFO - wrapper - {'acc': 0.84375}
2021-04-11 13:08:45,135 - INFO - wrapper - 7
2021-04-11 13:09:19,471 - INFO - wrapper - Writing example 0
2021-04-11 13:09:20,974 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:09:20,974 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 900
2021-04-11 13:09:20,974 - INFO - wrapper - Saving models.
2021-04-11 13:10:16,602 - INFO - wrapper - Writing example 0
2021-04-11 13:10:18,110 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:10:18,110 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 1000
2021-04-11 13:10:18,110 - INFO - wrapper - Saving models.
2021-04-11 13:11:49,129 - INFO - wrapper - Writing example 0
2021-04-11 13:11:50,672 - INFO - modeling - Saving complete
2021-04-11 13:11:50,672 - INFO - modeling - Starting evaluation...
2021-04-11 13:13:02,275 - INFO - wrapper - Writing example 0
2021-04-11 13:14:37,423 - INFO - wrapper - Writing example 0
2021-04-11 13:14:38,949 - INFO - modeling - --- RESULT (pattern_id=1, Task=mr) ---
2021-04-11 13:14:38,950 - INFO - modeling - eval_results:
2021-04-11 13:14:38,950 - INFO - modeling - {'acc': 0.881}
2021-04-11 13:15:41,055 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-11 13:15:41,055 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=train)
2021-04-11 13:15:41,060 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-11 13:15:41,060 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=test)
2021-04-11 13:15:41,080 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-11 13:15:41,080 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev)
2021-04-11 13:15:41,083 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-11 13:16:32,377 - INFO - wrapper - Writing example 0
2021-04-11 13:16:33,945 - INFO - wrapper - Writing example 0
2021-04-11 13:17:08,777 - INFO - wrapper - Writing example 0
2021-04-11 13:17:10,312 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:17:10,312 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-11 13:17:10,312 - INFO - wrapper - Saving models.
2021-04-11 13:18:05,406 - INFO - wrapper - Writing example 0
2021-04-11 13:18:06,900 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:18:06,900 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-11 13:18:06,900 - INFO - wrapper - Saving models.
2021-04-11 13:19:01,634 - INFO - wrapper - Writing example 0
2021-04-11 13:19:03,143 - INFO - wrapper - {'acc': 0.90625}
2021-04-11 13:19:03,143 - INFO - wrapper - 1
2021-04-11 13:19:37,591 - INFO - wrapper - Writing example 0
2021-04-11 13:19:39,067 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:19:39,067 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 400
2021-04-11 13:19:39,067 - INFO - wrapper - Saving models.
2021-04-11 13:20:33,825 - INFO - wrapper - Writing example 0
2021-04-11 13:20:35,316 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-11 13:20:35,317 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 500
2021-04-11 13:20:35,317 - INFO - wrapper - Saving models.
2021-04-11 13:21:30,427 - INFO - wrapper - Writing example 0
2021-04-11 13:21:31,924 - INFO - wrapper - {'acc': 0.84375}
2021-04-11 13:21:31,924 - INFO - wrapper - 4
2021-04-11 13:22:06,272 - INFO - wrapper - Writing example 0
2021-04-11 13:22:07,766 - INFO - wrapper - {'acc': 0.875}
2021-04-11 13:22:07,766 - INFO - wrapper - 5
2021-04-11 13:22:42,208 - INFO - wrapper - Writing example 0
2021-04-11 13:22:43,704 - INFO - wrapper - {'acc': 0.875}
2021-04-11 13:22:43,705 - INFO - wrapper - 6
2021-04-11 13:23:18,054 - INFO - wrapper - Writing example 0
2021-04-11 13:23:19,554 - INFO - wrapper - {'acc': 0.875}
2021-04-11 13:23:19,554 - INFO - wrapper - 7
2021-04-11 13:23:53,881 - INFO - wrapper - Writing example 0
2021-04-11 13:23:55,390 - INFO - wrapper - {'acc': 0.875}
2021-04-11 13:23:55,390 - INFO - wrapper - 8
2021-04-11 13:25:06,642 - INFO - wrapper - Writing example 0
2021-04-11 13:25:08,191 - INFO - modeling - Saving complete
2021-04-11 13:25:08,192 - INFO - modeling - Starting evaluation...
2021-04-11 13:26:20,701 - INFO - wrapper - Writing example 0
2021-04-11 13:27:56,027 - INFO - wrapper - Writing example 0
2021-04-11 13:27:57,589 - INFO - modeling - --- RESULT (pattern_id=1, Task=mr) ---
2021-04-11 13:27:57,590 - INFO - modeling - eval_results:
2021-04-11 13:27:57,590 - INFO - modeling - {'acc': 0.866}
2021-04-12 05:07:38,864 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='cr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 05:07:38,864 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=train)
2021-04-12 05:07:38,884 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-12 05:07:38,885 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=test)
2021-04-12 05:07:38,911 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-12 05:07:38,911 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/16-42 (num_examples=-1, set_type=dev)
2021-04-12 05:07:38,914 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-12 05:08:28,160 - INFO - wrapper - Writing example 0
2021-04-12 05:08:28,858 - INFO - wrapper - Writing example 0
2021-04-12 05:08:47,569 - INFO - wrapper - Writing example 0
2021-04-12 05:08:48,279 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-12 05:08:48,280 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-12 05:08:48,280 - INFO - wrapper - Saving models.
2021-04-12 05:09:24,511 - INFO - wrapper - Writing example 0
2021-04-12 05:09:25,174 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-12 05:09:25,174 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-12 05:09:25,174 - INFO - wrapper - Saving models.
2021-04-12 05:10:04,415 - INFO - wrapper - Writing example 0
2021-04-12 05:10:05,070 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-12 05:10:05,071 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-12 05:10:05,071 - INFO - wrapper - Saving models.
2021-04-12 05:10:44,751 - INFO - wrapper - Writing example 0
2021-04-12 05:10:45,414 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-12 05:10:45,414 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 400
2021-04-12 05:10:45,414 - INFO - wrapper - Saving models.
2021-04-12 05:11:26,707 - INFO - wrapper - Writing example 0
2021-04-12 05:11:27,352 - INFO - wrapper - {'acc': 0.90625}
2021-04-12 05:11:27,352 - INFO - wrapper - 1
2021-04-12 05:11:44,975 - INFO - wrapper - Writing example 0
2021-04-12 05:11:45,705 - INFO - wrapper - {'acc': 0.90625}
2021-04-12 05:11:45,705 - INFO - wrapper - 2
2021-04-12 05:12:03,436 - INFO - wrapper - Writing example 0
2021-04-12 05:12:04,043 - INFO - wrapper - {'acc': 0.90625}
2021-04-12 05:12:04,043 - INFO - wrapper - 3
2021-04-12 05:12:21,626 - INFO - wrapper - Writing example 0
2021-04-12 05:12:22,235 - INFO - wrapper - {'acc': 0.90625}
2021-04-12 05:12:22,236 - INFO - wrapper - 4
2021-04-12 05:12:39,760 - INFO - wrapper - Writing example 0
2021-04-12 05:12:40,380 - INFO - wrapper - {'acc': 0.90625}
2021-04-12 05:12:40,380 - INFO - wrapper - 5
2021-04-12 05:12:57,738 - INFO - wrapper - Writing example 0
2021-04-12 05:12:58,341 - INFO - wrapper - {'acc': 0.90625}
2021-04-12 05:12:58,341 - INFO - wrapper - 6
2021-04-12 05:14:10,358 - INFO - wrapper - Writing example 0
2021-04-12 05:14:10,994 - INFO - modeling - Saving complete
2021-04-12 05:14:10,994 - INFO - modeling - Starting evaluation...
2021-04-12 05:15:24,888 - INFO - wrapper - Writing example 0
2021-04-12 05:16:03,790 - INFO - wrapper - Writing example 0
2021-04-12 05:16:04,446 - INFO - modeling - --- RESULT (pattern_id=1, Task=cr) ---
2021-04-12 05:16:04,446 - INFO - modeling - eval_results:
2021-04-12 05:16:04,446 - INFO - modeling - {'acc': 0.9175}
2021-04-12 05:18:19,395 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=8000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 05:18:19,395 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42 (num_examples=-1, set_type=train)
2021-04-12 05:18:19,528 - INFO - task_processors - Returning 13883 train examples with label dist.: [(0, 6406), (1, 7477)]
2021-04-12 05:18:19,529 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 05:18:19,751 - INFO - task_processors - Returning 3474 dev examples with label dist.: [(0, 1603), (1, 1871)]
2021-04-12 05:18:45,372 - INFO - wrapper - Writing example 0
2021-04-12 05:18:51,159 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 05:18:51,159 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=train)
2021-04-12 05:18:51,209 - INFO - task_processors - Returning 6920 train examples with label dist.: [('0', 3310), ('1', 3610)]
2021-04-12 05:18:51,210 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-12 05:18:51,215 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 05:18:51,215 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 05:18:51,216 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-12 05:18:59,372 - INFO - wrapper - Writing example 10000
2021-04-12 05:19:17,566 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 05:19:17,567 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=train)
2021-04-12 05:19:17,637 - INFO - task_processors - Returning 8192 train examples with label dist.: [(0, 4096), (1, 4096)]
2021-04-12 05:19:17,637 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=test)
2021-04-12 05:19:17,660 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-12 05:19:17,660 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 05:19:17,667 - INFO - task_processors - Returning 470 dev examples with label dist.: [(0, 235), (1, 235)]
2021-04-12 05:19:47,776 - INFO - wrapper - Writing example 0
2021-04-12 05:19:53,856 - INFO - wrapper - Writing example 0
2021-04-12 05:20:06,586 - INFO - wrapper - Writing example 10000
2021-04-12 05:20:13,172 - INFO - wrapper - Writing example 0
2021-04-12 05:22:41,240 - INFO - wrapper - Writing example 0
2021-04-12 05:23:40,190 - INFO - wrapper - Writing example 0
2021-04-12 05:23:40,895 - INFO - wrapper - Writing example 0
2021-04-12 05:23:58,279 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 05:23:58,279 - INFO - wrapper - best_dev_acc: 0.8967 | best_global_step: 100
2021-04-12 05:23:58,279 - INFO - wrapper - Saving models.
2021-04-12 05:25:13,945 - INFO - wrapper - Writing example 0
2021-04-12 05:25:30,665 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 05:25:30,666 - INFO - wrapper - best_dev_acc: 0.9041 | best_global_step: 200
2021-04-12 05:25:30,666 - INFO - wrapper - Saving models.
2021-04-12 05:26:46,789 - INFO - wrapper - Writing example 0
2021-04-12 05:27:03,544 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 05:27:03,545 - INFO - wrapper - best_dev_acc: 0.9099 | best_global_step: 300
2021-04-12 05:27:03,545 - INFO - wrapper - Saving models.
2021-04-12 05:28:19,414 - INFO - wrapper - Writing example 0
2021-04-12 05:28:36,153 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 05:28:36,153 - INFO - wrapper - best_dev_acc: 0.9220 | best_global_step: 400
2021-04-12 05:28:36,154 - INFO - wrapper - Saving models.
2021-04-12 05:29:52,141 - INFO - wrapper - Writing example 0
2021-04-12 05:30:08,973 - INFO - wrapper - {'acc': 0.9173862982153138}
2021-04-12 05:30:08,973 - INFO - wrapper - 1
2021-04-12 05:31:17,413 - INFO - wrapper - Writing example 0
2021-04-12 05:31:33,955 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 05:31:33,955 - INFO - wrapper - best_dev_acc: 0.9223 | best_global_step: 600
2021-04-12 05:31:33,955 - INFO - wrapper - Saving models.
2021-04-12 05:32:49,917 - INFO - wrapper - Writing example 0
2021-04-12 05:33:06,589 - INFO - wrapper - {'acc': 0.9219919401266552}
2021-04-12 05:33:06,589 - INFO - wrapper - 1
2021-04-12 05:34:14,842 - INFO - wrapper - Writing example 0
2021-04-12 05:34:31,409 - INFO - wrapper - {'acc': 0.917098445595855}
2021-04-12 05:34:31,409 - INFO - wrapper - 2
2021-04-12 05:35:39,969 - INFO - wrapper - Writing example 0
2021-04-12 05:35:56,745 - INFO - wrapper - {'acc': 0.9211283822682786}
2021-04-12 05:35:56,746 - INFO - wrapper - 3
2021-04-12 05:37:05,054 - INFO - wrapper - Writing example 0
2021-04-12 05:37:21,610 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 05:37:21,610 - INFO - wrapper - best_dev_acc: 0.9240 | best_global_step: 1000
2021-04-12 05:37:21,610 - INFO - wrapper - Saving models.
2021-04-12 05:38:38,661 - INFO - wrapper - Writing example 0
2021-04-12 05:38:55,186 - INFO - wrapper - {'acc': 0.9225676453655728}
2021-04-12 05:38:55,186 - INFO - wrapper - 1
2021-04-12 05:40:17,162 - INFO - wrapper - Writing example 0
2021-04-12 05:41:01,033 - INFO - wrapper - {'acc': 0.9208405296488198}
2021-04-12 05:41:01,033 - INFO - wrapper - 2
2021-04-12 05:44:06,810 - INFO - wrapper - Writing example 0
2021-04-12 05:44:50,405 - INFO - wrapper - {'acc': 0.9208405296488198}
2021-04-12 05:44:50,405 - INFO - wrapper - 3
2021-04-12 05:47:47,031 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 05:47:47,031 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=train)
2021-04-12 05:47:47,077 - INFO - task_processors - Returning 6920 train examples with label dist.: [('0', 3310), ('1', 3610)]
2021-04-12 05:47:47,078 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-12 05:47:47,083 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 05:47:47,083 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 05:47:47,083 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-12 05:47:56,256 - INFO - wrapper - Writing example 0
2021-04-12 05:48:40,417 - INFO - wrapper - {'acc': 0.9182498560736903}
2021-04-12 05:48:40,418 - INFO - wrapper - 4
2021-04-12 05:48:44,014 - INFO - wrapper - Writing example 0
2021-04-12 05:52:43,571 - INFO - wrapper - Writing example 0
2021-04-12 05:53:10,942 - INFO - wrapper - Writing example 0
2021-04-12 05:54:25,583 - INFO - wrapper - {'acc': 0.9208405296488198}
2021-04-12 05:54:25,584 - INFO - wrapper - 5
2021-04-12 05:58:42,520 - INFO - wrapper - Writing example 0
2021-04-12 05:59:26,927 - INFO - wrapper - {'acc': 0.9214162348877375}
2021-04-12 05:59:26,927 - INFO - wrapper - 6
2021-04-12 06:02:32,650 - INFO - wrapper - Writing example 0
2021-04-12 06:03:16,234 - INFO - wrapper - {'acc': 0.9231433506044905}
2021-04-12 06:03:16,234 - INFO - wrapper - 7
2021-04-12 06:06:21,535 - INFO - wrapper - Writing example 0
2021-04-12 06:07:05,668 - INFO - wrapper - {'acc': 0.9225676453655728}
2021-04-12 06:07:05,668 - INFO - wrapper - 8
2021-04-12 06:10:12,092 - INFO - wrapper - Writing example 0
2021-04-12 06:10:55,888 - INFO - wrapper - {'acc': 0.9211283822682786}
2021-04-12 06:10:55,888 - INFO - wrapper - 9
2021-04-12 06:14:01,980 - INFO - wrapper - Writing example 0
2021-04-12 06:14:45,894 - INFO - wrapper - {'acc': 0.9234312032239493}
2021-04-12 06:14:45,895 - INFO - wrapper - 10
2021-04-12 06:15:16,616 - INFO - wrapper - Writing example 0
2021-04-12 06:15:30,285 - INFO - wrapper - Writing example 10000
2021-04-12 06:18:14,626 - INFO - modeling - Saving complete
2021-04-12 06:18:14,627 - INFO - modeling - Starting evaluation...
2021-04-12 06:28:39,048 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=8000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 06:28:39,049 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42 (num_examples=-1, set_type=train)
2021-04-12 06:28:39,160 - INFO - task_processors - Returning 13883 train examples with label dist.: [(0, 6406), (1, 7477)]
2021-04-12 06:28:39,160 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 06:28:39,391 - INFO - task_processors - Returning 3474 dev examples with label dist.: [(0, 1603), (1, 1871)]
2021-04-12 06:29:10,252 - INFO - wrapper - Writing example 0
2021-04-12 06:29:23,868 - INFO - wrapper - Writing example 10000
2021-04-12 06:32:07,473 - INFO - wrapper - Writing example 0
2021-04-12 06:32:19,653 - INFO - wrapper - Writing example 10000
2021-04-12 06:35:31,184 - INFO - wrapper - Writing example 0
2021-04-12 06:36:15,577 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 06:36:15,577 - INFO - wrapper - best_dev_acc: 0.8889 | best_global_step: 100
2021-04-12 06:36:15,577 - INFO - wrapper - Saving models.
2021-04-12 06:39:28,198 - INFO - wrapper - Writing example 0
2021-04-12 06:40:12,413 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 06:40:12,414 - INFO - wrapper - best_dev_acc: 0.9105 | best_global_step: 200
2021-04-12 06:40:12,414 - INFO - wrapper - Saving models.
2021-04-12 06:43:25,915 - INFO - wrapper - Writing example 0
2021-04-12 06:44:10,010 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 06:44:10,010 - INFO - wrapper - best_dev_acc: 0.9139 | best_global_step: 300
2021-04-12 06:44:10,010 - INFO - wrapper - Saving models.
2021-04-12 06:47:23,184 - INFO - wrapper - Writing example 0
2021-04-12 06:48:07,213 - INFO - wrapper - {'acc': 0.9124928036845136}
2021-04-12 06:48:07,213 - INFO - wrapper - 1
2021-04-12 06:51:13,367 - INFO - wrapper - Writing example 0
2021-04-12 06:51:57,174 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 06:51:57,175 - INFO - wrapper - best_dev_acc: 0.9165 | best_global_step: 500
2021-04-12 06:51:57,175 - INFO - wrapper - Saving models.
2021-04-12 06:55:11,438 - INFO - wrapper - Writing example 0
2021-04-12 06:55:55,421 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 06:55:55,422 - INFO - wrapper - best_dev_acc: 0.9226 | best_global_step: 600
2021-04-12 06:55:55,422 - INFO - wrapper - Saving models.
2021-04-12 06:59:09,369 - INFO - wrapper - Writing example 0
2021-04-12 06:59:52,584 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 06:59:52,585 - INFO - wrapper - best_dev_acc: 0.9243 | best_global_step: 700
2021-04-12 06:59:52,585 - INFO - wrapper - Saving models.
2021-04-12 07:03:06,881 - INFO - wrapper - Writing example 0
2021-04-12 07:03:50,715 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 07:03:50,715 - INFO - wrapper - best_dev_acc: 0.9249 | best_global_step: 800
2021-04-12 07:03:50,715 - INFO - wrapper - Saving models.
2021-04-12 07:07:03,926 - INFO - wrapper - Writing example 0
2021-04-12 07:07:47,940 - INFO - wrapper - {'acc': 0.9234312032239493}
2021-04-12 07:07:47,940 - INFO - wrapper - 1
2021-04-12 07:09:09,887 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 07:09:09,888 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=train)
2021-04-12 07:09:09,931 - INFO - task_processors - Returning 6920 train examples with label dist.: [('0', 3310), ('1', 3610)]
2021-04-12 07:09:09,931 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-12 07:09:09,936 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 07:09:09,936 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 07:09:09,936 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-12 07:10:09,294 - INFO - modeling - Starting evaluation...
2021-04-12 07:10:53,722 - INFO - wrapper - Writing example 0
2021-04-12 07:11:25,407 - INFO - wrapper - Writing example 0
2021-04-12 07:11:44,255 - INFO - wrapper - {'acc': 0.9214162348877375}
2021-04-12 07:11:44,256 - INFO - wrapper - 2
2021-04-12 07:14:54,297 - INFO - wrapper - Writing example 0
2021-04-12 07:15:38,206 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-12 07:15:38,206 - INFO - wrapper - best_dev_acc: 0.9249 | best_global_step: 1100
2021-04-12 07:15:38,206 - INFO - wrapper - Saving models.
2021-04-12 07:18:52,034 - INFO - wrapper - Writing example 0
2021-04-12 07:19:35,769 - INFO - wrapper - {'acc': 0.9245826137017847}
2021-04-12 07:19:35,770 - INFO - wrapper - 4
2021-04-12 07:22:41,198 - INFO - wrapper - Writing example 0
2021-04-12 07:23:25,272 - INFO - wrapper - {'acc': 0.9205526770293609}
2021-04-12 07:23:25,273 - INFO - wrapper - 5
2021-04-12 07:26:30,376 - INFO - wrapper - Writing example 0
2021-04-12 07:27:14,035 - INFO - wrapper - {'acc': 0.9208405296488198}
2021-04-12 07:27:14,036 - INFO - wrapper - 6
2021-04-12 07:30:19,475 - INFO - wrapper - Writing example 0
2021-04-12 07:31:03,231 - INFO - wrapper - {'acc': 0.9242947610823259}
2021-04-12 07:31:03,231 - INFO - wrapper - 7
2021-04-12 07:31:44,871 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 07:31:44,871 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=train)
2021-04-12 07:31:44,917 - INFO - task_processors - Returning 6920 train examples with label dist.: [('0', 3310), ('1', 3610)]
2021-04-12 07:31:44,917 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-12 07:31:44,922 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 07:31:44,922 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 07:31:44,923 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-12 07:32:43,556 - INFO - modeling - Starting evaluation...
2021-04-12 07:34:00,232 - INFO - wrapper - Writing example 0
2021-04-12 07:34:15,246 - INFO - wrapper - Writing example 0
2021-04-12 07:34:50,198 - INFO - wrapper - {'acc': 0.9222797927461139}
2021-04-12 07:34:50,198 - INFO - wrapper - 8
2021-04-12 07:35:59,015 - INFO - wrapper - Writing example 0
2021-04-12 07:36:15,856 - INFO - wrapper - {'acc': 0.9237190558434082}
2021-04-12 07:36:15,856 - INFO - wrapper - 9
2021-04-12 07:37:24,235 - INFO - wrapper - Writing example 0
2021-04-12 07:37:40,739 - INFO - wrapper - {'acc': 0.9165227403569373}
2021-04-12 07:37:40,739 - INFO - wrapper - 10
2021-04-12 07:38:10,755 - INFO - wrapper - Writing example 0
2021-04-12 07:38:24,457 - INFO - wrapper - Writing example 10000
2021-04-12 07:39:19,285 - INFO - modeling - Saving complete
2021-04-12 07:39:19,285 - INFO - modeling - Starting evaluation...
2021-04-12 07:47:59,993 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=8000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 07:47:59,994 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42 (num_examples=-1, set_type=train)
2021-04-12 07:48:00,103 - INFO - task_processors - Returning 13883 train examples with label dist.: [(0, 6406), (1, 7477)]
2021-04-12 07:48:00,103 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 07:48:00,314 - INFO - task_processors - Returning 3474 dev examples with label dist.: [(0, 1603), (1, 1871)]
2021-04-12 07:48:26,571 - INFO - modeling - Starting evaluation...
2021-04-12 07:48:57,715 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-12 07:48:57,743 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 07:48:57,743 - INFO - wrapper - Writing example 0
2021-04-12 07:49:02,366 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-12 07:49:02,366 - INFO - modeling - eval_results:
2021-04-12 07:49:02,366 - INFO - modeling - {'acc': 0.9529816513761468}
2021-04-12 07:49:02,367 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/mr/4096-42 (num_examples=-1, set_type=test)
2021-04-12 07:49:02,387 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-12 07:49:02,388 - INFO - wrapper - Writing example 0
2021-04-12 07:49:12,280 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-12 07:49:12,280 - INFO - modeling - eval_results:
2021-04-12 07:49:12,280 - INFO - modeling - {'acc': 0.904}
2021-04-12 07:49:12,280 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/cr/4096-42 (num_examples=-1, set_type=test)
2021-04-12 07:49:12,340 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-12 07:49:12,343 - INFO - wrapper - Writing example 0
2021-04-12 07:49:21,931 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-12 07:49:21,932 - INFO - modeling - eval_results:
2021-04-12 07:49:21,932 - INFO - modeling - {'acc': 0.908}
2021-04-12 07:53:50,251 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 07:53:50,251 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=train)
2021-04-12 07:53:50,296 - INFO - task_processors - Returning 6920 train examples with label dist.: [('0', 3310), ('1', 3610)]
2021-04-12 07:53:50,297 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-12 07:53:50,301 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 07:53:50,302 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 07:53:50,302 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-12 07:54:38,345 - INFO - modeling - Starting evaluation...
2021-04-12 07:55:48,024 - INFO - wrapper - Writing example 0
2021-04-12 07:58:15,969 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 07:58:15,970 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=train)
2021-04-12 07:58:16,015 - INFO - task_processors - Returning 6920 train examples with label dist.: [('0', 3310), ('1', 3610)]
2021-04-12 07:58:16,015 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-12 07:58:16,020 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 07:58:16,020 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 07:58:16,020 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-12 07:59:03,208 - INFO - modeling - Starting evaluation...
2021-04-12 08:00:11,381 - INFO - wrapper - Writing example 0
2021-04-12 08:00:20,548 - INFO - modeling - --- RESULT (pattern_id=1, Task=sst-2) ---
2021-04-12 08:00:20,549 - INFO - modeling - eval_results:
2021-04-12 08:00:20,549 - INFO - modeling - {'acc': 0.9185779816513762}
2021-04-12 08:03:35,182 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 08:03:35,182 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=train)
2021-04-12 08:03:35,227 - INFO - task_processors - Returning 6920 train examples with label dist.: [('0', 3310), ('1', 3610)]
2021-04-12 08:03:35,227 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-12 08:03:35,232 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 08:03:35,232 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 08:03:35,232 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-12 08:04:21,493 - INFO - wrapper - Writing example 0
2021-04-12 08:05:33,130 - INFO - wrapper - Writing example 0
2021-04-12 08:05:56,460 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 08:05:56,461 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=train)
2021-04-12 08:05:56,527 - INFO - task_processors - Returning 8192 train examples with label dist.: [(0, 4096), (1, 4096)]
2021-04-12 08:05:56,527 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=test)
2021-04-12 08:05:56,548 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-12 08:05:56,549 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=dev)
2021-04-12 08:05:56,556 - INFO - task_processors - Returning 470 dev examples with label dist.: [(0, 235), (1, 235)]
2021-04-12 08:06:49,260 - INFO - wrapper - Writing example 0
2021-04-12 08:08:29,780 - INFO - wrapper - Writing example 0
2021-04-12 08:11:33,653 - INFO - wrapper - Writing example 0
2021-04-12 08:11:38,565 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-12 08:11:38,565 - INFO - wrapper - best_dev_acc: 0.9000 | best_global_step: 100
2021-04-12 08:11:38,565 - INFO - wrapper - Saving models.
2021-04-12 08:11:57,583 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=2048, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 08:11:57,583 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=train)
2021-04-12 08:11:57,798 - INFO - task_processors - Returning 4096 train examples with label dist.: [('0', 2048), ('1', 2048)]
2021-04-12 08:11:57,798 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=test)
2021-04-12 08:11:57,803 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 08:11:57,803 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=dev)
2021-04-12 08:11:57,820 - INFO - task_processors - Returning 2824 dev examples with label dist.: [('0', 1262), ('1', 1562)]
2021-04-12 08:12:49,769 - INFO - wrapper - Writing example 0
2021-04-12 08:14:26,237 - INFO - wrapper - Writing example 0
2021-04-12 08:15:37,703 - INFO - wrapper - Writing example 0
2021-04-12 08:15:42,595 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-12 08:15:42,595 - INFO - wrapper - best_dev_acc: 0.9191 | best_global_step: 200
2021-04-12 08:15:42,595 - INFO - wrapper - Saving models.
2021-04-12 08:18:55,562 - INFO - wrapper - Writing example 0
2021-04-12 08:19:00,472 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-12 08:19:00,472 - INFO - wrapper - best_dev_acc: 0.9234 | best_global_step: 300
2021-04-12 08:19:00,472 - INFO - wrapper - Saving models.
2021-04-12 08:22:12,645 - INFO - wrapper - Writing example 0
2021-04-12 08:22:17,512 - INFO - wrapper - {'acc': 0.9191489361702128}
2021-04-12 08:22:17,513 - INFO - wrapper - 1
2021-04-12 08:25:10,188 - INFO - wrapper - Writing example 0
2021-04-12 08:25:15,074 - INFO - wrapper - {'acc': 0.9191489361702128}
2021-04-12 08:25:15,074 - INFO - wrapper - 2
2021-04-12 08:28:07,830 - INFO - wrapper - Writing example 0
2021-04-12 08:28:12,693 - INFO - wrapper - {'acc': 0.9212765957446809}
2021-04-12 08:28:12,693 - INFO - wrapper - 3
2021-04-12 08:31:05,592 - INFO - wrapper - Writing example 0
2021-04-12 08:31:10,461 - INFO - wrapper - {'acc': 0.9191489361702128}
2021-04-12 08:31:10,461 - INFO - wrapper - 4
2021-04-12 08:34:03,360 - INFO - wrapper - Writing example 0
2021-04-12 08:34:08,219 - INFO - wrapper - {'acc': 0.9212765957446809}
2021-04-12 08:34:08,219 - INFO - wrapper - 5
2021-04-12 08:37:00,934 - INFO - wrapper - Writing example 0
2021-04-12 08:37:06,013 - INFO - wrapper - {'acc': 0.9191489361702128}
2021-04-12 08:37:06,013 - INFO - wrapper - 6
2021-04-12 08:39:58,433 - INFO - wrapper - Writing example 0
2021-04-12 08:40:03,299 - INFO - wrapper - {'acc': 0.9170212765957447}
2021-04-12 08:40:03,299 - INFO - wrapper - 7
2021-04-12 08:41:16,333 - INFO - wrapper - Writing example 0
2021-04-12 08:42:43,055 - INFO - modeling - Saving complete
2021-04-12 08:42:43,055 - INFO - modeling - Starting evaluation...
2021-04-12 08:43:55,677 - INFO - wrapper - Writing example 0
2021-04-12 08:44:16,759 - INFO - modeling - --- RESULT (pattern_id=1, Task=mr) ---
2021-04-12 08:44:16,760 - INFO - modeling - eval_results:
2021-04-12 08:44:16,760 - INFO - modeling - {'acc': 0.9165}
2021-04-12 08:58:05,060 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=2048, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 08:58:05,061 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=train)
2021-04-12 08:58:05,086 - INFO - task_processors - Returning 4096 train examples with label dist.: [('0', 2048), ('1', 2048)]
2021-04-12 08:58:05,087 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=test)
2021-04-12 08:58:05,091 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-12 08:58:05,092 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=dev)
2021-04-12 08:58:05,109 - INFO - task_processors - Returning 2824 dev examples with label dist.: [('0', 1262), ('1', 1562)]
2021-04-12 08:58:50,244 - INFO - wrapper - Writing example 0
2021-04-12 08:59:32,646 - INFO - wrapper - Writing example 0
2021-04-12 09:01:08,685 - INFO - wrapper - Writing example 0
2021-04-12 09:01:38,128 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-12 09:01:38,129 - INFO - wrapper - best_dev_acc: 0.9366 | best_global_step: 100
2021-04-12 09:01:38,129 - INFO - wrapper - Saving models.
2021-04-12 09:03:32,196 - INFO - wrapper - Writing example 0
2021-04-12 09:04:01,351 - INFO - wrapper - {'acc': 0.9355524079320113}
2021-04-12 09:04:01,352 - INFO - wrapper - 1
2021-04-12 09:05:33,672 - INFO - wrapper - Writing example 0
2021-04-12 09:06:02,950 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-12 09:06:02,951 - INFO - wrapper - best_dev_acc: 0.9441 | best_global_step: 300
2021-04-12 09:06:02,951 - INFO - wrapper - Saving models.
2021-04-12 09:07:56,463 - INFO - wrapper - Writing example 0
2021-04-12 09:08:25,884 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-12 09:08:25,885 - INFO - wrapper - best_dev_acc: 0.9462 | best_global_step: 400
2021-04-12 09:08:25,885 - INFO - wrapper - Saving models.
2021-04-12 09:10:19,353 - INFO - wrapper - Writing example 0
2021-04-12 09:10:48,667 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-12 09:10:48,667 - INFO - wrapper - best_dev_acc: 0.9462 | best_global_step: 500
2021-04-12 09:10:48,667 - INFO - wrapper - Saving models.
2021-04-12 09:12:41,349 - INFO - wrapper - Writing example 0
2021-04-12 09:13:10,727 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-12 09:13:10,727 - INFO - wrapper - best_dev_acc: 0.9490 | best_global_step: 600
2021-04-12 09:13:10,728 - INFO - wrapper - Saving models.
2021-04-12 09:15:03,361 - INFO - wrapper - Writing example 0
2021-04-12 09:15:32,323 - INFO - wrapper - {'acc': 0.9475920679886686}
2021-04-12 09:15:32,323 - INFO - wrapper - 1
2021-04-12 09:17:03,749 - INFO - wrapper - Writing example 0
2021-04-12 09:17:32,820 - INFO - wrapper - {'acc': 0.9483002832861189}
2021-04-12 09:17:32,820 - INFO - wrapper - 2
2021-04-12 09:18:42,539 - INFO - wrapper - Writing example 0
2021-04-12 09:19:25,213 - INFO - modeling - Saving complete
2021-04-12 09:19:25,213 - INFO - modeling - Starting evaluation...
2021-04-12 09:20:39,380 - INFO - wrapper - Writing example 0
2021-04-12 09:20:49,156 - INFO - modeling - --- RESULT (pattern_id=1, Task=sst-2) ---
2021-04-12 09:20:49,157 - INFO - modeling - eval_results:
2021-04-12 09:20:49,157 - INFO - modeling - {'acc': 0.9575688073394495}
2021-04-12 09:29:31,406 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/650-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=650, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=600, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=16, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='cr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 09:29:31,407 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/650-42 (num_examples=-1, set_type=train)
2021-04-12 09:29:31,467 - INFO - task_processors - Returning 1018 train examples with label dist.: [(0, 368), (1, 650)]
2021-04-12 09:29:31,467 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/650-42 (num_examples=-1, set_type=test)
2021-04-12 09:29:31,500 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-12 09:29:31,500 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/650-42 (num_examples=-1, set_type=dev)
2021-04-12 09:29:31,512 - INFO - task_processors - Returning 650 dev examples with label dist.: [(1, 650)]
2021-04-12 09:30:19,307 - INFO - wrapper - Writing example 0
2021-04-12 09:30:30,034 - INFO - wrapper - Writing example 0
2021-04-12 09:31:22,840 - INFO - wrapper - Writing example 0
2021-04-12 09:31:29,754 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-12 09:31:29,754 - INFO - wrapper - best_dev_acc: 0.9662 | best_global_step: 100
2021-04-12 09:31:29,755 - INFO - wrapper - Saving models.
2021-04-12 09:32:42,918 - INFO - wrapper - Writing example 0
2021-04-12 09:32:49,827 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-12 09:32:49,827 - INFO - wrapper - best_dev_acc: 0.9692 | best_global_step: 200
2021-04-12 09:32:49,828 - INFO - wrapper - Saving models.
2021-04-12 09:34:02,825 - INFO - wrapper - Writing example 0
2021-04-12 09:34:09,780 - INFO - wrapper - {'acc': 0.94}
2021-04-12 09:34:09,780 - INFO - wrapper - 1
2021-04-12 09:35:01,618 - INFO - wrapper - Writing example 0
2021-04-12 09:35:08,501 - INFO - wrapper - {'acc': 0.9569230769230769}
2021-04-12 09:35:08,501 - INFO - wrapper - 2
2021-04-12 09:36:00,005 - INFO - wrapper - Writing example 0
2021-04-12 09:36:06,906 - INFO - wrapper - {'acc': 0.943076923076923}
2021-04-12 09:36:06,906 - INFO - wrapper - 3
2021-04-12 09:36:58,446 - INFO - wrapper - Writing example 0
2021-04-12 09:37:05,342 - INFO - wrapper - {'acc': 0.9415384615384615}
2021-04-12 09:37:05,342 - INFO - wrapper - 4
2021-04-12 09:38:13,662 - INFO - wrapper - Writing example 0
2021-04-12 09:38:24,504 - INFO - modeling - Saving complete
2021-04-12 09:38:24,505 - INFO - modeling - Starting evaluation...
2021-04-12 09:39:37,055 - INFO - wrapper - Writing example 0
2021-04-12 09:39:58,241 - INFO - modeling - --- RESULT (pattern_id=1, Task=cr) ---
2021-04-12 09:39:58,242 - INFO - modeling - eval_results:
2021-04-12 09:39:58,242 - INFO - modeling - {'acc': 0.9095}
2021-04-12 09:46:12,967 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 09:46:12,967 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-04-12 09:46:12,985 - INFO - task_processors - Returning 96 train examples with label dist.: [('entailment', 32), ('neutral', 32), ('contradiction', 32)]
2021-04-12 09:46:12,985 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-04-12 09:46:12,990 - INFO - task_processors - Returning 96 dev examples with label dist.: [('entailment', 32), ('neutral', 32), ('contradiction', 32)]
2021-04-12 09:46:38,642 - INFO - wrapper - Writing example 0
2021-04-12 09:46:47,959 - INFO - wrapper - Writing example 0
2021-04-12 09:46:49,154 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 09:46:49,154 - INFO - wrapper - best_dev_acc: 0.3958 | best_global_step: 100
2021-04-12 09:46:49,154 - INFO - wrapper - Saving models.
2021-04-12 09:47:02,112 - INFO - wrapper - Writing example 0
2021-04-12 09:47:03,302 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 09:47:03,303 - INFO - wrapper - best_dev_acc: 0.5729 | best_global_step: 200
2021-04-12 09:47:03,303 - INFO - wrapper - Saving models.
2021-04-12 09:47:19,640 - INFO - wrapper - Writing example 0
2021-04-12 09:47:20,812 - INFO - wrapper - {'acc': 0.5104166666666666}
2021-04-12 09:47:20,812 - INFO - wrapper - 1
2021-04-12 09:47:29,534 - INFO - wrapper - Writing example 0
2021-04-12 09:47:30,701 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 09:47:30,701 - INFO - wrapper - best_dev_acc: 0.6667 | best_global_step: 400
2021-04-12 09:47:30,701 - INFO - wrapper - Saving models.
2021-04-12 09:47:46,976 - INFO - wrapper - Writing example 0
2021-04-12 09:47:48,148 - INFO - wrapper - {'acc': 0.6041666666666666}
2021-04-12 09:47:48,148 - INFO - wrapper - 1
2021-04-12 09:47:56,783 - INFO - wrapper - Writing example 0
2021-04-12 09:47:57,912 - INFO - wrapper - {'acc': 0.6458333333333334}
2021-04-12 09:47:57,912 - INFO - wrapper - 2
2021-04-12 09:48:06,437 - INFO - wrapper - Writing example 0
2021-04-12 09:48:07,578 - INFO - wrapper - {'acc': 0.65625}
2021-04-12 09:48:07,578 - INFO - wrapper - 3
2021-04-12 09:48:16,122 - INFO - wrapper - Writing example 0
2021-04-12 09:48:17,264 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 09:48:17,264 - INFO - wrapper - best_dev_acc: 0.6875 | best_global_step: 800
2021-04-12 09:48:17,264 - INFO - wrapper - Saving models.
2021-04-12 09:48:33,357 - INFO - wrapper - Writing example 0
2021-04-12 09:48:34,494 - INFO - wrapper - {'acc': 0.6770833333333334}
2021-04-12 09:48:34,494 - INFO - wrapper - 1
2021-04-12 09:48:43,031 - INFO - wrapper - Writing example 0
2021-04-12 09:48:44,258 - INFO - wrapper - {'acc': 0.6770833333333334}
2021-04-12 09:48:44,259 - INFO - wrapper - 2
2021-04-12 09:49:14,500 - INFO - wrapper - Writing example 0
2021-04-12 09:49:15,801 - INFO - modeling - Saving complete
2021-04-12 09:49:15,801 - INFO - modeling - Starting evaluation...
2021-04-12 09:49:45,736 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/MNLI/16-42 (num_examples=-1, set_type=test)
2021-04-12 09:49:46,052 - INFO - task_processors - Returning 9815 test examples with label dist.: [('neutral', 3123), ('contradiction', 3213), ('entailment', 3479)]
2021-04-12 09:49:46,053 - INFO - modeling - Group g2: Task mnli 's Test examples number: 9815
2021-04-12 09:49:46,053 - INFO - wrapper - Writing example 0
2021-04-12 09:51:45,395 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-12 09:51:45,396 - INFO - modeling - eval_results:
2021-04-12 09:51:45,396 - INFO - modeling - {'acc': 0.5743250127356088}
2021-04-12 09:51:45,396 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SNLI/16-42 (num_examples=-1, set_type=test)
2021-04-12 09:51:45,871 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-12 09:51:45,878 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-12 09:51:45,879 - INFO - wrapper - Writing example 0
2021-04-12 09:53:08,274 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mnli/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=2000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mnli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 09:53:08,274 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mnli/16-42 (num_examples=-1, set_type=train)
2021-04-12 09:53:44,280 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=snli) ---
2021-04-12 09:53:44,281 - INFO - modeling - eval_results:
2021-04-12 09:53:44,281 - INFO - modeling - {'acc': 0.6414346677504572}
2021-04-12 09:56:21,990 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=2000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mnli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 09:56:21,990 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/16-42 (num_examples=-1, set_type=train)
2021-04-12 09:56:22,021 - INFO - task_processors - Returning 48 train examples with label dist.: [('entailment', 16), ('neutral', 16), ('contradiction', 16)]
2021-04-12 09:56:22,022 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/16-42 (num_examples=-1, set_type=test)
2021-04-12 09:56:22,320 - INFO - task_processors - Returning 9815 test examples with label dist.: [('neutral', 3123), ('contradiction', 3213), ('entailment', 3479)]
2021-04-12 09:56:22,320 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/16-42 (num_examples=-1, set_type=dev)
2021-04-12 09:56:22,322 - INFO - task_processors - Returning 48 dev examples with label dist.: [('entailment', 16), ('neutral', 16), ('contradiction', 16)]
2021-04-12 09:57:06,161 - INFO - wrapper - Writing example 0
2021-04-12 09:57:24,414 - INFO - wrapper - Writing example 0
2021-04-12 09:57:25,407 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 09:57:25,407 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 100
2021-04-12 09:57:25,407 - INFO - wrapper - Saving models.
2021-04-12 09:57:53,925 - INFO - wrapper - Writing example 0
2021-04-12 09:57:54,858 - INFO - wrapper - {'acc': 0.5833333333333334}
2021-04-12 09:57:54,859 - INFO - wrapper - 1
2021-04-12 09:58:12,174 - INFO - wrapper - Writing example 0
2021-04-12 09:58:13,108 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 09:58:13,108 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 300
2021-04-12 09:58:13,108 - INFO - wrapper - Saving models.
2021-04-12 09:58:51,630 - INFO - wrapper - Writing example 0
2021-04-12 09:58:52,557 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 09:58:52,557 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 400
2021-04-12 09:58:52,557 - INFO - wrapper - Saving models.
2021-04-12 09:59:30,869 - INFO - wrapper - Writing example 0
2021-04-12 09:59:31,801 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 09:59:31,801 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 500
2021-04-12 09:59:31,801 - INFO - wrapper - Saving models.
2021-04-12 10:00:10,394 - INFO - wrapper - Writing example 0
2021-04-12 10:00:11,342 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:00:11,342 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 600
2021-04-12 10:00:11,342 - INFO - wrapper - Saving models.
2021-04-12 10:00:27,517 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 10:00:27,784 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-04-12 10:00:28,340 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('neutral', 32), ('entailment', 32)]
2021-04-12 10:00:28,340 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-04-12 10:00:28,342 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('neutral', 32), ('entailment', 32)]
2021-04-12 10:00:50,569 - INFO - wrapper - Writing example 0
2021-04-12 10:00:51,611 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:00:51,611 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 700
2021-04-12 10:00:51,611 - INFO - wrapper - Saving models.
2021-04-12 10:00:55,164 - INFO - wrapper - Writing example 0
2021-04-12 10:01:04,602 - INFO - wrapper - Writing example 0
2021-04-12 10:01:05,813 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 10:01:05,813 - INFO - wrapper - best_dev_acc: 0.4479 | best_global_step: 100
2021-04-12 10:01:05,813 - INFO - wrapper - Saving models.
2021-04-12 10:01:32,278 - INFO - wrapper - Writing example 0
2021-04-12 10:01:34,684 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 10:01:34,684 - INFO - wrapper - best_dev_acc: 0.4688 | best_global_step: 200
2021-04-12 10:01:34,684 - INFO - wrapper - Saving models.
2021-04-12 10:01:38,612 - INFO - wrapper - Writing example 0
2021-04-12 10:01:39,952 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:01:39,952 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 800
2021-04-12 10:01:39,952 - INFO - wrapper - Saving models.
2021-04-12 10:01:51,028 - INFO - wrapper - Writing example 0
2021-04-12 10:01:52,181 - INFO - wrapper - {'acc': 0.4479166666666667}
2021-04-12 10:01:52,181 - INFO - wrapper - 1
2021-04-12 10:02:00,244 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=2000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mnli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 10:02:00,244 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/16-42 (num_examples=-1, set_type=train)
2021-04-12 10:02:00,651 - INFO - task_processors - Returning 48 train examples with label dist.: [('contradiction', 16), ('entailment', 16), ('neutral', 16)]
2021-04-12 10:02:00,651 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/16-42 (num_examples=-1, set_type=test)
2021-04-12 10:02:01,154 - INFO - wrapper - Writing example 0
2021-04-12 10:02:03,746 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 10:02:03,746 - INFO - wrapper - best_dev_acc: 0.5000 | best_global_step: 400
2021-04-12 10:02:03,746 - INFO - wrapper - Saving models.
2021-04-12 10:02:22,304 - INFO - wrapper - Writing example 0
2021-04-12 10:02:23,793 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:02:23,794 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 900
2021-04-12 10:02:23,794 - INFO - wrapper - Saving models.
2021-04-12 10:02:25,846 - INFO - wrapper - Writing example 0
2021-04-12 10:02:27,004 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 10:02:27,004 - INFO - wrapper - best_dev_acc: 0.5104 | best_global_step: 500
2021-04-12 10:02:27,004 - INFO - wrapper - Saving models.
2021-04-12 10:02:44,334 - INFO - wrapper - Writing example 0
2021-04-12 10:02:45,516 - INFO - wrapper - {'acc': 0.4791666666666667}
2021-04-12 10:02:45,516 - INFO - wrapper - 1
2021-04-12 10:03:00,610 - INFO - wrapper - Writing example 0
2021-04-12 10:03:03,075 - INFO - wrapper - {'acc': 0.5}
2021-04-12 10:03:03,075 - INFO - wrapper - 2
2021-04-12 10:03:11,582 - INFO - wrapper - Writing example 0
2021-04-12 10:03:13,074 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:03:13,074 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 1000
2021-04-12 10:03:13,074 - INFO - wrapper - Saving models.
2021-04-12 10:03:16,034 - INFO - wrapper - Writing example 0
2021-04-12 10:03:17,197 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 10:03:17,197 - INFO - wrapper - best_dev_acc: 0.5104 | best_global_step: 800
2021-04-12 10:03:17,197 - INFO - wrapper - Saving models.
2021-04-12 10:03:35,218 - INFO - wrapper - Writing example 0
2021-04-12 10:03:37,042 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 10:03:37,043 - INFO - wrapper - best_dev_acc: 0.5521 | best_global_step: 900
2021-04-12 10:03:37,043 - INFO - wrapper - Saving models.
2021-04-12 10:03:57,795 - INFO - wrapper - Writing example 0
2021-04-12 10:03:59,277 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:03:59,277 - INFO - wrapper - best_dev_acc: 0.6250 | best_global_step: 1100
2021-04-12 10:03:59,277 - INFO - wrapper - Saving models.
2021-04-12 10:03:59,761 - INFO - wrapper - Writing example 0
2021-04-12 10:04:00,917 - INFO - wrapper - {'acc': 0.5416666666666666}
2021-04-12 10:04:00,918 - INFO - wrapper - 1
2021-04-12 10:04:30,574 - INFO - wrapper - Writing example 0
2021-04-12 10:04:33,064 - INFO - modeling - Saving complete
2021-04-12 10:04:33,065 - INFO - modeling - Starting evaluation...
2021-04-12 10:04:40,392 - INFO - wrapper - Writing example 0
2021-04-12 10:04:41,339 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:04:41,339 - INFO - wrapper - best_dev_acc: 0.6250 | best_global_step: 1200
2021-04-12 10:04:41,339 - INFO - wrapper - Saving models.
2021-04-12 10:05:04,080 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-04-12 10:05:05,049 - INFO - task_processors - Returning 9815 test examples with label dist.: [('neutral', 3123), ('contradiction', 3213), ('entailment', 3479)]
2021-04-12 10:05:05,050 - INFO - modeling - Group g2: Task mnli 's Test examples number: 9815
2021-04-12 10:05:05,050 - INFO - wrapper - Writing example 0
2021-04-12 10:05:22,048 - INFO - wrapper - Writing example 0
2021-04-12 10:05:23,153 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:05:23,153 - INFO - wrapper - best_dev_acc: 0.6250 | best_global_step: 1300
2021-04-12 10:05:23,153 - INFO - wrapper - Saving models.
2021-04-12 10:06:05,930 - INFO - wrapper - Writing example 0
2021-04-12 10:06:07,042 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-12 10:06:07,042 - INFO - wrapper - best_dev_acc: 0.6458 | best_global_step: 1400
2021-04-12 10:06:07,042 - INFO - wrapper - Saving models.
2021-04-12 10:06:30,245 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=2000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='snli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 10:06:30,245 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/16-42 (num_examples=-1, set_type=train)
2021-04-12 10:06:30,247 - INFO - task_processors - Returning 48 train examples with label dist.: [('contradiction', 16), ('entailment', 16), ('neutral', 16)]
2021-04-12 10:06:30,247 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/16-42 (num_examples=-1, set_type=test)
2021-04-12 10:06:30,458 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-12 10:06:30,458 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/16-42 (num_examples=-1, set_type=dev)
2021-04-12 10:06:30,459 - INFO - task_processors - Returning 48 dev examples with label dist.: [('contradiction', 16), ('entailment', 16), ('neutral', 16)]
2021-04-12 10:06:50,361 - INFO - wrapper - Writing example 0
2021-04-12 10:06:51,475 - INFO - wrapper - {'acc': 0.625}
2021-04-12 10:06:51,475 - INFO - wrapper - 1
2021-04-12 10:07:13,858 - INFO - wrapper - Writing example 0
2021-04-12 10:07:15,023 - INFO - wrapper - {'acc': 0.625}
2021-04-12 10:07:15,024 - INFO - wrapper - 2
2021-04-12 10:07:24,791 - INFO - wrapper - Writing example 0
2021-04-12 10:07:43,743 - INFO - wrapper - Writing example 0
2021-04-12 10:07:46,067 - INFO - wrapper - {'acc': 0.625}
2021-04-12 10:07:46,067 - INFO - wrapper - 3
2021-04-12 10:08:00,008 - INFO - wrapper - Writing example 0
2021-04-12 10:08:02,344 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-12 10:08:02,344 - INFO - wrapper - best_dev_acc: 0.5833 | best_global_step: 100
2021-04-12 10:08:02,344 - INFO - wrapper - Saving models.
2021-04-12 10:08:13,683 - INFO - wrapper - Writing example 0
2021-04-12 10:08:15,703 - INFO - wrapper - {'acc': 0.625}
2021-04-12 10:08:15,703 - INFO - wrapper - 4
2021-04-12 10:08:48,680 - INFO - wrapper - Writing example 0
2021-04-12 10:08:50,237 - INFO - wrapper - Writing example 0
2021-04-12 10:08:50,746 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-12 10:08:50,746 - INFO - wrapper - best_dev_acc: 0.6875 | best_global_step: 200
2021-04-12 10:08:50,746 - INFO - wrapper - Saving models.
2021-04-12 10:08:51,522 - INFO - wrapper - {'acc': 0.625}
2021-04-12 10:08:51,522 - INFO - wrapper - 5
2021-04-12 10:08:59,622 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-12 10:08:59,623 - INFO - modeling - eval_results:
2021-04-12 10:08:59,623 - INFO - modeling - {'acc': 0.5102394294447274}
2021-04-12 10:08:59,623 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-04-12 10:08:59,852 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-12 10:08:59,864 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-12 10:08:59,864 - INFO - wrapper - Writing example 0
2021-04-12 10:09:10,601 - INFO - wrapper - Writing example 0
2021-04-12 10:09:11,537 - INFO - wrapper - {'acc': 0.625}
2021-04-12 10:09:11,537 - INFO - wrapper - 6
2021-04-12 10:09:33,571 - INFO - wrapper - Writing example 0
2021-04-12 10:09:34,676 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-12 10:09:34,676 - INFO - wrapper - best_dev_acc: 0.7083 | best_global_step: 300
2021-04-12 10:09:34,676 - INFO - wrapper - Saving models.
2021-04-12 10:10:17,926 - INFO - wrapper - Writing example 0
2021-04-12 10:10:19,062 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:10:19,062 - INFO - wrapper - 1
2021-04-12 10:10:27,161 - INFO - wrapper - Writing example 0
2021-04-12 10:10:29,377 - INFO - modeling - Saving complete
2021-04-12 10:10:29,377 - INFO - modeling - Starting evaluation...
2021-04-12 10:10:29,377 - INFO - modeling - Single: Task mnli 's Test examples number: 9815
2021-04-12 10:10:42,373 - INFO - wrapper - Writing example 0
2021-04-12 10:10:43,462 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:10:43,463 - INFO - wrapper - 2
2021-04-12 10:11:06,850 - INFO - wrapper - Writing example 0
2021-04-12 10:11:08,155 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:11:08,155 - INFO - wrapper - 3
2021-04-12 10:11:29,895 - INFO - wrapper - Writing example 0
2021-04-12 10:11:31,072 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:11:31,072 - INFO - wrapper - 4
2021-04-12 10:11:46,809 - INFO - wrapper - Writing example 0
2021-04-12 10:11:53,463 - INFO - wrapper - Writing example 0
2021-04-12 10:11:54,555 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:11:54,555 - INFO - wrapper - 5
2021-04-12 10:12:20,717 - INFO - wrapper - Writing example 0
2021-04-12 10:12:22,457 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:12:22,458 - INFO - wrapper - 6
2021-04-12 10:12:51,303 - INFO - wrapper - Writing example 0
2021-04-12 10:12:52,956 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:12:52,956 - INFO - wrapper - 7
2021-04-12 10:12:58,973 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=snli) ---
2021-04-12 10:12:58,974 - INFO - modeling - eval_results:
2021-04-12 10:12:58,974 - INFO - modeling - {'acc': 0.6193863035968299}
2021-04-12 10:13:20,034 - INFO - wrapper - Writing example 0
2021-04-12 10:13:21,495 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:13:21,496 - INFO - wrapper - 8
2021-04-12 10:13:47,968 - INFO - wrapper - Writing example 0
2021-04-12 10:13:49,423 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:13:49,423 - INFO - wrapper - 9
2021-04-12 10:14:15,814 - INFO - wrapper - Writing example 0
2021-04-12 10:14:17,267 - INFO - wrapper - {'acc': 0.6875}
2021-04-12 10:14:17,268 - INFO - wrapper - 10
2021-04-12 10:15:27,620 - INFO - wrapper - Writing example 0
2021-04-12 10:15:29,088 - INFO - modeling - Saving complete
2021-04-12 10:15:29,088 - INFO - modeling - Starting evaluation...
2021-04-12 10:15:29,088 - INFO - modeling - Single: Task snli 's Test examples number: 9842
2021-04-12 10:16:11,068 - INFO - modeling - --- RESULT (pattern_id=1, Task=mnli) ---
2021-04-12 10:16:11,068 - INFO - modeling - eval_results:
2021-04-12 10:16:11,068 - INFO - modeling - {'acc': 0.6241467142129393}
2021-04-12 10:16:40,347 - INFO - wrapper - Writing example 0
2021-04-12 10:19:52,356 - INFO - modeling - --- RESULT (pattern_id=1, Task=snli) ---
2021-04-12 10:19:52,356 - INFO - modeling - eval_results:
2021-04-12 10:19:52,356 - INFO - modeling - {'acc': 0.702804308067466}
2021-04-12 12:22:07,366 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=36000, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=36000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 12:22:07,367 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=train)
2021-04-12 12:22:37,753 - INFO - task_processors - Returning 753653 train examples with label dist.: [('entailment', 251451), ('neutral', 250931), ('contradiction', 251271)]
2021-04-12 12:22:37,754 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=dev)
2021-04-12 12:22:44,747 - INFO - task_processors - Returning 188416 dev examples with label dist.: [('entailment', 62864), ('neutral', 62733), ('contradiction', 62819)]
2021-04-12 12:23:10,506 - INFO - wrapper - Writing example 0
2021-04-12 12:23:25,997 - INFO - wrapper - Writing example 10000
2021-04-12 12:23:40,532 - INFO - wrapper - Writing example 20000
2021-04-12 12:23:54,890 - INFO - wrapper - Writing example 30000
2021-04-12 12:24:09,147 - INFO - wrapper - Writing example 40000
2021-04-12 12:24:23,399 - INFO - wrapper - Writing example 50000
2021-04-12 12:24:42,018 - INFO - wrapper - Writing example 60000
2021-04-12 12:24:56,233 - INFO - wrapper - Writing example 70000
2021-04-12 12:25:10,435 - INFO - wrapper - Writing example 80000
2021-04-12 12:25:24,711 - INFO - wrapper - Writing example 90000
2021-04-12 12:25:38,904 - INFO - wrapper - Writing example 100000
2021-04-12 12:25:53,073 - INFO - wrapper - Writing example 110000
2021-04-12 12:26:07,249 - INFO - wrapper - Writing example 120000
2021-04-12 12:26:21,352 - INFO - wrapper - Writing example 130000
2021-04-12 12:26:42,962 - INFO - wrapper - Writing example 140000
2021-04-12 12:26:57,236 - INFO - wrapper - Writing example 150000
2021-04-12 12:27:11,356 - INFO - wrapper - Writing example 160000
2021-04-12 12:27:25,460 - INFO - wrapper - Writing example 170000
2021-04-12 12:27:39,564 - INFO - wrapper - Writing example 180000
2021-04-12 12:27:53,596 - INFO - wrapper - Writing example 190000
2021-04-12 12:28:07,659 - INFO - wrapper - Writing example 200000
2021-04-12 12:28:21,819 - INFO - wrapper - Writing example 210000
2021-04-12 12:28:35,844 - INFO - wrapper - Writing example 220000
2021-04-12 12:28:49,890 - INFO - wrapper - Writing example 230000
2021-04-12 12:29:14,370 - INFO - wrapper - Writing example 240000
2021-04-12 12:29:28,398 - INFO - wrapper - Writing example 250000
2021-04-12 12:29:42,478 - INFO - wrapper - Writing example 260000
2021-04-12 12:29:56,600 - INFO - wrapper - Writing example 270000
2021-04-12 12:30:10,777 - INFO - wrapper - Writing example 280000
2021-04-12 12:30:24,848 - INFO - wrapper - Writing example 290000
2021-04-12 12:30:38,930 - INFO - wrapper - Writing example 300000
2021-04-12 12:30:53,025 - INFO - wrapper - Writing example 310000
2021-04-12 12:31:07,158 - INFO - wrapper - Writing example 320000
2021-04-12 12:31:21,141 - INFO - wrapper - Writing example 330000
2021-04-12 12:31:35,201 - INFO - wrapper - Writing example 340000
2021-04-12 12:31:49,306 - INFO - wrapper - Writing example 350000
2021-04-12 12:32:03,410 - INFO - wrapper - Writing example 360000
2021-04-12 12:32:32,804 - INFO - wrapper - Writing example 370000
2021-04-12 12:32:46,866 - INFO - wrapper - Writing example 380000
2021-04-12 12:33:00,948 - INFO - wrapper - Writing example 390000
2021-04-12 12:33:15,004 - INFO - wrapper - Writing example 400000
2021-04-12 12:33:29,055 - INFO - wrapper - Writing example 410000
2021-04-12 12:33:43,209 - INFO - wrapper - Writing example 420000
2021-04-12 12:33:57,281 - INFO - wrapper - Writing example 430000
2021-04-12 12:34:11,360 - INFO - wrapper - Writing example 440000
2021-04-12 12:34:25,401 - INFO - wrapper - Writing example 450000
2021-04-12 12:34:39,474 - INFO - wrapper - Writing example 460000
2021-04-12 12:34:53,540 - INFO - wrapper - Writing example 470000
2021-04-12 12:35:07,627 - INFO - wrapper - Writing example 480000
2021-04-12 12:35:21,679 - INFO - wrapper - Writing example 490000
2021-04-12 12:35:35,806 - INFO - wrapper - Writing example 500000
2021-04-12 12:35:49,852 - INFO - wrapper - Writing example 510000
2021-04-12 12:36:03,854 - INFO - wrapper - Writing example 520000
2021-04-12 12:36:38,417 - INFO - wrapper - Writing example 530000
2021-04-12 12:36:52,413 - INFO - wrapper - Writing example 540000
2021-04-12 12:37:06,340 - INFO - wrapper - Writing example 550000
2021-04-12 12:37:20,465 - INFO - wrapper - Writing example 560000
2021-04-12 12:37:34,693 - INFO - wrapper - Writing example 570000
2021-04-12 12:37:48,802 - INFO - wrapper - Writing example 580000
2021-04-12 12:38:02,859 - INFO - wrapper - Writing example 590000
2021-04-12 12:38:16,939 - INFO - wrapper - Writing example 600000
2021-04-12 12:38:30,984 - INFO - wrapper - Writing example 610000
2021-04-12 12:38:44,983 - INFO - wrapper - Writing example 620000
2021-04-12 12:38:59,091 - INFO - wrapper - Writing example 630000
2021-04-12 12:39:13,312 - INFO - wrapper - Writing example 640000
2021-04-12 12:39:27,461 - INFO - wrapper - Writing example 650000
2021-04-12 12:39:41,523 - INFO - wrapper - Writing example 660000
2021-04-12 12:39:55,527 - INFO - wrapper - Writing example 670000
2021-04-12 12:40:09,579 - INFO - wrapper - Writing example 680000
2021-04-12 12:40:23,666 - INFO - wrapper - Writing example 690000
2021-04-12 12:40:37,752 - INFO - wrapper - Writing example 700000
2021-04-12 12:40:51,680 - INFO - wrapper - Writing example 710000
2021-04-12 12:41:33,065 - INFO - wrapper - Writing example 720000
2021-04-12 12:41:47,049 - INFO - wrapper - Writing example 730000
2021-04-12 12:42:01,013 - INFO - wrapper - Writing example 740000
2021-04-12 12:42:14,914 - INFO - wrapper - Writing example 750000
2021-04-12 12:54:59,678 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=3600, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=36000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 12:54:59,678 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=train)
2021-04-12 12:55:28,206 - INFO - task_processors - Returning 753653 train examples with label dist.: [('entailment', 251451), ('neutral', 250931), ('contradiction', 251271)]
2021-04-12 12:55:28,207 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=dev)
2021-04-12 12:55:34,458 - INFO - task_processors - Returning 188416 dev examples with label dist.: [('entailment', 62864), ('neutral', 62733), ('contradiction', 62819)]
2021-04-12 12:56:02,541 - INFO - wrapper - Writing example 0
2021-04-12 12:56:18,114 - INFO - wrapper - Writing example 10000
2021-04-12 12:56:32,835 - INFO - wrapper - Writing example 20000
2021-04-12 12:56:47,262 - INFO - wrapper - Writing example 30000
2021-04-12 12:57:01,542 - INFO - wrapper - Writing example 40000
2021-04-12 12:57:15,779 - INFO - wrapper - Writing example 50000
2021-04-12 12:57:34,781 - INFO - wrapper - Writing example 60000
2021-04-12 12:57:49,101 - INFO - wrapper - Writing example 70000
2021-04-12 12:58:03,618 - INFO - wrapper - Writing example 80000
2021-04-12 12:58:17,968 - INFO - wrapper - Writing example 90000
2021-04-12 12:58:32,206 - INFO - wrapper - Writing example 100000
2021-04-12 12:58:42,650 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=5250, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=63000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=24, pet_per_gpu_train_batch_size=24, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mnli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-12 12:58:42,650 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/167000-42 (num_examples=-1, set_type=train)
2021-04-12 12:58:46,461 - INFO - wrapper - Writing example 110000
2021-04-12 12:58:57,817 - INFO - task_processors - Returning 392702 train examples with label dist.: [('entailment', 130899), ('neutral', 130900), ('contradiction', 130903)]
2021-04-12 12:58:57,818 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/167000-42 (num_examples=-1, set_type=test)
2021-04-12 12:58:58,099 - INFO - task_processors - Returning 9815 test examples with label dist.: [('neutral', 3123), ('contradiction', 3213), ('entailment', 3479)]
2021-04-12 12:58:58,099 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/167000-42 (num_examples=-1, set_type=dev)
2021-04-12 12:58:58,100 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-12 12:59:00,543 - INFO - wrapper - Writing example 120000
2021-04-12 12:59:14,594 - INFO - wrapper - Writing example 130000
2021-04-12 12:59:35,846 - INFO - wrapper - Writing example 140000
2021-04-12 12:59:50,263 - INFO - wrapper - Writing example 150000
2021-04-12 12:59:52,581 - INFO - wrapper - Writing example 0
2021-04-12 13:00:04,295 - INFO - wrapper - Writing example 160000
2021-04-12 13:00:10,884 - INFO - wrapper - Writing example 10000
2021-04-12 13:00:18,276 - INFO - wrapper - Writing example 170000
2021-04-12 13:00:26,386 - INFO - wrapper - Writing example 20000
2021-04-12 13:00:32,246 - INFO - wrapper - Writing example 180000
2021-04-12 13:00:41,774 - INFO - wrapper - Writing example 30000
2021-04-12 13:00:46,542 - INFO - wrapper - Writing example 190000
2021-04-12 13:00:56,841 - INFO - wrapper - Writing example 40000
2021-04-12 13:01:00,782 - INFO - wrapper - Writing example 200000
2021-04-12 13:01:14,518 - INFO - wrapper - Writing example 50000
2021-04-12 13:01:15,077 - INFO - wrapper - Writing example 210000
2021-04-12 13:01:29,178 - INFO - wrapper - Writing example 220000
2021-04-12 13:01:29,338 - INFO - wrapper - Writing example 60000
2021-04-12 13:01:43,280 - INFO - wrapper - Writing example 230000
2021-04-12 13:01:44,217 - INFO - wrapper - Writing example 70000
2021-04-12 13:01:59,028 - INFO - wrapper - Writing example 80000
2021-04-12 13:02:08,231 - INFO - wrapper - Writing example 240000
2021-04-12 13:02:17,957 - INFO - wrapper - Writing example 90000
2021-04-12 13:02:22,181 - INFO - wrapper - Writing example 250000
2021-04-12 13:02:32,778 - INFO - wrapper - Writing example 100000
2021-04-12 13:02:36,177 - INFO - wrapper - Writing example 260000
2021-04-12 13:02:47,615 - INFO - wrapper - Writing example 110000
2021-04-12 13:02:50,224 - INFO - wrapper - Writing example 270000
2021-04-12 13:03:02,319 - INFO - wrapper - Writing example 120000
2021-04-12 13:03:04,254 - INFO - wrapper - Writing example 280000
2021-04-12 13:03:17,431 - INFO - wrapper - Writing example 130000
2021-04-12 13:03:18,419 - INFO - wrapper - Writing example 290000
2021-04-12 13:03:32,337 - INFO - wrapper - Writing example 140000
2021-04-12 13:03:32,607 - INFO - wrapper - Writing example 300000
2021-04-12 13:03:46,735 - INFO - wrapper - Writing example 310000
2021-04-12 13:03:53,468 - INFO - wrapper - Writing example 150000
2021-04-12 13:04:00,887 - INFO - wrapper - Writing example 320000
2021-04-12 13:04:08,141 - INFO - wrapper - Writing example 160000
2021-04-12 13:04:15,006 - INFO - wrapper - Writing example 330000
2021-04-12 13:04:22,916 - INFO - wrapper - Writing example 170000
2021-04-12 13:04:29,056 - INFO - wrapper - Writing example 340000
2021-04-12 13:04:37,444 - INFO - wrapper - Writing example 180000
2021-04-12 13:04:43,144 - INFO - wrapper - Writing example 350000
2021-04-12 13:04:52,184 - INFO - wrapper - Writing example 190000
2021-04-12 13:04:57,431 - INFO - wrapper - Writing example 360000
2021-04-12 13:05:07,055 - INFO - wrapper - Writing example 200000
2021-04-12 13:05:27,107 - INFO - wrapper - Writing example 370000
2021-04-12 13:05:30,458 - INFO - wrapper - Writing example 210000
2021-04-12 13:05:41,155 - INFO - wrapper - Writing example 380000
2021-04-12 13:05:45,046 - INFO - wrapper - Writing example 220000
2021-04-12 13:05:55,258 - INFO - wrapper - Writing example 390000
2021-04-12 13:05:59,677 - INFO - wrapper - Writing example 230000
2021-04-12 13:06:09,339 - INFO - wrapper - Writing example 400000
2021-04-12 13:06:14,202 - INFO - wrapper - Writing example 240000
2021-04-12 13:06:23,342 - INFO - wrapper - Writing example 410000
2021-04-12 13:06:28,743 - INFO - wrapper - Writing example 250000
2021-04-12 13:06:37,571 - INFO - wrapper - Writing example 420000
2021-04-12 13:06:43,344 - INFO - wrapper - Writing example 260000
2021-04-12 13:06:51,745 - INFO - wrapper - Writing example 430000
2021-04-12 13:06:57,744 - INFO - wrapper - Writing example 270000
2021-04-12 13:07:05,876 - INFO - wrapper - Writing example 440000
2021-04-12 13:07:12,118 - INFO - wrapper - Writing example 280000
2021-04-12 13:07:19,903 - INFO - wrapper - Writing example 450000
2021-04-12 13:07:26,570 - INFO - wrapper - Writing example 290000
2021-04-12 13:07:33,947 - INFO - wrapper - Writing example 460000
2021-04-12 13:07:47,949 - INFO - wrapper - Writing example 470000
2021-04-12 13:07:52,507 - INFO - wrapper - Writing example 300000
2021-04-12 13:08:01,985 - INFO - wrapper - Writing example 480000
2021-04-12 13:08:06,892 - INFO - wrapper - Writing example 310000
2021-04-12 13:08:16,025 - INFO - wrapper - Writing example 490000
2021-04-12 13:08:21,315 - INFO - wrapper - Writing example 320000
2021-04-12 13:08:30,001 - INFO - wrapper - Writing example 500000
2021-04-12 13:08:36,068 - INFO - wrapper - Writing example 330000
2021-04-12 13:08:43,919 - INFO - wrapper - Writing example 510000
2021-04-12 13:08:50,538 - INFO - wrapper - Writing example 340000
2021-04-12 13:08:57,842 - INFO - wrapper - Writing example 520000
2021-04-12 13:09:04,969 - INFO - wrapper - Writing example 350000
2021-04-12 13:09:19,435 - INFO - wrapper - Writing example 360000
2021-04-12 13:09:32,158 - INFO - wrapper - Writing example 530000
2021-04-12 13:09:33,910 - INFO - wrapper - Writing example 370000
2021-04-12 13:09:46,174 - INFO - wrapper - Writing example 540000
2021-04-12 13:09:48,363 - INFO - wrapper - Writing example 380000
2021-04-12 13:10:00,721 - INFO - wrapper - Writing example 550000
2021-04-12 13:10:03,485 - INFO - wrapper - Writing example 390000
2021-04-12 13:10:14,907 - INFO - wrapper - Writing example 560000
2021-04-12 13:10:29,099 - INFO - wrapper - Writing example 570000
2021-04-12 13:10:43,313 - INFO - wrapper - Writing example 580000
2021-04-12 13:10:57,419 - INFO - wrapper - Writing example 590000
2021-04-12 13:11:11,521 - INFO - wrapper - Writing example 600000
2021-04-12 13:11:25,669 - INFO - wrapper - Writing example 610000
2021-04-12 13:11:39,722 - INFO - wrapper - Writing example 620000
2021-04-12 13:11:53,855 - INFO - wrapper - Writing example 630000
2021-04-12 13:12:08,413 - INFO - wrapper - Writing example 640000
2021-04-12 13:12:23,232 - INFO - wrapper - Writing example 650000
2021-04-12 13:12:38,193 - INFO - wrapper - Writing example 660000
2021-04-12 13:12:52,831 - INFO - wrapper - Writing example 670000
2021-04-12 13:13:06,943 - INFO - wrapper - Writing example 680000
2021-04-12 13:13:21,109 - INFO - wrapper - Writing example 690000
2021-04-12 13:13:35,407 - INFO - wrapper - Writing example 700000
2021-04-12 13:13:49,683 - INFO - wrapper - Writing example 710000
2021-04-12 13:14:34,026 - INFO - wrapper - Writing example 720000
2021-04-12 13:14:47,987 - INFO - wrapper - Writing example 730000
2021-04-12 13:15:01,888 - INFO - wrapper - Writing example 740000
2021-04-12 13:15:16,259 - INFO - wrapper - Writing example 750000
2021-04-12 14:33:24,914 - INFO - wrapper - Writing example 0
2021-04-12 14:33:38,809 - INFO - wrapper - Writing example 10000
2021-04-12 14:33:52,787 - INFO - wrapper - Writing example 20000
2021-04-12 14:34:06,693 - INFO - wrapper - Writing example 30000
2021-04-12 14:34:20,670 - INFO - wrapper - Writing example 40000
2021-04-12 14:34:34,659 - INFO - wrapper - Writing example 50000
2021-04-12 14:34:48,847 - INFO - wrapper - Writing example 60000
2021-04-12 14:35:03,091 - INFO - wrapper - Writing example 70000
2021-04-12 14:35:17,419 - INFO - wrapper - Writing example 80000
2021-04-12 14:35:31,643 - INFO - wrapper - Writing example 90000
2021-04-12 14:35:46,079 - INFO - wrapper - Writing example 100000
2021-04-12 14:36:00,254 - INFO - wrapper - Writing example 110000
2021-04-12 14:36:14,296 - INFO - wrapper - Writing example 120000
2021-04-12 14:36:28,516 - INFO - wrapper - Writing example 130000
2021-04-12 14:36:42,823 - INFO - wrapper - Writing example 140000
2021-04-12 14:36:57,089 - INFO - wrapper - Writing example 150000
2021-04-12 14:37:11,441 - INFO - wrapper - Writing example 160000
2021-04-12 14:37:25,771 - INFO - wrapper - Writing example 170000
2021-04-12 14:37:39,937 - INFO - wrapper - Writing example 180000
2021-04-12 14:54:57,019 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 14:54:57,020 - INFO - wrapper - best_dev_acc: 0.8522 | best_global_step: 3600
2021-04-12 14:54:57,020 - INFO - wrapper - Saving models.
2021-04-12 15:26:57,532 - INFO - wrapper - Writing example 0
2021-04-12 15:27:11,555 - INFO - wrapper - Writing example 10000
2021-04-12 15:27:28,411 - INFO - wrapper - Writing example 20000
2021-04-12 15:27:42,364 - INFO - wrapper - Writing example 30000
2021-04-12 15:27:56,435 - INFO - wrapper - Writing example 40000
2021-04-12 15:28:10,725 - INFO - wrapper - Writing example 50000
2021-04-12 15:28:24,958 - INFO - wrapper - Writing example 60000
2021-04-12 15:28:39,300 - INFO - wrapper - Writing example 70000
2021-04-12 15:28:53,636 - INFO - wrapper - Writing example 80000
2021-04-12 15:29:14,414 - INFO - wrapper - Writing example 90000
2021-04-12 15:29:28,389 - INFO - wrapper - Writing example 100000
2021-04-12 15:29:42,473 - INFO - wrapper - Writing example 110000
2021-04-12 15:29:56,555 - INFO - wrapper - Writing example 120000
2021-04-12 15:30:10,670 - INFO - wrapper - Writing example 130000
2021-04-12 15:30:24,671 - INFO - wrapper - Writing example 140000
2021-04-12 15:30:38,967 - INFO - wrapper - Writing example 150000
2021-04-12 15:30:52,980 - INFO - wrapper - Writing example 160000
2021-04-12 15:31:16,695 - INFO - wrapper - Writing example 170000
2021-04-12 15:31:30,631 - INFO - wrapper - Writing example 180000
2021-04-12 15:48:55,530 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 15:48:55,531 - INFO - wrapper - best_dev_acc: 0.8647 | best_global_step: 7200
2021-04-12 15:48:55,531 - INFO - wrapper - Saving models.
2021-04-12 16:20:53,776 - INFO - wrapper - Writing example 0
2021-04-12 16:21:07,840 - INFO - wrapper - Writing example 10000
2021-04-12 16:21:22,233 - INFO - wrapper - Writing example 20000
2021-04-12 16:21:36,343 - INFO - wrapper - Writing example 30000
2021-04-12 16:21:50,562 - INFO - wrapper - Writing example 40000
2021-04-12 16:22:04,521 - INFO - wrapper - Writing example 50000
2021-04-12 16:22:18,544 - INFO - wrapper - Writing example 60000
2021-04-12 16:22:32,655 - INFO - wrapper - Writing example 70000
2021-04-12 16:22:47,114 - INFO - wrapper - Writing example 80000
2021-04-12 16:23:09,426 - INFO - wrapper - Writing example 90000
2021-04-12 16:23:23,768 - INFO - wrapper - Writing example 100000
2021-04-12 16:23:37,927 - INFO - wrapper - Writing example 110000
2021-04-12 16:23:52,026 - INFO - wrapper - Writing example 120000
2021-04-12 16:24:06,130 - INFO - wrapper - Writing example 130000
2021-04-12 16:24:20,291 - INFO - wrapper - Writing example 140000
2021-04-12 16:24:34,469 - INFO - wrapper - Writing example 150000
2021-04-12 16:24:48,752 - INFO - wrapper - Writing example 160000
2021-04-12 16:25:13,758 - INFO - wrapper - Writing example 170000
2021-04-12 16:25:27,940 - INFO - wrapper - Writing example 180000
2021-04-12 16:42:51,333 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 16:42:51,334 - INFO - wrapper - best_dev_acc: 0.8674 | best_global_step: 10800
2021-04-12 16:42:51,334 - INFO - wrapper - Saving models.
2021-04-12 17:14:55,181 - INFO - wrapper - Writing example 0
2021-04-12 17:15:09,235 - INFO - wrapper - Writing example 10000
2021-04-12 17:15:23,334 - INFO - wrapper - Writing example 20000
2021-04-12 17:15:37,401 - INFO - wrapper - Writing example 30000
2021-04-12 17:15:51,484 - INFO - wrapper - Writing example 40000
2021-04-12 17:16:05,546 - INFO - wrapper - Writing example 50000
2021-04-12 17:16:19,613 - INFO - wrapper - Writing example 60000
2021-04-12 17:16:33,872 - INFO - wrapper - Writing example 70000
2021-04-12 17:16:48,218 - INFO - wrapper - Writing example 80000
2021-04-12 17:17:09,274 - INFO - wrapper - Writing example 90000
2021-04-12 17:17:23,962 - INFO - wrapper - Writing example 100000
2021-04-12 17:17:38,511 - INFO - wrapper - Writing example 110000
2021-04-12 17:17:52,625 - INFO - wrapper - Writing example 120000
2021-04-12 17:18:07,011 - INFO - wrapper - Writing example 130000
2021-04-12 17:18:21,100 - INFO - wrapper - Writing example 140000
2021-04-12 17:18:35,250 - INFO - wrapper - Writing example 150000
2021-04-12 17:18:49,628 - INFO - wrapper - Writing example 160000
2021-04-12 17:19:15,374 - INFO - wrapper - Writing example 170000
2021-04-12 17:19:29,995 - INFO - wrapper - Writing example 180000
2021-04-12 17:36:51,680 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 17:36:51,680 - INFO - wrapper - best_dev_acc: 0.8718 | best_global_step: 14400
2021-04-12 17:36:51,680 - INFO - wrapper - Saving models.
2021-04-12 18:08:53,162 - INFO - wrapper - Writing example 0
2021-04-12 18:09:06,726 - INFO - wrapper - Writing example 10000
2021-04-12 18:09:20,781 - INFO - wrapper - Writing example 20000
2021-04-12 18:09:34,808 - INFO - wrapper - Writing example 30000
2021-04-12 18:09:48,651 - INFO - wrapper - Writing example 40000
2021-04-12 18:10:02,370 - INFO - wrapper - Writing example 50000
2021-04-12 18:10:15,856 - INFO - wrapper - Writing example 60000
2021-04-12 18:10:29,540 - INFO - wrapper - Writing example 70000
2021-04-12 18:10:43,800 - INFO - wrapper - Writing example 80000
2021-04-12 18:11:03,010 - INFO - wrapper - Writing example 90000
2021-04-12 18:11:16,986 - INFO - wrapper - Writing example 100000
2021-04-12 18:11:31,037 - INFO - wrapper - Writing example 110000
2021-04-12 18:11:45,051 - INFO - wrapper - Writing example 120000
2021-04-12 18:11:58,815 - INFO - wrapper - Writing example 130000
2021-04-12 18:12:12,506 - INFO - wrapper - Writing example 140000
2021-04-12 18:12:26,041 - INFO - wrapper - Writing example 150000
2021-04-12 18:12:39,715 - INFO - wrapper - Writing example 160000
2021-04-12 18:13:02,112 - INFO - wrapper - Writing example 170000
2021-04-12 18:13:16,192 - INFO - wrapper - Writing example 180000
2021-04-12 18:30:34,644 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 18:30:34,645 - INFO - wrapper - best_dev_acc: 0.8767 | best_global_step: 18000
2021-04-12 18:30:34,645 - INFO - wrapper - Saving models.
2021-04-12 19:02:37,608 - INFO - wrapper - Writing example 0
2021-04-12 19:02:51,449 - INFO - wrapper - Writing example 10000
2021-04-12 19:03:05,393 - INFO - wrapper - Writing example 20000
2021-04-12 19:03:19,231 - INFO - wrapper - Writing example 30000
2021-04-12 19:03:32,787 - INFO - wrapper - Writing example 40000
2021-04-12 19:03:46,697 - INFO - wrapper - Writing example 50000
2021-04-12 19:04:00,476 - INFO - wrapper - Writing example 60000
2021-04-12 19:04:14,077 - INFO - wrapper - Writing example 70000
2021-04-12 19:04:28,032 - INFO - wrapper - Writing example 80000
2021-04-12 19:04:48,190 - INFO - wrapper - Writing example 90000
2021-04-12 19:05:02,221 - INFO - wrapper - Writing example 100000
2021-04-12 19:05:16,423 - INFO - wrapper - Writing example 110000
2021-04-12 19:05:30,574 - INFO - wrapper - Writing example 120000
2021-04-12 19:05:44,563 - INFO - wrapper - Writing example 130000
2021-04-12 19:05:58,555 - INFO - wrapper - Writing example 140000
2021-04-12 19:06:12,705 - INFO - wrapper - Writing example 150000
2021-04-12 19:06:26,527 - INFO - wrapper - Writing example 160000
2021-04-12 19:06:49,731 - INFO - wrapper - Writing example 170000
2021-04-12 19:07:03,672 - INFO - wrapper - Writing example 180000
2021-04-12 19:24:23,592 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 19:24:23,593 - INFO - wrapper - best_dev_acc: 0.8792 | best_global_step: 21600
2021-04-12 19:24:23,593 - INFO - wrapper - Saving models.
2021-04-12 19:56:27,630 - INFO - wrapper - Writing example 0
2021-04-12 19:56:41,663 - INFO - wrapper - Writing example 10000
2021-04-12 19:56:56,080 - INFO - wrapper - Writing example 20000
2021-04-12 19:57:10,243 - INFO - wrapper - Writing example 30000
2021-04-12 19:57:24,051 - INFO - wrapper - Writing example 40000
2021-04-12 19:57:37,779 - INFO - wrapper - Writing example 50000
2021-04-12 19:57:51,616 - INFO - wrapper - Writing example 60000
2021-04-12 19:58:05,539 - INFO - wrapper - Writing example 70000
2021-04-12 19:58:19,812 - INFO - wrapper - Writing example 80000
2021-04-12 19:58:39,201 - INFO - wrapper - Writing example 90000
2021-04-12 19:58:53,110 - INFO - wrapper - Writing example 100000
2021-04-12 19:59:06,907 - INFO - wrapper - Writing example 110000
2021-04-12 19:59:20,712 - INFO - wrapper - Writing example 120000
2021-04-12 19:59:34,777 - INFO - wrapper - Writing example 130000
2021-04-12 19:59:48,794 - INFO - wrapper - Writing example 140000
2021-04-12 20:00:03,018 - INFO - wrapper - Writing example 150000
2021-04-12 20:00:17,086 - INFO - wrapper - Writing example 160000
2021-04-12 20:00:41,307 - INFO - wrapper - Writing example 170000
2021-04-12 20:00:55,210 - INFO - wrapper - Writing example 180000
2021-04-12 20:18:15,152 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 20:18:15,153 - INFO - wrapper - best_dev_acc: 0.8807 | best_global_step: 25200
2021-04-12 20:18:15,153 - INFO - wrapper - Saving models.
2021-04-12 20:50:15,862 - INFO - wrapper - Writing example 0
2021-04-12 20:50:29,976 - INFO - wrapper - Writing example 10000
2021-04-12 20:50:43,883 - INFO - wrapper - Writing example 20000
2021-04-12 20:50:57,626 - INFO - wrapper - Writing example 30000
2021-04-12 20:51:11,472 - INFO - wrapper - Writing example 40000
2021-04-12 20:51:25,388 - INFO - wrapper - Writing example 50000
2021-04-12 20:51:39,177 - INFO - wrapper - Writing example 60000
2021-04-12 20:51:53,280 - INFO - wrapper - Writing example 70000
2021-04-12 20:52:07,493 - INFO - wrapper - Writing example 80000
2021-04-12 20:52:27,034 - INFO - wrapper - Writing example 90000
2021-04-12 20:52:41,114 - INFO - wrapper - Writing example 100000
2021-04-12 20:52:55,100 - INFO - wrapper - Writing example 110000
2021-04-12 20:53:08,981 - INFO - wrapper - Writing example 120000
2021-04-12 20:53:22,813 - INFO - wrapper - Writing example 130000
2021-04-12 20:53:36,820 - INFO - wrapper - Writing example 140000
2021-04-12 20:53:50,958 - INFO - wrapper - Writing example 150000
2021-04-12 20:54:04,994 - INFO - wrapper - Writing example 160000
2021-04-12 20:54:27,901 - INFO - wrapper - Writing example 170000
2021-04-12 20:54:41,694 - INFO - wrapper - Writing example 180000
2021-04-12 21:12:03,135 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 21:12:03,136 - INFO - wrapper - best_dev_acc: 0.8815 | best_global_step: 28800
2021-04-12 21:12:03,136 - INFO - wrapper - Saving models.
2021-04-12 21:44:05,710 - INFO - wrapper - Writing example 0
2021-04-12 21:44:19,442 - INFO - wrapper - Writing example 10000
2021-04-12 21:44:33,115 - INFO - wrapper - Writing example 20000
2021-04-12 21:44:46,680 - INFO - wrapper - Writing example 30000
2021-04-12 21:45:00,439 - INFO - wrapper - Writing example 40000
2021-04-12 21:45:14,118 - INFO - wrapper - Writing example 50000
2021-04-12 21:45:28,550 - INFO - wrapper - Writing example 60000
2021-04-12 21:45:42,564 - INFO - wrapper - Writing example 70000
2021-04-12 21:46:01,488 - INFO - wrapper - Writing example 80000
2021-04-12 21:46:15,578 - INFO - wrapper - Writing example 90000
2021-04-12 21:46:29,872 - INFO - wrapper - Writing example 100000
2021-04-12 21:46:43,706 - INFO - wrapper - Writing example 110000
2021-04-12 21:46:57,554 - INFO - wrapper - Writing example 120000
2021-04-12 21:47:11,428 - INFO - wrapper - Writing example 130000
2021-04-12 21:47:25,191 - INFO - wrapper - Writing example 140000
2021-04-12 21:47:39,419 - INFO - wrapper - Writing example 150000
2021-04-12 21:47:53,666 - INFO - wrapper - Writing example 160000
2021-04-12 21:48:16,123 - INFO - wrapper - Writing example 170000
2021-04-12 21:48:29,789 - INFO - wrapper - Writing example 180000
2021-04-12 22:05:47,701 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 22:05:47,702 - INFO - wrapper - best_dev_acc: 0.8825 | best_global_step: 32400
2021-04-12 22:05:47,702 - INFO - wrapper - Saving models.
2021-04-12 22:37:50,030 - INFO - wrapper - Writing example 0
2021-04-12 22:38:04,032 - INFO - wrapper - Writing example 10000
2021-04-12 22:38:18,171 - INFO - wrapper - Writing example 20000
2021-04-12 22:38:32,074 - INFO - wrapper - Writing example 30000
2021-04-12 22:38:46,278 - INFO - wrapper - Writing example 40000
2021-04-12 22:39:00,163 - INFO - wrapper - Writing example 50000
2021-04-12 22:39:13,861 - INFO - wrapper - Writing example 60000
2021-04-12 22:39:27,524 - INFO - wrapper - Writing example 70000
2021-04-12 22:39:46,982 - INFO - wrapper - Writing example 80000
2021-04-12 22:40:00,850 - INFO - wrapper - Writing example 90000
2021-04-12 22:40:14,900 - INFO - wrapper - Writing example 100000
2021-04-12 22:40:28,953 - INFO - wrapper - Writing example 110000
2021-04-12 22:40:43,097 - INFO - wrapper - Writing example 120000
2021-04-12 22:40:57,306 - INFO - wrapper - Writing example 130000
2021-04-12 22:41:11,380 - INFO - wrapper - Writing example 140000
2021-04-12 22:41:25,344 - INFO - wrapper - Writing example 150000
2021-04-12 22:41:39,531 - INFO - wrapper - Writing example 160000
2021-04-12 22:42:02,741 - INFO - wrapper - Writing example 170000
2021-04-12 22:42:16,577 - INFO - wrapper - Writing example 180000
2021-04-12 22:59:37,151 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-12 22:59:37,152 - INFO - wrapper - best_dev_acc: 0.8835 | best_global_step: 36000
2021-04-12 22:59:37,152 - INFO - wrapper - Saving models.
2021-04-12 23:00:15,655 - INFO - wrapper - Writing example 0
2021-04-12 23:00:31,360 - INFO - wrapper - Writing example 10000
2021-04-12 23:00:46,265 - INFO - wrapper - Writing example 20000
2021-04-12 23:01:00,959 - INFO - wrapper - Writing example 30000
2021-04-12 23:01:15,625 - INFO - wrapper - Writing example 40000
2021-04-12 23:01:30,248 - INFO - wrapper - Writing example 50000
2021-04-12 23:01:44,561 - INFO - wrapper - Writing example 60000
2021-04-12 23:01:58,766 - INFO - wrapper - Writing example 70000
2021-04-12 23:02:18,991 - INFO - wrapper - Writing example 80000
2021-04-12 23:02:33,388 - INFO - wrapper - Writing example 90000
2021-04-12 23:02:47,660 - INFO - wrapper - Writing example 100000
2021-04-12 23:03:02,023 - INFO - wrapper - Writing example 110000
2021-04-12 23:03:16,026 - INFO - wrapper - Writing example 120000
2021-04-12 23:03:30,046 - INFO - wrapper - Writing example 130000
2021-04-12 23:03:44,184 - INFO - wrapper - Writing example 140000
2021-04-12 23:03:58,145 - INFO - wrapper - Writing example 150000
2021-04-12 23:04:12,117 - INFO - wrapper - Writing example 160000
2021-04-12 23:04:34,784 - INFO - wrapper - Writing example 170000
2021-04-12 23:04:49,022 - INFO - wrapper - Writing example 180000
2021-04-12 23:05:03,186 - INFO - wrapper - Writing example 190000
2021-04-12 23:05:17,415 - INFO - wrapper - Writing example 200000
2021-04-12 23:05:31,904 - INFO - wrapper - Writing example 210000
2021-04-12 23:05:46,205 - INFO - wrapper - Writing example 220000
2021-04-12 23:06:00,234 - INFO - wrapper - Writing example 230000
2021-04-12 23:06:14,420 - INFO - wrapper - Writing example 240000
2021-04-12 23:06:28,618 - INFO - wrapper - Writing example 250000
2021-04-12 23:06:42,516 - INFO - wrapper - Writing example 260000
2021-04-12 23:07:10,140 - INFO - wrapper - Writing example 270000
2021-04-12 23:07:24,090 - INFO - wrapper - Writing example 280000
2021-04-12 23:07:38,307 - INFO - wrapper - Writing example 290000
2021-04-12 23:07:52,753 - INFO - wrapper - Writing example 300000
2021-04-12 23:08:07,126 - INFO - wrapper - Writing example 310000
2021-04-12 23:08:21,472 - INFO - wrapper - Writing example 320000
2021-04-12 23:08:35,631 - INFO - wrapper - Writing example 330000
2021-04-12 23:08:49,627 - INFO - wrapper - Writing example 340000
2021-04-12 23:09:03,598 - INFO - wrapper - Writing example 350000
2021-04-12 23:09:17,671 - INFO - wrapper - Writing example 360000
2021-04-12 23:09:32,049 - INFO - wrapper - Writing example 370000
2021-04-12 23:09:46,455 - INFO - wrapper - Writing example 380000
2021-04-12 23:10:00,574 - INFO - wrapper - Writing example 390000
2021-04-12 23:10:34,553 - INFO - wrapper - Writing example 400000
2021-04-12 23:10:48,582 - INFO - wrapper - Writing example 410000
2021-04-12 23:11:02,495 - INFO - wrapper - Writing example 420000
2021-04-12 23:11:16,555 - INFO - wrapper - Writing example 430000
2021-04-12 23:11:31,016 - INFO - wrapper - Writing example 440000
2021-04-12 23:11:45,531 - INFO - wrapper - Writing example 450000
2021-04-12 23:11:59,856 - INFO - wrapper - Writing example 460000
2021-04-12 23:12:14,191 - INFO - wrapper - Writing example 470000
2021-04-12 23:12:28,166 - INFO - wrapper - Writing example 480000
2021-04-12 23:12:41,935 - INFO - wrapper - Writing example 490000
2021-04-12 23:12:55,752 - INFO - wrapper - Writing example 500000
2021-04-12 23:13:10,101 - INFO - wrapper - Writing example 510000
2021-04-12 23:13:24,460 - INFO - wrapper - Writing example 520000
2021-04-12 23:13:38,787 - INFO - wrapper - Writing example 530000
2021-04-12 23:13:52,967 - INFO - wrapper - Writing example 540000
2021-04-12 23:14:07,087 - INFO - wrapper - Writing example 550000
2021-04-12 23:14:21,370 - INFO - wrapper - Writing example 560000
2021-04-12 23:14:59,213 - INFO - wrapper - Writing example 570000
2021-04-12 23:15:13,282 - INFO - wrapper - Writing example 580000
2021-04-12 23:15:27,309 - INFO - wrapper - Writing example 590000
2021-04-12 23:15:41,959 - INFO - wrapper - Writing example 600000
2021-04-12 23:15:55,986 - INFO - wrapper - Writing example 610000
2021-04-12 23:16:09,902 - INFO - wrapper - Writing example 620000
2021-04-12 23:16:23,797 - INFO - wrapper - Writing example 630000
2021-04-12 23:16:38,033 - INFO - wrapper - Writing example 640000
2021-04-12 23:16:51,935 - INFO - wrapper - Writing example 650000
2021-04-12 23:17:05,730 - INFO - wrapper - Writing example 660000
2021-04-12 23:17:19,498 - INFO - wrapper - Writing example 670000
2021-04-12 23:17:33,564 - INFO - wrapper - Writing example 680000
2021-04-12 23:17:47,622 - INFO - wrapper - Writing example 690000
2021-04-12 23:18:01,723 - INFO - wrapper - Writing example 700000
2021-04-12 23:18:15,760 - INFO - wrapper - Writing example 710000
2021-04-12 23:18:30,076 - INFO - wrapper - Writing example 720000
2021-04-12 23:18:44,300 - INFO - wrapper - Writing example 730000
2021-04-12 23:18:58,313 - INFO - wrapper - Writing example 740000
2021-04-12 23:19:12,268 - INFO - wrapper - Writing example 750000
2021-04-13 00:28:56,438 - INFO - modeling - Saving complete
2021-04-13 00:28:56,438 - INFO - modeling - Starting evaluation...
2021-04-13 00:29:23,163 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/MNLI/167000-42 (num_examples=-1, set_type=test)
2021-04-13 00:29:23,505 - INFO - task_processors - Returning 9815 test examples with label dist.: [('neutral', 3123), ('contradiction', 3213), ('entailment', 3479)]
2021-04-13 00:29:23,505 - INFO - modeling - Group g2: Task mnli 's Test examples number: 9815
2021-04-13 00:29:23,506 - INFO - wrapper - Writing example 0
2021-04-13 00:30:32,397 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-13 00:30:32,397 - INFO - modeling - eval_results:
2021-04-13 00:30:32,397 - INFO - modeling - {'acc': 0.8696892511462048}
2021-04-13 00:30:32,397 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SNLI/167000-42 (num_examples=-1, set_type=test)
2021-04-13 00:30:35,231 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-13 00:30:35,241 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-13 00:30:35,241 - INFO - wrapper - Writing example 0
2021-04-13 00:31:42,336 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=snli) ---
2021-04-13 00:31:42,336 - INFO - modeling - eval_results:
2021-04-13 00:31:42,336 - INFO - modeling - {'acc': 0.9147530989636253}
2021-04-13 05:36:05,249 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 05:36:05,249 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-13 05:36:05,256 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-13 05:36:05,256 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-13 05:36:05,259 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-13 05:36:54,344 - INFO - wrapper - Writing example 0
2021-04-13 05:38:03,630 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 05:38:03,631 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-13 05:38:03,636 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-13 05:38:03,636 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-13 05:38:03,639 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-13 05:38:51,491 - INFO - wrapper - Writing example 0
2021-04-13 05:39:27,839 - INFO - wrapper - Writing example 0
2021-04-13 05:39:32,819 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:39:32,819 - INFO - wrapper - best_dev_acc: 0.8333 | best_global_step: 100
2021-04-13 05:39:32,820 - INFO - wrapper - Saving models.
2021-04-13 05:40:25,336 - INFO - wrapper - Writing example 0
2021-04-13 05:40:30,245 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:40:30,246 - INFO - wrapper - best_dev_acc: 0.9167 | best_global_step: 200
2021-04-13 05:40:30,246 - INFO - wrapper - Saving models.
2021-04-13 05:41:23,603 - INFO - wrapper - Writing example 0
2021-04-13 05:41:28,501 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:41:28,501 - INFO - wrapper - best_dev_acc: 0.9167 | best_global_step: 300
2021-04-13 05:41:28,501 - INFO - wrapper - Saving models.
2021-04-13 05:42:21,781 - INFO - wrapper - Writing example 0
2021-04-13 05:42:26,645 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:42:26,645 - INFO - wrapper - best_dev_acc: 0.9271 | best_global_step: 400
2021-04-13 05:42:26,645 - INFO - wrapper - Saving models.
2021-04-13 05:43:19,964 - INFO - wrapper - Writing example 0
2021-04-13 05:43:24,830 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:43:24,830 - INFO - wrapper - best_dev_acc: 0.9271 | best_global_step: 500
2021-04-13 05:43:24,830 - INFO - wrapper - Saving models.
2021-04-13 05:44:18,250 - INFO - wrapper - Writing example 0
2021-04-13 05:44:23,118 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:44:23,118 - INFO - wrapper - best_dev_acc: 0.9271 | best_global_step: 600
2021-04-13 05:44:23,118 - INFO - wrapper - Saving models.
2021-04-13 05:45:16,380 - INFO - wrapper - Writing example 0
2021-04-13 05:45:21,302 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:45:21,302 - INFO - wrapper - best_dev_acc: 0.9271 | best_global_step: 700
2021-04-13 05:45:21,302 - INFO - wrapper - Saving models.
2021-04-13 05:46:14,845 - INFO - wrapper - Writing example 0
2021-04-13 05:46:19,738 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:46:19,739 - INFO - wrapper - best_dev_acc: 0.9271 | best_global_step: 800
2021-04-13 05:46:19,739 - INFO - wrapper - Saving models.
2021-04-13 05:47:13,219 - INFO - wrapper - Writing example 0
2021-04-13 05:47:18,102 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:47:18,103 - INFO - wrapper - best_dev_acc: 0.9271 | best_global_step: 900
2021-04-13 05:47:18,103 - INFO - wrapper - Saving models.
2021-04-13 05:48:11,097 - INFO - wrapper - Writing example 0
2021-04-13 05:48:15,958 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-13 05:48:15,958 - INFO - wrapper - best_dev_acc: 0.9271 | best_global_step: 1000
2021-04-13 05:48:15,958 - INFO - wrapper - Saving models.
2021-04-13 05:49:40,795 - INFO - wrapper - Writing example 0
2021-04-13 05:49:45,765 - INFO - modeling - Saving complete
2021-04-13 05:49:45,765 - INFO - modeling - Starting evaluation...
2021-04-13 05:50:51,006 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-13 05:50:51,145 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-13 05:50:51,145 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-13 05:50:51,145 - INFO - wrapper - Writing example 0
2021-04-13 05:51:36,159 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-13 05:51:36,160 - INFO - modeling - eval_results:
2021-04-13 05:51:36,160 - INFO - modeling - {'acc': 0.9380733944954128}
2021-04-13 05:51:36,160 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-13 05:51:36,562 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-13 05:51:36,563 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-13 05:51:36,563 - INFO - wrapper - Writing example 0
2021-04-13 05:53:19,463 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-13 05:53:19,463 - INFO - modeling - eval_results:
2021-04-13 05:53:19,463 - INFO - modeling - {'acc': 0.8915}
2021-04-13 05:53:19,463 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-13 05:53:19,486 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-13 05:53:19,489 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-13 05:53:19,489 - INFO - wrapper - Writing example 0
2021-04-13 05:55:01,812 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-13 05:55:01,813 - INFO - modeling - eval_results:
2021-04-13 05:55:01,813 - INFO - modeling - {'acc': 0.9185}
2021-04-13 06:11:07,095 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=2048, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 06:11:07,123 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=train)
2021-04-13 06:11:07,164 - INFO - task_processors - Returning 4096 train examples with label dist.: [('0', 2048), ('1', 2048)]
2021-04-13 06:11:07,164 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=test)
2021-04-13 06:11:07,185 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-13 06:11:07,186 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=dev)
2021-04-13 06:11:07,203 - INFO - task_processors - Returning 2824 dev examples with label dist.: [('0', 1262), ('1', 1562)]
2021-04-13 06:11:34,019 - INFO - wrapper - Writing example 0
2021-04-13 06:12:08,931 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=2048, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 06:12:08,931 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=train)
2021-04-13 06:12:08,957 - INFO - task_processors - Returning 4096 train examples with label dist.: [('0', 2048), ('1', 2048)]
2021-04-13 06:12:08,958 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=test)
2021-04-13 06:12:08,962 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-13 06:12:08,962 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=dev)
2021-04-13 06:12:08,980 - INFO - task_processors - Returning 2824 dev examples with label dist.: [('0', 1262), ('1', 1562)]
2021-04-13 06:12:41,979 - INFO - wrapper - Writing example 0
2021-04-13 06:23:40,011 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=2048, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=800, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 06:23:40,011 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=train)
2021-04-13 06:23:40,037 - INFO - task_processors - Returning 4096 train examples with label dist.: [('0', 2048), ('1', 2048)]
2021-04-13 06:23:40,037 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=test)
2021-04-13 06:23:40,042 - INFO - task_processors - Returning 872 test examples with label dist.: [('0', 428), ('1', 444)]
2021-04-13 06:23:40,042 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/2048-42 (num_examples=-1, set_type=dev)
2021-04-13 06:23:40,058 - INFO - task_processors - Returning 2824 dev examples with label dist.: [('0', 1262), ('1', 1562)]
2021-04-13 06:23:56,397 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 06:23:56,398 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=train)
2021-04-13 06:23:56,490 - INFO - task_processors - Returning 8192 train examples with label dist.: [(0, 4096), (1, 4096)]
2021-04-13 06:23:56,491 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=test)
2021-04-13 06:23:56,519 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-13 06:23:56,520 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/4096-42 (num_examples=-1, set_type=dev)
2021-04-13 06:23:56,537 - INFO - task_processors - Returning 470 dev examples with label dist.: [(0, 235), (1, 235)]
2021-04-13 06:24:06,447 - INFO - wrapper - Writing example 0
2021-04-13 06:24:26,027 - INFO - wrapper - Writing example 0
2021-04-13 06:25:03,000 - INFO - wrapper - Writing example 0
2021-04-13 06:25:33,088 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-13 06:25:33,088 - INFO - wrapper - best_dev_acc: 0.8931 | best_global_step: 100
2021-04-13 06:25:33,088 - INFO - wrapper - Saving models.
2021-04-13 06:26:49,585 - INFO - wrapper - Writing example 0
2021-04-13 06:26:54,294 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-13 06:26:54,295 - INFO - wrapper - best_dev_acc: 0.8766 | best_global_step: 100
2021-04-13 06:26:54,295 - INFO - wrapper - Saving models.
2021-04-13 06:26:54,777 - INFO - wrapper - Writing example 0
2021-04-13 06:27:13,496 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-13 06:27:13,496 - INFO - wrapper - best_dev_acc: 0.9256 | best_global_step: 200
2021-04-13 06:27:13,496 - INFO - wrapper - Saving models.
2021-04-13 06:28:36,972 - INFO - wrapper - Writing example 0
2021-04-13 06:29:06,990 - INFO - wrapper - {'acc': 0.9231586402266289}
2021-04-13 06:29:06,990 - INFO - wrapper - 1
2021-04-13 06:29:13,467 - INFO - wrapper - Writing example 0
2021-04-13 06:29:18,180 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-13 06:29:18,181 - INFO - wrapper - best_dev_acc: 0.8936 | best_global_step: 200
2021-04-13 06:29:18,181 - INFO - wrapper - Saving models.
2021-04-13 06:30:14,003 - INFO - wrapper - Writing example 0
2021-04-13 06:30:43,884 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-13 06:30:43,884 - INFO - wrapper - best_dev_acc: 0.9271 | best_global_step: 400
2021-04-13 06:30:43,884 - INFO - wrapper - Saving models.
2021-04-13 06:31:37,730 - INFO - wrapper - Writing example 0
2021-04-13 06:31:42,433 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-13 06:31:42,433 - INFO - wrapper - best_dev_acc: 0.9043 | best_global_step: 300
2021-04-13 06:31:42,434 - INFO - wrapper - Saving models.
2021-04-13 06:31:58,705 - INFO - wrapper - Writing example 0
2021-04-13 06:32:28,489 - INFO - wrapper - {'acc': 0.9259915014164306}
2021-04-13 06:32:28,489 - INFO - wrapper - 1
2021-04-13 06:33:43,707 - INFO - wrapper - Writing example 0
2021-04-13 06:34:03,426 - INFO - wrapper - Writing example 0
2021-04-13 06:34:07,615 - INFO - wrapper - {'acc': 0.8914893617021277}
2021-04-13 06:34:07,616 - INFO - wrapper - 1
2021-04-13 06:34:11,635 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-13 06:34:11,636 - INFO - wrapper - best_dev_acc: 0.9313 | best_global_step: 600
2021-04-13 06:34:11,636 - INFO - wrapper - Saving models.
2021-04-13 06:35:34,346 - INFO - wrapper - Writing example 0
2021-04-13 06:36:04,180 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2/p1-i1...
2021-04-13 06:36:04,180 - INFO - wrapper - best_dev_acc: 0.9341 | best_global_step: 700
2021-04-13 06:36:04,180 - INFO - wrapper - Saving models.
2021-04-13 06:36:10,883 - INFO - wrapper - Writing example 0
2021-04-13 06:36:15,949 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr/p1-i1...
2021-04-13 06:36:15,949 - INFO - wrapper - best_dev_acc: 0.9106 | best_global_step: 500
2021-04-13 06:36:15,949 - INFO - wrapper - Saving models.
2021-04-13 06:37:18,888 - INFO - wrapper - Writing example 0
2021-04-13 06:37:48,703 - INFO - wrapper - {'acc': 0.9327195467422096}
2021-04-13 06:37:48,703 - INFO - wrapper - 1
2021-04-13 06:38:14,193 - INFO - wrapper - Writing example 0
2021-04-13 06:38:16,422 - INFO - wrapper - {'acc': 0.8914893617021277}
2021-04-13 06:38:16,480 - INFO - wrapper - 1
2021-04-13 06:38:16,975 - INFO - wrapper - Writing example 0
2021-04-13 06:39:01,249 - INFO - modeling - Saving complete
2021-04-13 06:39:01,249 - INFO - modeling - Starting evaluation...
2021-04-13 06:39:01,250 - INFO - modeling - Single: Task sst-2 's Test examples number: 872
2021-04-13 06:39:29,086 - INFO - wrapper - Writing example 0
2021-04-13 06:39:38,786 - INFO - modeling - --- RESULT (pattern_id=1, Task=sst-2) ---
2021-04-13 06:39:38,786 - INFO - modeling - eval_results:
2021-04-13 06:39:38,787 - INFO - modeling - {'acc': 0.9369266055045872}
2021-04-13 06:39:46,072 - INFO - wrapper - Writing example 0
2021-04-13 06:39:48,326 - INFO - wrapper - {'acc': 0.9085106382978724}
2021-04-13 06:39:48,326 - INFO - wrapper - 2
2021-04-13 06:40:56,661 - INFO - wrapper - Writing example 0
2021-04-13 06:40:58,892 - INFO - wrapper - {'acc': 0.9063829787234042}
2021-04-13 06:40:58,892 - INFO - wrapper - 3
2021-04-13 06:42:07,279 - INFO - wrapper - Writing example 0
2021-04-13 06:42:09,533 - INFO - wrapper - {'acc': 0.9}
2021-04-13 06:42:09,533 - INFO - wrapper - 4
2021-04-13 06:43:17,733 - INFO - wrapper - Writing example 0
2021-04-13 06:43:19,956 - INFO - wrapper - {'acc': 0.9042553191489362}
2021-04-13 06:43:19,957 - INFO - wrapper - 5
2021-04-13 06:43:46,956 - INFO - wrapper - Writing example 0
2021-04-13 06:44:28,028 - INFO - modeling - Saving complete
2021-04-13 06:44:28,028 - INFO - modeling - Starting evaluation...
2021-04-13 06:44:28,028 - INFO - modeling - Single: Task mr 's Test examples number: 2000
2021-04-13 06:44:55,601 - INFO - wrapper - Writing example 0
2021-04-13 06:45:05,749 - INFO - modeling - --- RESULT (pattern_id=1, Task=mr) ---
2021-04-13 06:45:05,750 - INFO - modeling - eval_results:
2021-04-13 06:45:05,750 - INFO - modeling - {'acc': 0.901}
2021-04-13 06:54:26,977 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/650-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=650, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=600, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=16, pet_per_gpu_train_batch_size=16, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='cr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 06:54:26,978 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/650-42 (num_examples=-1, set_type=train)
2021-04-13 06:54:27,007 - INFO - task_processors - Returning 1018 train examples with label dist.: [(0, 368), (1, 650)]
2021-04-13 06:54:27,007 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/650-42 (num_examples=-1, set_type=test)
2021-04-13 06:54:27,032 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-13 06:54:27,032 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/cr/650-42 (num_examples=-1, set_type=dev)
2021-04-13 06:54:27,051 - INFO - task_processors - Returning 650 dev examples with label dist.: [(1, 650)]
2021-04-13 06:54:55,942 - INFO - wrapper - Writing example 0
2021-04-13 06:55:19,341 - INFO - wrapper - Writing example 0
2021-04-13 06:55:22,574 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-13 06:55:22,574 - INFO - wrapper - best_dev_acc: 0.9400 | best_global_step: 100
2021-04-13 06:55:22,574 - INFO - wrapper - Saving models.
2021-04-13 06:55:52,060 - INFO - wrapper - Writing example 0
2021-04-13 06:55:55,284 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/cr/p1-i1...
2021-04-13 06:55:55,284 - INFO - wrapper - best_dev_acc: 0.9646 | best_global_step: 200
2021-04-13 06:55:55,284 - INFO - wrapper - Saving models.
2021-04-13 06:56:21,960 - INFO - wrapper - Writing example 0
2021-04-13 06:56:25,105 - INFO - wrapper - {'acc': 0.96}
2021-04-13 06:56:25,105 - INFO - wrapper - 1
2021-04-13 06:56:46,581 - INFO - wrapper - Writing example 0
2021-04-13 06:56:49,740 - INFO - wrapper - {'acc': 0.9446153846153846}
2021-04-13 06:56:49,740 - INFO - wrapper - 2
2021-04-13 06:57:11,296 - INFO - wrapper - Writing example 0
2021-04-13 06:57:14,468 - INFO - wrapper - {'acc': 0.936923076923077}
2021-04-13 06:57:14,469 - INFO - wrapper - 3
2021-04-13 06:57:35,990 - INFO - wrapper - Writing example 0
2021-04-13 06:57:39,184 - INFO - wrapper - {'acc': 0.94}
2021-04-13 06:57:39,184 - INFO - wrapper - 4
2021-04-13 06:58:06,651 - INFO - wrapper - Writing example 0
2021-04-13 06:58:11,813 - INFO - modeling - Saving complete
2021-04-13 06:58:11,813 - INFO - modeling - Starting evaluation...
2021-04-13 06:58:11,814 - INFO - modeling - Single: Task cr 's Test examples number: 2000
2021-04-13 06:58:40,101 - INFO - wrapper - Writing example 0
2021-04-13 06:58:50,206 - INFO - modeling - --- RESULT (pattern_id=1, Task=cr) ---
2021-04-13 06:58:50,206 - INFO - modeling - eval_results:
2021-04-13 06:58:50,206 - INFO - modeling - {'acc': 0.9025}
2021-04-13 07:07:30,291 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 07:07:30,292 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-04-13 07:07:30,295 - INFO - task_processors - Returning 96 train examples with label dist.: [('entailment', 32), ('neutral', 32), ('contradiction', 32)]
2021-04-13 07:07:30,295 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-04-13 07:07:30,297 - INFO - task_processors - Returning 96 dev examples with label dist.: [('entailment', 32), ('neutral', 32), ('contradiction', 32)]
2021-04-13 07:08:20,642 - INFO - wrapper - Writing example 0
2021-04-13 07:08:40,118 - INFO - wrapper - Writing example 0
2021-04-13 07:08:42,134 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-13 07:08:42,135 - INFO - wrapper - best_dev_acc: 0.5208 | best_global_step: 100
2021-04-13 07:08:42,135 - INFO - wrapper - Saving models.
2021-04-13 07:09:19,501 - INFO - wrapper - Writing example 0
2021-04-13 07:09:21,513 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-13 07:09:21,513 - INFO - wrapper - best_dev_acc: 0.6771 | best_global_step: 200
2021-04-13 07:09:21,513 - INFO - wrapper - Saving models.
2021-04-13 07:09:57,758 - INFO - wrapper - Writing example 0
2021-04-13 07:09:59,707 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g2/p1-i1...
2021-04-13 07:09:59,708 - INFO - wrapper - best_dev_acc: 0.7604 | best_global_step: 300
2021-04-13 07:09:59,708 - INFO - wrapper - Saving models.
2021-04-13 07:10:35,743 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=5250, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=63000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=24, pet_per_gpu_train_batch_size=24, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mnli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 07:10:35,744 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/167000-42 (num_examples=-1, set_type=train)
2021-04-13 07:10:36,399 - INFO - wrapper - Writing example 0
2021-04-13 07:10:38,316 - INFO - wrapper - {'acc': 0.7291666666666666}
2021-04-13 07:10:38,317 - INFO - wrapper - 1
2021-04-13 07:10:50,362 - INFO - task_processors - Returning 392702 train examples with label dist.: [('entailment', 130899), ('neutral', 130900), ('contradiction', 130903)]
2021-04-13 07:10:50,363 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/167000-42 (num_examples=-1, set_type=test)
2021-04-13 07:10:50,626 - INFO - task_processors - Returning 9815 test examples with label dist.: [('neutral', 3123), ('contradiction', 3213), ('entailment', 3479)]
2021-04-13 07:10:50,626 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/167000-42 (num_examples=-1, set_type=dev)
2021-04-13 07:10:50,626 - INFO - task_processors - Returning 0 dev examples with label dist.: []
2021-04-13 07:10:55,897 - INFO - wrapper - Writing example 0
2021-04-13 07:10:57,769 - INFO - wrapper - {'acc': 0.7291666666666666}
2021-04-13 07:10:57,770 - INFO - wrapper - 2
2021-04-13 07:11:15,526 - INFO - wrapper - Writing example 0
2021-04-13 07:11:17,436 - INFO - wrapper - {'acc': 0.7395833333333334}
2021-04-13 07:11:17,436 - INFO - wrapper - 3
2021-04-13 07:11:19,857 - INFO - wrapper - Writing example 0
2021-04-13 07:11:35,063 - INFO - wrapper - Writing example 0
2021-04-13 07:11:36,965 - INFO - wrapper - {'acc': 0.7291666666666666}
2021-04-13 07:11:36,965 - INFO - wrapper - 4
2021-04-13 07:11:38,121 - INFO - wrapper - Writing example 10000
2021-04-13 07:11:53,633 - INFO - wrapper - Writing example 20000
2021-04-13 07:11:54,508 - INFO - wrapper - Writing example 0
2021-04-13 07:11:56,402 - INFO - wrapper - {'acc': 0.7291666666666666}
2021-04-13 07:11:56,402 - INFO - wrapper - 5
2021-04-13 07:12:09,018 - INFO - wrapper - Writing example 30000
2021-04-13 07:12:14,176 - INFO - wrapper - Writing example 0
2021-04-13 07:12:16,076 - INFO - wrapper - {'acc': 0.7291666666666666}
2021-04-13 07:12:16,077 - INFO - wrapper - 6
2021-04-13 07:12:23,826 - INFO - wrapper - Writing example 40000
2021-04-13 07:12:33,643 - INFO - wrapper - Writing example 0
2021-04-13 07:12:35,536 - INFO - wrapper - {'acc': 0.7291666666666666}
2021-04-13 07:12:35,537 - INFO - wrapper - 7
2021-04-13 07:12:41,541 - INFO - wrapper - Writing example 50000
2021-04-13 07:12:56,446 - INFO - wrapper - Writing example 60000
2021-04-13 07:13:11,341 - INFO - wrapper - Writing example 70000
2021-04-13 07:13:26,329 - INFO - wrapper - Writing example 80000
2021-04-13 07:13:40,291 - INFO - wrapper - Writing example 0
2021-04-13 07:13:42,411 - INFO - modeling - Saving complete
2021-04-13 07:13:42,411 - INFO - modeling - Starting evaluation...
2021-04-13 07:13:45,332 - INFO - wrapper - Writing example 90000
2021-04-13 07:14:00,162 - INFO - wrapper - Writing example 100000
2021-04-13 07:14:14,995 - INFO - wrapper - Writing example 110000
2021-04-13 07:14:29,690 - INFO - wrapper - Writing example 120000
2021-04-13 07:14:44,564 - INFO - wrapper - Writing example 130000
2021-04-13 07:14:48,377 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/MNLI/16-42 (num_examples=-1, set_type=test)
2021-04-13 07:14:48,642 - INFO - task_processors - Returning 9815 test examples with label dist.: [('neutral', 3123), ('contradiction', 3213), ('entailment', 3479)]
2021-04-13 07:14:48,642 - INFO - modeling - Group g2: Task mnli 's Test examples number: 9815
2021-04-13 07:14:48,642 - INFO - wrapper - Writing example 0
2021-04-13 07:14:59,269 - INFO - wrapper - Writing example 140000
2021-04-13 07:15:19,592 - INFO - wrapper - Writing example 150000
2021-04-13 07:15:34,085 - INFO - wrapper - Writing example 160000
2021-04-13 07:15:48,676 - INFO - wrapper - Writing example 170000
2021-04-13 07:16:03,230 - INFO - wrapper - Writing example 180000
2021-04-13 07:16:17,771 - INFO - wrapper - Writing example 190000
2021-04-13 07:16:32,515 - INFO - wrapper - Writing example 200000
2021-04-13 07:16:56,096 - INFO - wrapper - Writing example 210000
2021-04-13 07:17:10,731 - INFO - wrapper - Writing example 220000
2021-04-13 07:17:25,322 - INFO - wrapper - Writing example 230000
2021-04-13 07:17:40,018 - INFO - wrapper - Writing example 240000
2021-04-13 07:17:54,615 - INFO - wrapper - Writing example 250000
2021-04-13 07:18:03,268 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-13 07:18:03,269 - INFO - modeling - eval_results:
2021-04-13 07:18:03,269 - INFO - modeling - {'acc': 0.6883341823739175}
2021-04-13 07:18:03,269 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/SNLI/16-42 (num_examples=-1, set_type=test)
2021-04-13 07:18:03,484 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-13 07:18:03,496 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-13 07:18:03,496 - INFO - wrapper - Writing example 0
2021-04-13 07:18:09,196 - INFO - wrapper - Writing example 260000
2021-04-13 07:18:23,623 - INFO - wrapper - Writing example 270000
2021-04-13 07:18:38,206 - INFO - wrapper - Writing example 280000
2021-04-13 07:18:52,876 - INFO - wrapper - Writing example 290000
2021-04-13 07:19:19,469 - INFO - wrapper - Writing example 300000
2021-04-13 07:19:33,860 - INFO - wrapper - Writing example 310000
2021-04-13 07:19:48,287 - INFO - wrapper - Writing example 320000
2021-04-13 07:20:02,847 - INFO - wrapper - Writing example 330000
2021-04-13 07:20:17,330 - INFO - wrapper - Writing example 340000
2021-04-13 07:20:31,838 - INFO - wrapper - Writing example 350000
2021-04-13 07:20:46,359 - INFO - wrapper - Writing example 360000
2021-04-13 07:21:00,856 - INFO - wrapper - Writing example 370000
2021-04-13 07:21:15,227 - INFO - wrapper - Writing example 380000
2021-04-13 07:21:18,201 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=snli) ---
2021-04-13 07:21:18,201 - INFO - modeling - eval_results:
2021-04-13 07:21:18,201 - INFO - modeling - {'acc': 0.7424304003251372}
2021-04-13 07:21:29,754 - INFO - wrapper - Writing example 390000
2021-04-13 08:29:28,567 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/104700-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=5250, eval_examples=-1, eval_set='dev', k=104700, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=63000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=24, pet_per_gpu_train_batch_size=24, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mnli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 08:29:28,568 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/104700-42 (num_examples=-1, set_type=train)
2021-04-13 08:29:40,033 - INFO - task_processors - Returning 314100 train examples with label dist.: [('entailment', 104700), ('neutral', 104700), ('contradiction', 104700)]
2021-04-13 08:29:40,034 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/104700-42 (num_examples=-1, set_type=test)
2021-04-13 08:29:40,314 - INFO - task_processors - Returning 9815 test examples with label dist.: [('neutral', 3123), ('contradiction', 3213), ('entailment', 3479)]
2021-04-13 08:29:40,314 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MNLI/104700-42 (num_examples=-1, set_type=dev)
2021-04-13 08:29:43,286 - INFO - task_processors - Returning 78602 dev examples with label dist.: [('entailment', 26199), ('neutral', 26200), ('contradiction', 26203)]
2021-04-13 08:30:09,111 - INFO - wrapper - Writing example 0
2021-04-13 08:30:26,167 - INFO - wrapper - Writing example 10000
2021-04-13 08:30:41,711 - INFO - wrapper - Writing example 20000
2021-04-13 08:30:56,995 - INFO - wrapper - Writing example 30000
2021-04-13 08:31:15,016 - INFO - wrapper - Writing example 40000
2021-04-13 08:31:30,558 - INFO - wrapper - Writing example 50000
2021-04-13 08:31:46,041 - INFO - wrapper - Writing example 60000
2021-04-13 08:32:01,704 - INFO - wrapper - Writing example 70000
2021-04-13 08:32:21,226 - INFO - wrapper - Writing example 80000
2021-04-13 08:32:36,852 - INFO - wrapper - Writing example 90000
2021-04-13 08:32:52,415 - INFO - wrapper - Writing example 100000
2021-04-13 08:33:07,635 - INFO - wrapper - Writing example 110000
2021-04-13 08:33:22,742 - INFO - wrapper - Writing example 120000
2021-04-13 08:33:44,636 - INFO - wrapper - Writing example 130000
2021-04-13 08:33:59,899 - INFO - wrapper - Writing example 140000
2021-04-13 08:34:15,115 - INFO - wrapper - Writing example 150000
2021-04-13 08:34:30,010 - INFO - wrapper - Writing example 160000
2021-04-13 08:34:44,864 - INFO - wrapper - Writing example 170000
2021-04-13 08:34:59,696 - INFO - wrapper - Writing example 180000
2021-04-13 08:35:22,989 - INFO - wrapper - Writing example 190000
2021-04-13 08:35:37,793 - INFO - wrapper - Writing example 200000
2021-04-13 08:35:52,538 - INFO - wrapper - Writing example 210000
2021-04-13 08:36:07,117 - INFO - wrapper - Writing example 220000
2021-04-13 08:36:21,847 - INFO - wrapper - Writing example 230000
2021-04-13 08:36:36,712 - INFO - wrapper - Writing example 240000
2021-04-13 08:36:51,802 - INFO - wrapper - Writing example 250000
2021-04-13 08:37:06,489 - INFO - wrapper - Writing example 260000
2021-04-13 08:37:33,971 - INFO - wrapper - Writing example 270000
2021-04-13 08:37:48,906 - INFO - wrapper - Writing example 280000
2021-04-13 08:38:03,758 - INFO - wrapper - Writing example 290000
2021-04-13 08:38:18,778 - INFO - wrapper - Writing example 300000
2021-04-13 08:38:33,842 - INFO - wrapper - Writing example 310000
2021-04-13 08:42:55,499 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=5250, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=63000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=24, pet_per_gpu_train_batch_size=24, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='snli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 08:42:55,516 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/167000-42 (num_examples=-1, set_type=train)
2021-04-13 08:43:47,266 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=5250, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=63000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=24, pet_per_gpu_train_batch_size=24, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='snli', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 08:43:47,266 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/167000-42 (num_examples=-1, set_type=train)
2021-04-13 08:44:04,779 - INFO - task_processors - Returning 501000 train examples with label dist.: [('contradiction', 167000), ('entailment', 167000), ('neutral', 167000)]
2021-04-13 08:44:04,780 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/167000-42 (num_examples=-1, set_type=test)
2021-04-13 08:44:05,023 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-13 08:44:05,023 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SNLI/167000-42 (num_examples=-1, set_type=dev)
2021-04-13 08:44:07,844 - INFO - task_processors - Returning 48367 dev examples with label dist.: [('contradiction', 16187), ('entailment', 16416), ('neutral', 15764)]
2021-04-13 08:44:36,236 - INFO - wrapper - Writing example 0
2021-04-13 08:44:48,366 - INFO - wrapper - Writing example 10000
2021-04-13 08:44:59,739 - INFO - wrapper - Writing example 20000
2021-04-13 08:45:11,310 - INFO - wrapper - Writing example 30000
2021-04-13 08:45:22,706 - INFO - wrapper - Writing example 40000
2021-04-13 08:45:38,140 - INFO - wrapper - Writing example 50000
2021-04-13 08:45:49,298 - INFO - wrapper - Writing example 60000
2021-04-13 08:46:00,609 - INFO - wrapper - Writing example 70000
2021-04-13 08:46:12,182 - INFO - wrapper - Writing example 80000
2021-04-13 08:46:23,631 - INFO - wrapper - Writing example 90000
2021-04-13 08:46:42,034 - INFO - wrapper - Writing example 100000
2021-04-13 08:46:53,408 - INFO - wrapper - Writing example 110000
2021-04-13 08:47:04,686 - INFO - wrapper - Writing example 120000
2021-04-13 08:47:15,921 - INFO - wrapper - Writing example 130000
2021-04-13 08:47:27,080 - INFO - wrapper - Writing example 140000
2021-04-13 08:47:38,350 - INFO - wrapper - Writing example 150000
2021-04-13 08:47:59,189 - INFO - wrapper - Writing example 160000
2021-04-13 08:48:10,212 - INFO - wrapper - Writing example 170000
2021-04-13 08:48:21,260 - INFO - wrapper - Writing example 180000
2021-04-13 08:48:32,315 - INFO - wrapper - Writing example 190000
2021-04-13 08:48:43,328 - INFO - wrapper - Writing example 200000
2021-04-13 08:48:54,272 - INFO - wrapper - Writing example 210000
2021-04-13 08:49:05,350 - INFO - wrapper - Writing example 220000
2021-04-13 08:49:16,441 - INFO - wrapper - Writing example 230000
2021-04-13 08:49:27,391 - INFO - wrapper - Writing example 240000
2021-04-13 08:49:51,444 - INFO - wrapper - Writing example 250000
2021-04-13 08:50:02,671 - INFO - wrapper - Writing example 260000
2021-04-13 08:50:14,170 - INFO - wrapper - Writing example 270000
2021-04-13 08:50:25,573 - INFO - wrapper - Writing example 280000
2021-04-13 08:50:36,750 - INFO - wrapper - Writing example 290000
2021-04-13 08:50:48,064 - INFO - wrapper - Writing example 300000
2021-04-13 08:50:59,393 - INFO - wrapper - Writing example 310000
2021-04-13 08:51:10,627 - INFO - wrapper - Writing example 320000
2021-04-13 08:51:21,848 - INFO - wrapper - Writing example 330000
2021-04-13 08:51:33,159 - INFO - wrapper - Writing example 340000
2021-04-13 08:52:01,847 - INFO - wrapper - Writing example 350000
2021-04-13 08:52:13,311 - INFO - wrapper - Writing example 360000
2021-04-13 08:52:24,599 - INFO - wrapper - Writing example 370000
2021-04-13 08:52:36,226 - INFO - wrapper - Writing example 380000
2021-04-13 08:52:47,718 - INFO - wrapper - Writing example 390000
2021-04-13 08:52:59,221 - INFO - wrapper - Writing example 400000
2021-04-13 08:53:10,641 - INFO - wrapper - Writing example 410000
2021-04-13 08:53:22,122 - INFO - wrapper - Writing example 420000
2021-04-13 08:53:33,562 - INFO - wrapper - Writing example 430000
2021-04-13 08:53:44,950 - INFO - wrapper - Writing example 440000
2021-04-13 08:53:56,237 - INFO - wrapper - Writing example 450000
2021-04-13 08:54:07,554 - INFO - wrapper - Writing example 460000
2021-04-13 08:54:18,857 - INFO - wrapper - Writing example 470000
2021-04-13 08:54:54,058 - INFO - wrapper - Writing example 480000
2021-04-13 08:55:05,611 - INFO - wrapper - Writing example 490000
2021-04-13 08:55:16,993 - INFO - wrapper - Writing example 500000
2021-04-13 09:37:22,545 - INFO - wrapper - Writing example 0
2021-04-13 09:37:37,113 - INFO - wrapper - Writing example 10000
2021-04-13 09:37:51,699 - INFO - wrapper - Writing example 20000
2021-04-13 09:38:06,494 - INFO - wrapper - Writing example 30000
2021-04-13 09:38:21,318 - INFO - wrapper - Writing example 40000
2021-04-13 09:38:38,899 - INFO - wrapper - Writing example 50000
2021-04-13 09:38:53,968 - INFO - wrapper - Writing example 60000
2021-04-13 09:39:08,828 - INFO - wrapper - Writing example 70000
2021-04-13 09:56:44,979 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-13 09:56:44,980 - INFO - wrapper - best_dev_acc: 0.8362 | best_global_step: 5250
2021-04-13 09:56:44,980 - INFO - wrapper - Saving models.
2021-04-13 10:08:06,586 - INFO - wrapper - Writing example 0
2021-04-13 10:08:18,162 - INFO - wrapper - Writing example 10000
2021-04-13 10:08:29,713 - INFO - wrapper - Writing example 20000
2021-04-13 10:08:41,154 - INFO - wrapper - Writing example 30000
2021-04-13 10:08:52,519 - INFO - wrapper - Writing example 40000
2021-04-13 10:19:53,030 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 10:19:53,030 - INFO - wrapper - best_dev_acc: 0.8767 | best_global_step: 5250
2021-04-13 10:19:53,030 - INFO - wrapper - Saving models.
2021-04-13 11:10:59,325 - INFO - wrapper - Writing example 0
2021-04-13 11:11:15,438 - INFO - wrapper - Writing example 10000
2021-04-13 11:11:30,116 - INFO - wrapper - Writing example 20000
2021-04-13 11:11:44,787 - INFO - wrapper - Writing example 30000
2021-04-13 11:12:01,788 - INFO - wrapper - Writing example 40000
2021-04-13 11:12:16,476 - INFO - wrapper - Writing example 50000
2021-04-13 11:12:30,946 - INFO - wrapper - Writing example 60000
2021-04-13 11:12:45,446 - INFO - wrapper - Writing example 70000
2021-04-13 11:30:21,602 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-13 11:30:21,603 - INFO - wrapper - best_dev_acc: 0.8559 | best_global_step: 10500
2021-04-13 11:30:21,603 - INFO - wrapper - Saving models.
2021-04-13 11:32:12,614 - INFO - wrapper - Writing example 0
2021-04-13 11:32:24,131 - INFO - wrapper - Writing example 10000
2021-04-13 11:32:35,480 - INFO - wrapper - Writing example 20000
2021-04-13 11:32:46,827 - INFO - wrapper - Writing example 30000
2021-04-13 11:32:57,954 - INFO - wrapper - Writing example 40000
2021-04-13 11:43:59,038 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 11:43:59,038 - INFO - wrapper - best_dev_acc: 0.8776 | best_global_step: 10500
2021-04-13 11:43:59,038 - INFO - wrapper - Saving models.
2021-04-13 12:50:37,166 - INFO - wrapper - Writing example 0
2021-04-13 12:50:51,968 - INFO - wrapper - Writing example 10000
2021-04-13 12:51:06,820 - INFO - wrapper - Writing example 20000
2021-04-13 12:51:24,161 - INFO - wrapper - Writing example 30000
2021-04-13 12:51:39,286 - INFO - wrapper - Writing example 40000
2021-04-13 12:51:54,514 - INFO - wrapper - Writing example 50000
2021-04-13 12:52:09,522 - INFO - wrapper - Writing example 60000
2021-04-13 12:52:28,658 - INFO - wrapper - Writing example 70000
2021-04-13 13:04:35,530 - INFO - wrapper - Writing example 0
2021-04-13 13:04:46,658 - INFO - wrapper - Writing example 10000
2021-04-13 13:04:57,943 - INFO - wrapper - Writing example 20000
2021-04-13 13:05:11,898 - INFO - wrapper - Writing example 30000
2021-04-13 13:05:23,150 - INFO - wrapper - Writing example 40000
2021-04-13 13:10:26,793 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-13 13:10:26,794 - INFO - wrapper - best_dev_acc: 0.8627 | best_global_step: 15750
2021-04-13 13:10:26,794 - INFO - wrapper - Saving models.
2021-04-13 13:16:40,198 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 13:16:40,198 - INFO - wrapper - best_dev_acc: 0.8850 | best_global_step: 15750
2021-04-13 13:16:40,199 - INFO - wrapper - Saving models.
2021-04-13 13:23:00,014 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 13:23:00,014 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=train)
2021-04-13 13:23:00,025 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-13 13:23:00,025 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=test)
2021-04-13 13:23:00,051 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-13 13:23:00,051 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev)
2021-04-13 13:23:00,055 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-13 13:23:34,690 - INFO - wrapper - Writing example 0
2021-04-13 13:23:57,883 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mr', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mr', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-13 13:23:57,883 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=train)
2021-04-13 13:23:57,894 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-13 13:23:57,895 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=test)
2021-04-13 13:23:57,915 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-13 13:23:57,915 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/mr/16-42 (num_examples=-1, set_type=dev)
2021-04-13 13:23:57,918 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-13 13:24:30,658 - INFO - wrapper - Writing example 0
2021-04-13 14:32:08,182 - INFO - wrapper - Writing example 0
2021-04-13 14:32:23,268 - INFO - wrapper - Writing example 10000
2021-04-13 14:32:38,013 - INFO - wrapper - Writing example 20000
2021-04-13 14:32:52,573 - INFO - wrapper - Writing example 30000
2021-04-13 14:33:09,654 - INFO - wrapper - Writing example 40000
2021-04-13 14:33:24,141 - INFO - wrapper - Writing example 50000
2021-04-13 14:33:38,557 - INFO - wrapper - Writing example 60000
2021-04-13 14:33:52,937 - INFO - wrapper - Writing example 70000
2021-04-13 14:37:07,190 - INFO - wrapper - Writing example 0
2021-04-13 14:37:18,522 - INFO - wrapper - Writing example 10000
2021-04-13 14:37:32,069 - INFO - wrapper - Writing example 20000
2021-04-13 14:37:42,931 - INFO - wrapper - Writing example 30000
2021-04-13 14:37:53,813 - INFO - wrapper - Writing example 40000
2021-04-13 14:48:35,812 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 14:48:35,812 - INFO - wrapper - best_dev_acc: 0.8946 | best_global_step: 21000
2021-04-13 14:48:35,812 - INFO - wrapper - Saving models.
2021-04-13 14:50:57,037 - INFO - wrapper - {'acc': 0.8620391338642782}
2021-04-13 14:50:57,038 - INFO - wrapper - 1
2021-04-13 16:11:52,098 - INFO - wrapper - Writing example 0
2021-04-13 16:11:59,323 - INFO - wrapper - Writing example 10000
2021-04-13 16:12:05,088 - INFO - wrapper - Writing example 20000
2021-04-13 16:12:10,843 - INFO - wrapper - Writing example 30000
2021-04-13 16:12:16,678 - INFO - wrapper - Writing example 40000
2021-04-13 16:13:46,105 - INFO - wrapper - Writing example 0
2021-04-13 16:13:53,828 - INFO - wrapper - Writing example 10000
2021-04-13 16:14:01,339 - INFO - wrapper - Writing example 20000
2021-04-13 16:14:08,865 - INFO - wrapper - Writing example 30000
2021-04-13 16:14:16,415 - INFO - wrapper - Writing example 40000
2021-04-13 16:14:25,698 - INFO - wrapper - Writing example 50000
2021-04-13 16:14:33,290 - INFO - wrapper - Writing example 60000
2021-04-13 16:14:40,853 - INFO - wrapper - Writing example 70000
2021-04-13 16:21:42,411 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 16:21:42,411 - INFO - wrapper - best_dev_acc: 0.8961 | best_global_step: 26250
2021-04-13 16:21:42,411 - INFO - wrapper - Saving models.
2021-04-13 16:32:14,948 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-13 16:32:14,949 - INFO - wrapper - best_dev_acc: 0.8675 | best_global_step: 26250
2021-04-13 16:32:14,949 - INFO - wrapper - Saving models.
2021-04-13 17:44:17,622 - INFO - wrapper - Writing example 0
2021-04-13 17:44:23,504 - INFO - wrapper - Writing example 10000
2021-04-13 17:44:29,181 - INFO - wrapper - Writing example 20000
2021-04-13 17:44:34,853 - INFO - wrapper - Writing example 30000
2021-04-13 17:44:40,516 - INFO - wrapper - Writing example 40000
2021-04-13 17:54:59,673 - INFO - wrapper - Writing example 0
2021-04-13 17:55:08,457 - INFO - wrapper - Writing example 10000
2021-04-13 17:55:16,062 - INFO - wrapper - Writing example 20000
2021-04-13 17:55:23,654 - INFO - wrapper - Writing example 30000
2021-04-13 17:55:32,750 - INFO - wrapper - Writing example 40000
2021-04-13 17:55:40,364 - INFO - wrapper - Writing example 50000
2021-04-13 17:55:43,258 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 17:55:43,258 - INFO - wrapper - best_dev_acc: 0.8975 | best_global_step: 31500
2021-04-13 17:55:43,258 - INFO - wrapper - Saving models.
2021-04-13 17:55:47,943 - INFO - wrapper - Writing example 60000
2021-04-13 17:55:55,462 - INFO - wrapper - Writing example 70000
2021-04-13 18:14:54,921 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-13 18:14:54,921 - INFO - wrapper - best_dev_acc: 0.8690 | best_global_step: 31500
2021-04-13 18:14:54,922 - INFO - wrapper - Saving models.
2021-04-13 19:16:16,792 - INFO - wrapper - Writing example 0
2021-04-13 19:16:22,786 - INFO - wrapper - Writing example 10000
2021-04-13 19:16:28,617 - INFO - wrapper - Writing example 20000
2021-04-13 19:16:34,405 - INFO - wrapper - Writing example 30000
2021-04-13 19:16:42,126 - INFO - wrapper - Writing example 40000
2021-04-13 19:28:28,741 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 19:28:28,742 - INFO - wrapper - best_dev_acc: 0.8977 | best_global_step: 36750
2021-04-13 19:28:28,742 - INFO - wrapper - Saving models.
2021-04-13 19:36:13,790 - INFO - wrapper - Writing example 0
2021-04-13 19:36:21,516 - INFO - wrapper - Writing example 10000
2021-04-13 19:36:29,036 - INFO - wrapper - Writing example 20000
2021-04-13 19:36:36,690 - INFO - wrapper - Writing example 30000
2021-04-13 19:36:44,356 - INFO - wrapper - Writing example 40000
2021-04-13 19:36:53,578 - INFO - wrapper - Writing example 50000
2021-04-13 19:37:01,118 - INFO - wrapper - Writing example 60000
2021-04-13 19:37:08,633 - INFO - wrapper - Writing example 70000
2021-04-13 19:56:15,484 - INFO - wrapper - {'acc': 0.8681967379964887}
2021-04-13 19:56:15,484 - INFO - wrapper - 1
2021-04-13 20:49:19,941 - INFO - wrapper - Writing example 0
2021-04-13 20:49:25,823 - INFO - wrapper - Writing example 10000
2021-04-13 20:49:31,493 - INFO - wrapper - Writing example 20000
2021-04-13 20:49:37,128 - INFO - wrapper - Writing example 30000
2021-04-13 20:49:44,713 - INFO - wrapper - Writing example 40000
2021-04-13 21:01:05,358 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 21:01:05,358 - INFO - wrapper - best_dev_acc: 0.9001 | best_global_step: 42000
2021-04-13 21:01:05,358 - INFO - wrapper - Saving models.
2021-04-13 21:17:17,569 - INFO - wrapper - Writing example 0
2021-04-13 21:17:26,922 - INFO - wrapper - Writing example 10000
2021-04-13 21:17:34,621 - INFO - wrapper - Writing example 20000
2021-04-13 21:17:42,283 - INFO - wrapper - Writing example 30000
2021-04-13 21:17:51,550 - INFO - wrapper - Writing example 40000
2021-04-13 21:17:59,221 - INFO - wrapper - Writing example 50000
2021-04-13 21:18:06,837 - INFO - wrapper - Writing example 60000
2021-04-13 21:18:14,420 - INFO - wrapper - Writing example 70000
2021-04-13 21:37:22,577 - INFO - wrapper - {'acc': 0.8682857942545992}
2021-04-13 21:37:22,578 - INFO - wrapper - 2
2021-04-13 22:22:06,450 - INFO - wrapper - Writing example 0
2021-04-13 22:22:12,333 - INFO - wrapper - Writing example 10000
2021-04-13 22:22:18,031 - INFO - wrapper - Writing example 20000
2021-04-13 22:22:23,657 - INFO - wrapper - Writing example 30000
2021-04-13 22:22:31,127 - INFO - wrapper - Writing example 40000
2021-04-13 22:34:18,928 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-13 22:34:18,928 - INFO - wrapper - best_dev_acc: 0.9016 | best_global_step: 47250
2021-04-13 22:34:18,928 - INFO - wrapper - Saving models.
2021-04-13 22:59:30,338 - INFO - wrapper - Writing example 0
2021-04-13 22:59:38,973 - INFO - wrapper - Writing example 10000
2021-04-13 22:59:46,544 - INFO - wrapper - Writing example 20000
2021-04-13 22:59:54,122 - INFO - wrapper - Writing example 30000
2021-04-13 23:00:03,214 - INFO - wrapper - Writing example 40000
2021-04-13 23:00:10,785 - INFO - wrapper - Writing example 50000
2021-04-13 23:00:18,797 - INFO - wrapper - Writing example 60000
2021-04-13 23:00:26,408 - INFO - wrapper - Writing example 70000
2021-04-13 23:18:45,799 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-13 23:18:45,799 - INFO - wrapper - best_dev_acc: 0.8701 | best_global_step: 47250
2021-04-13 23:18:45,799 - INFO - wrapper - Saving models.
2021-04-13 23:54:19,212 - INFO - wrapper - Writing example 0
2021-04-13 23:54:25,101 - INFO - wrapper - Writing example 10000
2021-04-13 23:54:30,816 - INFO - wrapper - Writing example 20000
2021-04-13 23:54:38,199 - INFO - wrapper - Writing example 30000
2021-04-13 23:54:43,891 - INFO - wrapper - Writing example 40000
2021-04-14 00:06:32,244 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-14 00:06:32,244 - INFO - wrapper - best_dev_acc: 0.9026 | best_global_step: 52500
2021-04-14 00:06:32,244 - INFO - wrapper - Saving models.
2021-04-14 00:40:58,415 - INFO - wrapper - Writing example 0
2021-04-14 00:41:06,094 - INFO - wrapper - Writing example 10000
2021-04-14 00:41:13,585 - INFO - wrapper - Writing example 20000
2021-04-14 00:41:21,100 - INFO - wrapper - Writing example 30000
2021-04-14 00:41:28,856 - INFO - wrapper - Writing example 40000
2021-04-14 00:41:38,319 - INFO - wrapper - Writing example 50000
2021-04-14 00:41:45,943 - INFO - wrapper - Writing example 60000
2021-04-14 00:41:53,538 - INFO - wrapper - Writing example 70000
2021-04-14 01:00:54,520 - INFO - wrapper - {'acc': 0.8698124729650645}
2021-04-14 01:00:54,521 - INFO - wrapper - 1
2021-04-14 01:27:21,465 - INFO - wrapper - Writing example 0
2021-04-14 01:27:27,268 - INFO - wrapper - Writing example 10000
2021-04-14 01:27:32,844 - INFO - wrapper - Writing example 20000
2021-04-14 01:27:39,988 - INFO - wrapper - Writing example 30000
2021-04-14 01:27:45,581 - INFO - wrapper - Writing example 40000
2021-04-14 01:39:08,292 - INFO - wrapper - {'acc': 0.9023094258482023}
2021-04-14 01:39:08,292 - INFO - wrapper - 1
2021-04-14 02:22:00,352 - INFO - wrapper - Writing example 0
2021-04-14 02:22:09,177 - INFO - wrapper - Writing example 10000
2021-04-14 02:22:17,055 - INFO - wrapper - Writing example 20000
2021-04-14 02:22:24,732 - INFO - wrapper - Writing example 30000
2021-04-14 02:22:32,518 - INFO - wrapper - Writing example 40000
2021-04-14 02:22:42,230 - INFO - wrapper - Writing example 50000
2021-04-14 02:22:49,862 - INFO - wrapper - Writing example 60000
2021-04-14 02:22:57,930 - INFO - wrapper - Writing example 70000
2021-04-14 02:42:04,138 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-14 02:42:04,138 - INFO - wrapper - best_dev_acc: 0.8703 | best_global_step: 57750
2021-04-14 02:42:04,138 - INFO - wrapper - Saving models.
2021-04-14 03:00:12,841 - INFO - wrapper - Writing example 0
2021-04-14 03:00:18,853 - INFO - wrapper - Writing example 10000
2021-04-14 03:00:24,666 - INFO - wrapper - Writing example 20000
2021-04-14 03:00:32,090 - INFO - wrapper - Writing example 30000
2021-04-14 03:00:37,911 - INFO - wrapper - Writing example 40000
2021-04-14 03:12:23,903 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/snli/p1-i1...
2021-04-14 03:12:23,904 - INFO - wrapper - best_dev_acc: 0.9029 | best_global_step: 63000
2021-04-14 03:12:23,904 - INFO - wrapper - Saving models.
2021-04-14 03:12:50,923 - INFO - wrapper - Writing example 0
2021-04-14 03:12:57,104 - INFO - wrapper - Writing example 10000
2021-04-14 03:13:04,493 - INFO - wrapper - Writing example 20000
2021-04-14 03:13:10,364 - INFO - wrapper - Writing example 30000
2021-04-14 03:13:16,207 - INFO - wrapper - Writing example 40000
2021-04-14 03:13:22,029 - INFO - wrapper - Writing example 50000
2021-04-14 03:13:27,897 - INFO - wrapper - Writing example 60000
2021-04-14 03:13:36,071 - INFO - wrapper - Writing example 70000
2021-04-14 03:13:41,961 - INFO - wrapper - Writing example 80000
2021-04-14 03:13:47,851 - INFO - wrapper - Writing example 90000
2021-04-14 03:13:54,022 - INFO - wrapper - Writing example 100000
2021-04-14 03:13:59,911 - INFO - wrapper - Writing example 110000
2021-04-14 03:14:05,772 - INFO - wrapper - Writing example 120000
2021-04-14 03:14:15,256 - INFO - wrapper - Writing example 130000
2021-04-14 03:14:21,049 - INFO - wrapper - Writing example 140000
2021-04-14 03:14:26,831 - INFO - wrapper - Writing example 150000
2021-04-14 03:14:32,592 - INFO - wrapper - Writing example 160000
2021-04-14 03:14:38,309 - INFO - wrapper - Writing example 170000
2021-04-14 03:14:44,038 - INFO - wrapper - Writing example 180000
2021-04-14 03:14:49,733 - INFO - wrapper - Writing example 190000
2021-04-14 03:15:00,551 - INFO - wrapper - Writing example 200000
2021-04-14 03:15:06,204 - INFO - wrapper - Writing example 210000
2021-04-14 03:15:11,875 - INFO - wrapper - Writing example 220000
2021-04-14 03:15:17,572 - INFO - wrapper - Writing example 230000
2021-04-14 03:15:23,347 - INFO - wrapper - Writing example 240000
2021-04-14 03:15:29,116 - INFO - wrapper - Writing example 250000
2021-04-14 03:15:34,897 - INFO - wrapper - Writing example 260000
2021-04-14 03:15:40,630 - INFO - wrapper - Writing example 270000
2021-04-14 03:15:46,399 - INFO - wrapper - Writing example 280000
2021-04-14 03:15:59,209 - INFO - wrapper - Writing example 290000
2021-04-14 03:16:04,938 - INFO - wrapper - Writing example 300000
2021-04-14 03:16:10,631 - INFO - wrapper - Writing example 310000
2021-04-14 03:16:16,331 - INFO - wrapper - Writing example 320000
2021-04-14 03:16:22,048 - INFO - wrapper - Writing example 330000
2021-04-14 03:16:27,839 - INFO - wrapper - Writing example 340000
2021-04-14 03:16:33,661 - INFO - wrapper - Writing example 350000
2021-04-14 03:16:39,525 - INFO - wrapper - Writing example 360000
2021-04-14 03:16:45,374 - INFO - wrapper - Writing example 370000
2021-04-14 03:16:51,203 - INFO - wrapper - Writing example 380000
2021-04-14 03:16:57,054 - INFO - wrapper - Writing example 390000
2021-04-14 03:17:02,906 - INFO - wrapper - Writing example 400000
2021-04-14 03:17:18,269 - INFO - wrapper - Writing example 410000
2021-04-14 03:17:24,078 - INFO - wrapper - Writing example 420000
2021-04-14 03:17:29,944 - INFO - wrapper - Writing example 430000
2021-04-14 03:17:35,812 - INFO - wrapper - Writing example 440000
2021-04-14 03:17:41,646 - INFO - wrapper - Writing example 450000
2021-04-14 03:17:47,475 - INFO - wrapper - Writing example 460000
2021-04-14 03:17:53,286 - INFO - wrapper - Writing example 470000
2021-04-14 03:17:59,103 - INFO - wrapper - Writing example 480000
2021-04-14 03:18:04,928 - INFO - wrapper - Writing example 490000
2021-04-14 03:18:10,758 - INFO - wrapper - Writing example 500000
2021-04-14 03:54:33,454 - INFO - wrapper - Writing example 0
2021-04-14 03:54:42,496 - INFO - wrapper - Writing example 10000
2021-04-14 03:54:50,133 - INFO - wrapper - Writing example 20000
2021-04-14 03:54:57,766 - INFO - wrapper - Writing example 30000
2021-04-14 03:55:06,887 - INFO - wrapper - Writing example 40000
2021-04-14 03:55:14,513 - INFO - wrapper - Writing example 50000
2021-04-14 03:55:22,055 - INFO - wrapper - Writing example 60000
2021-04-14 03:55:29,587 - INFO - wrapper - Writing example 70000
2021-04-14 04:12:37,868 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mnli/p1-i1...
2021-04-14 04:12:37,868 - INFO - wrapper - best_dev_acc: 0.8705 | best_global_step: 63000
2021-04-14 04:12:37,868 - INFO - wrapper - Saving models.
2021-04-14 04:13:03,980 - INFO - wrapper - Writing example 0
2021-04-14 04:13:12,843 - INFO - wrapper - Writing example 10000
2021-04-14 04:13:21,037 - INFO - wrapper - Writing example 20000
2021-04-14 04:13:29,109 - INFO - wrapper - Writing example 30000
2021-04-14 04:13:37,091 - INFO - wrapper - Writing example 40000
2021-04-14 04:13:46,686 - INFO - wrapper - Writing example 50000
2021-04-14 04:13:54,538 - INFO - wrapper - Writing example 60000
2021-04-14 04:14:02,384 - INFO - wrapper - Writing example 70000
2021-04-14 04:14:10,261 - INFO - wrapper - Writing example 80000
2021-04-14 04:14:20,645 - INFO - wrapper - Writing example 90000
2021-04-14 04:14:28,474 - INFO - wrapper - Writing example 100000
2021-04-14 04:14:36,227 - INFO - wrapper - Writing example 110000
2021-04-14 04:14:43,933 - INFO - wrapper - Writing example 120000
2021-04-14 04:14:51,642 - INFO - wrapper - Writing example 130000
2021-04-14 04:15:03,312 - INFO - wrapper - Writing example 140000
2021-04-14 04:15:11,066 - INFO - wrapper - Writing example 150000
2021-04-14 04:15:19,320 - INFO - wrapper - Writing example 160000
2021-04-14 04:15:27,347 - INFO - wrapper - Writing example 170000
2021-04-14 04:15:35,585 - INFO - wrapper - Writing example 180000
2021-04-14 04:15:43,561 - INFO - wrapper - Writing example 190000
2021-04-14 04:15:51,497 - INFO - wrapper - Writing example 200000
2021-04-14 04:16:05,336 - INFO - wrapper - Writing example 210000
2021-04-14 04:16:12,942 - INFO - wrapper - Writing example 220000
2021-04-14 04:16:21,062 - INFO - wrapper - Writing example 230000
2021-04-14 04:16:28,791 - INFO - wrapper - Writing example 240000
2021-04-14 04:16:36,464 - INFO - wrapper - Writing example 250000
2021-04-14 04:16:44,057 - INFO - wrapper - Writing example 260000
2021-04-14 04:16:51,695 - INFO - wrapper - Writing example 270000
2021-04-14 04:16:59,603 - INFO - wrapper - Writing example 280000
2021-04-14 04:17:14,412 - INFO - wrapper - Writing example 290000
2021-04-14 04:17:22,145 - INFO - wrapper - Writing example 300000
2021-04-14 04:17:29,742 - INFO - wrapper - Writing example 310000
2021-04-14 05:04:17,614 - INFO - modeling - Saving complete
2021-04-14 05:04:17,614 - INFO - modeling - Starting evaluation...
2021-04-14 05:04:17,614 - INFO - modeling - Single: Task snli 's Test examples number: 9842
2021-04-14 05:04:36,461 - INFO - wrapper - Writing example 0
2021-04-14 05:06:50,831 - INFO - modeling - --- RESULT (pattern_id=1, Task=snli) ---
2021-04-14 05:06:50,831 - INFO - modeling - eval_results:
2021-04-14 05:06:50,831 - INFO - modeling - {'acc': 0.9166836008941273}
2021-04-14 05:13:29,122 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=2000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 05:13:29,122 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=train)
2021-04-14 05:13:29,140 - INFO - task_processors - Returning 32 train examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 05:13:29,140 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=dev)
2021-04-14 05:13:29,141 - INFO - task_processors - Returning 32 dev examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 05:17:02,647 - INFO - modeling - Saving complete
2021-04-14 05:17:02,647 - INFO - modeling - Starting evaluation...
2021-04-14 05:17:02,647 - INFO - modeling - Single: Task mnli 's Test examples number: 9815
2021-04-14 05:17:21,862 - INFO - wrapper - Writing example 0
2021-04-14 05:18:36,156 - INFO - modeling - --- RESULT (pattern_id=1, Task=mnli) ---
2021-04-14 05:18:36,156 - INFO - modeling - eval_results:
2021-04-14 05:18:36,156 - INFO - modeling - {'acc': 0.8717269485481406}
2021-04-14 05:19:39,932 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=2000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 05:19:39,932 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=train)
2021-04-14 05:19:39,932 - INFO - task_processors - Returning 32 train examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 05:19:39,932 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=dev)
2021-04-14 05:19:39,933 - INFO - task_processors - Returning 32 dev examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 05:20:10,282 - INFO - wrapper - Writing example 0
2021-04-14 05:20:31,503 - INFO - wrapper - Writing example 0
2021-04-14 05:20:52,613 - INFO - wrapper - Writing example 0
2021-04-14 05:21:12,695 - INFO - wrapper - Writing example 0
2021-04-14 05:22:29,810 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=2000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 05:22:29,810 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=train)
2021-04-14 05:22:29,811 - INFO - task_processors - Returning 32 train examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 05:22:29,811 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=dev)
2021-04-14 05:22:29,811 - INFO - task_processors - Returning 32 dev examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 05:23:03,166 - INFO - wrapper - Writing example 0
2021-04-14 05:23:25,035 - INFO - wrapper - Writing example 0
2021-04-14 05:23:45,108 - INFO - wrapper - Writing example 0
2021-04-14 05:24:05,719 - INFO - wrapper - Writing example 0
2021-04-14 05:24:26,613 - INFO - wrapper - Writing example 0
2021-04-14 05:24:46,804 - INFO - wrapper - Writing example 0
2021-04-14 05:25:07,187 - INFO - wrapper - Writing example 0
2021-04-14 05:25:28,209 - INFO - wrapper - Writing example 0
2021-04-14 05:25:48,898 - INFO - wrapper - Writing example 0
2021-04-14 05:26:10,066 - INFO - wrapper - Writing example 0
2021-04-14 05:26:30,291 - INFO - wrapper - Writing example 0
2021-04-14 05:26:50,496 - INFO - wrapper - Writing example 0
2021-04-14 05:27:11,035 - INFO - wrapper - Writing example 0
2021-04-14 05:27:31,868 - INFO - wrapper - Writing example 0
2021-04-14 05:27:52,763 - INFO - wrapper - Writing example 0
2021-04-14 05:28:13,661 - INFO - wrapper - Writing example 0
2021-04-14 05:28:35,673 - INFO - wrapper - Writing example 0
2021-04-14 05:28:55,840 - INFO - wrapper - Writing example 0
2021-04-14 05:29:16,840 - INFO - wrapper - Writing example 0
2021-04-14 05:29:37,646 - INFO - wrapper - Writing example 0
2021-04-14 05:29:58,265 - INFO - wrapper - Writing example 0
2021-04-14 05:34:50,846 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=2000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 05:34:50,846 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=train)
2021-04-14 05:34:50,847 - INFO - task_processors - Returning 32 train examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 05:34:50,847 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=dev)
2021-04-14 05:34:50,848 - INFO - task_processors - Returning 32 dev examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 05:35:24,658 - INFO - wrapper - Writing example 0
2021-04-14 05:35:46,462 - INFO - wrapper - Writing example 0
2021-04-14 05:35:47,041 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 05:35:47,041 - INFO - wrapper - best_dev_acc: 0.4688 | best_global_step: 100
2021-04-14 05:35:47,041 - INFO - wrapper - Saving models.
2021-04-14 05:36:13,738 - INFO - wrapper - Writing example 0
2021-04-14 05:36:14,413 - INFO - wrapper - {'acc': 0.40625}
2021-04-14 05:36:14,413 - INFO - wrapper - 1
2021-04-14 05:36:34,530 - INFO - wrapper - Writing example 0
2021-04-14 05:36:35,196 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 05:36:35,196 - INFO - wrapper - best_dev_acc: 0.4688 | best_global_step: 300
2021-04-14 05:36:35,196 - INFO - wrapper - Saving models.
2021-04-14 05:37:12,086 - INFO - wrapper - Writing example 0
2021-04-14 05:37:12,743 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 05:37:12,743 - INFO - wrapper - best_dev_acc: 0.5312 | best_global_step: 400
2021-04-14 05:37:12,743 - INFO - wrapper - Saving models.
2021-04-14 05:37:50,630 - INFO - wrapper - Writing example 0
2021-04-14 05:37:51,303 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 05:37:51,304 - INFO - wrapper - best_dev_acc: 0.5312 | best_global_step: 500
2021-04-14 05:37:51,304 - INFO - wrapper - Saving models.
2021-04-14 05:38:28,414 - INFO - wrapper - Writing example 0
2021-04-14 05:38:28,976 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 05:38:28,976 - INFO - wrapper - best_dev_acc: 0.5312 | best_global_step: 600
2021-04-14 05:38:28,976 - INFO - wrapper - Saving models.
2021-04-14 05:39:05,223 - INFO - wrapper - Writing example 0
2021-04-14 05:39:05,788 - INFO - wrapper - {'acc': 0.4375}
2021-04-14 05:39:05,788 - INFO - wrapper - 3
2021-04-14 05:39:26,707 - INFO - wrapper - Writing example 0
2021-04-14 05:39:27,273 - INFO - wrapper - {'acc': 0.46875}
2021-04-14 05:39:27,273 - INFO - wrapper - 4
2021-04-14 05:39:47,060 - INFO - wrapper - Writing example 0
2021-04-14 05:39:47,621 - INFO - wrapper - {'acc': 0.5}
2021-04-14 05:39:47,621 - INFO - wrapper - 5
2021-04-14 05:40:07,194 - INFO - wrapper - Writing example 0
2021-04-14 05:40:07,830 - INFO - wrapper - {'acc': 0.5}
2021-04-14 05:40:07,830 - INFO - wrapper - 6
2021-04-14 05:40:29,133 - INFO - wrapper - Writing example 0
2021-04-14 05:40:29,715 - INFO - wrapper - {'acc': 0.5}
2021-04-14 05:40:29,715 - INFO - wrapper - 7
2021-04-14 05:40:50,922 - INFO - wrapper - Writing example 0
2021-04-14 05:40:51,498 - INFO - wrapper - {'acc': 0.5}
2021-04-14 05:40:51,498 - INFO - wrapper - 8
2021-04-14 05:41:11,212 - INFO - wrapper - Writing example 0
2021-04-14 05:41:11,779 - INFO - wrapper - {'acc': 0.5}
2021-04-14 05:41:11,779 - INFO - wrapper - 9
2021-04-14 05:41:32,356 - INFO - wrapper - Writing example 0
2021-04-14 05:41:32,916 - INFO - wrapper - {'acc': 0.5}
2021-04-14 05:41:32,916 - INFO - wrapper - 10
2021-04-14 05:42:20,904 - INFO - wrapper - Writing example 0
2021-04-14 05:42:21,573 - INFO - modeling - Saving complete
2021-04-14 05:42:21,573 - INFO - modeling - Starting evaluation...
2021-04-14 05:43:07,348 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/MRPC/16-42 (num_examples=-1, set_type=test)
2021-04-14 05:43:07,377 - INFO - task_processors - Returning 408 test examples with label dist.: [('1', 279), ('0', 129)]
2021-04-14 05:43:07,377 - INFO - modeling - Group g3: Task mrpc 's Test examples number: 408
2021-04-14 05:43:07,377 - INFO - wrapper - Writing example 0
2021-04-14 05:43:14,857 - INFO - modeling - --- RESULT (pattern_id=1, Group=g3, Task=mrpc) ---
2021-04-14 05:43:14,858 - INFO - modeling - eval_results:
2021-04-14 05:43:14,858 - INFO - modeling - {'acc': 0.7083333333333334}
2021-04-14 05:43:14,858 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/QQP/16-42 (num_examples=-1, set_type=test)
2021-04-14 05:43:15,669 - INFO - task_processors - Returning 40430 test examples with label dist.: [('0', 25545), ('1', 14885)]
2021-04-14 05:43:15,670 - INFO - modeling - Group g3: Task qqp 's Test examples number: 40430
2021-04-14 05:43:15,670 - INFO - wrapper - Writing example 0
2021-04-14 05:43:21,577 - INFO - wrapper - Writing example 10000
2021-04-14 05:43:27,386 - INFO - wrapper - Writing example 20000
2021-04-14 05:43:33,260 - INFO - wrapper - Writing example 30000
2021-04-14 05:43:39,361 - INFO - wrapper - Writing example 40000
2021-04-14 05:54:57,930 - INFO - modeling - --- RESULT (pattern_id=1, Group=g3, Task=qqp) ---
2021-04-14 05:54:57,931 - INFO - modeling - eval_results:
2021-04-14 05:54:57,931 - INFO - modeling - {'acc': 0.6998515953499876}
2021-04-14 06:14:21,723 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MRPC/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mrpc', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mrpc', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 06:14:21,724 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MRPC/16-42 (num_examples=-1, set_type=train)
2021-04-14 06:14:21,724 - INFO - task_processors - LOOKING AT /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MRPC/16-42/train.tsv
2021-04-14 06:14:21,742 - INFO - task_processors - Returning 32 train examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 06:14:21,742 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MRPC/16-42 (num_examples=-1, set_type=test)
2021-04-14 06:14:21,752 - INFO - task_processors - Returning 408 test examples with label dist.: [('1', 279), ('0', 129)]
2021-04-14 06:14:21,752 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MRPC/16-42 (num_examples=-1, set_type=dev)
2021-04-14 06:14:21,752 - INFO - task_processors - Returning 32 dev examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 06:14:53,528 - INFO - wrapper - Writing example 0
2021-04-14 06:15:13,107 - INFO - wrapper - Writing example 0
2021-04-14 06:15:13,605 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mrpc/p1-i1...
2021-04-14 06:15:13,605 - INFO - wrapper - best_dev_acc: 0.6875 | best_global_step: 100
2021-04-14 06:15:13,605 - INFO - wrapper - Saving models.
2021-04-14 06:15:37,461 - INFO - wrapper - Writing example 0
2021-04-14 06:15:37,892 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mrpc/p1-i1...
2021-04-14 06:15:37,892 - INFO - wrapper - best_dev_acc: 0.7188 | best_global_step: 200
2021-04-14 06:15:37,892 - INFO - wrapper - Saving models.
2021-04-14 06:16:11,694 - INFO - wrapper - Writing example 0
2021-04-14 06:16:12,145 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mrpc/p1-i1...
2021-04-14 06:16:12,145 - INFO - wrapper - best_dev_acc: 0.7188 | best_global_step: 300
2021-04-14 06:16:12,145 - INFO - wrapper - Saving models.
2021-04-14 06:16:45,661 - INFO - wrapper - Writing example 0
2021-04-14 06:16:46,113 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mrpc/p1-i1...
2021-04-14 06:16:46,113 - INFO - wrapper - best_dev_acc: 0.7500 | best_global_step: 400
2021-04-14 06:16:46,114 - INFO - wrapper - Saving models.
2021-04-14 06:17:19,976 - INFO - wrapper - Writing example 0
2021-04-14 06:17:20,428 - INFO - wrapper - {'acc': 0.6875}
2021-04-14 06:17:20,429 - INFO - wrapper - 1
2021-04-14 06:17:38,941 - INFO - wrapper - Writing example 0
2021-04-14 06:17:39,393 - INFO - wrapper - {'acc': 0.6875}
2021-04-14 06:17:39,394 - INFO - wrapper - 2
2021-04-14 06:17:57,723 - INFO - wrapper - Writing example 0
2021-04-14 06:17:58,199 - INFO - wrapper - {'acc': 0.6875}
2021-04-14 06:17:58,199 - INFO - wrapper - 3
2021-04-14 06:18:15,417 - INFO - wrapper - Writing example 0
2021-04-14 06:18:15,870 - INFO - wrapper - {'acc': 0.6875}
2021-04-14 06:18:15,870 - INFO - wrapper - 4
2021-04-14 06:18:34,389 - INFO - wrapper - Writing example 0
2021-04-14 06:18:34,848 - INFO - wrapper - {'acc': 0.6875}
2021-04-14 06:18:34,848 - INFO - wrapper - 5
2021-04-14 06:18:51,489 - INFO - wrapper - Writing example 0
2021-04-14 06:18:51,965 - INFO - wrapper - {'acc': 0.6875}
2021-04-14 06:18:51,965 - INFO - wrapper - 6
2021-04-14 06:19:33,434 - INFO - wrapper - Writing example 0
2021-04-14 06:19:33,896 - INFO - modeling - Saving complete
2021-04-14 06:19:33,896 - INFO - modeling - Starting evaluation...
2021-04-14 06:19:33,896 - INFO - modeling - Single: Task mrpc 's Test examples number: 408
2021-04-14 06:20:15,709 - INFO - wrapper - Writing example 0
2021-04-14 06:20:21,201 - INFO - modeling - --- RESULT (pattern_id=1, Task=mrpc) ---
2021-04-14 06:20:21,201 - INFO - modeling - eval_results:
2021-04-14 06:20:21,201 - INFO - modeling - {'acc': 0.6642156862745098}
2021-04-14 06:23:56,080 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/QQP/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/qqp', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='qqp', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 06:23:56,081 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/QQP/16-42 (num_examples=-1, set_type=train)
2021-04-14 06:23:56,106 - INFO - task_processors - Returning 32 train examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 06:23:56,107 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/QQP/16-42 (num_examples=-1, set_type=test)
2021-04-14 06:23:56,488 - INFO - task_processors - Returning 40430 test examples with label dist.: [('0', 25545), ('1', 14885)]
2021-04-14 06:23:56,488 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/QQP/16-42 (num_examples=-1, set_type=dev)
2021-04-14 06:23:56,490 - INFO - task_processors - Returning 32 dev examples with label dist.: [('1', 16), ('0', 16)]
2021-04-14 06:24:28,357 - INFO - wrapper - Writing example 0
2021-04-14 06:24:47,405 - INFO - wrapper - Writing example 0
2021-04-14 06:24:47,912 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/qqp/p1-i1...
2021-04-14 06:24:47,912 - INFO - wrapper - best_dev_acc: 0.6562 | best_global_step: 100
2021-04-14 06:24:47,912 - INFO - wrapper - Saving models.
2021-04-14 06:25:14,437 - INFO - wrapper - Writing example 0
2021-04-14 06:25:14,888 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/qqp/p1-i1...
2021-04-14 06:25:14,888 - INFO - wrapper - best_dev_acc: 0.6875 | best_global_step: 200
2021-04-14 06:25:14,888 - INFO - wrapper - Saving models.
2021-04-14 06:25:50,858 - INFO - wrapper - Writing example 0
2021-04-14 06:25:51,306 - INFO - wrapper - {'acc': 0.625}
2021-04-14 06:25:51,306 - INFO - wrapper - 1
2021-04-14 06:26:09,977 - INFO - wrapper - Writing example 0
2021-04-14 06:26:10,423 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/qqp/p1-i1...
2021-04-14 06:26:10,423 - INFO - wrapper - best_dev_acc: 0.7500 | best_global_step: 400
2021-04-14 06:26:10,423 - INFO - wrapper - Saving models.
2021-04-14 06:26:42,772 - INFO - wrapper - Writing example 0
2021-04-14 06:26:43,223 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/qqp/p1-i1...
2021-04-14 06:26:43,223 - INFO - wrapper - best_dev_acc: 0.7812 | best_global_step: 500
2021-04-14 06:26:43,223 - INFO - wrapper - Saving models.
2021-04-14 06:27:18,438 - INFO - wrapper - Writing example 0
2021-04-14 06:27:18,889 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/qqp/p1-i1...
2021-04-14 06:27:18,889 - INFO - wrapper - best_dev_acc: 0.7812 | best_global_step: 600
2021-04-14 06:27:18,889 - INFO - wrapper - Saving models.
2021-04-14 06:27:53,711 - INFO - wrapper - Writing example 0
2021-04-14 06:27:54,185 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/qqp/p1-i1...
2021-04-14 06:27:54,186 - INFO - wrapper - best_dev_acc: 0.7812 | best_global_step: 700
2021-04-14 06:27:54,186 - INFO - wrapper - Saving models.
2021-04-14 06:28:26,734 - INFO - wrapper - Writing example 0
2021-04-14 06:28:27,209 - INFO - wrapper - {'acc': 0.65625}
2021-04-14 06:28:27,209 - INFO - wrapper - 3
2021-04-14 06:28:44,870 - INFO - wrapper - Writing example 0
2021-04-14 06:28:45,342 - INFO - wrapper - {'acc': 0.65625}
2021-04-14 06:28:45,342 - INFO - wrapper - 4
2021-04-14 06:29:03,355 - INFO - wrapper - Writing example 0
2021-04-14 06:29:03,804 - INFO - wrapper - {'acc': 0.65625}
2021-04-14 06:29:03,804 - INFO - wrapper - 5
2021-04-14 06:29:45,468 - INFO - wrapper - Writing example 0
2021-04-14 06:29:45,920 - INFO - modeling - Saving complete
2021-04-14 06:29:45,920 - INFO - modeling - Starting evaluation...
2021-04-14 06:29:45,921 - INFO - modeling - Single: Task qqp 's Test examples number: 40430
2021-04-14 06:30:28,091 - INFO - wrapper - Writing example 0
2021-04-14 06:30:35,296 - INFO - wrapper - Writing example 10000
2021-04-14 06:30:41,727 - INFO - wrapper - Writing example 20000
2021-04-14 06:30:48,236 - INFO - wrapper - Writing example 30000
2021-04-14 06:30:54,203 - INFO - wrapper - Writing example 40000
2021-04-14 06:39:22,851 - INFO - modeling - --- RESULT (pattern_id=1, Task=qqp) ---
2021-04-14 06:39:22,851 - INFO - modeling - eval_results:
2021-04-14 06:39:22,851 - INFO - modeling - {'acc': 0.6056888449171407}
2021-04-14 06:49:31,746 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/145000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=3600, eval_examples=-1, eval_set='dev', k=145000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=36000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=24, pet_per_gpu_train_batch_size=24, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 06:49:31,746 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/145000-42 (num_examples=-1, set_type=train)
2021-04-14 06:49:35,202 - INFO - task_processors - Returning 291076 train examples with label dist.: [('1', 107502), ('0', 183574)]
2021-04-14 06:49:35,203 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/g3/145000-42 (num_examples=-1, set_type=dev)
2021-04-14 06:49:36,270 - INFO - task_processors - Returning 72770 dev examples with label dist.: [('1', 26876), ('0', 45894)]
2021-04-14 06:49:54,474 - INFO - wrapper - Writing example 0
2021-04-14 06:50:00,374 - INFO - wrapper - Writing example 10000
2021-04-14 06:50:06,585 - INFO - wrapper - Writing example 20000
2021-04-14 06:50:11,845 - INFO - wrapper - Writing example 30000
2021-04-14 06:50:17,008 - INFO - wrapper - Writing example 40000
2021-04-14 06:50:23,473 - INFO - wrapper - Writing example 50000
2021-04-14 06:50:28,599 - INFO - wrapper - Writing example 60000
2021-04-14 06:50:33,673 - INFO - wrapper - Writing example 70000
2021-04-14 06:50:38,755 - INFO - wrapper - Writing example 80000
2021-04-14 06:50:45,753 - INFO - wrapper - Writing example 90000
2021-04-14 06:50:51,080 - INFO - wrapper - Writing example 100000
2021-04-14 06:50:56,237 - INFO - wrapper - Writing example 110000
2021-04-14 06:51:01,784 - INFO - wrapper - Writing example 120000
2021-04-14 06:51:07,216 - INFO - wrapper - Writing example 130000
2021-04-14 06:51:12,624 - INFO - wrapper - Writing example 140000
2021-04-14 06:51:21,779 - INFO - wrapper - Writing example 150000
2021-04-14 06:51:27,284 - INFO - wrapper - Writing example 160000
2021-04-14 06:51:32,698 - INFO - wrapper - Writing example 170000
2021-04-14 06:51:38,333 - INFO - wrapper - Writing example 180000
2021-04-14 06:51:43,791 - INFO - wrapper - Writing example 190000
2021-04-14 06:51:49,327 - INFO - wrapper - Writing example 200000
2021-04-14 06:51:58,618 - INFO - wrapper - Writing example 210000
2021-04-14 06:52:03,958 - INFO - wrapper - Writing example 220000
2021-04-14 06:52:09,260 - INFO - wrapper - Writing example 230000
2021-04-14 06:52:14,539 - INFO - wrapper - Writing example 240000
2021-04-14 06:52:19,811 - INFO - wrapper - Writing example 250000
2021-04-14 06:52:25,066 - INFO - wrapper - Writing example 260000
2021-04-14 06:52:30,316 - INFO - wrapper - Writing example 270000
2021-04-14 06:52:35,559 - INFO - wrapper - Writing example 280000
2021-04-14 06:52:45,569 - INFO - wrapper - Writing example 290000
2021-04-14 07:11:50,246 - INFO - wrapper - Writing example 0
2021-04-14 07:11:55,371 - INFO - wrapper - Writing example 10000
2021-04-14 07:12:00,256 - INFO - wrapper - Writing example 20000
2021-04-14 07:12:05,245 - INFO - wrapper - Writing example 30000
2021-04-14 07:12:10,454 - INFO - wrapper - Writing example 40000
2021-04-14 07:12:15,664 - INFO - wrapper - Writing example 50000
2021-04-14 07:12:20,912 - INFO - wrapper - Writing example 60000
2021-04-14 07:12:26,138 - INFO - wrapper - Writing example 70000
2021-04-14 07:17:22,239 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 07:17:22,239 - INFO - wrapper - best_dev_acc: 0.8682 | best_global_step: 3600
2021-04-14 07:17:22,239 - INFO - wrapper - Saving models.
2021-04-14 07:38:42,373 - INFO - wrapper - Writing example 0
2021-04-14 07:38:47,937 - INFO - wrapper - Writing example 10000
2021-04-14 07:38:53,895 - INFO - wrapper - Writing example 20000
2021-04-14 07:38:58,911 - INFO - wrapper - Writing example 30000
2021-04-14 07:39:04,053 - INFO - wrapper - Writing example 40000
2021-04-14 07:39:09,609 - INFO - wrapper - Writing example 50000
2021-04-14 07:39:16,354 - INFO - wrapper - Writing example 60000
2021-04-14 07:39:21,635 - INFO - wrapper - Writing example 70000
2021-04-14 07:44:16,866 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 07:44:16,866 - INFO - wrapper - best_dev_acc: 0.8737 | best_global_step: 7200
2021-04-14 07:44:16,866 - INFO - wrapper - Saving models.
2021-04-14 08:04:17,684 - INFO - wrapper - Writing example 0
2021-04-14 08:04:22,791 - INFO - wrapper - Writing example 10000
2021-04-14 08:04:28,572 - INFO - wrapper - Writing example 20000
2021-04-14 08:04:33,536 - INFO - wrapper - Writing example 30000
2021-04-14 08:04:38,676 - INFO - wrapper - Writing example 40000
2021-04-14 08:04:44,050 - INFO - wrapper - Writing example 50000
2021-04-14 08:04:50,408 - INFO - wrapper - Writing example 60000
2021-04-14 08:04:55,525 - INFO - wrapper - Writing example 70000
2021-04-14 08:10:27,596 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 08:10:27,596 - INFO - wrapper - best_dev_acc: 0.8901 | best_global_step: 10800
2021-04-14 08:10:27,596 - INFO - wrapper - Saving models.
2021-04-14 08:18:03,506 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MRPC/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/mrpc', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='mrpc', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 08:18:03,506 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/MRPC/16-42 (num_examples=-1, set_type=train)
2021-04-14 08:33:14,071 - INFO - wrapper - Writing example 0
2021-04-14 08:33:19,246 - INFO - wrapper - Writing example 10000
2021-04-14 08:33:25,124 - INFO - wrapper - Writing example 20000
2021-04-14 08:33:30,179 - INFO - wrapper - Writing example 30000
2021-04-14 08:33:35,369 - INFO - wrapper - Writing example 40000
2021-04-14 08:33:40,569 - INFO - wrapper - Writing example 50000
2021-04-14 08:33:47,072 - INFO - wrapper - Writing example 60000
2021-04-14 08:33:52,262 - INFO - wrapper - Writing example 70000
2021-04-14 08:39:45,439 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 08:39:45,440 - INFO - wrapper - best_dev_acc: 0.8958 | best_global_step: 14400
2021-04-14 08:39:45,440 - INFO - wrapper - Saving models.
2021-04-14 08:46:21,933 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 08:46:21,934 - INFO - task_processors - Creating features from dataset file at data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-14 08:47:20,794 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-single/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 08:47:20,794 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-14 09:00:00,881 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-single/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 09:00:00,881 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-14 09:00:28,568 - INFO - wrapper - Writing example 0
2021-04-14 09:00:33,808 - INFO - wrapper - Writing example 10000
2021-04-14 09:00:40,323 - INFO - wrapper - Writing example 20000
2021-04-14 09:00:45,546 - INFO - wrapper - Writing example 30000
2021-04-14 09:00:50,694 - INFO - wrapper - Writing example 40000
2021-04-14 09:00:57,213 - INFO - wrapper - Writing example 50000
2021-04-14 09:01:02,356 - INFO - wrapper - Writing example 60000
2021-04-14 09:01:07,495 - INFO - wrapper - Writing example 70000
2021-04-14 09:01:50,765 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-single/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 09:01:50,765 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-14 09:01:50,768 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-14 09:01:50,768 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-14 09:01:50,772 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-14 09:01:50,773 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-14 09:01:50,774 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-14 09:01:50,774 - INFO - cli - ************Training Example:**************
2021-04-14 09:01:50,804 - INFO - cli - **********************************
2021-04-14 09:02:26,899 - INFO - wrapper - Writing example 0
2021-04-14 09:07:13,767 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 09:07:13,767 - INFO - wrapper - best_dev_acc: 0.8985 | best_global_step: 18000
2021-04-14 09:07:13,767 - INFO - wrapper - Saving models.
2021-04-14 09:08:23,278 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-single/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 09:08:23,278 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-14 09:08:23,281 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-14 09:08:23,281 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-14 09:08:23,285 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-14 09:08:23,285 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-14 09:08:23,287 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-14 09:08:23,287 - INFO - cli - ************Training Example:**************
2021-04-14 09:08:23,287 - INFO - cli - text_a=of all the halloween 's , this is the most visually unappealing .
2021-04-14 09:08:23,287 - INFO - cli - text_b=None
2021-04-14 09:08:23,287 - INFO - cli - task=SST-2
2021-04-14 09:08:23,287 - INFO - cli - label=0
2021-04-14 09:08:23,287 - INFO - cli - **********************************
2021-04-14 09:08:56,637 - INFO - wrapper - Writing example 0
2021-04-14 09:09:27,303 - INFO - wrapper - Writing example 0
2021-04-14 09:09:28,425 - INFO - wrapper - Saving trained model at output/SST-2/p1-i1...
2021-04-14 09:09:28,426 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-14 09:09:28,426 - INFO - wrapper - Saving models.
2021-04-14 09:10:14,729 - INFO - wrapper - Writing example 0
2021-04-14 09:10:15,904 - INFO - wrapper - Saving trained model at output/SST-2/p1-i1...
2021-04-14 09:10:15,904 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-14 09:10:15,904 - INFO - wrapper - Saving models.
2021-04-14 09:11:01,604 - INFO - wrapper - Writing example 0
2021-04-14 09:11:02,771 - INFO - wrapper - Saving trained model at output/SST-2/p1-i1...
2021-04-14 09:11:02,771 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-14 09:11:02,772 - INFO - wrapper - Saving models.
2021-04-14 09:11:49,376 - INFO - wrapper - Writing example 0
2021-04-14 09:11:50,470 - INFO - wrapper - Saving trained model at output/SST-2/p1-i1...
2021-04-14 09:11:50,470 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 400
2021-04-14 09:11:50,470 - INFO - wrapper - Saving models.
2021-04-14 09:12:37,297 - INFO - wrapper - Writing example 0
2021-04-14 09:12:38,314 - INFO - wrapper - Saving trained model at output/SST-2/p1-i1...
2021-04-14 09:12:38,314 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 500
2021-04-14 09:12:38,314 - INFO - wrapper - Saving models.
2021-04-14 09:13:24,422 - INFO - wrapper - Writing example 0
2021-04-14 09:13:25,525 - INFO - wrapper - {'acc': 0.90625}
2021-04-14 09:13:25,525 - INFO - wrapper - 5
2021-04-14 09:13:56,021 - INFO - wrapper - Writing example 0
2021-04-14 09:13:57,084 - INFO - wrapper - {'acc': 0.90625}
2021-04-14 09:13:57,084 - INFO - wrapper - 6
2021-04-14 09:14:27,501 - INFO - wrapper - Writing example 0
2021-04-14 09:14:28,752 - INFO - wrapper - {'acc': 0.90625}
2021-04-14 09:14:28,752 - INFO - wrapper - 7
2021-04-14 09:14:59,822 - INFO - wrapper - Writing example 0
2021-04-14 09:15:01,080 - INFO - wrapper - {'acc': 0.90625}
2021-04-14 09:15:01,080 - INFO - wrapper - 8
2021-04-14 09:15:31,852 - INFO - wrapper - Writing example 0
2021-04-14 09:15:33,166 - INFO - wrapper - {'acc': 0.90625}
2021-04-14 09:15:33,166 - INFO - wrapper - 9
2021-04-14 09:16:15,261 - INFO - wrapper - Writing example 0
2021-04-14 09:16:16,333 - INFO - modeling - Saving complete
2021-04-14 09:16:16,333 - INFO - modeling - Starting evaluation...
2021-04-14 09:16:16,333 - INFO - modeling - Single: Task sst-2 's Test examples number: 872
2021-04-14 09:17:00,676 - INFO - wrapper - Writing example 0
2021-04-14 09:17:31,266 - INFO - modeling - --- RESULT (pattern_id=1, Task=sst-2) ---
2021-04-14 09:17:31,266 - INFO - modeling - eval_results:
2021-04-14 09:17:31,266 - INFO - modeling - {'acc': 0.8967889908256881}
2021-04-14 09:33:50,428 - INFO - wrapper - Writing example 0
2021-04-14 09:33:55,620 - INFO - wrapper - Writing example 10000
2021-04-14 09:34:01,470 - INFO - wrapper - Writing example 20000
2021-04-14 09:34:06,525 - INFO - wrapper - Writing example 30000
2021-04-14 09:34:11,712 - INFO - wrapper - Writing example 40000
2021-04-14 09:34:18,239 - INFO - wrapper - Writing example 50000
2021-04-14 09:34:23,492 - INFO - wrapper - Writing example 60000
2021-04-14 09:34:28,693 - INFO - wrapper - Writing example 70000
2021-04-14 09:40:35,797 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 09:40:35,797 - INFO - wrapper - best_dev_acc: 0.9021 | best_global_step: 21600
2021-04-14 09:40:35,797 - INFO - wrapper - Saving models.
2021-04-14 10:04:48,219 - INFO - wrapper - Writing example 0
2021-04-14 10:04:53,477 - INFO - wrapper - Writing example 10000
2021-04-14 10:04:59,435 - INFO - wrapper - Writing example 20000
2021-04-14 10:05:04,483 - INFO - wrapper - Writing example 30000
2021-04-14 10:05:09,626 - INFO - wrapper - Writing example 40000
2021-04-14 10:05:16,148 - INFO - wrapper - Writing example 50000
2021-04-14 10:05:21,297 - INFO - wrapper - Writing example 60000
2021-04-14 10:05:26,441 - INFO - wrapper - Writing example 70000
2021-04-14 10:11:34,234 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 10:11:34,235 - INFO - wrapper - best_dev_acc: 0.9034 | best_global_step: 25200
2021-04-14 10:11:34,235 - INFO - wrapper - Saving models.
2021-04-14 10:35:45,325 - INFO - wrapper - Writing example 0
2021-04-14 10:35:51,538 - INFO - wrapper - Writing example 10000
2021-04-14 10:35:56,647 - INFO - wrapper - Writing example 20000
2021-04-14 10:36:01,703 - INFO - wrapper - Writing example 30000
2021-04-14 10:36:08,089 - INFO - wrapper - Writing example 40000
2021-04-14 10:36:13,226 - INFO - wrapper - Writing example 50000
2021-04-14 10:36:18,337 - INFO - wrapper - Writing example 60000
2021-04-14 10:36:23,464 - INFO - wrapper - Writing example 70000
2021-04-14 10:42:29,664 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 10:42:29,665 - INFO - wrapper - best_dev_acc: 0.9052 | best_global_step: 28800
2021-04-14 10:42:29,665 - INFO - wrapper - Saving models.
2021-04-14 11:06:51,412 - INFO - wrapper - Writing example 0
2021-04-14 11:06:57,526 - INFO - wrapper - Writing example 10000
2021-04-14 11:07:02,831 - INFO - wrapper - Writing example 20000
2021-04-14 11:07:10,015 - INFO - wrapper - Writing example 30000
2021-04-14 11:07:15,842 - INFO - wrapper - Writing example 40000
2021-04-14 11:07:21,988 - INFO - wrapper - Writing example 50000
2021-04-14 11:07:27,363 - INFO - wrapper - Writing example 60000
2021-04-14 11:07:34,951 - INFO - wrapper - Writing example 70000
2021-04-14 11:13:42,821 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 11:13:42,822 - INFO - wrapper - best_dev_acc: 0.9058 | best_global_step: 32400
2021-04-14 11:13:42,822 - INFO - wrapper - Saving models.
2021-04-14 11:38:01,183 - INFO - wrapper - Writing example 0
2021-04-14 11:38:06,303 - INFO - wrapper - Writing example 10000
2021-04-14 11:38:11,178 - INFO - wrapper - Writing example 20000
2021-04-14 11:38:16,142 - INFO - wrapper - Writing example 30000
2021-04-14 11:38:22,442 - INFO - wrapper - Writing example 40000
2021-04-14 11:38:27,563 - INFO - wrapper - Writing example 50000
2021-04-14 11:38:32,662 - INFO - wrapper - Writing example 60000
2021-04-14 11:38:37,984 - INFO - wrapper - Writing example 70000
2021-04-14 11:44:45,923 - INFO - wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g3/p1-i1...
2021-04-14 11:44:45,923 - INFO - wrapper - best_dev_acc: 0.9059 | best_global_step: 36000
2021-04-14 11:44:45,923 - INFO - wrapper - Saving models.
2021-04-14 11:45:12,144 - INFO - wrapper - Writing example 0
2021-04-14 11:45:17,773 - INFO - wrapper - Writing example 10000
2021-04-14 11:45:23,049 - INFO - wrapper - Writing example 20000
2021-04-14 11:45:29,313 - INFO - wrapper - Writing example 30000
2021-04-14 11:45:34,518 - INFO - wrapper - Writing example 40000
2021-04-14 11:45:39,678 - INFO - wrapper - Writing example 50000
2021-04-14 11:45:44,842 - INFO - wrapper - Writing example 60000
2021-04-14 11:45:51,593 - INFO - wrapper - Writing example 70000
2021-04-14 11:45:56,723 - INFO - wrapper - Writing example 80000
2021-04-14 11:46:01,868 - INFO - wrapper - Writing example 90000
2021-04-14 11:46:06,982 - INFO - wrapper - Writing example 100000
2021-04-14 11:46:12,236 - INFO - wrapper - Writing example 110000
2021-04-14 11:46:20,036 - INFO - wrapper - Writing example 120000
2021-04-14 11:46:25,576 - INFO - wrapper - Writing example 130000
2021-04-14 11:46:31,104 - INFO - wrapper - Writing example 140000
2021-04-14 11:46:36,594 - INFO - wrapper - Writing example 150000
2021-04-14 11:46:42,073 - INFO - wrapper - Writing example 160000
2021-04-14 11:46:50,403 - INFO - wrapper - Writing example 170000
2021-04-14 11:46:55,868 - INFO - wrapper - Writing example 180000
2021-04-14 11:47:01,294 - INFO - wrapper - Writing example 190000
2021-04-14 11:47:06,703 - INFO - wrapper - Writing example 200000
2021-04-14 11:47:12,101 - INFO - wrapper - Writing example 210000
2021-04-14 11:47:17,516 - INFO - wrapper - Writing example 220000
2021-04-14 11:47:22,916 - INFO - wrapper - Writing example 230000
2021-04-14 11:47:32,185 - INFO - wrapper - Writing example 240000
2021-04-14 11:47:37,588 - INFO - wrapper - Writing example 250000
2021-04-14 11:47:42,976 - INFO - wrapper - Writing example 260000
2021-04-14 11:47:48,380 - INFO - wrapper - Writing example 270000
2021-04-14 11:47:53,767 - INFO - wrapper - Writing example 280000
2021-04-14 11:47:59,164 - INFO - wrapper - Writing example 290000
2021-04-14 12:12:20,115 - INFO - modeling - Saving complete
2021-04-14 12:12:20,116 - INFO - modeling - Starting evaluation...
2021-04-14 12:12:39,834 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/MRPC/145000-42 (num_examples=-1, set_type=test)
2021-04-14 12:12:39,867 - INFO - task_processors - Returning 408 test examples with label dist.: [('1', 279), ('0', 129)]
2021-04-14 12:12:39,867 - INFO - modeling - Group g3: Task mrpc 's Test examples number: 408
2021-04-14 12:12:39,867 - INFO - wrapper - Writing example 0
2021-04-14 12:12:42,338 - INFO - modeling - --- RESULT (pattern_id=1, Group=g3, Task=mrpc) ---
2021-04-14 12:12:42,338 - INFO - modeling - eval_results:
2021-04-14 12:12:42,338 - INFO - modeling - {'acc': 0.6887254901960784}
2021-04-14 12:12:42,338 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot-cross/QQP/145000-42 (num_examples=-1, set_type=test)
2021-04-14 12:12:42,586 - INFO - task_processors - Returning 40430 test examples with label dist.: [('0', 25545), ('1', 14885)]
2021-04-14 12:12:42,586 - INFO - modeling - Group g3: Task qqp 's Test examples number: 40430
2021-04-14 12:12:42,588 - INFO - wrapper - Writing example 0
2021-04-14 12:12:48,796 - INFO - wrapper - Writing example 10000
2021-04-14 12:12:54,301 - INFO - wrapper - Writing example 20000
2021-04-14 12:13:00,937 - INFO - wrapper - Writing example 30000
2021-04-14 12:13:06,418 - INFO - wrapper - Writing example 40000
2021-04-14 12:16:29,892 - INFO - modeling - --- RESULT (pattern_id=1, Group=g3, Task=qqp) ---
2021-04-14 12:16:29,892 - INFO - modeling - eval_results:
2021-04-14 12:16:29,892 - INFO - modeling - {'acc': 0.9059361860004946}
2021-04-14 15:27:52,372 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:27:52,372 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:30:02,962 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:30:02,962 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:30:53,274 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-single/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:30:53,274 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:30:53,277 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-14 15:30:53,277 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-14 15:30:53,281 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-14 15:30:53,281 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-14 15:30:53,283 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-14 15:30:53,283 - INFO - cli - ************Training Example:**************
2021-04-14 15:30:53,283 - INFO - cli - text_a=of all the halloween 's , this is the most visually unappealing .
2021-04-14 15:30:53,283 - INFO - cli - text_b=None
2021-04-14 15:30:53,283 - INFO - cli - task=SST-2
2021-04-14 15:30:53,283 - INFO - cli - label=0
2021-04-14 15:30:53,283 - INFO - cli - **********************************
2021-04-14 15:31:34,718 - INFO - wrapper - Writing example 0
2021-04-14 15:31:55,437 - INFO - wrapper - Writing example 0
2021-04-14 15:31:55,994 - INFO - wrapper - Saving trained model at output/SST-2/p1-i1...
2021-04-14 15:31:55,994 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-14 15:31:55,995 - INFO - wrapper - Saving models.
2021-04-14 15:32:57,646 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:32:57,646 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:32:57,649 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:32:57,650 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-14 15:32:57,651 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:32:57,651 - INFO - cli - ************Training Example:**************
2021-04-14 15:32:57,651 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-14 15:32:57,652 - INFO - cli - text_b=None
2021-04-14 15:32:57,652 - INFO - cli - task=mr
2021-04-14 15:32:57,652 - INFO - cli - label=0
2021-04-14 15:32:57,652 - INFO - cli - **********************************
2021-04-14 15:33:01,214 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-14 15:33:33,887 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:37:22,960 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:37:22,960 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:37:22,963 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:37:22,963 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-14 15:37:22,965 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:37:22,965 - INFO - cli - ************Training Example:**************
2021-04-14 15:37:22,965 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-14 15:37:22,965 - INFO - cli - text_b=None
2021-04-14 15:37:22,965 - INFO - cli - task=mr
2021-04-14 15:37:22,965 - INFO - cli - label=0
2021-04-14 15:37:22,966 - INFO - cli - **********************************
2021-04-14 15:37:27,484 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-14 15:37:58,498 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:39:17,380 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:39:17,380 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:39:17,383 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:39:17,384 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-14 15:39:17,385 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:39:17,385 - INFO - cli - ************Training Example:**************
2021-04-14 15:39:17,385 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-14 15:39:17,386 - INFO - cli - text_b=None
2021-04-14 15:39:17,386 - INFO - cli - task=mr
2021-04-14 15:39:17,386 - INFO - cli - label=0
2021-04-14 15:39:17,386 - INFO - cli - **********************************
2021-04-14 15:39:21,524 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-14 15:39:52,740 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:41:03,473 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:41:03,474 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:41:03,477 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:41:03,477 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-14 15:41:03,479 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:41:03,479 - INFO - cli - ************Training Example:**************
2021-04-14 15:41:03,479 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-14 15:41:03,479 - INFO - cli - text_b=None
2021-04-14 15:41:03,479 - INFO - cli - task=mr
2021-04-14 15:41:03,479 - INFO - cli - label=0
2021-04-14 15:41:03,479 - INFO - cli - **********************************
2021-04-14 15:41:07,048 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-14 15:41:37,677 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:48:38,568 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:48:38,569 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:48:38,572 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:48:38,572 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-14 15:48:38,573 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:48:38,573 - INFO - cli - ************Training Example:**************
2021-04-14 15:48:38,574 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-14 15:48:38,574 - INFO - cli - text_b=None
2021-04-14 15:48:38,574 - INFO - cli - task=mr
2021-04-14 15:48:38,574 - INFO - cli - label=0
2021-04-14 15:48:38,574 - INFO - cli - **********************************
2021-04-14 15:48:41,640 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-14 15:49:12,903 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:49:44,232 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-14 15:49:44,232 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-14 15:49:44,235 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:49:44,235 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-14 15:49:44,237 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-14 15:49:44,237 - INFO - cli - ************Training Example:**************
2021-04-14 15:49:44,237 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-14 15:49:44,237 - INFO - cli - text_b=None
2021-04-14 15:49:44,237 - INFO - cli - task=mr
2021-04-14 15:49:44,237 - INFO - cli - label=0
2021-04-14 15:49:44,237 - INFO - cli - **********************************
2021-04-14 15:49:47,374 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-14 15:50:21,688 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:50:43,816 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:50:45,770 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-14 15:50:45,770 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-14 15:50:45,770 - INFO - transprompt_wrapper - Saving models.
2021-04-14 15:51:28,769 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:51:30,638 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-14 15:51:30,639 - INFO - transprompt_wrapper - 1
2021-04-14 15:51:52,498 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:51:54,232 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-14 15:51:54,232 - INFO - transprompt_wrapper - 2
2021-04-14 15:52:16,115 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:52:17,883 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-14 15:52:17,883 - INFO - transprompt_wrapper - 3
2021-04-14 15:52:39,692 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:52:41,637 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-14 15:52:41,637 - INFO - transprompt_wrapper - 4
2021-04-14 15:53:03,351 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:53:05,269 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-14 15:53:05,269 - INFO - transprompt_wrapper - 5
2021-04-14 15:53:26,806 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:53:28,748 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-14 15:53:28,748 - INFO - transprompt_wrapper - 6
2021-04-14 15:53:50,567 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:53:52,366 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-14 15:53:52,366 - INFO - transprompt_wrapper - 7
2021-04-14 15:54:14,270 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:54:16,003 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-14 15:54:16,003 - INFO - transprompt_wrapper - 8
2021-04-14 15:54:37,847 - INFO - transprompt_wrapper - Writing example 0
2021-04-14 15:54:39,791 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-14 15:54:39,792 - INFO - transprompt_wrapper - 9
2021-04-14 15:55:25,236 - INFO - wrapper - Writing example 0
2021-04-14 15:55:27,109 - INFO - modeling - Saving complete
2021-04-14 15:55:27,109 - INFO - modeling - Starting evaluation...
2021-04-14 15:56:11,493 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-14 15:56:11,501 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-14 15:56:11,501 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-14 15:56:11,501 - INFO - modeling - ************Test Example:**************
2021-04-14 15:56:11,501 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-14 15:56:11,501 - INFO - modeling - text_b=None
2021-04-14 15:56:11,501 - INFO - modeling - task=SST-2
2021-04-14 15:56:11,501 - INFO - modeling - label=1
2021-04-14 15:56:11,501 - INFO - modeling - **********************************
2021-04-14 15:56:11,502 - INFO - wrapper - Writing example 0
2021-04-14 15:56:27,651 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-14 15:56:27,652 - INFO - modeling - eval_results:
2021-04-14 15:56:27,652 - INFO - modeling - {'acc': 0.9231651376146789}
2021-04-14 15:56:27,652 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-14 15:56:27,681 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-14 15:56:27,682 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-14 15:56:27,682 - INFO - modeling - ************Test Example:**************
2021-04-14 15:56:27,682 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-14 15:56:27,682 - INFO - modeling - text_b=None
2021-04-14 15:56:27,682 - INFO - modeling - task=mr
2021-04-14 15:56:27,682 - INFO - modeling - label=1
2021-04-14 15:56:27,682 - INFO - modeling - **********************************
2021-04-14 15:56:27,683 - INFO - wrapper - Writing example 0
2021-04-14 15:57:04,604 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-14 15:57:04,604 - INFO - modeling - eval_results:
2021-04-14 15:57:04,604 - INFO - modeling - {'acc': 0.888}
2021-04-14 15:57:04,604 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-14 15:57:04,616 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-14 15:57:04,617 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-14 15:57:04,618 - INFO - modeling - ************Test Example:**************
2021-04-14 15:57:04,618 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-14 15:57:04,618 - INFO - modeling - text_b=None
2021-04-14 15:57:04,618 - INFO - modeling - task=cr
2021-04-14 15:57:04,618 - INFO - modeling - label=1
2021-04-14 15:57:04,618 - INFO - modeling - **********************************
2021-04-14 15:57:04,618 - INFO - wrapper - Writing example 0
2021-04-14 15:57:41,452 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-14 15:57:41,452 - INFO - modeling - eval_results:
2021-04-14 15:57:41,452 - INFO - modeling - {'acc': 0.9195}
2021-04-15 04:02:04,752 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=3, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-15 04:02:04,753 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 04:02:04,757 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 04:02:04,757 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 04:02:04,759 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 04:02:04,759 - INFO - cli - ************Training Example:**************
2021-04-15 04:02:04,759 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 04:02:04,759 - INFO - cli - text_b=None
2021-04-15 04:02:04,759 - INFO - cli - task=mr
2021-04-15 04:02:04,759 - INFO - cli - label=0
2021-04-15 04:02:04,759 - INFO - cli - **********************************
2021-04-15 04:02:07,231 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 04:02:39,262 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:03:28,408 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:03:30,478 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 04:03:30,478 - INFO - transprompt_wrapper - best_dev_acc: 0.8958 | best_global_step: 100
2021-04-15 04:03:30,478 - INFO - transprompt_wrapper - Saving models.
2021-04-15 04:04:37,408 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:04:39,543 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 04:04:39,543 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 200
2021-04-15 04:04:39,543 - INFO - transprompt_wrapper - Saving models.
2021-04-15 04:05:48,374 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:05:50,309 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 04:05:50,309 - INFO - transprompt_wrapper - 1
2021-04-15 04:06:40,338 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:06:42,066 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 04:06:42,066 - INFO - transprompt_wrapper - 2
2021-04-15 04:07:31,612 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:07:33,437 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 04:07:33,437 - INFO - transprompt_wrapper - 3
2021-04-15 04:08:22,920 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:08:24,883 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 04:08:24,884 - INFO - transprompt_wrapper - 4
2021-04-15 04:09:11,779 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:09:13,931 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 04:09:13,931 - INFO - transprompt_wrapper - 5
2021-04-15 04:10:00,233 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:10:02,044 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 04:10:02,044 - INFO - transprompt_wrapper - 6
2021-04-15 04:10:51,715 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:10:53,553 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 04:10:53,553 - INFO - transprompt_wrapper - 7
2021-04-15 04:11:43,402 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 04:11:45,498 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 04:11:45,498 - INFO - transprompt_wrapper - 8
2021-04-15 04:12:31,539 - INFO - wrapper - Writing example 0
2021-04-15 04:12:33,488 - INFO - modeling - Saving complete
2021-04-15 04:12:33,489 - INFO - modeling - Starting evaluation...
2021-04-15 04:13:22,186 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-15 04:13:22,196 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-15 04:13:22,196 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-15 04:13:22,196 - INFO - modeling - ************Test Example:**************
2021-04-15 04:13:22,197 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-15 04:13:22,197 - INFO - modeling - text_b=None
2021-04-15 04:13:22,197 - INFO - modeling - task=SST-2
2021-04-15 04:13:22,197 - INFO - modeling - label=1
2021-04-15 04:13:22,197 - INFO - modeling - **********************************
2021-04-15 04:13:22,197 - INFO - wrapper - Writing example 0
2021-04-15 04:13:39,033 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-15 04:13:39,033 - INFO - modeling - eval_results:
2021-04-15 04:13:39,034 - INFO - modeling - {'acc': 0.9185779816513762}
2021-04-15 04:13:39,034 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-15 04:13:39,064 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 04:13:39,070 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-15 04:13:39,071 - INFO - modeling - ************Test Example:**************
2021-04-15 04:13:39,071 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-15 04:13:39,071 - INFO - modeling - text_b=None
2021-04-15 04:13:39,071 - INFO - modeling - task=mr
2021-04-15 04:13:39,071 - INFO - modeling - label=1
2021-04-15 04:13:39,072 - INFO - modeling - **********************************
2021-04-15 04:13:39,072 - INFO - wrapper - Writing example 0
2021-04-15 04:14:17,632 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-15 04:14:17,632 - INFO - modeling - eval_results:
2021-04-15 04:14:17,632 - INFO - modeling - {'acc': 0.874}
2021-04-15 04:14:17,632 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-15 04:14:17,647 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 04:14:17,649 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-15 04:14:17,649 - INFO - modeling - ************Test Example:**************
2021-04-15 04:14:17,649 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-15 04:14:17,649 - INFO - modeling - text_b=None
2021-04-15 04:14:17,649 - INFO - modeling - task=cr
2021-04-15 04:14:17,649 - INFO - modeling - label=1
2021-04-15 04:14:17,649 - INFO - modeling - **********************************
2021-04-15 04:14:17,649 - INFO - wrapper - Writing example 0
2021-04-15 04:14:56,886 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-15 04:14:56,886 - INFO - modeling - eval_results:
2021-04-15 04:14:56,886 - INFO - modeling - {'acc': 0.913}
2021-04-15 06:02:24,684 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', data_dir='data/k-shot-cross/g1/4096-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=100, eval_examples=-1, eval_set='dev', k=4096, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=8000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-15 06:02:24,684 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/4096-42 (num_examples=-1, set_type=train)
2021-04-15 06:02:24,753 - INFO - task_processors - Returning 13883 train examples with label dist.: [(0, 6406), (1, 7477)]
2021-04-15 06:02:24,753 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/4096-42 (num_examples=-1, set_type=dev)
2021-04-15 06:02:24,965 - INFO - task_processors - Returning 3474 dev examples with label dist.: [(0, 1603), (1, 1871)]
2021-04-15 06:02:24,965 - INFO - cli - ************Training Example:**************
2021-04-15 06:02:24,965 - INFO - cli - text_a=if the last man were the last movie left on earth , there would be a toss-up between presiding over the end of cinema as we know it and another night of delightful hand shadows .
2021-04-15 06:02:24,965 - INFO - cli - text_b=None
2021-04-15 06:02:24,965 - INFO - cli - task=mr
2021-04-15 06:02:24,965 - INFO - cli - label=0
2021-04-15 06:02:24,966 - INFO - cli - **********************************
2021-04-15 06:03:21,179 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 06:04:32,600 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:04:40,914 - INFO - transprompt_wrapper - Writing example 10000
2021-04-15 06:06:38,602 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:07:02,616 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:07:02,616 - INFO - transprompt_wrapper - best_dev_acc: 0.8978 | best_global_step: 100
2021-04-15 06:07:02,616 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:09:05,283 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:09:29,153 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:09:29,153 - INFO - transprompt_wrapper - best_dev_acc: 0.9073 | best_global_step: 200
2021-04-15 06:09:29,153 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:11:32,307 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:11:56,521 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:11:56,521 - INFO - transprompt_wrapper - best_dev_acc: 0.9177 | best_global_step: 300
2021-04-15 06:11:56,521 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:13:59,886 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:14:24,103 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:14:24,104 - INFO - transprompt_wrapper - best_dev_acc: 0.9203 | best_global_step: 400
2021-04-15 06:14:24,104 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:16:27,975 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:16:52,210 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:16:52,210 - INFO - transprompt_wrapper - best_dev_acc: 0.9234 | best_global_step: 500
2021-04-15 06:16:52,210 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:18:54,632 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:19:19,002 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:19:19,002 - INFO - transprompt_wrapper - best_dev_acc: 0.9277 | best_global_step: 600
2021-04-15 06:19:19,002 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:21:23,029 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:21:47,783 - INFO - transprompt_wrapper - {'acc': 0.92573402417962}
2021-04-15 06:21:47,783 - INFO - transprompt_wrapper - 1
2021-04-15 06:23:42,841 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:24:07,798 - INFO - transprompt_wrapper - {'acc': 0.9234312032239493}
2021-04-15 06:24:07,798 - INFO - transprompt_wrapper - 2
2021-04-15 06:26:03,337 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:26:27,419 - INFO - transprompt_wrapper - {'acc': 0.9245826137017847}
2021-04-15 06:26:27,419 - INFO - transprompt_wrapper - 3
2021-04-15 06:28:23,297 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:28:47,892 - INFO - transprompt_wrapper - {'acc': 0.9254461715601612}
2021-04-15 06:28:47,892 - INFO - transprompt_wrapper - 4
2021-04-15 06:30:43,243 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:31:07,615 - INFO - transprompt_wrapper - {'acc': 0.927461139896373}
2021-04-15 06:31:07,615 - INFO - transprompt_wrapper - 5
2021-04-15 06:33:00,926 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:33:25,836 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:33:25,836 - INFO - transprompt_wrapper - best_dev_acc: 0.9295 | best_global_step: 1200
2021-04-15 06:33:25,836 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:35:33,170 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:35:58,398 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:35:58,398 - INFO - transprompt_wrapper - best_dev_acc: 0.9301 | best_global_step: 1300
2021-04-15 06:35:58,398 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:38:04,439 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:38:29,667 - INFO - transprompt_wrapper - {'acc': 0.9265975820379966}
2021-04-15 06:38:29,667 - INFO - transprompt_wrapper - 1
2021-04-15 06:40:28,034 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:40:52,311 - INFO - transprompt_wrapper - {'acc': 0.924006908462867}
2021-04-15 06:40:52,312 - INFO - transprompt_wrapper - 2
2021-04-15 06:42:47,386 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:43:11,645 - INFO - transprompt_wrapper - {'acc': 0.927461139896373}
2021-04-15 06:43:11,645 - INFO - transprompt_wrapper - 3
2021-04-15 06:45:06,404 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:45:30,855 - INFO - transprompt_wrapper - {'acc': 0.9251583189407023}
2021-04-15 06:45:30,855 - INFO - transprompt_wrapper - 4
2021-04-15 06:47:26,829 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:47:50,885 - INFO - transprompt_wrapper - {'acc': 0.9234312032239493}
2021-04-15 06:47:50,885 - INFO - transprompt_wrapper - 5
2021-04-15 06:49:46,130 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:50:10,613 - INFO - transprompt_wrapper - {'acc': 0.927461139896373}
2021-04-15 06:50:10,613 - INFO - transprompt_wrapper - 6
2021-04-15 06:52:06,061 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:52:30,152 - INFO - transprompt_wrapper - {'acc': 0.9265975820379966}
2021-04-15 06:52:30,152 - INFO - transprompt_wrapper - 7
2021-04-15 06:54:26,198 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:54:51,449 - INFO - transprompt_wrapper - {'acc': 0.9286125503742084}
2021-04-15 06:54:51,449 - INFO - transprompt_wrapper - 8
2021-04-15 06:56:50,407 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:57:15,742 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 06:57:15,742 - INFO - transprompt_wrapper - best_dev_acc: 0.9309 | best_global_step: 2200
2021-04-15 06:57:15,742 - INFO - transprompt_wrapper - Saving models.
2021-04-15 06:59:19,874 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 06:59:43,899 - INFO - transprompt_wrapper - {'acc': 0.9286125503742084}
2021-04-15 06:59:43,899 - INFO - transprompt_wrapper - 1
2021-04-15 07:01:39,540 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:02:04,232 - INFO - transprompt_wrapper - {'acc': 0.9280368451352907}
2021-04-15 07:02:04,232 - INFO - transprompt_wrapper - 2
2021-04-15 07:04:01,585 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:04:26,516 - INFO - transprompt_wrapper - {'acc': 0.9277489925158319}
2021-04-15 07:04:26,516 - INFO - transprompt_wrapper - 3
2021-04-15 07:06:23,758 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:06:48,282 - INFO - transprompt_wrapper - {'acc': 0.9303396660909614}
2021-04-15 07:06:48,282 - INFO - transprompt_wrapper - 4
2021-04-15 07:08:43,089 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:09:07,190 - INFO - transprompt_wrapper - {'acc': 0.9263097294185377}
2021-04-15 07:09:07,190 - INFO - transprompt_wrapper - 5
2021-04-15 07:11:02,372 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:11:26,824 - INFO - transprompt_wrapper - {'acc': 0.9297639608520437}
2021-04-15 07:11:26,824 - INFO - transprompt_wrapper - 6
2021-04-15 07:13:21,053 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:13:45,332 - INFO - transprompt_wrapper - Saving trained model at /wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/g1/p1-i1...
2021-04-15 07:13:45,333 - INFO - transprompt_wrapper - best_dev_acc: 0.9321 | best_global_step: 2900
2021-04-15 07:13:45,333 - INFO - transprompt_wrapper - Saving models.
2021-04-15 07:15:48,591 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:16:13,174 - INFO - transprompt_wrapper - {'acc': 0.9300518134715026}
2021-04-15 07:16:13,175 - INFO - transprompt_wrapper - 1
2021-04-15 07:18:08,165 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:18:33,062 - INFO - transprompt_wrapper - {'acc': 0.9289004029936673}
2021-04-15 07:18:33,062 - INFO - transprompt_wrapper - 2
2021-04-15 07:20:28,138 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:20:52,255 - INFO - transprompt_wrapper - {'acc': 0.92573402417962}
2021-04-15 07:20:52,255 - INFO - transprompt_wrapper - 3
2021-04-15 07:22:47,211 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:23:11,256 - INFO - transprompt_wrapper - {'acc': 0.9303396660909614}
2021-04-15 07:23:11,256 - INFO - transprompt_wrapper - 4
2021-04-15 07:25:07,745 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:25:32,382 - INFO - transprompt_wrapper - {'acc': 0.927461139896373}
2021-04-15 07:25:32,382 - INFO - transprompt_wrapper - 5
2021-04-15 07:27:27,497 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:27:51,599 - INFO - transprompt_wrapper - {'acc': 0.9265975820379966}
2021-04-15 07:27:51,599 - INFO - transprompt_wrapper - 6
2021-04-15 07:29:48,035 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:30:12,915 - INFO - transprompt_wrapper - {'acc': 0.9300518134715026}
2021-04-15 07:30:12,915 - INFO - transprompt_wrapper - 7
2021-04-15 07:32:08,348 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:32:32,838 - INFO - transprompt_wrapper - {'acc': 0.9294761082325849}
2021-04-15 07:32:32,838 - INFO - transprompt_wrapper - 8
2021-04-15 07:34:28,871 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:34:53,466 - INFO - transprompt_wrapper - {'acc': 0.9263097294185377}
2021-04-15 07:34:53,467 - INFO - transprompt_wrapper - 9
2021-04-15 07:36:50,378 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 07:37:16,026 - INFO - transprompt_wrapper - {'acc': 0.9271732872769142}
2021-04-15 07:37:16,026 - INFO - transprompt_wrapper - 10
2021-04-15 07:38:28,121 - INFO - wrapper - Writing example 0
2021-04-15 07:38:36,561 - INFO - wrapper - Writing example 10000
2021-04-15 07:39:50,656 - INFO - modeling - Saving complete
2021-04-15 07:39:50,657 - INFO - modeling - Starting evaluation...
2021-04-15 07:41:05,706 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/4096-42 (num_examples=-1, set_type=test)
2021-04-15 07:41:05,716 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-15 07:41:05,716 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-15 07:41:05,716 - INFO - modeling - ************Test Example:**************
2021-04-15 07:41:05,716 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-15 07:41:05,716 - INFO - modeling - text_b=None
2021-04-15 07:41:05,716 - INFO - modeling - task=SST-2
2021-04-15 07:41:05,716 - INFO - modeling - label=1
2021-04-15 07:41:05,716 - INFO - modeling - **********************************
2021-04-15 07:41:05,716 - INFO - wrapper - Writing example 0
2021-04-15 07:41:10,604 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-15 07:41:10,604 - INFO - modeling - eval_results:
2021-04-15 07:41:10,604 - INFO - modeling - {'acc': 0.948394495412844}
2021-04-15 07:41:10,604 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/4096-42 (num_examples=-1, set_type=test)
2021-04-15 07:41:10,624 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 07:41:10,624 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-15 07:41:10,624 - INFO - modeling - ************Test Example:**************
2021-04-15 07:41:10,624 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-15 07:41:10,624 - INFO - modeling - text_b=None
2021-04-15 07:41:10,624 - INFO - modeling - task=mr
2021-04-15 07:41:10,624 - INFO - modeling - label=1
2021-04-15 07:41:10,625 - INFO - modeling - **********************************
2021-04-15 07:41:10,625 - INFO - wrapper - Writing example 0
2021-04-15 07:41:21,780 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-15 07:41:21,781 - INFO - modeling - eval_results:
2021-04-15 07:41:21,781 - INFO - modeling - {'acc': 0.899}
2021-04-15 07:41:21,781 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/4096-42 (num_examples=-1, set_type=test)
2021-04-15 07:41:21,796 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 07:41:21,797 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-15 07:41:21,797 - INFO - modeling - ************Test Example:**************
2021-04-15 07:41:21,797 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-15 07:41:21,797 - INFO - modeling - text_b=None
2021-04-15 07:41:21,797 - INFO - modeling - task=cr
2021-04-15 07:41:21,797 - INFO - modeling - label=1
2021-04-15 07:41:21,797 - INFO - modeling - **********************************
2021-04-15 07:41:21,797 - INFO - wrapper - Writing example 0
2021-04-15 07:41:32,493 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-15 07:41:32,494 - INFO - modeling - eval_results:
2021-04-15 07:41:32,494 - INFO - modeling - {'acc': 0.9155}
2021-04-15 08:15:35,216 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-single/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=640, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 08:15:35,217 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 08:16:12,821 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=640, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 08:16:12,821 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 08:16:12,824 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:16:12,824 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 08:16:12,826 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:16:12,826 - INFO - cli - ************Training Example:**************
2021-04-15 08:16:12,826 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 08:16:12,826 - INFO - cli - text_b=None
2021-04-15 08:16:12,826 - INFO - cli - task=mr
2021-04-15 08:16:12,826 - INFO - cli - label=0
2021-04-15 08:16:12,826 - INFO - cli - **********************************
2021-04-15 08:17:09,079 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 08:18:03,932 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=640, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 08:18:03,932 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 08:18:03,936 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:18:03,936 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 08:18:03,938 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:18:03,938 - INFO - cli - ************Training Example:**************
2021-04-15 08:18:03,938 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 08:18:03,938 - INFO - cli - text_b=None
2021-04-15 08:18:03,938 - INFO - cli - task=mr
2021-04-15 08:18:03,938 - INFO - cli - label=0
2021-04-15 08:18:03,938 - INFO - cli - **********************************
2021-04-15 08:19:00,147 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 08:20:25,788 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:23:47,086 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=640, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 08:23:47,086 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 08:23:47,089 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:23:47,089 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 08:23:47,091 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:23:47,091 - INFO - cli - ************Training Example:**************
2021-04-15 08:23:47,091 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 08:23:47,091 - INFO - cli - text_b=None
2021-04-15 08:23:47,091 - INFO - cli - task=mr
2021-04-15 08:23:47,091 - INFO - cli - label=0
2021-04-15 08:23:47,091 - INFO - cli - **********************************
2021-04-15 08:24:43,283 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 08:26:07,927 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:29:35,049 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=640, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 08:29:35,049 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 08:29:35,052 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:29:35,052 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 08:29:35,054 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:29:35,054 - INFO - cli - ************Training Example:**************
2021-04-15 08:29:35,054 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 08:29:35,054 - INFO - cli - text_b=None
2021-04-15 08:29:35,054 - INFO - cli - task=mr
2021-04-15 08:29:35,054 - INFO - cli - label=0
2021-04-15 08:29:35,054 - INFO - cli - **********************************
2021-04-15 08:30:31,260 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 08:31:55,016 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:35:36,631 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=640, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 08:35:36,631 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 08:35:36,634 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:35:36,634 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 08:35:36,635 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 08:35:36,635 - INFO - cli - ************Training Example:**************
2021-04-15 08:35:36,635 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 08:35:36,635 - INFO - cli - text_b=None
2021-04-15 08:35:36,636 - INFO - cli - task=mr
2021-04-15 08:35:36,636 - INFO - cli - label=0
2021-04-15 08:35:36,636 - INFO - cli - **********************************
2021-04-15 08:36:32,846 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 08:37:58,350 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:38:36,156 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:38:39,152 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-15 08:38:39,152 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 64
2021-04-15 08:38:39,153 - INFO - transprompt_wrapper - Saving models.
2021-04-15 08:39:24,408 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:39:27,384 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-15 08:39:27,384 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 128
2021-04-15 08:39:27,384 - INFO - transprompt_wrapper - Saving models.
2021-04-15 08:40:23,943 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:40:26,507 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-15 08:40:26,508 - INFO - transprompt_wrapper - 1
2021-04-15 08:41:04,305 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:41:07,233 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-15 08:41:07,233 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 256
2021-04-15 08:41:07,233 - INFO - transprompt_wrapper - Saving models.
2021-04-15 08:42:03,382 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:42:05,976 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-15 08:42:05,976 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 320
2021-04-15 08:42:05,976 - INFO - transprompt_wrapper - Saving models.
2021-04-15 08:43:01,701 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:43:04,649 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 08:43:04,650 - INFO - transprompt_wrapper - 1
2021-04-15 08:43:40,843 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:43:43,842 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 08:43:43,842 - INFO - transprompt_wrapper - 2
2021-04-15 08:44:20,157 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:44:23,134 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 08:44:23,134 - INFO - transprompt_wrapper - 3
2021-04-15 08:44:59,394 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:45:02,376 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 08:45:02,376 - INFO - transprompt_wrapper - 4
2021-04-15 08:45:38,732 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 08:45:41,736 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 08:45:41,736 - INFO - transprompt_wrapper - 5
2021-04-15 08:47:17,843 - INFO - wrapper - Writing example 0
2021-04-15 08:47:20,296 - INFO - modeling - Saving complete
2021-04-15 08:47:20,296 - INFO - modeling - Starting evaluation...
2021-04-15 08:48:57,658 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-15 08:48:57,667 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-15 08:48:57,667 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-15 08:48:57,667 - INFO - modeling - ************Test Example:**************
2021-04-15 08:48:57,667 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-15 08:48:57,667 - INFO - modeling - text_b=None
2021-04-15 08:48:57,668 - INFO - modeling - task=SST-2
2021-04-15 08:48:57,668 - INFO - modeling - label=1
2021-04-15 08:48:57,668 - INFO - modeling - **********************************
2021-04-15 08:48:57,668 - INFO - wrapper - Writing example 0
2021-04-15 08:49:21,179 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-15 08:49:21,179 - INFO - modeling - eval_results:
2021-04-15 08:49:21,179 - INFO - modeling - {'acc': 0.9311926605504587}
2021-04-15 08:49:21,179 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-15 08:49:21,191 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 08:49:21,192 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-15 08:49:21,192 - INFO - modeling - ************Test Example:**************
2021-04-15 08:49:21,192 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-15 08:49:21,192 - INFO - modeling - text_b=None
2021-04-15 08:49:21,192 - INFO - modeling - task=mr
2021-04-15 08:49:21,192 - INFO - modeling - label=1
2021-04-15 08:49:21,192 - INFO - modeling - **********************************
2021-04-15 08:49:21,192 - INFO - wrapper - Writing example 0
2021-04-15 08:50:14,681 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-15 08:50:14,681 - INFO - modeling - eval_results:
2021-04-15 08:50:14,681 - INFO - modeling - {'acc': 0.876}
2021-04-15 08:50:14,681 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-15 08:50:14,694 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 08:50:14,695 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-15 08:50:14,695 - INFO - modeling - ************Test Example:**************
2021-04-15 08:50:14,696 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-15 08:50:14,696 - INFO - modeling - text_b=None
2021-04-15 08:50:14,696 - INFO - modeling - task=cr
2021-04-15 08:50:14,696 - INFO - modeling - label=1
2021-04-15 08:50:14,696 - INFO - modeling - **********************************
2021-04-15 08:50:14,696 - INFO - wrapper - Writing example 0
2021-04-15 08:51:07,719 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-15 08:51:07,720 - INFO - modeling - eval_results:
2021-04-15 08:51:07,720 - INFO - modeling - {'acc': 0.915}
2021-04-15 09:06:09,270 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[4], pet_gradient_accumulation_steps=1, pet_max_seq_length=196, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 09:06:09,270 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 09:06:09,273 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 09:06:09,273 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 09:06:09,274 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 09:06:09,274 - INFO - cli - ************Training Example:**************
2021-04-15 09:06:09,275 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 09:06:09,275 - INFO - cli - text_b=None
2021-04-15 09:06:09,275 - INFO - cli - task=mr
2021-04-15 09:06:09,275 - INFO - cli - label=0
2021-04-15 09:06:09,275 - INFO - cli - **********************************
2021-04-15 09:07:05,483 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 09:08:29,045 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:12:35,612 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[4], pet_gradient_accumulation_steps=1, pet_max_seq_length=196, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 09:12:35,612 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 09:12:35,615 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 09:12:35,615 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 09:12:35,617 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 09:12:35,617 - INFO - cli - ************Training Example:**************
2021-04-15 09:12:35,617 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 09:12:35,617 - INFO - cli - text_b=None
2021-04-15 09:12:35,617 - INFO - cli - task=mr
2021-04-15 09:12:35,617 - INFO - cli - label=0
2021-04-15 09:12:35,617 - INFO - cli - **********************************
2021-04-15 09:13:31,826 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 09:14:55,272 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:15:27,953 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:15:30,151 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 09:15:30,151 - INFO - transprompt_wrapper - best_dev_acc: 0.8854 | best_global_step: 64
2021-04-15 09:15:30,151 - INFO - transprompt_wrapper - Saving models.
2021-04-15 09:16:10,017 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:16:12,189 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 09:16:12,189 - INFO - transprompt_wrapper - best_dev_acc: 0.9583 | best_global_step: 128
2021-04-15 09:16:12,189 - INFO - transprompt_wrapper - Saving models.
2021-04-15 09:17:04,660 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:17:06,812 - INFO - transprompt_wrapper - {'acc': 0.9479166666666666}
2021-04-15 09:17:06,812 - INFO - transprompt_wrapper - 1
2021-04-15 09:17:38,407 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:17:40,989 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 09:17:40,989 - INFO - transprompt_wrapper - 2
2021-04-15 09:18:12,543 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:18:14,698 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 09:18:14,698 - INFO - transprompt_wrapper - best_dev_acc: 0.9583 | best_global_step: 320
2021-04-15 09:18:14,698 - INFO - transprompt_wrapper - Saving models.
2021-04-15 09:19:05,732 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:19:07,933 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 09:19:07,933 - INFO - transprompt_wrapper - best_dev_acc: 0.9583 | best_global_step: 384
2021-04-15 09:19:07,933 - INFO - transprompt_wrapper - Saving models.
2021-04-15 09:19:59,331 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:20:01,862 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 09:20:01,862 - INFO - transprompt_wrapper - best_dev_acc: 0.9583 | best_global_step: 448
2021-04-15 09:20:01,863 - INFO - transprompt_wrapper - Saving models.
2021-04-15 09:20:53,417 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:20:55,982 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 09:20:55,982 - INFO - transprompt_wrapper - best_dev_acc: 0.9583 | best_global_step: 512
2021-04-15 09:20:55,982 - INFO - transprompt_wrapper - Saving models.
2021-04-15 09:21:47,414 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:21:49,958 - INFO - transprompt_wrapper - {'acc': 0.9479166666666666}
2021-04-15 09:21:49,958 - INFO - transprompt_wrapper - 7
2021-04-15 09:22:22,150 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:22:24,529 - INFO - transprompt_wrapper - {'acc': 0.9479166666666666}
2021-04-15 09:22:24,529 - INFO - transprompt_wrapper - 8
2021-04-15 09:22:55,529 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:22:57,681 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 09:22:57,681 - INFO - transprompt_wrapper - best_dev_acc: 0.9583 | best_global_step: 704
2021-04-15 09:22:57,681 - INFO - transprompt_wrapper - Saving models.
2021-04-15 09:23:49,178 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 09:23:51,336 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 09:23:51,336 - INFO - transprompt_wrapper - best_dev_acc: 0.9583 | best_global_step: 768
2021-04-15 09:23:51,336 - INFO - transprompt_wrapper - Saving models.
2021-04-15 09:25:46,841 - INFO - wrapper - Writing example 0
2021-04-15 09:25:49,308 - INFO - modeling - Saving complete
2021-04-15 09:25:49,308 - INFO - modeling - Starting evaluation...
2021-04-15 09:27:25,706 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-15 09:27:25,712 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-15 09:27:25,712 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-15 09:27:25,712 - INFO - modeling - ************Test Example:**************
2021-04-15 09:27:25,712 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-15 09:27:25,713 - INFO - modeling - text_b=None
2021-04-15 09:27:25,713 - INFO - modeling - task=SST-2
2021-04-15 09:27:25,713 - INFO - modeling - label=1
2021-04-15 09:27:25,713 - INFO - modeling - **********************************
2021-04-15 09:27:25,713 - INFO - wrapper - Writing example 0
2021-04-15 09:27:43,948 - INFO - modeling - --- RESULT (pattern_id=4, Group=g1, Task=sst-2) ---
2021-04-15 09:27:43,948 - INFO - modeling - eval_results:
2021-04-15 09:27:43,948 - INFO - modeling - {'acc': 0.9254587155963303}
2021-04-15 09:27:43,948 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-15 09:27:43,958 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 09:27:43,959 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-15 09:27:43,959 - INFO - modeling - ************Test Example:**************
2021-04-15 09:27:43,959 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-15 09:27:43,959 - INFO - modeling - text_b=None
2021-04-15 09:27:43,959 - INFO - modeling - task=mr
2021-04-15 09:27:43,959 - INFO - modeling - label=1
2021-04-15 09:27:43,959 - INFO - modeling - **********************************
2021-04-15 09:27:43,959 - INFO - wrapper - Writing example 0
2021-04-15 09:28:26,120 - INFO - modeling - --- RESULT (pattern_id=4, Group=g1, Task=mr) ---
2021-04-15 09:28:26,120 - INFO - modeling - eval_results:
2021-04-15 09:28:26,120 - INFO - modeling - {'acc': 0.8865}
2021-04-15 09:28:26,120 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-15 09:28:26,131 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 09:28:26,132 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-15 09:28:26,132 - INFO - modeling - ************Test Example:**************
2021-04-15 09:28:26,132 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-15 09:28:26,132 - INFO - modeling - text_b=None
2021-04-15 09:28:26,133 - INFO - modeling - task=cr
2021-04-15 09:28:26,133 - INFO - modeling - label=1
2021-04-15 09:28:26,133 - INFO - modeling - **********************************
2021-04-15 09:28:26,133 - INFO - wrapper - Writing example 0
2021-04-15 09:29:07,729 - INFO - modeling - --- RESULT (pattern_id=4, Group=g1, Task=cr) ---
2021-04-15 09:29:07,730 - INFO - modeling - eval_results:
2021-04-15 09:29:07,730 - INFO - modeling - {'acc': 0.915}
2021-04-15 13:11:29,999 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[4], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 13:11:29,999 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 13:11:30,002 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 13:11:30,002 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 13:11:30,004 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 13:11:30,004 - INFO - cli - ************Training Example:**************
2021-04-15 13:11:30,004 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 13:11:30,004 - INFO - cli - text_b=None
2021-04-15 13:11:30,004 - INFO - cli - task=mr
2021-04-15 13:11:30,004 - INFO - cli - label=0
2021-04-15 13:11:30,004 - INFO - cli - **********************************
2021-04-15 13:12:26,211 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 13:13:52,219 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:14:30,920 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:14:33,670 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 13:14:33,670 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 64
2021-04-15 13:14:33,670 - INFO - transprompt_wrapper - Saving models.
2021-04-15 13:15:32,495 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:15:35,581 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 13:15:35,581 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 128
2021-04-15 13:15:35,581 - INFO - transprompt_wrapper - Saving models.
2021-04-15 13:16:32,547 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:16:35,611 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 13:16:35,611 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 192
2021-04-15 13:16:35,611 - INFO - transprompt_wrapper - Saving models.
2021-04-15 13:17:33,179 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:17:35,914 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p4-i1...
2021-04-15 13:17:35,914 - INFO - transprompt_wrapper - best_dev_acc: 0.9479 | best_global_step: 256
2021-04-15 13:17:35,914 - INFO - transprompt_wrapper - Saving models.
2021-04-15 13:18:34,182 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:18:36,893 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:18:36,893 - INFO - transprompt_wrapper - 1
2021-04-15 13:19:13,649 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:19:16,730 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:19:16,730 - INFO - transprompt_wrapper - 2
2021-04-15 13:19:54,306 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:19:57,007 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:19:57,008 - INFO - transprompt_wrapper - 3
2021-04-15 13:20:34,621 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:20:37,310 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:20:37,310 - INFO - transprompt_wrapper - 4
2021-04-15 13:21:15,420 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:21:18,228 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:21:18,228 - INFO - transprompt_wrapper - 5
2021-04-15 13:21:55,701 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:21:58,802 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:21:58,802 - INFO - transprompt_wrapper - 6
2021-04-15 13:22:37,222 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:22:39,920 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:22:39,921 - INFO - transprompt_wrapper - 7
2021-04-15 13:23:18,039 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:23:21,116 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:23:21,116 - INFO - transprompt_wrapper - 8
2021-04-15 13:23:58,805 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:24:01,486 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:24:01,486 - INFO - transprompt_wrapper - 9
2021-04-15 13:24:39,149 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:24:41,835 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-15 13:24:41,836 - INFO - transprompt_wrapper - 10
2021-04-15 13:26:21,270 - INFO - wrapper - Writing example 0
2021-04-15 13:26:24,140 - INFO - modeling - Saving complete
2021-04-15 13:26:24,140 - INFO - modeling - Starting evaluation...
2021-04-15 13:28:02,797 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-15 13:28:02,804 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-15 13:28:02,804 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-15 13:28:02,804 - INFO - modeling - ************Test Example:**************
2021-04-15 13:28:02,804 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-15 13:28:02,804 - INFO - modeling - text_b=None
2021-04-15 13:28:02,804 - INFO - modeling - task=SST-2
2021-04-15 13:28:02,804 - INFO - modeling - label=1
2021-04-15 13:28:02,804 - INFO - modeling - **********************************
2021-04-15 13:28:02,804 - INFO - wrapper - Writing example 0
2021-04-15 13:28:26,765 - INFO - modeling - --- RESULT (pattern_id=4, Group=g1, Task=sst-2) ---
2021-04-15 13:28:26,765 - INFO - modeling - eval_results:
2021-04-15 13:28:26,765 - INFO - modeling - {'acc': 0.9243119266055045}
2021-04-15 13:28:26,765 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-15 13:28:26,778 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 13:28:26,778 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-15 13:28:26,778 - INFO - modeling - ************Test Example:**************
2021-04-15 13:28:26,778 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-15 13:28:26,778 - INFO - modeling - text_b=None
2021-04-15 13:28:26,778 - INFO - modeling - task=mr
2021-04-15 13:28:26,778 - INFO - modeling - label=1
2021-04-15 13:28:26,778 - INFO - modeling - **********************************
2021-04-15 13:28:26,779 - INFO - wrapper - Writing example 0
2021-04-15 13:29:23,447 - INFO - modeling - --- RESULT (pattern_id=4, Group=g1, Task=mr) ---
2021-04-15 13:29:23,447 - INFO - modeling - eval_results:
2021-04-15 13:29:23,447 - INFO - modeling - {'acc': 0.8715}
2021-04-15 13:29:23,447 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-15 13:29:23,461 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 13:29:23,463 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-15 13:29:23,463 - INFO - modeling - ************Test Example:**************
2021-04-15 13:29:23,463 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-15 13:29:23,464 - INFO - modeling - text_b=None
2021-04-15 13:29:23,464 - INFO - modeling - task=cr
2021-04-15 13:29:23,464 - INFO - modeling - label=1
2021-04-15 13:29:23,464 - INFO - modeling - **********************************
2021-04-15 13:29:23,464 - INFO - wrapper - Writing example 0
2021-04-15 13:30:18,842 - INFO - modeling - --- RESULT (pattern_id=4, Group=g1, Task=cr) ---
2021-04-15 13:30:18,843 - INFO - modeling - eval_results:
2021-04-15 13:30:18,843 - INFO - modeling - {'acc': 0.881}
2021-04-15 13:53:42,363 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 13:53:42,363 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-15 13:53:42,368 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 13:53:42,368 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-15 13:53:42,371 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-15 13:53:42,371 - INFO - cli - ************Training Example:**************
2021-04-15 13:53:42,371 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-15 13:53:42,371 - INFO - cli - text_b=None
2021-04-15 13:53:42,371 - INFO - cli - task=mr
2021-04-15 13:53:42,371 - INFO - cli - label=0
2021-04-15 13:53:42,371 - INFO - cli - **********************************
2021-04-15 13:54:38,577 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 13:56:00,794 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:56:39,605 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:56:42,259 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-15 13:56:42,259 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 64
2021-04-15 13:56:42,259 - INFO - transprompt_wrapper - Saving models.
2021-04-15 13:57:39,968 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:57:42,563 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-15 13:57:42,563 - INFO - transprompt_wrapper - 1
2021-04-15 13:58:19,059 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:58:21,648 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-15 13:58:21,648 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 192
2021-04-15 13:58:21,648 - INFO - transprompt_wrapper - Saving models.
2021-04-15 13:59:17,730 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:59:20,362 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-15 13:59:20,362 - INFO - transprompt_wrapper - 3
2021-04-15 13:59:56,593 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 13:59:59,522 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-15 13:59:59,522 - INFO - transprompt_wrapper - 4
2021-04-15 14:00:36,016 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 14:00:38,930 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-15 14:00:38,930 - INFO - transprompt_wrapper - 5
2021-04-15 14:01:16,030 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 14:01:18,638 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-15 14:01:18,638 - INFO - transprompt_wrapper - 6
2021-04-15 14:01:56,093 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 14:01:58,701 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-15 14:01:58,701 - INFO - transprompt_wrapper - 7
2021-04-15 14:02:36,229 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 14:02:39,034 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-15 14:02:39,034 - INFO - transprompt_wrapper - 8
2021-04-15 14:03:15,133 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 14:03:18,102 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-15 14:03:18,102 - INFO - transprompt_wrapper - 9
2021-04-15 14:03:54,545 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 14:03:57,568 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-15 14:03:57,568 - INFO - transprompt_wrapper - 10
2021-04-15 14:05:36,740 - INFO - wrapper - Writing example 0
2021-04-15 14:05:39,507 - INFO - modeling - Saving complete
2021-04-15 14:05:39,508 - INFO - modeling - Starting evaluation...
2021-04-15 14:07:18,918 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-15 14:07:18,926 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-15 14:07:18,926 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-15 14:07:18,926 - INFO - modeling - ************Test Example:**************
2021-04-15 14:07:18,926 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-15 14:07:18,926 - INFO - modeling - text_b=None
2021-04-15 14:07:18,926 - INFO - modeling - task=SST-2
2021-04-15 14:07:18,926 - INFO - modeling - label=1
2021-04-15 14:07:18,926 - INFO - modeling - **********************************
2021-04-15 14:07:18,926 - INFO - wrapper - Writing example 0
2021-04-15 14:07:42,333 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-15 14:07:42,333 - INFO - modeling - eval_results:
2021-04-15 14:07:42,333 - INFO - modeling - {'acc': 0.9311926605504587}
2021-04-15 14:07:42,333 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-15 14:07:42,348 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 14:07:42,348 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-15 14:07:42,348 - INFO - modeling - ************Test Example:**************
2021-04-15 14:07:42,348 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-15 14:07:42,348 - INFO - modeling - text_b=None
2021-04-15 14:07:42,348 - INFO - modeling - task=mr
2021-04-15 14:07:42,349 - INFO - modeling - label=1
2021-04-15 14:07:42,349 - INFO - modeling - **********************************
2021-04-15 14:07:42,349 - INFO - wrapper - Writing example 0
2021-04-15 14:08:36,172 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-15 14:08:36,172 - INFO - modeling - eval_results:
2021-04-15 14:08:36,172 - INFO - modeling - {'acc': 0.8855}
2021-04-15 14:08:36,172 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-15 14:08:36,186 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-15 14:08:36,188 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-15 14:08:36,188 - INFO - modeling - ************Test Example:**************
2021-04-15 14:08:36,188 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-15 14:08:36,188 - INFO - modeling - text_b=None
2021-04-15 14:08:36,188 - INFO - modeling - task=cr
2021-04-15 14:08:36,188 - INFO - modeling - label=1
2021-04-15 14:08:36,188 - INFO - modeling - **********************************
2021-04-15 14:08:36,188 - INFO - wrapper - Writing example 0
2021-04-15 14:09:30,220 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-15 14:09:30,220 - INFO - modeling - eval_results:
2021-04-15 14:09:30,220 - INFO - modeling - {'acc': 0.9185}
2021-04-15 14:40:26,280 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 14:40:26,280 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-04-15 14:40:26,286 - INFO - task_processors - Returning 96 train examples with label dist.: [('entailment', 32), ('neutral', 32), ('contradiction', 32)]
2021-04-15 14:40:26,286 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-04-15 14:40:26,289 - INFO - task_processors - Returning 96 dev examples with label dist.: [('entailment', 32), ('neutral', 32), ('contradiction', 32)]
2021-04-15 14:40:26,289 - INFO - cli - ************Training Example:**************
2021-04-15 14:40:26,289 - INFO - cli - text_a=A man wearing work clothes is on top of machinery.
2021-04-15 14:40:26,289 - INFO - cli - text_b=a man is on top of machinery
2021-04-15 14:40:26,289 - INFO - cli - task=SNLI
2021-04-15 14:40:26,289 - INFO - cli - label=entailment
2021-04-15 14:40:26,289 - INFO - cli - **********************************
2021-04-15 14:41:22,497 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 14:42:47,827 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:49:13,732 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-15 15:49:13,732 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-04-15 15:49:13,735 - INFO - task_processors - Returning 96 train examples with label dist.: [('entailment', 32), ('neutral', 32), ('contradiction', 32)]
2021-04-15 15:49:13,735 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-04-15 15:49:13,737 - INFO - task_processors - Returning 96 dev examples with label dist.: [('entailment', 32), ('neutral', 32), ('contradiction', 32)]
2021-04-15 15:49:13,737 - INFO - cli - ************Training Example:**************
2021-04-15 15:49:13,737 - INFO - cli - text_a=A man wearing work clothes is on top of machinery.
2021-04-15 15:49:13,737 - INFO - cli - text_b=a man is on top of machinery
2021-04-15 15:49:13,737 - INFO - cli - task=SNLI
2021-04-15 15:49:13,737 - INFO - cli - label=entailment
2021-04-15 15:49:13,737 - INFO - cli - **********************************
2021-04-15 15:50:09,945 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-15 15:51:35,279 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:52:12,500 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:52:15,133 - INFO - transprompt_wrapper - Saving trained model at output/g2/p1-i1...
2021-04-15 15:52:15,134 - INFO - transprompt_wrapper - best_dev_acc: 0.5208 | best_global_step: 64
2021-04-15 15:52:15,134 - INFO - transprompt_wrapper - Saving models.
2021-04-15 15:53:10,280 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:53:12,909 - INFO - transprompt_wrapper - Saving trained model at output/g2/p1-i1...
2021-04-15 15:53:12,909 - INFO - transprompt_wrapper - best_dev_acc: 0.6354 | best_global_step: 128
2021-04-15 15:53:12,909 - INFO - transprompt_wrapper - Saving models.
2021-04-15 15:54:06,694 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:54:09,754 - INFO - transprompt_wrapper - {'acc': 0.625}
2021-04-15 15:54:09,754 - INFO - transprompt_wrapper - 1
2021-04-15 15:54:46,411 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:54:49,009 - INFO - transprompt_wrapper - Saving trained model at output/g2/p1-i1...
2021-04-15 15:54:49,009 - INFO - transprompt_wrapper - best_dev_acc: 0.6354 | best_global_step: 256
2021-04-15 15:54:49,009 - INFO - transprompt_wrapper - Saving models.
2021-04-15 15:55:43,564 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:55:46,225 - INFO - transprompt_wrapper - Saving trained model at output/g2/p1-i1...
2021-04-15 15:55:46,226 - INFO - transprompt_wrapper - best_dev_acc: 0.6458 | best_global_step: 320
2021-04-15 15:55:46,226 - INFO - transprompt_wrapper - Saving models.
2021-04-15 15:56:39,814 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:56:42,869 - INFO - transprompt_wrapper - {'acc': 0.6145833333333334}
2021-04-15 15:56:42,869 - INFO - transprompt_wrapper - 1
2021-04-15 15:57:19,033 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:57:22,027 - INFO - transprompt_wrapper - {'acc': 0.6145833333333334}
2021-04-15 15:57:22,027 - INFO - transprompt_wrapper - 2
2021-04-15 15:57:58,312 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:58:01,126 - INFO - transprompt_wrapper - {'acc': 0.6354166666666666}
2021-04-15 15:58:01,126 - INFO - transprompt_wrapper - 3
2021-04-15 15:58:37,083 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:58:40,082 - INFO - transprompt_wrapper - Saving trained model at output/g2/p1-i1...
2021-04-15 15:58:40,082 - INFO - transprompt_wrapper - best_dev_acc: 0.6458 | best_global_step: 576
2021-04-15 15:58:40,082 - INFO - transprompt_wrapper - Saving models.
2021-04-15 15:59:34,803 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 15:59:37,411 - INFO - transprompt_wrapper - Saving trained model at output/g2/p1-i1...
2021-04-15 15:59:37,411 - INFO - transprompt_wrapper - best_dev_acc: 0.6458 | best_global_step: 640
2021-04-15 15:59:37,412 - INFO - transprompt_wrapper - Saving models.
2021-04-15 16:00:31,690 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 16:00:34,328 - INFO - transprompt_wrapper - Saving trained model at output/g2/p1-i1...
2021-04-15 16:00:34,328 - INFO - transprompt_wrapper - best_dev_acc: 0.6458 | best_global_step: 704
2021-04-15 16:00:34,329 - INFO - transprompt_wrapper - Saving models.
2021-04-15 16:01:29,057 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 16:01:32,117 - INFO - transprompt_wrapper - Saving trained model at output/g2/p1-i1...
2021-04-15 16:01:32,118 - INFO - transprompt_wrapper - best_dev_acc: 0.7083 | best_global_step: 768
2021-04-15 16:01:32,118 - INFO - transprompt_wrapper - Saving models.
2021-04-15 16:02:26,885 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 16:02:29,727 - INFO - transprompt_wrapper - {'acc': 0.6979166666666666}
2021-04-15 16:02:29,728 - INFO - transprompt_wrapper - 1
2021-04-15 16:03:05,918 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 16:03:08,953 - INFO - transprompt_wrapper - {'acc': 0.6875}
2021-04-15 16:03:08,953 - INFO - transprompt_wrapper - 2
2021-04-15 16:03:45,808 - INFO - transprompt_wrapper - Writing example 0
2021-04-15 16:03:48,465 - INFO - transprompt_wrapper - {'acc': 0.6875}
2021-04-15 16:03:48,465 - INFO - transprompt_wrapper - 3
2021-04-15 16:05:50,067 - INFO - wrapper - Writing example 0
2021-04-15 16:05:52,918 - INFO - modeling - Saving complete
2021-04-15 16:05:52,919 - INFO - modeling - Starting evaluation...
2021-04-15 16:07:30,443 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-42 (num_examples=-1, set_type=test)
2021-04-15 16:07:30,938 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('contradiction', 6453), ('neutral', 6252)]
2021-04-15 16:07:30,939 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-15 16:07:30,940 - INFO - modeling - ************Test Example:**************
2021-04-15 16:07:30,940 - INFO - modeling - text_a=However, the specific approaches to executing those principles tended to differ among the various sectors.
2021-04-15 16:07:30,941 - INFO - modeling - text_b=Specific approaches to each principle is different in each sector.
2021-04-15 16:07:30,941 - INFO - modeling - task=MNLI
2021-04-15 16:07:30,941 - INFO - modeling - label=entailment
2021-04-15 16:07:30,941 - INFO - modeling - **********************************
2021-04-15 16:07:30,941 - INFO - wrapper - Writing example 0
2021-04-15 16:07:44,863 - INFO - wrapper - Writing example 10000
2021-04-15 16:16:23,039 - INFO - modeling - --- RESULT (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-15 16:16:23,039 - INFO - modeling - eval_results:
2021-04-15 16:16:23,039 - INFO - modeling - {'acc': 0.6818852751056141}
2021-04-15 16:16:23,039 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-42 (num_examples=-1, set_type=test)
2021-04-16 02:46:31,079 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-16 02:46:31,079 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-16 02:46:31,082 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 02:46:31,082 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-16 02:46:31,084 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 02:46:31,084 - INFO - cli - ************Training Example:**************
2021-04-16 02:46:31,084 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-16 02:46:31,084 - INFO - cli - text_b=None
2021-04-16 02:46:31,084 - INFO - cli - task=mr
2021-04-16 02:46:31,084 - INFO - cli - label=0
2021-04-16 02:46:31,084 - INFO - cli - **********************************
2021-04-16 02:47:27,284 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 02:48:51,829 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 02:49:30,746 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 02:49:33,389 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 02:49:33,389 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 64
2021-04-16 02:49:33,389 - INFO - transprompt_wrapper - Saving models.
2021-04-16 02:50:58,290 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-16 02:50:58,290 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-16 02:50:58,293 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 02:50:58,293 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-16 02:50:58,295 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 02:50:58,295 - INFO - cli - ************Training Example:**************
2021-04-16 02:50:58,295 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-16 02:50:58,295 - INFO - cli - text_b=None
2021-04-16 02:50:58,295 - INFO - cli - task=mr
2021-04-16 02:50:58,295 - INFO - cli - label=0
2021-04-16 02:50:58,295 - INFO - cli - **********************************
2021-04-16 02:51:54,503 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 02:53:18,471 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 02:57:43,138 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='/wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='/wjn/few_shot_fine_tuning/P-tuning/PT-Fewshot/output/SST-2', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-16 02:57:43,138 - INFO - task_processors - Creating features from dataset file at /wjn/few_shot_fine_tuning/LM-BFF/data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-16 02:58:15,518 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2-', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-16 02:58:15,518 - INFO - task_processors - Creating features from dataset file at data/k-shot/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-16 02:58:35,824 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-single/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2-', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-16 02:58:35,824 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-16 02:58:35,827 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-16 02:58:35,827 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-16 02:58:35,831 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-16 02:58:35,831 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-16 02:58:35,833 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-16 02:58:35,833 - INFO - cli - ************Training Example:**************
2021-04-16 02:58:35,833 - INFO - cli - text_a=of all the halloween 's , this is the most visually unappealing .
2021-04-16 02:58:35,833 - INFO - cli - text_b=None
2021-04-16 02:58:35,833 - INFO - cli - task=SST-2
2021-04-16 02:58:35,833 - INFO - cli - label=0
2021-04-16 02:58:35,833 - INFO - cli - **********************************
2021-04-16 02:59:15,076 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-single/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2-', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-16 02:59:15,076 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-16 02:59:15,079 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-16 02:59:15,079 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-16 02:59:15,083 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-16 02:59:15,083 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-16 02:59:15,085 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-16 02:59:15,085 - INFO - cli - ************Training Example:**************
2021-04-16 02:59:15,085 - INFO - cli - text_a=of all the halloween 's , this is the most visually unappealing .
2021-04-16 02:59:15,085 - INFO - cli - text_b=None
2021-04-16 02:59:15,085 - INFO - cli - task=SST-2
2021-04-16 02:59:15,085 - INFO - cli - label=0
2021-04-16 02:59:15,085 - INFO - cli - **********************************
2021-04-16 03:01:34,516 - INFO - wrapper - Writing example 0
2021-04-16 03:06:14,047 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-single/SST-2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/SST-2-', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='sst-2', task_type='single_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-16 03:06:14,047 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=train)
2021-04-16 03:06:14,050 - INFO - task_processors - Returning 32 train examples with label dist.: [(0, 16), (1, 16)]
2021-04-16 03:06:14,050 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-16 03:06:14,054 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-16 03:06:14,054 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/SST-2/16-42 (num_examples=-1, set_type=dev)
2021-04-16 03:06:14,056 - INFO - task_processors - Returning 32 dev examples with label dist.: [(0, 16), (1, 16)]
2021-04-16 03:06:14,056 - INFO - cli - ************Training Example:**************
2021-04-16 03:06:14,056 - INFO - cli - text_a=of all the halloween 's , this is the most visually unappealing .
2021-04-16 03:06:14,056 - INFO - cli - text_b=None
2021-04-16 03:06:14,056 - INFO - cli - task=SST-2
2021-04-16 03:06:14,056 - INFO - cli - label=0
2021-04-16 03:06:14,056 - INFO - cli - **********************************
2021-04-16 03:08:34,002 - INFO - wrapper - Writing example 0
2021-04-16 03:25:03,138 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-16 03:25:03,138 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-16 03:25:03,141 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 03:25:03,141 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-16 03:25:03,142 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 03:25:03,143 - INFO - cli - ************Training Example:**************
2021-04-16 03:25:03,143 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-16 03:25:03,143 - INFO - cli - text_b=None
2021-04-16 03:25:03,143 - INFO - cli - task=mr
2021-04-16 03:25:03,143 - INFO - cli - label=0
2021-04-16 03:25:03,143 - INFO - cli - **********************************
2021-04-16 03:25:24,140 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-16 03:25:24,140 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-16 03:25:24,144 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 03:25:24,144 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-16 03:25:24,146 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 03:25:24,147 - INFO - cli - ************Training Example:**************
2021-04-16 03:25:24,147 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-16 03:25:24,147 - INFO - cli - text_b=None
2021-04-16 03:25:24,147 - INFO - cli - task=mr
2021-04-16 03:25:24,147 - INFO - cli - label=0
2021-04-16 03:25:24,147 - INFO - cli - **********************************
2021-04-16 03:26:20,352 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 03:27:46,517 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:37:02,347 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-16 03:37:02,347 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-16 03:37:02,350 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 03:37:02,350 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-16 03:37:02,352 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 03:37:02,352 - INFO - cli - ************Training Example:**************
2021-04-16 03:37:02,352 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-16 03:37:02,352 - INFO - cli - text_b=None
2021-04-16 03:37:02,352 - INFO - cli - task=mr
2021-04-16 03:37:02,352 - INFO - cli - label=0
2021-04-16 03:37:02,352 - INFO - cli - **********************************
2021-04-16 03:37:58,567 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 03:39:21,684 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:39:59,120 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:40:01,749 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 03:40:01,749 - INFO - transprompt_wrapper - best_dev_acc: 0.9479 | best_global_step: 64
2021-04-16 03:40:01,749 - INFO - transprompt_wrapper - Saving models.
2021-04-16 03:40:58,320 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:41:01,072 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 03:41:01,072 - INFO - transprompt_wrapper - best_dev_acc: 0.9479 | best_global_step: 128
2021-04-16 03:41:01,072 - INFO - transprompt_wrapper - Saving models.
2021-04-16 03:41:56,575 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:41:59,398 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 03:41:59,398 - INFO - transprompt_wrapper - best_dev_acc: 0.9479 | best_global_step: 192
2021-04-16 03:41:59,398 - INFO - transprompt_wrapper - Saving models.
2021-04-16 03:42:55,790 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:42:58,363 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-16 03:42:58,363 - INFO - transprompt_wrapper - 3
2021-04-16 03:43:34,927 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:43:37,517 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-16 03:43:37,517 - INFO - transprompt_wrapper - 4
2021-04-16 03:44:14,211 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:44:16,793 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-16 03:44:16,793 - INFO - transprompt_wrapper - 5
2021-04-16 03:44:53,500 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:44:56,079 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-16 03:44:56,079 - INFO - transprompt_wrapper - 6
2021-04-16 03:45:32,940 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:45:35,505 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-16 03:45:35,505 - INFO - transprompt_wrapper - 7
2021-04-16 03:46:12,398 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:46:14,996 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-16 03:46:14,997 - INFO - transprompt_wrapper - 8
2021-04-16 03:46:51,592 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:46:54,186 - INFO - transprompt_wrapper - {'acc': 0.9375}
2021-04-16 03:46:54,186 - INFO - transprompt_wrapper - 9
2021-04-16 03:47:30,910 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 03:47:33,499 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-16 03:47:33,499 - INFO - transprompt_wrapper - 10
2021-04-16 03:49:09,304 - INFO - wrapper - Writing example 0
2021-04-16 03:49:12,305 - INFO - modeling - Saving complete
2021-04-16 03:49:12,305 - INFO - modeling - Starting evaluation...
2021-04-16 03:50:50,435 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-16 03:50:50,443 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-16 03:50:50,443 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-16 03:50:50,443 - INFO - modeling - ************Test Example:**************
2021-04-16 03:50:50,443 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-16 03:50:50,443 - INFO - modeling - text_b=None
2021-04-16 03:50:50,443 - INFO - modeling - task=SST-2
2021-04-16 03:50:50,443 - INFO - modeling - label=1
2021-04-16 03:50:50,443 - INFO - modeling - **********************************
2021-04-16 03:50:50,443 - INFO - wrapper - Writing example 0
2021-04-16 03:51:13,994 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-16 03:51:13,994 - INFO - modeling - eval_results:
2021-04-16 03:51:13,994 - INFO - modeling - {'acc': 0.926605504587156}
2021-04-16 03:51:13,994 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-16 03:51:14,005 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-16 03:51:14,005 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-16 03:51:14,005 - INFO - modeling - ************Test Example:**************
2021-04-16 03:51:14,005 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-16 03:51:14,005 - INFO - modeling - text_b=None
2021-04-16 03:51:14,005 - INFO - modeling - task=mr
2021-04-16 03:51:14,005 - INFO - modeling - label=1
2021-04-16 03:51:14,005 - INFO - modeling - **********************************
2021-04-16 03:51:14,005 - INFO - wrapper - Writing example 0
2021-04-16 03:52:07,822 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-16 03:52:07,822 - INFO - modeling - eval_results:
2021-04-16 03:52:07,822 - INFO - modeling - {'acc': 0.875}
2021-04-16 03:52:07,822 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-16 03:52:07,832 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-16 03:52:07,833 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-16 03:52:07,833 - INFO - modeling - ************Test Example:**************
2021-04-16 03:52:07,833 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-16 03:52:07,833 - INFO - modeling - text_b=None
2021-04-16 03:52:07,833 - INFO - modeling - task=cr
2021-04-16 03:52:07,833 - INFO - modeling - label=1
2021-04-16 03:52:07,833 - INFO - modeling - **********************************
2021-04-16 03:52:07,833 - INFO - wrapper - Writing example 0
2021-04-16 03:53:01,603 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-16 03:53:01,604 - INFO - modeling - eval_results:
2021-04-16 03:53:01,604 - INFO - modeling - {'acc': 0.9095}
2021-04-16 04:39:57,354 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-16 04:39:57,354 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-16 04:39:57,357 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 04:39:57,357 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-16 04:39:57,359 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 04:39:57,359 - INFO - cli - ************Training Example:**************
2021-04-16 04:39:57,359 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-16 04:39:57,359 - INFO - cli - text_b=None
2021-04-16 04:39:57,359 - INFO - cli - task=mr
2021-04-16 04:39:57,359 - INFO - cli - label=0
2021-04-16 04:39:57,360 - INFO - cli - **********************************
2021-04-16 04:40:53,569 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 04:42:17,271 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 06:49:53,476 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=3600, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output/g2-full', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=36000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-16 06:49:53,476 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=train)
2021-04-16 06:50:04,757 - INFO - task_processors - Returning 753653 train examples with label dist.: [('entailment', 251451), ('neutral', 250931), ('contradiction', 251271)]
2021-04-16 06:50:04,758 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=dev)
2021-04-16 06:50:07,343 - INFO - task_processors - Returning 188416 dev examples with label dist.: [('entailment', 62864), ('neutral', 62733), ('contradiction', 62819)]
2021-04-16 06:50:07,344 - INFO - cli - ************Training Example:**************
2021-04-16 06:50:07,344 - INFO - cli - text_a=We seem to believe that all human action is motivated not by the desire to know or improve the lot of humankind, but only by the basest motives of greed, power, and self-aggrandizement.
2021-04-16 06:50:07,344 - INFO - cli - text_b=Human action is believed to be motivated solely on greed and power.
2021-04-16 06:50:07,344 - INFO - cli - task=MNLI
2021-04-16 06:50:07,344 - INFO - cli - label=entailment
2021-04-16 06:50:07,344 - INFO - cli - **********************************
2021-04-16 06:51:03,561 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 06:52:12,195 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:09:31,167 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-16 10:09:31,167 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-16 10:09:31,172 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 10:09:31,172 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-16 10:09:31,174 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-16 10:09:31,174 - INFO - cli - ************Training Example:**************
2021-04-16 10:09:31,174 - INFO - cli - text_a=plays like a bad blend of an overripe episode of tv's dawson's creek and a recycled and dumbed-down version of love story .
2021-04-16 10:09:31,174 - INFO - cli - text_b=None
2021-04-16 10:09:31,175 - INFO - cli - task=mr
2021-04-16 10:09:31,175 - INFO - cli - label=0
2021-04-16 10:09:31,175 - INFO - cli - **********************************
2021-04-16 10:10:27,390 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 10:11:51,395 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:12:21,102 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:12:23,258 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:12:23,258 - INFO - transprompt_wrapper - best_dev_acc: 0.8958 | best_global_step: 64
2021-04-16 10:12:23,259 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:12:33,678 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g2/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=3600, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output/g2-full', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=36000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-16 10:12:33,679 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=train)
2021-04-16 10:12:43,387 - INFO - task_processors - Returning 753653 train examples with label dist.: [('entailment', 251451), ('neutral', 250931), ('contradiction', 251271)]
2021-04-16 10:12:43,387 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=dev)
2021-04-16 10:12:45,858 - INFO - task_processors - Returning 188416 dev examples with label dist.: [('entailment', 62864), ('neutral', 62733), ('contradiction', 62819)]
2021-04-16 10:12:45,858 - INFO - cli - ************Training Example:**************
2021-04-16 10:12:45,858 - INFO - cli - text_a=We seem to believe that all human action is motivated not by the desire to know or improve the lot of humankind, but only by the basest motives of greed, power, and self-aggrandizement.
2021-04-16 10:12:45,858 - INFO - cli - text_b=Human action is believed to be motivated solely on greed and power.
2021-04-16 10:12:45,858 - INFO - cli - task=MNLI
2021-04-16 10:12:45,858 - INFO - cli - label=entailment
2021-04-16 10:12:45,858 - INFO - cli - **********************************
2021-04-16 10:13:10,501 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:13:12,592 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:13:12,592 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 128
2021-04-16 10:13:12,592 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:13:42,072 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 10:14:00,118 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:14:02,211 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:14:02,211 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 192
2021-04-16 10:14:02,211 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:14:50,265 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:14:52,579 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:14:52,579 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 256
2021-04-16 10:14:52,579 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:14:54,429 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:15:40,097 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:15:42,213 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:15:42,213 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 320
2021-04-16 10:15:42,213 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:16:29,347 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:16:31,413 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:16:31,413 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 384
2021-04-16 10:16:31,413 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:17:18,969 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:17:21,081 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:17:21,082 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 448
2021-04-16 10:17:21,082 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:18:09,067 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:18:11,208 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:18:11,208 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 512
2021-04-16 10:18:11,208 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:18:57,944 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:19:00,054 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:19:00,054 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 576
2021-04-16 10:19:00,054 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:19:47,679 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:19:49,790 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:19:49,791 - INFO - transprompt_wrapper - best_dev_acc: 0.9479 | best_global_step: 640
2021-04-16 10:19:49,791 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:20:37,217 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:20:39,331 - INFO - transprompt_wrapper - Saving trained model at output/g1-few/p1-i1...
2021-04-16 10:20:39,331 - INFO - transprompt_wrapper - best_dev_acc: 0.9479 | best_global_step: 704
2021-04-16 10:20:39,331 - INFO - transprompt_wrapper - Saving models.
2021-04-16 10:21:27,362 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:21:29,521 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-16 10:21:29,521 - INFO - transprompt_wrapper - 2
2021-04-16 10:21:59,314 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:22:01,444 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-16 10:22:01,444 - INFO - transprompt_wrapper - 3
2021-04-16 10:22:31,287 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:22:31,610 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g2/167000-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=3600, eval_examples=-1, eval_set='dev', k=167000, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output/g2-full', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=192, pet_max_steps=36000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=32, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-16 10:22:31,610 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=train)
2021-04-16 10:22:33,414 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-16 10:22:33,414 - INFO - transprompt_wrapper - 4
2021-04-16 10:22:41,235 - INFO - task_processors - Returning 753653 train examples with label dist.: [('entailment', 251451), ('neutral', 250931), ('contradiction', 251271)]
2021-04-16 10:22:41,236 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/167000-42 (num_examples=-1, set_type=dev)
2021-04-16 10:22:43,669 - INFO - task_processors - Returning 188416 dev examples with label dist.: [('entailment', 62864), ('neutral', 62733), ('contradiction', 62819)]
2021-04-16 10:22:43,669 - INFO - cli - ************Training Example:**************
2021-04-16 10:22:43,669 - INFO - cli - text_a=We seem to believe that all human action is motivated not by the desire to know or improve the lot of humankind, but only by the basest motives of greed, power, and self-aggrandizement.
2021-04-16 10:22:43,669 - INFO - cli - text_b=Human action is believed to be motivated solely on greed and power.
2021-04-16 10:22:43,669 - INFO - cli - task=MNLI
2021-04-16 10:22:43,669 - INFO - cli - label=entailment
2021-04-16 10:22:43,669 - INFO - cli - **********************************
2021-04-16 10:23:03,277 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:23:05,444 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-16 10:23:05,444 - INFO - transprompt_wrapper - 5
2021-04-16 10:23:39,885 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-16 10:24:49,590 - INFO - transprompt_wrapper - Writing example 0
2021-04-16 10:25:00,278 - INFO - wrapper - Writing example 0
2021-04-16 10:25:02,311 - INFO - modeling - Saving complete
2021-04-16 10:25:02,311 - INFO - modeling - Starting evaluation...
2021-04-16 10:26:38,859 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-16 10:26:38,867 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-16 10:26:38,867 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-16 10:26:38,867 - INFO - modeling - ************Test Example:**************
2021-04-16 10:26:38,867 - INFO - modeling - text_a=the movie 's relatively simple plot and uncomplicated morality play well with the affable cast .
2021-04-16 10:26:38,867 - INFO - modeling - text_b=None
2021-04-16 10:26:38,867 - INFO - modeling - task=SST-2
2021-04-16 10:26:38,867 - INFO - modeling - label=1
2021-04-16 10:26:38,867 - INFO - modeling - **********************************
2021-04-16 10:26:38,867 - INFO - wrapper - Writing example 0
2021-04-16 10:26:56,993 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-16 10:26:56,994 - INFO - modeling - eval_results:
2021-04-16 10:26:56,994 - INFO - modeling - {'acc': 0.9220183486238532}
2021-04-16 10:26:56,994 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-16 10:26:57,018 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-16 10:26:57,019 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-16 10:26:57,019 - INFO - modeling - ************Test Example:**************
2021-04-16 10:26:57,019 - INFO - modeling - text_a=you wouldn't call the good girl a date movie ( an anti-date movie is more like it ) , but when it's good , it's good and horrid .
2021-04-16 10:26:57,019 - INFO - modeling - text_b=None
2021-04-16 10:26:57,019 - INFO - modeling - task=mr
2021-04-16 10:26:57,019 - INFO - modeling - label=1
2021-04-16 10:26:57,019 - INFO - modeling - **********************************
2021-04-16 10:26:57,019 - INFO - wrapper - Writing example 0
2021-04-16 10:27:39,567 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=mr) ---
2021-04-16 10:27:39,567 - INFO - modeling - eval_results:
2021-04-16 10:27:39,567 - INFO - modeling - {'acc': 0.859}
2021-04-16 10:27:39,567 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-16 10:27:39,596 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-16 10:27:39,599 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-16 10:27:39,599 - INFO - modeling - ************Test Example:**************
2021-04-16 10:27:39,599 - INFO - modeling - text_a=the music plays awesome , never skips , even if u run for a bit , so you can listen to music without interruption .
2021-04-16 10:27:39,599 - INFO - modeling - text_b=None
2021-04-16 10:27:39,599 - INFO - modeling - task=cr
2021-04-16 10:27:39,599 - INFO - modeling - label=1
2021-04-16 10:27:39,599 - INFO - modeling - **********************************
2021-04-16 10:27:39,599 - INFO - wrapper - Writing example 0
2021-04-16 10:28:22,254 - INFO - modeling - --- RESULT (pattern_id=1, Group=g1, Task=cr) ---
2021-04-16 10:28:22,254 - INFO - modeling - eval_results:
2021-04-16 10:28:22,254 - INFO - modeling - {'acc': 0.9165}
2021-04-21 03:04:55,494 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-single/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 03:04:55,494 - INFO - task_processors - Creating features from dataset file at data/k-shot-single/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 03:05:21,502 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 03:05:21,502 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 03:05:21,554 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:05:21,554 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 03:05:21,560 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:05:21,560 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 03:05:21,560 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 03:05:21,560 - INFO - run_task_adaptation - text_b=None
2021-04-21 03:05:21,560 - INFO - run_task_adaptation - task=SST-2
2021-04-21 03:05:21,561 - INFO - run_task_adaptation - label=0
2021-04-21 03:05:21,561 - INFO - run_task_adaptation - **********************************
2021-04-21 03:05:32,609 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 03:06:36,295 - INFO - cli - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=64, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output/g1-few', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=256, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=64, weight_decay=0.1)
2021-04-21 03:06:36,295 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 03:06:36,298 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:06:36,298 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 03:06:36,300 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:06:36,300 - INFO - cli - ************Training Example:**************
2021-04-21 03:06:36,300 - INFO - cli - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 03:06:36,301 - INFO - cli - text_b=None
2021-04-21 03:06:36,301 - INFO - cli - task=SST-2
2021-04-21 03:06:36,301 - INFO - cli - label=0
2021-04-21 03:06:36,301 - INFO - cli - **********************************
2021-04-21 03:06:38,452 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 03:09:34,699 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:10:04,965 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:10:07,152 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/g1-few/p1-i1...
2021-04-21 03:10:07,153 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 64
2021-04-21 03:10:07,153 - INFO - transprompt_wrapper - Saving models.
2021-04-21 03:10:45,271 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 03:10:45,271 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 03:10:45,275 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:10:45,275 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 03:10:45,277 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:10:45,277 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 03:10:45,277 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 03:10:45,277 - INFO - run_task_adaptation - text_b=None
2021-04-21 03:10:45,277 - INFO - run_task_adaptation - task=SST-2
2021-04-21 03:10:45,277 - INFO - run_task_adaptation - label=0
2021-04-21 03:10:45,277 - INFO - run_task_adaptation - **********************************
2021-04-21 03:10:47,302 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 03:11:14,491 - INFO - modeling - Starting Fine-tuning Multi-Task Meta-Learner ...
2021-04-21 03:11:14,491 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:11:44,633 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:11:45,919 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 03:11:45,920 - INFO - transprompt_wrapper - best_dev_acc: 0.8646 | best_global_step: 100
2021-04-21 03:11:45,920 - INFO - transprompt_wrapper - Saving models.
2021-04-21 03:28:51,448 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 03:28:51,448 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 03:28:51,452 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:28:51,452 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 03:28:51,453 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:28:51,454 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 03:28:51,454 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 03:28:51,454 - INFO - run_task_adaptation - text_b=None
2021-04-21 03:28:51,454 - INFO - run_task_adaptation - task=SST-2
2021-04-21 03:28:51,454 - INFO - run_task_adaptation - label=0
2021-04-21 03:28:51,454 - INFO - run_task_adaptation - **********************************
2021-04-21 03:28:53,311 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 03:29:20,441 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 03:29:20,441 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:29:49,660 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:29:50,932 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 03:29:50,932 - INFO - transprompt_wrapper - best_dev_acc: 0.8646 | best_global_step: 100
2021-04-21 03:29:50,932 - INFO - transprompt_wrapper - Saving models.
2021-04-21 03:30:39,753 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:30:40,954 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 03:30:40,954 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-21 03:30:40,954 - INFO - transprompt_wrapper - Saving models.
2021-04-21 03:31:30,638 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:31:31,883 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 03:31:31,883 - INFO - transprompt_wrapper - best_dev_acc: 0.8854 | best_global_step: 300
2021-04-21 03:31:31,883 - INFO - transprompt_wrapper - Saving models.
2021-04-21 03:32:21,597 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:32:22,834 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 03:32:22,835 - INFO - transprompt_wrapper - best_dev_acc: 0.8854 | best_global_step: 400
2021-04-21 03:32:22,835 - INFO - transprompt_wrapper - Saving models.
2021-04-21 03:33:12,476 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:33:13,719 - INFO - transprompt_wrapper - {'acc': 0.875}
2021-04-21 03:33:13,719 - INFO - transprompt_wrapper - 2
2021-04-21 03:33:42,409 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:33:43,635 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-21 03:33:43,635 - INFO - transprompt_wrapper - 3
2021-04-21 03:34:12,160 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:34:13,378 - INFO - transprompt_wrapper - {'acc': 0.875}
2021-04-21 03:34:13,379 - INFO - transprompt_wrapper - 4
2021-04-21 03:34:41,853 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:34:43,142 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 03:34:43,143 - INFO - transprompt_wrapper - 5
2021-04-21 03:35:11,356 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:35:12,563 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 03:35:12,563 - INFO - transprompt_wrapper - 6
2021-04-21 03:35:40,655 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 03:35:41,854 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 03:35:41,854 - INFO - transprompt_wrapper - 7
2021-04-21 03:35:42,130 - INFO - modeling - Saving complete
2021-04-21 03:35:42,131 - INFO - modeling - ========= Finish Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 03:35:42,131 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 03:36:23,329 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 03:39:04,241 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_seq_length=128, pet_max_steps=1000, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=6, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 03:39:04,242 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 03:39:04,245 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:39:04,245 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 03:39:04,247 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:39:04,247 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 03:39:04,247 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 03:39:04,247 - INFO - run_task_adaptation - text_b=None
2021-04-21 03:39:04,247 - INFO - run_task_adaptation - task=SST-2
2021-04-21 03:39:04,247 - INFO - run_task_adaptation - label=0
2021-04-21 03:39:04,247 - INFO - run_task_adaptation - **********************************
2021-04-21 03:39:06,092 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 03:39:36,975 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 03:40:22,747 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 03:40:22,748 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 03:40:22,748 - INFO - modeling - ========= Stage2.0: Specific fine-tuning on Task sst-2 =========
2021-04-21 03:40:22,748 - INFO - wrapper - Writing example 0
2021-04-21 03:59:30,865 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=80, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=256, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=80, weight_decay=0.1)
2021-04-21 03:59:30,865 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 03:59:30,868 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:59:30,868 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 03:59:30,870 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 03:59:30,870 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 03:59:30,870 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 03:59:30,870 - INFO - run_task_adaptation - text_b=None
2021-04-21 03:59:30,870 - INFO - run_task_adaptation - task=SST-2
2021-04-21 03:59:30,870 - INFO - run_task_adaptation - label=0
2021-04-21 03:59:30,870 - INFO - run_task_adaptation - **********************************
2021-04-21 03:59:32,680 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 04:00:02,620 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 04:00:46,545 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 04:00:46,546 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 04:00:46,546 - INFO - modeling - ========= Stage2.0: Specific fine-tuning on Task sst-2 =========
2021-04-21 04:00:46,546 - INFO - wrapper - Writing example 0
2021-04-21 04:01:11,236 - INFO - wrapper - Writing example 0
2021-04-21 04:01:11,729 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 04:01:11,729 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-21 04:01:11,729 - INFO - wrapper - Saving models.
2021-04-21 04:01:42,413 - INFO - wrapper - Writing example 0
2021-04-21 04:01:42,877 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 04:01:42,877 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 04:01:42,877 - INFO - wrapper - Saving models.
2021-04-21 04:02:58,814 - INFO - modeling - ========= Stage2.0: Evaluating test set on Task sst-2
2021-04-21 04:02:58,814 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 04:02:58,826 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 04:02:58,826 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 04:02:58,826 - INFO - wrapper - Writing example 0
2021-04-21 04:03:11,086 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 04:03:11,086 - INFO - modeling - eval_results: {'acc': 0.9151376146788991}
2021-04-21 04:03:11,088 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mr =========
2021-04-21 04:03:11,088 - INFO - wrapper - Writing example 0
2021-04-21 04:03:35,687 - INFO - wrapper - Writing example 0
2021-04-21 04:03:36,137 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 04:03:36,137 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-21 04:03:36,137 - INFO - wrapper - Saving models.
2021-04-21 04:04:06,643 - INFO - wrapper - Writing example 0
2021-04-21 04:04:07,107 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 04:04:07,107 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 04:04:07,107 - INFO - wrapper - Saving models.
2021-04-21 04:05:23,011 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mr
2021-04-21 04:05:23,011 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-21 04:05:23,026 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 04:05:23,027 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 04:05:23,028 - INFO - wrapper - Writing example 0
2021-04-21 04:05:51,395 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 04:05:51,395 - INFO - modeling - eval_results: {'acc': 0.8745}
2021-04-21 04:05:51,397 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task cr =========
2021-04-21 04:05:51,397 - INFO - wrapper - Writing example 0
2021-04-21 04:06:16,466 - INFO - wrapper - Writing example 0
2021-04-21 04:06:16,960 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 04:06:16,961 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-21 04:06:16,961 - INFO - wrapper - Saving models.
2021-04-21 04:06:48,376 - INFO - wrapper - Writing example 0
2021-04-21 04:06:48,891 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 04:06:48,892 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 04:06:48,892 - INFO - wrapper - Saving models.
2021-04-21 04:08:10,562 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task cr
2021-04-21 04:08:10,568 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-21 04:08:10,587 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 04:08:10,590 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 04:08:10,590 - INFO - wrapper - Writing example 0
2021-04-21 04:08:38,499 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 04:08:38,500 - INFO - modeling - eval_results: {'acc': 0.921}
2021-04-21 04:11:01,250 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=80, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=256, pet_max_meta_steps=640, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=80, weight_decay=0.1)
2021-04-21 04:11:01,250 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 04:11:01,253 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 04:11:01,253 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 04:11:01,255 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 04:11:01,255 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 04:11:01,255 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 04:11:01,255 - INFO - run_task_adaptation - text_b=None
2021-04-21 04:11:01,255 - INFO - run_task_adaptation - task=SST-2
2021-04-21 04:11:01,255 - INFO - run_task_adaptation - label=0
2021-04-21 04:11:01,256 - INFO - run_task_adaptation - **********************************
2021-04-21 04:11:03,062 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 04:11:33,692 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 04:11:33,692 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:11:59,857 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:12:01,498 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 04:12:01,498 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 80
2021-04-21 04:12:01,498 - INFO - transprompt_wrapper - Saving models.
2021-04-21 04:12:46,129 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:12:47,583 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 04:12:47,584 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 160
2021-04-21 04:12:47,584 - INFO - transprompt_wrapper - Saving models.
2021-04-21 04:13:32,413 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:13:33,883 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 04:13:33,883 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 240
2021-04-21 04:13:33,883 - INFO - transprompt_wrapper - Saving models.
2021-04-21 04:14:18,731 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:14:20,187 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 04:14:20,187 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 320
2021-04-21 04:14:20,187 - INFO - transprompt_wrapper - Saving models.
2021-04-21 04:15:04,298 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:15:05,729 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-21 04:15:05,729 - INFO - transprompt_wrapper - 1
2021-04-21 04:15:29,287 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:15:30,762 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-21 04:15:30,763 - INFO - transprompt_wrapper - 2
2021-04-21 04:15:54,452 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:15:55,929 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-21 04:15:55,929 - INFO - transprompt_wrapper - 3
2021-04-21 04:16:19,626 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:16:21,090 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-21 04:16:21,091 - INFO - transprompt_wrapper - 4
2021-04-21 04:16:21,378 - INFO - modeling - Saving complete
2021-04-21 04:16:21,378 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 04:16:21,378 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 04:17:05,378 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 04:17:05,378 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 04:17:05,378 - INFO - modeling - ========= Stage2.0: Specific fine-tuning on Task sst-2 =========
2021-04-21 04:17:05,378 - INFO - wrapper - Writing example 0
2021-04-21 04:17:23,197 - INFO - wrapper - Writing example 0
2021-04-21 04:17:23,799 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 04:17:23,799 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 80
2021-04-21 04:17:23,800 - INFO - wrapper - Saving models.
2021-04-21 04:17:55,000 - INFO - wrapper - Writing example 0
2021-04-21 04:17:55,501 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 04:17:55,501 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 160
2021-04-21 04:17:55,501 - INFO - wrapper - Saving models.
2021-04-21 04:18:26,013 - INFO - wrapper - Writing example 0
2021-04-21 04:18:26,521 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 04:18:26,521 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 04:18:26,521 - INFO - wrapper - Saving models.
2021-04-21 04:19:34,645 - INFO - modeling - ========= Stage2.0: Evaluating test set on Task sst-2
2021-04-21 04:19:34,645 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 04:19:34,820 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 04:19:34,820 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 04:19:34,820 - INFO - wrapper - Writing example 0
2021-04-21 04:19:47,013 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 04:19:47,013 - INFO - modeling - eval_results: {'acc': 0.908256880733945}
2021-04-21 04:19:47,015 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mr =========
2021-04-21 04:19:47,015 - INFO - wrapper - Writing example 0
2021-04-21 04:20:02,445 - INFO - wrapper - Writing example 0
2021-04-21 04:20:02,961 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 04:20:02,961 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 80
2021-04-21 04:20:02,961 - INFO - wrapper - Saving models.
2021-04-21 04:20:33,118 - INFO - wrapper - Writing example 0
2021-04-21 04:20:33,644 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 04:20:33,644 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 160
2021-04-21 04:20:33,644 - INFO - wrapper - Saving models.
2021-04-21 04:21:01,793 - INFO - wrapper - Writing example 0
2021-04-21 04:21:02,236 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 04:21:02,236 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 04:21:02,236 - INFO - wrapper - Saving models.
2021-04-21 04:22:10,976 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mr
2021-04-21 04:22:10,977 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-21 04:22:11,165 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 04:22:11,167 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 04:22:11,167 - INFO - wrapper - Writing example 0
2021-04-21 04:22:39,443 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 04:22:39,443 - INFO - modeling - eval_results: {'acc': 0.827}
2021-04-21 04:22:39,445 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task cr =========
2021-04-21 04:22:39,445 - INFO - wrapper - Writing example 0
2021-04-21 04:22:51,086 - INFO - wrapper - Writing example 0
2021-04-21 04:22:51,536 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 04:22:51,537 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 80
2021-04-21 04:22:51,537 - INFO - wrapper - Saving models.
2021-04-21 04:23:21,692 - INFO - wrapper - Writing example 0
2021-04-21 04:23:22,190 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 04:23:22,190 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 160
2021-04-21 04:23:22,190 - INFO - wrapper - Saving models.
2021-04-21 04:23:52,811 - INFO - wrapper - Writing example 0
2021-04-21 04:23:53,339 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 04:23:53,340 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 04:23:53,340 - INFO - wrapper - Saving models.
2021-04-21 04:24:59,116 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task cr
2021-04-21 04:24:59,116 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-21 04:24:59,131 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 04:24:59,133 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 04:24:59,133 - INFO - wrapper - Writing example 0
2021-04-21 04:25:28,452 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 04:25:28,453 - INFO - modeling - eval_results: {'acc': 0.9065}
2021-04-21 04:36:53,324 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=80, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=256, pet_max_meta_steps=640, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=80, weight_decay=0.1)
2021-04-21 04:36:53,324 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 04:36:53,328 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 04:36:53,328 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 04:36:53,330 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 04:36:53,331 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 04:36:53,331 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 04:36:53,331 - INFO - run_task_adaptation - text_b=None
2021-04-21 04:36:53,331 - INFO - run_task_adaptation - task=SST-2
2021-04-21 04:36:53,331 - INFO - run_task_adaptation - label=0
2021-04-21 04:36:53,331 - INFO - run_task_adaptation - **********************************
2021-04-21 04:36:55,407 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 04:37:26,070 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 04:37:26,071 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:51:46,790 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=512, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 04:51:46,791 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 04:51:46,794 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 04:51:46,794 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 04:51:46,796 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 04:51:46,796 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 04:51:46,796 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 04:51:46,796 - INFO - run_task_adaptation - text_b=None
2021-04-21 04:51:46,796 - INFO - run_task_adaptation - task=SST-2
2021-04-21 04:51:46,796 - INFO - run_task_adaptation - label=0
2021-04-21 04:51:46,796 - INFO - run_task_adaptation - **********************************
2021-04-21 04:51:48,810 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 04:52:20,397 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 04:52:20,397 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:52:51,480 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:52:52,988 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 04:52:52,988 - INFO - transprompt_wrapper - best_dev_acc: 0.8646 | best_global_step: 100
2021-04-21 04:52:52,988 - INFO - transprompt_wrapper - Saving models.
2021-04-21 04:53:42,495 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:53:43,967 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 04:53:43,967 - INFO - transprompt_wrapper - 1
2021-04-21 04:54:13,606 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:54:15,071 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 04:54:15,071 - INFO - transprompt_wrapper - 2
2021-04-21 04:54:44,889 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:54:46,505 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 04:54:46,505 - INFO - transprompt_wrapper - 3
2021-04-21 04:55:17,014 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:55:18,677 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 04:55:18,677 - INFO - transprompt_wrapper - 4
2021-04-21 04:55:48,596 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:55:50,065 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 04:55:50,065 - INFO - transprompt_wrapper - 5
2021-04-21 04:56:19,691 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:56:21,175 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 04:56:21,175 - INFO - transprompt_wrapper - 6
2021-04-21 04:56:50,937 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:56:52,443 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 04:56:52,443 - INFO - transprompt_wrapper - 7
2021-04-21 04:57:22,125 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:57:23,604 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 04:57:23,605 - INFO - transprompt_wrapper - 8
2021-04-21 04:57:53,260 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 04:57:54,726 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 04:57:54,726 - INFO - transprompt_wrapper - 9
2021-04-21 04:57:55,013 - INFO - modeling - Saving complete
2021-04-21 04:57:55,013 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 04:57:55,013 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 04:58:42,119 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 04:58:42,120 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 04:58:42,120 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 04:58:42,120 - INFO - wrapper - Writing example 0
2021-04-21 04:59:00,337 - INFO - wrapper - Writing example 0
2021-04-21 04:59:00,864 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 04:59:00,864 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-21 04:59:00,864 - INFO - wrapper - Saving models.
2021-04-21 04:59:34,274 - INFO - wrapper - Writing example 0
2021-04-21 04:59:34,795 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 04:59:34,795 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 04:59:34,795 - INFO - wrapper - Saving models.
2021-04-21 05:00:09,439 - INFO - wrapper - Writing example 0
2021-04-21 05:00:09,953 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:00:09,953 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-21 05:00:09,953 - INFO - wrapper - Saving models.
2021-04-21 05:00:44,768 - INFO - wrapper - Writing example 0
2021-04-21 05:00:45,291 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:00:45,291 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-21 05:00:45,291 - INFO - wrapper - Saving models.
2021-04-21 05:01:19,382 - INFO - wrapper - Writing example 0
2021-04-21 05:01:19,876 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:01:19,876 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-21 05:01:19,876 - INFO - wrapper - Saving models.
2021-04-21 05:02:25,821 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 05:02:25,822 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 05:02:25,832 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 05:02:25,832 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 05:02:25,832 - INFO - wrapper - Writing example 0
2021-04-21 05:02:38,095 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 05:02:38,095 - INFO - modeling - eval_results: {'acc': 0.9243119266055045}
2021-04-21 05:02:38,100 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 05:02:38,100 - INFO - wrapper - Writing example 0
2021-04-21 05:02:56,858 - INFO - wrapper - Writing example 0
2021-04-21 05:02:57,368 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:02:57,368 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 100
2021-04-21 05:02:57,368 - INFO - wrapper - Saving models.
2021-04-21 05:03:31,621 - INFO - wrapper - Writing example 0
2021-04-21 05:03:32,071 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:03:32,071 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 05:03:32,071 - INFO - wrapper - Saving models.
2021-04-21 05:04:05,792 - INFO - wrapper - Writing example 0
2021-04-21 05:04:06,310 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:04:06,310 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-21 05:04:06,310 - INFO - wrapper - Saving models.
2021-04-21 05:04:40,445 - INFO - wrapper - Writing example 0
2021-04-21 05:04:40,962 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:04:40,962 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-21 05:04:40,962 - INFO - wrapper - Saving models.
2021-04-21 05:05:16,233 - INFO - wrapper - Writing example 0
2021-04-21 05:05:16,730 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:05:16,730 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-21 05:05:16,730 - INFO - wrapper - Saving models.
2021-04-21 05:06:25,559 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 05:06:25,560 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-21 05:06:25,682 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 05:06:25,683 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 05:06:25,684 - INFO - wrapper - Writing example 0
2021-04-21 05:06:53,031 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 05:06:53,031 - INFO - modeling - eval_results: {'acc': 0.863}
2021-04-21 05:06:53,033 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 05:06:53,033 - INFO - wrapper - Writing example 0
2021-04-21 05:07:13,005 - INFO - wrapper - Writing example 0
2021-04-21 05:07:13,519 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:07:13,519 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-21 05:07:13,519 - INFO - wrapper - Saving models.
2021-04-21 05:07:47,796 - INFO - wrapper - Writing example 0
2021-04-21 05:07:48,310 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:07:48,310 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 05:07:48,310 - INFO - wrapper - Saving models.
2021-04-21 05:08:22,976 - INFO - wrapper - Writing example 0
2021-04-21 05:08:23,486 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:08:23,486 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-21 05:08:23,487 - INFO - wrapper - Saving models.
2021-04-21 05:08:58,185 - INFO - wrapper - Writing example 0
2021-04-21 05:08:58,691 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:08:58,691 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-21 05:08:58,691 - INFO - wrapper - Saving models.
2021-04-21 05:09:31,834 - INFO - wrapper - Writing example 0
2021-04-21 05:09:32,360 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:09:32,360 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-21 05:09:32,360 - INFO - wrapper - Saving models.
2021-04-21 05:10:41,682 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 05:10:41,682 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-21 05:10:41,698 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 05:10:41,700 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 05:10:41,700 - INFO - wrapper - Writing example 0
2021-04-21 05:11:08,880 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 05:11:08,881 - INFO - modeling - eval_results: {'acc': 0.891}
2021-04-21 05:23:28,726 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=512, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 05:23:28,727 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 05:23:28,730 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 05:23:28,730 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 05:23:28,732 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 05:23:28,732 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 05:23:28,732 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 05:23:28,732 - INFO - run_task_adaptation - text_b=None
2021-04-21 05:23:28,732 - INFO - run_task_adaptation - task=SST-2
2021-04-21 05:23:28,732 - INFO - run_task_adaptation - label=0
2021-04-21 05:23:28,733 - INFO - run_task_adaptation - **********************************
2021-04-21 05:23:30,815 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 05:24:01,370 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 05:24:01,371 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:24:31,732 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:24:33,255 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:24:33,255 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 100
2021-04-21 05:24:33,255 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:25:23,431 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:25:25,095 - INFO - transprompt_wrapper - {'acc': 0.8333333333333334}
2021-04-21 05:25:25,095 - INFO - transprompt_wrapper - 1
2021-04-21 05:25:57,023 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:25:58,657 - INFO - transprompt_wrapper - {'acc': 0.8333333333333334}
2021-04-21 05:25:58,657 - INFO - transprompt_wrapper - 2
2021-04-21 05:26:28,212 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:26:29,707 - INFO - transprompt_wrapper - {'acc': 0.8229166666666666}
2021-04-21 05:26:29,707 - INFO - transprompt_wrapper - 3
2021-04-21 05:26:59,201 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:27:00,672 - INFO - transprompt_wrapper - {'acc': 0.8333333333333334}
2021-04-21 05:27:00,672 - INFO - transprompt_wrapper - 4
2021-04-21 05:27:30,253 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:27:31,723 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:27:31,723 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 600
2021-04-21 05:27:31,723 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:28:22,185 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:28:23,671 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:28:23,671 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 700
2021-04-21 05:28:23,671 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:29:14,780 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:29:16,275 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:29:16,275 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 800
2021-04-21 05:29:16,275 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:30:08,794 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:30:10,489 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:30:10,489 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 900
2021-04-21 05:30:10,493 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:31:01,999 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:31:03,521 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:31:03,522 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 1000
2021-04-21 05:31:03,522 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:31:25,259 - INFO - modeling - Saving complete
2021-04-21 05:31:25,259 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 05:31:25,259 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 05:32:10,041 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 05:32:10,042 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 05:32:10,042 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 05:32:10,042 - INFO - wrapper - Writing example 0
2021-04-21 05:32:30,016 - INFO - wrapper - Writing example 0
2021-04-21 05:32:30,525 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:32:30,526 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-21 05:32:30,526 - INFO - wrapper - Saving models.
2021-04-21 05:33:07,635 - INFO - wrapper - Writing example 0
2021-04-21 05:33:08,209 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:33:08,209 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 05:33:08,209 - INFO - wrapper - Saving models.
2021-04-21 05:33:41,080 - INFO - wrapper - Writing example 0
2021-04-21 05:33:41,545 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:33:41,545 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-21 05:33:41,545 - INFO - wrapper - Saving models.
2021-04-21 05:34:15,691 - INFO - wrapper - Writing example 0
2021-04-21 05:34:16,222 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:34:16,222 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-21 05:34:16,222 - INFO - wrapper - Saving models.
2021-04-21 05:34:52,055 - INFO - wrapper - Writing example 0
2021-04-21 05:34:52,629 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:34:52,629 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-21 05:34:52,629 - INFO - wrapper - Saving models.
2021-04-21 05:36:00,948 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 05:36:00,948 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 05:36:00,960 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 05:36:00,960 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 05:36:00,960 - INFO - wrapper - Writing example 0
2021-04-21 05:36:12,944 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 05:36:12,944 - INFO - modeling - eval_results: {'acc': 0.9128440366972477}
2021-04-21 05:36:12,946 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 05:36:12,946 - INFO - wrapper - Writing example 0
2021-04-21 05:36:32,735 - INFO - wrapper - Writing example 0
2021-04-21 05:36:33,273 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:36:33,273 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-21 05:36:33,273 - INFO - wrapper - Saving models.
2021-04-21 05:37:09,585 - INFO - wrapper - Writing example 0
2021-04-21 05:37:10,112 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:37:10,112 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 05:37:10,112 - INFO - wrapper - Saving models.
2021-04-21 05:37:44,766 - INFO - wrapper - Writing example 0
2021-04-21 05:37:45,304 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:37:45,304 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-21 05:37:45,304 - INFO - wrapper - Saving models.
2021-04-21 05:38:21,620 - INFO - wrapper - Writing example 0
2021-04-21 05:38:22,139 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:38:22,139 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-21 05:38:22,140 - INFO - wrapper - Saving models.
2021-04-21 05:38:57,723 - INFO - wrapper - Writing example 0
2021-04-21 05:38:58,265 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:38:58,265 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-21 05:38:58,265 - INFO - wrapper - Saving models.
2021-04-21 05:40:05,340 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 05:40:05,341 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-21 05:40:05,359 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 05:40:05,360 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 05:40:05,360 - INFO - wrapper - Writing example 0
2021-04-21 05:40:33,461 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 05:40:33,461 - INFO - modeling - eval_results: {'acc': 0.8665}
2021-04-21 05:40:33,463 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 05:40:33,464 - INFO - wrapper - Writing example 0
2021-04-21 05:40:48,213 - INFO - wrapper - Writing example 0
2021-04-21 05:40:48,655 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:40:48,655 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-21 05:40:48,655 - INFO - wrapper - Saving models.
2021-04-21 05:41:22,949 - INFO - wrapper - Writing example 0
2021-04-21 05:41:23,445 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:41:23,445 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-21 05:41:23,445 - INFO - wrapper - Saving models.
2021-04-21 05:41:56,551 - INFO - wrapper - Writing example 0
2021-04-21 05:41:57,001 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:41:57,001 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-21 05:41:57,001 - INFO - wrapper - Saving models.
2021-04-21 05:42:32,020 - INFO - wrapper - Writing example 0
2021-04-21 05:42:32,563 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:42:32,563 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-21 05:42:32,563 - INFO - wrapper - Saving models.
2021-04-21 05:43:06,811 - INFO - wrapper - Writing example 0
2021-04-21 05:43:07,278 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:43:07,278 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-21 05:43:07,278 - INFO - wrapper - Saving models.
2021-04-21 05:44:11,816 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 05:44:11,817 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-21 05:44:11,831 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 05:44:11,833 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 05:44:11,833 - INFO - wrapper - Writing example 0
2021-04-21 05:44:39,042 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 05:44:39,042 - INFO - modeling - eval_results: {'acc': 0.9125}
2021-04-21 05:47:41,533 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=24, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=256, pet_max_meta_steps=120, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=8, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=24, weight_decay=0.1)
2021-04-21 05:47:41,533 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 05:47:41,537 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 05:47:41,537 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 05:47:41,539 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 05:47:41,539 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 05:47:41,539 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 05:47:41,539 - INFO - run_task_adaptation - text_b=None
2021-04-21 05:47:41,539 - INFO - run_task_adaptation - task=SST-2
2021-04-21 05:47:41,539 - INFO - run_task_adaptation - label=0
2021-04-21 05:47:41,539 - INFO - run_task_adaptation - **********************************
2021-04-21 05:47:43,676 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 05:48:14,742 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 05:48:14,742 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:48:23,865 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:48:25,355 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:48:25,355 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 24
2021-04-21 05:48:25,355 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:48:55,020 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:48:56,517 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:48:56,517 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 48
2021-04-21 05:48:56,517 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:49:26,298 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:49:27,743 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 05:49:27,743 - INFO - transprompt_wrapper - best_dev_acc: 0.8854 | best_global_step: 72
2021-04-21 05:49:27,743 - INFO - transprompt_wrapper - Saving models.
2021-04-21 05:49:57,942 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:49:59,447 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 05:49:59,447 - INFO - transprompt_wrapper - 1
2021-04-21 05:50:08,122 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 05:50:09,582 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 05:50:09,582 - INFO - transprompt_wrapper - 2
2021-04-21 05:50:09,925 - INFO - modeling - Saving complete
2021-04-21 05:50:09,925 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 05:50:09,926 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 05:50:57,501 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 05:50:57,502 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 05:50:57,502 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 05:50:57,502 - INFO - wrapper - Writing example 0
2021-04-21 05:51:02,602 - INFO - wrapper - Writing example 0
2021-04-21 05:51:03,107 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:51:03,108 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 24
2021-04-21 05:51:03,108 - INFO - wrapper - Saving models.
2021-04-21 05:51:22,738 - INFO - wrapper - Writing example 0
2021-04-21 05:51:23,246 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:51:23,246 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 48
2021-04-21 05:51:23,246 - INFO - wrapper - Saving models.
2021-04-21 05:51:43,199 - INFO - wrapper - Writing example 0
2021-04-21 05:51:43,698 - INFO - wrapper - {'acc': 0.9375}
2021-04-21 05:51:43,698 - INFO - wrapper - 2
2021-04-21 05:51:48,777 - INFO - wrapper - Writing example 0
2021-04-21 05:51:49,276 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:51:49,276 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 96
2021-04-21 05:51:49,276 - INFO - wrapper - Saving models.
2021-04-21 05:52:08,645 - INFO - wrapper - Writing example 0
2021-04-21 05:52:09,168 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:52:09,168 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 120
2021-04-21 05:52:09,168 - INFO - wrapper - Saving models.
2021-04-21 05:52:28,556 - INFO - wrapper - Writing example 0
2021-04-21 05:52:29,063 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:52:29,063 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 144
2021-04-21 05:52:29,063 - INFO - wrapper - Saving models.
2021-04-21 05:52:48,629 - INFO - wrapper - Writing example 0
2021-04-21 05:52:49,132 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:52:49,132 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 168
2021-04-21 05:52:49,132 - INFO - wrapper - Saving models.
2021-04-21 05:53:08,022 - INFO - wrapper - Writing example 0
2021-04-21 05:53:08,468 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:53:08,468 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 192
2021-04-21 05:53:08,468 - INFO - wrapper - Saving models.
2021-04-21 05:53:26,796 - INFO - wrapper - Writing example 0
2021-04-21 05:53:27,236 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:53:27,236 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 216
2021-04-21 05:53:27,236 - INFO - wrapper - Saving models.
2021-04-21 05:53:45,129 - INFO - wrapper - Writing example 0
2021-04-21 05:53:45,566 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 05:53:45,566 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 05:53:45,566 - INFO - wrapper - Saving models.
2021-04-21 05:54:52,860 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 05:54:52,860 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 05:54:52,976 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 05:54:52,976 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 05:54:52,976 - INFO - wrapper - Writing example 0
2021-04-21 05:55:05,200 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 05:55:05,201 - INFO - modeling - eval_results: {'acc': 0.9208715596330275}
2021-04-21 05:55:05,203 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 05:55:05,203 - INFO - wrapper - Writing example 0
2021-04-21 05:55:10,122 - INFO - wrapper - Writing example 0
2021-04-21 05:55:10,648 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:55:10,649 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 24
2021-04-21 05:55:10,654 - INFO - wrapper - Saving models.
2021-04-21 05:55:29,887 - INFO - wrapper - Writing example 0
2021-04-21 05:55:30,399 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:55:30,399 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 48
2021-04-21 05:55:30,399 - INFO - wrapper - Saving models.
2021-04-21 05:55:51,259 - INFO - wrapper - Writing example 0
2021-04-21 05:55:51,788 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:55:51,788 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 72
2021-04-21 05:55:51,788 - INFO - wrapper - Saving models.
2021-04-21 05:56:10,666 - INFO - wrapper - Writing example 0
2021-04-21 05:56:11,112 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:56:11,112 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 96
2021-04-21 05:56:11,112 - INFO - wrapper - Saving models.
2021-04-21 05:56:30,985 - INFO - wrapper - Writing example 0
2021-04-21 05:56:31,511 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:56:31,511 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 120
2021-04-21 05:56:31,512 - INFO - wrapper - Saving models.
2021-04-21 05:56:51,156 - INFO - wrapper - Writing example 0
2021-04-21 05:56:51,678 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:56:51,679 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 144
2021-04-21 05:56:51,679 - INFO - wrapper - Saving models.
2021-04-21 05:57:11,344 - INFO - wrapper - Writing example 0
2021-04-21 05:57:11,866 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:57:11,866 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 168
2021-04-21 05:57:11,866 - INFO - wrapper - Saving models.
2021-04-21 05:57:31,720 - INFO - wrapper - Writing example 0
2021-04-21 05:57:32,241 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:57:32,241 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 192
2021-04-21 05:57:32,241 - INFO - wrapper - Saving models.
2021-04-21 05:57:51,327 - INFO - wrapper - Writing example 0
2021-04-21 05:57:51,850 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:57:51,850 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 216
2021-04-21 05:57:51,850 - INFO - wrapper - Saving models.
2021-04-21 05:58:11,168 - INFO - wrapper - Writing example 0
2021-04-21 05:58:11,680 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 05:58:11,681 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 05:58:11,681 - INFO - wrapper - Saving models.
2021-04-21 05:59:18,337 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 05:59:18,337 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-21 05:59:18,354 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 05:59:18,355 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 05:59:18,355 - INFO - wrapper - Writing example 0
2021-04-21 05:59:45,733 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 05:59:45,734 - INFO - modeling - eval_results: {'acc': 0.867}
2021-04-21 05:59:45,735 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 05:59:45,736 - INFO - wrapper - Writing example 0
2021-04-21 05:59:50,454 - INFO - wrapper - Writing example 0
2021-04-21 05:59:50,978 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 05:59:50,979 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 24
2021-04-21 05:59:50,979 - INFO - wrapper - Saving models.
2021-04-21 06:00:11,025 - INFO - wrapper - Writing example 0
2021-04-21 06:00:11,548 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:00:11,548 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 48
2021-04-21 06:00:11,548 - INFO - wrapper - Saving models.
2021-04-21 06:00:31,474 - INFO - wrapper - Writing example 0
2021-04-21 06:00:31,984 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:00:31,984 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 72
2021-04-21 06:00:31,984 - INFO - wrapper - Saving models.
2021-04-21 06:00:51,870 - INFO - wrapper - Writing example 0
2021-04-21 06:00:52,382 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:00:52,382 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 96
2021-04-21 06:00:52,382 - INFO - wrapper - Saving models.
2021-04-21 06:01:12,479 - INFO - wrapper - Writing example 0
2021-04-21 06:01:12,969 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:01:12,969 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 120
2021-04-21 06:01:12,969 - INFO - wrapper - Saving models.
2021-04-21 06:01:33,461 - INFO - wrapper - Writing example 0
2021-04-21 06:01:34,078 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:01:34,078 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 144
2021-04-21 06:01:34,078 - INFO - wrapper - Saving models.
2021-04-21 06:01:54,410 - INFO - wrapper - Writing example 0
2021-04-21 06:01:54,923 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:01:54,924 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 168
2021-04-21 06:01:54,924 - INFO - wrapper - Saving models.
2021-04-21 06:02:13,883 - INFO - wrapper - Writing example 0
2021-04-21 06:02:14,408 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:02:14,408 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 192
2021-04-21 06:02:14,408 - INFO - wrapper - Saving models.
2021-04-21 06:02:34,975 - INFO - wrapper - Writing example 0
2021-04-21 06:02:35,503 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:02:35,504 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 216
2021-04-21 06:02:35,504 - INFO - wrapper - Saving models.
2021-04-21 06:02:55,248 - INFO - wrapper - Writing example 0
2021-04-21 06:02:55,779 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:02:55,779 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 06:02:55,779 - INFO - wrapper - Saving models.
2021-04-21 06:04:06,243 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 06:04:06,244 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-21 06:04:06,260 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 06:04:06,262 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 06:04:06,262 - INFO - wrapper - Writing example 0
2021-04-21 06:04:33,741 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 06:04:33,742 - INFO - modeling - eval_results: {'acc': 0.9155}
2021-04-21 06:20:15,606 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=24, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=256, pet_max_meta_steps=120, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=8, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=24, weight_decay=0.1)
2021-04-21 06:20:15,606 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 06:20:15,610 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 06:20:15,610 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 06:20:15,613 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 06:20:15,613 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 06:20:15,613 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 06:20:15,613 - INFO - run_task_adaptation - text_b=None
2021-04-21 06:20:15,613 - INFO - run_task_adaptation - task=SST-2
2021-04-21 06:20:15,613 - INFO - run_task_adaptation - label=0
2021-04-21 06:20:15,614 - INFO - run_task_adaptation - **********************************
2021-04-21 06:20:21,036 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 06:20:51,564 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 06:20:51,564 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:21:00,674 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:21:02,081 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 06:21:02,081 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 24
2021-04-21 06:21:02,081 - INFO - transprompt_wrapper - Saving models.
2021-04-21 06:21:31,552 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:21:32,979 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 06:21:32,979 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 48
2021-04-21 06:21:32,979 - INFO - transprompt_wrapper - Saving models.
2021-04-21 06:22:02,890 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:22:04,347 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 06:22:04,347 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 72
2021-04-21 06:22:04,348 - INFO - transprompt_wrapper - Saving models.
2021-04-21 06:22:33,625 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:22:34,959 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 06:22:34,959 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 96
2021-04-21 06:22:34,959 - INFO - transprompt_wrapper - Saving models.
2021-04-21 06:23:02,364 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:23:03,789 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 06:23:03,789 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 120
2021-04-21 06:23:03,789 - INFO - transprompt_wrapper - Saving models.
2021-04-21 06:23:25,491 - INFO - modeling - Saving complete
2021-04-21 06:23:25,491 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 06:23:25,491 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 06:24:11,238 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 06:24:11,238 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 06:24:11,238 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 06:24:11,238 - INFO - wrapper - Writing example 0
2021-04-21 06:24:15,579 - INFO - wrapper - Writing example 0
2021-04-21 06:24:16,059 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:24:16,059 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 24
2021-04-21 06:24:16,059 - INFO - wrapper - Saving models.
2021-04-21 06:24:35,366 - INFO - wrapper - Writing example 0
2021-04-21 06:24:35,882 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:24:35,883 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 48
2021-04-21 06:24:35,883 - INFO - wrapper - Saving models.
2021-04-21 06:24:56,724 - INFO - wrapper - Writing example 0
2021-04-21 06:24:57,232 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:24:57,233 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 72
2021-04-21 06:24:57,233 - INFO - wrapper - Saving models.
2021-04-21 06:25:17,432 - INFO - wrapper - Writing example 0
2021-04-21 06:25:17,931 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:25:17,931 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 96
2021-04-21 06:25:17,931 - INFO - wrapper - Saving models.
2021-04-21 06:25:37,773 - INFO - wrapper - Writing example 0
2021-04-21 06:25:38,278 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:25:38,278 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 120
2021-04-21 06:25:38,278 - INFO - wrapper - Saving models.
2021-04-21 06:25:57,966 - INFO - wrapper - Writing example 0
2021-04-21 06:25:58,470 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:25:58,470 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 144
2021-04-21 06:25:58,470 - INFO - wrapper - Saving models.
2021-04-21 06:26:17,784 - INFO - wrapper - Writing example 0
2021-04-21 06:26:18,264 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:26:18,264 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 168
2021-04-21 06:26:18,264 - INFO - wrapper - Saving models.
2021-04-21 06:26:37,447 - INFO - wrapper - Writing example 0
2021-04-21 06:26:37,951 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:26:37,951 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 192
2021-04-21 06:26:37,951 - INFO - wrapper - Saving models.
2021-04-21 06:26:57,404 - INFO - wrapper - Writing example 0
2021-04-21 06:26:57,890 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:26:57,890 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 216
2021-04-21 06:26:57,890 - INFO - wrapper - Saving models.
2021-04-21 06:27:17,028 - INFO - wrapper - Writing example 0
2021-04-21 06:27:17,508 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 06:27:17,508 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 06:27:17,508 - INFO - wrapper - Saving models.
2021-04-21 06:28:31,189 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 06:28:31,189 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 06:28:31,198 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 06:28:31,198 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 06:28:31,198 - INFO - wrapper - Writing example 0
2021-04-21 06:28:43,100 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 06:28:43,100 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-04-21 06:28:43,102 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 06:28:43,102 - INFO - wrapper - Writing example 0
2021-04-21 06:28:47,164 - INFO - wrapper - Writing example 0
2021-04-21 06:28:47,638 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:28:47,638 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 24
2021-04-21 06:28:47,638 - INFO - wrapper - Saving models.
2021-04-21 06:29:07,935 - INFO - wrapper - Writing example 0
2021-04-21 06:29:08,399 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:29:08,399 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 48
2021-04-21 06:29:08,399 - INFO - wrapper - Saving models.
2021-04-21 06:29:27,830 - INFO - wrapper - Writing example 0
2021-04-21 06:29:28,336 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:29:28,336 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 72
2021-04-21 06:29:28,336 - INFO - wrapper - Saving models.
2021-04-21 06:29:47,787 - INFO - wrapper - Writing example 0
2021-04-21 06:29:48,221 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:29:48,221 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 96
2021-04-21 06:29:48,221 - INFO - wrapper - Saving models.
2021-04-21 06:30:06,903 - INFO - wrapper - Writing example 0
2021-04-21 06:30:07,366 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:30:07,366 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 120
2021-04-21 06:30:07,367 - INFO - wrapper - Saving models.
2021-04-21 06:30:26,138 - INFO - wrapper - Writing example 0
2021-04-21 06:30:26,629 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:30:26,629 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 144
2021-04-21 06:30:26,629 - INFO - wrapper - Saving models.
2021-04-21 06:30:46,951 - INFO - wrapper - Writing example 0
2021-04-21 06:30:47,447 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:30:47,447 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 168
2021-04-21 06:30:47,447 - INFO - wrapper - Saving models.
2021-04-21 06:31:06,890 - INFO - wrapper - Writing example 0
2021-04-21 06:31:07,435 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:31:07,435 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 192
2021-04-21 06:31:07,435 - INFO - wrapper - Saving models.
2021-04-21 06:31:27,302 - INFO - wrapper - Writing example 0
2021-04-21 06:31:27,798 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:31:27,798 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 216
2021-04-21 06:31:27,798 - INFO - wrapper - Saving models.
2021-04-21 06:31:46,769 - INFO - wrapper - Writing example 0
2021-04-21 06:31:47,242 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 06:31:47,243 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 06:31:47,243 - INFO - wrapper - Saving models.
2021-04-21 06:32:56,134 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 06:32:56,135 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-21 06:32:56,358 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 06:32:56,359 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 06:32:56,359 - INFO - wrapper - Writing example 0
2021-04-21 06:33:25,239 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 06:33:25,239 - INFO - modeling - eval_results: {'acc': 0.859}
2021-04-21 06:33:25,242 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 06:33:25,243 - INFO - wrapper - Writing example 0
2021-04-21 06:33:29,862 - INFO - wrapper - Writing example 0
2021-04-21 06:33:30,346 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:33:30,346 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 24
2021-04-21 06:33:30,346 - INFO - wrapper - Saving models.
2021-04-21 06:33:50,846 - INFO - wrapper - Writing example 0
2021-04-21 06:33:51,297 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:33:51,297 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 48
2021-04-21 06:33:51,297 - INFO - wrapper - Saving models.
2021-04-21 06:34:11,110 - INFO - wrapper - Writing example 0
2021-04-21 06:34:11,584 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:34:11,584 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 72
2021-04-21 06:34:11,596 - INFO - wrapper - Saving models.
2021-04-21 06:34:31,193 - INFO - wrapper - Writing example 0
2021-04-21 06:34:31,676 - INFO - wrapper - {'acc': 0.96875}
2021-04-21 06:34:31,676 - INFO - wrapper - 3
2021-04-21 06:34:36,238 - INFO - wrapper - Writing example 0
2021-04-21 06:34:36,719 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:34:36,719 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 120
2021-04-21 06:34:36,736 - INFO - wrapper - Saving models.
2021-04-21 06:34:56,470 - INFO - wrapper - Writing example 0
2021-04-21 06:34:56,968 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:34:56,968 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 144
2021-04-21 06:34:56,968 - INFO - wrapper - Saving models.
2021-04-21 06:35:16,512 - INFO - wrapper - Writing example 0
2021-04-21 06:35:16,997 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:35:16,997 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 168
2021-04-21 06:35:16,997 - INFO - wrapper - Saving models.
2021-04-21 06:35:37,444 - INFO - wrapper - Writing example 0
2021-04-21 06:35:37,940 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:35:37,940 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 192
2021-04-21 06:35:37,940 - INFO - wrapper - Saving models.
2021-04-21 06:35:57,564 - INFO - wrapper - Writing example 0
2021-04-21 06:35:58,070 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:35:58,070 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 216
2021-04-21 06:35:58,070 - INFO - wrapper - Saving models.
2021-04-21 06:36:17,407 - INFO - wrapper - Writing example 0
2021-04-21 06:36:17,844 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 06:36:17,844 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 06:36:17,844 - INFO - wrapper - Saving models.
2021-04-21 06:37:24,841 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 06:37:24,842 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-21 06:37:24,857 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 06:37:24,859 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 06:37:24,859 - INFO - wrapper - Writing example 0
2021-04-21 06:37:52,472 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 06:37:52,473 - INFO - modeling - eval_results: {'acc': 0.904}
2021-04-21 06:54:52,282 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=80, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=256, pet_max_meta_steps=1000, pet_max_seq_length=256, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 06:54:52,282 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 06:54:52,285 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 06:54:52,286 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 06:54:52,287 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 06:54:52,288 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 06:54:52,288 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 06:54:52,288 - INFO - run_task_adaptation - text_b=None
2021-04-21 06:54:52,288 - INFO - run_task_adaptation - task=SST-2
2021-04-21 06:54:52,288 - INFO - run_task_adaptation - label=0
2021-04-21 06:54:52,288 - INFO - run_task_adaptation - **********************************
2021-04-21 06:54:54,307 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 06:55:28,133 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 06:55:28,134 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:56:06,017 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:56:08,395 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 06:56:08,395 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 80
2021-04-21 06:56:08,395 - INFO - transprompt_wrapper - Saving models.
2021-04-21 06:57:06,377 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:57:08,715 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 06:57:08,715 - INFO - transprompt_wrapper - best_dev_acc: 0.8646 | best_global_step: 160
2021-04-21 06:57:08,715 - INFO - transprompt_wrapper - Saving models.
2021-04-21 06:58:06,657 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:58:09,008 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 06:58:09,008 - INFO - transprompt_wrapper - 1
2021-04-21 06:58:46,533 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:58:48,910 - INFO - transprompt_wrapper - {'acc': 0.8020833333333334}
2021-04-21 06:58:48,911 - INFO - transprompt_wrapper - 2
2021-04-21 06:59:26,384 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 06:59:28,738 - INFO - transprompt_wrapper - {'acc': 0.8229166666666666}
2021-04-21 06:59:28,738 - INFO - transprompt_wrapper - 3
2021-04-21 07:00:06,000 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:00:08,326 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 07:00:08,327 - INFO - transprompt_wrapper - 4
2021-04-21 07:00:45,030 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:00:47,362 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 07:00:47,362 - INFO - transprompt_wrapper - 5
2021-04-21 07:01:23,919 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:01:26,260 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 07:01:26,260 - INFO - transprompt_wrapper - 6
2021-04-21 07:02:03,125 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:02:05,458 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-21 07:02:05,458 - INFO - transprompt_wrapper - 7
2021-04-21 07:02:42,432 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:02:44,779 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 07:02:44,779 - INFO - transprompt_wrapper - 8
2021-04-21 07:03:21,664 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:03:24,012 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 07:03:24,012 - INFO - transprompt_wrapper - 9
2021-04-21 07:04:00,999 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:04:03,353 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 07:04:03,353 - INFO - transprompt_wrapper - best_dev_acc: 0.8646 | best_global_step: 960
2021-04-21 07:04:03,354 - INFO - transprompt_wrapper - Saving models.
2021-04-21 07:04:24,389 - INFO - modeling - Saving complete
2021-04-21 07:04:24,389 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 07:04:24,389 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 07:05:12,306 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 07:05:12,307 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 07:05:12,307 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 07:05:12,307 - INFO - wrapper - Writing example 0
2021-04-21 07:05:29,935 - INFO - wrapper - Writing example 0
2021-04-21 07:05:30,705 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 07:05:30,705 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 80
2021-04-21 07:05:30,705 - INFO - wrapper - Saving models.
2021-04-21 07:06:02,358 - INFO - wrapper - Writing example 0
2021-04-21 07:06:03,142 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 07:06:03,142 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 160
2021-04-21 07:06:03,143 - INFO - wrapper - Saving models.
2021-04-21 07:06:36,004 - INFO - wrapper - Writing example 0
2021-04-21 07:06:36,751 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 07:06:36,751 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 07:06:36,751 - INFO - wrapper - Saving models.
2021-04-21 07:07:48,898 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 07:07:48,899 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 07:07:48,908 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 07:07:48,908 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 07:07:48,908 - INFO - wrapper - Writing example 0
2021-04-21 07:08:09,653 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 07:08:09,653 - INFO - modeling - eval_results: {'acc': 0.9128440366972477}
2021-04-21 07:08:09,655 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 07:08:09,655 - INFO - wrapper - Writing example 0
2021-04-21 07:08:29,563 - INFO - wrapper - Writing example 0
2021-04-21 07:08:30,356 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 07:08:30,357 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 80
2021-04-21 07:08:30,357 - INFO - wrapper - Saving models.
2021-04-21 07:09:04,427 - INFO - wrapper - Writing example 0
2021-04-21 07:09:05,215 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 07:09:05,215 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 160
2021-04-21 07:09:05,215 - INFO - wrapper - Saving models.
2021-04-21 07:09:39,806 - INFO - wrapper - Writing example 0
2021-04-21 07:09:40,599 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 07:09:40,600 - INFO - wrapper - best_dev_acc: 1.0000 | best_global_step: 240
2021-04-21 07:09:40,600 - INFO - wrapper - Saving models.
2021-04-21 07:19:09,202 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=24, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=256, pet_max_meta_steps=120, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=8, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=24, weight_decay=0.1)
2021-04-21 07:19:09,202 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-21 07:19:09,211 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 07:19:09,211 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-21 07:19:09,216 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 07:19:09,217 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 07:19:09,217 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 07:19:09,217 - INFO - run_task_adaptation - text_b=None
2021-04-21 07:19:09,217 - INFO - run_task_adaptation - task=SST-2
2021-04-21 07:19:09,217 - INFO - run_task_adaptation - label=0
2021-04-21 07:19:09,218 - INFO - run_task_adaptation - **********************************
2021-04-21 07:19:11,337 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 07:19:44,563 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 07:19:44,563 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:19:54,140 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:19:55,646 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 07:19:55,646 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 24
2021-04-21 07:19:55,646 - INFO - transprompt_wrapper - Saving models.
2021-04-21 07:20:25,994 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:20:27,498 - INFO - transprompt_wrapper - {'acc': 0.84375}
2021-04-21 07:20:27,498 - INFO - transprompt_wrapper - 1
2021-04-21 07:20:36,172 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:20:37,593 - INFO - transprompt_wrapper - {'acc': 0.8229166666666666}
2021-04-21 07:20:37,593 - INFO - transprompt_wrapper - 2
2021-04-21 07:20:46,383 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:20:47,860 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-21 07:20:47,860 - INFO - transprompt_wrapper - 3
2021-04-21 07:20:56,364 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:20:57,890 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 07:20:57,890 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 120
2021-04-21 07:20:57,891 - INFO - transprompt_wrapper - Saving models.
2021-04-21 07:21:19,797 - INFO - modeling - Saving complete
2021-04-21 07:21:19,797 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 07:21:19,797 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 07:22:04,314 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 07:22:04,314 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 07:22:04,314 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 07:22:04,315 - INFO - wrapper - Writing example 0
2021-04-21 07:22:08,866 - INFO - wrapper - Writing example 0
2021-04-21 07:22:09,354 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 07:22:09,354 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 24
2021-04-21 07:22:09,355 - INFO - wrapper - Saving models.
2021-04-21 07:22:29,300 - INFO - wrapper - Writing example 0
2021-04-21 07:22:29,816 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:22:29,817 - INFO - wrapper - 1
2021-04-21 07:22:34,168 - INFO - wrapper - Writing example 0
2021-04-21 07:22:34,663 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:22:34,663 - INFO - wrapper - 2
2021-04-21 07:22:39,064 - INFO - wrapper - Writing example 0
2021-04-21 07:22:39,545 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:22:39,545 - INFO - wrapper - 3
2021-04-21 07:22:43,840 - INFO - wrapper - Writing example 0
2021-04-21 07:22:44,310 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:22:44,310 - INFO - wrapper - 4
2021-04-21 07:22:49,030 - INFO - wrapper - Writing example 0
2021-04-21 07:22:49,525 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:22:49,525 - INFO - wrapper - 5
2021-04-21 07:22:54,303 - INFO - wrapper - Writing example 0
2021-04-21 07:22:54,798 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:22:54,798 - INFO - wrapper - 6
2021-04-21 07:22:59,503 - INFO - wrapper - Writing example 0
2021-04-21 07:22:59,947 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:22:59,947 - INFO - wrapper - 7
2021-04-21 07:23:04,308 - INFO - wrapper - Writing example 0
2021-04-21 07:23:04,931 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:23:04,932 - INFO - wrapper - 8
2021-04-21 07:23:09,685 - INFO - wrapper - Writing example 0
2021-04-21 07:23:10,168 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 07:23:10,168 - INFO - wrapper - 9
2021-04-21 07:24:03,258 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 07:24:03,258 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 07:24:03,267 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 07:24:03,267 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 07:24:03,267 - INFO - wrapper - Writing example 0
2021-04-21 07:24:15,994 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 07:24:15,994 - INFO - modeling - eval_results: {'acc': 0.9105504587155964}
2021-04-21 07:24:15,998 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 07:24:15,998 - INFO - wrapper - Writing example 0
2021-04-21 07:24:20,926 - INFO - wrapper - Writing example 0
2021-04-21 07:24:21,440 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 07:24:21,440 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 24
2021-04-21 07:24:21,440 - INFO - wrapper - Saving models.
2021-04-21 07:24:42,398 - INFO - wrapper - Writing example 0
2021-04-21 07:24:42,970 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 07:24:42,970 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 48
2021-04-21 07:24:42,970 - INFO - wrapper - Saving models.
2021-04-21 07:25:01,892 - INFO - wrapper - Writing example 0
2021-04-21 07:25:02,351 - INFO - wrapper - {'acc': 0.8125}
2021-04-21 07:25:02,351 - INFO - wrapper - 2
2021-04-21 07:25:06,638 - INFO - wrapper - Writing example 0
2021-04-21 07:25:07,070 - INFO - wrapper - {'acc': 0.8125}
2021-04-21 07:25:07,070 - INFO - wrapper - 3
2021-04-21 07:25:11,441 - INFO - wrapper - Writing example 0
2021-04-21 07:25:11,946 - INFO - wrapper - {'acc': 0.8125}
2021-04-21 07:25:11,947 - INFO - wrapper - 4
2021-04-21 07:25:16,176 - INFO - wrapper - Writing example 0
2021-04-21 07:25:16,655 - INFO - wrapper - {'acc': 0.8125}
2021-04-21 07:25:16,655 - INFO - wrapper - 5
2021-04-21 07:25:20,974 - INFO - wrapper - Writing example 0
2021-04-21 07:25:21,461 - INFO - wrapper - {'acc': 0.8125}
2021-04-21 07:25:21,462 - INFO - wrapper - 6
2021-04-21 07:25:26,142 - INFO - wrapper - Writing example 0
2021-04-21 07:25:26,636 - INFO - wrapper - {'acc': 0.8125}
2021-04-21 07:25:26,637 - INFO - wrapper - 7
2021-04-21 07:25:31,228 - INFO - wrapper - Writing example 0
2021-04-21 07:25:31,720 - INFO - wrapper - {'acc': 0.8125}
2021-04-21 07:25:31,720 - INFO - wrapper - 8
2021-04-21 07:25:36,376 - INFO - wrapper - Writing example 0
2021-04-21 07:25:36,878 - INFO - wrapper - {'acc': 0.8125}
2021-04-21 07:25:36,878 - INFO - wrapper - 9
2021-04-21 07:26:25,199 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 07:26:25,199 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-21 07:26:25,322 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 07:26:25,323 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 07:26:25,323 - INFO - wrapper - Writing example 0
2021-04-21 07:26:53,238 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 07:26:53,238 - INFO - modeling - eval_results: {'acc': 0.8375}
2021-04-21 07:26:53,240 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 07:26:53,241 - INFO - wrapper - Writing example 0
2021-04-21 07:26:58,180 - INFO - wrapper - Writing example 0
2021-04-21 07:26:58,800 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:26:58,800 - INFO - wrapper - best_dev_acc: 0.8125 | best_global_step: 24
2021-04-21 07:26:58,802 - INFO - wrapper - Saving models.
2021-04-21 07:27:18,453 - INFO - wrapper - Writing example 0
2021-04-21 07:27:18,950 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:27:18,950 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 48
2021-04-21 07:27:18,951 - INFO - wrapper - Saving models.
2021-04-21 07:27:38,494 - INFO - wrapper - Writing example 0
2021-04-21 07:27:38,989 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:27:38,989 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 72
2021-04-21 07:27:38,989 - INFO - wrapper - Saving models.
2021-04-21 07:27:58,436 - INFO - wrapper - Writing example 0
2021-04-21 07:27:58,924 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:27:58,925 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 96
2021-04-21 07:27:58,925 - INFO - wrapper - Saving models.
2021-04-21 07:28:17,146 - INFO - wrapper - Writing example 0
2021-04-21 07:28:17,580 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:28:17,580 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 120
2021-04-21 07:28:17,580 - INFO - wrapper - Saving models.
2021-04-21 07:28:37,218 - INFO - wrapper - Writing example 0
2021-04-21 07:28:37,708 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:28:37,708 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 144
2021-04-21 07:28:37,708 - INFO - wrapper - Saving models.
2021-04-21 07:28:56,841 - INFO - wrapper - Writing example 0
2021-04-21 07:28:57,273 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:28:57,273 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 168
2021-04-21 07:28:57,273 - INFO - wrapper - Saving models.
2021-04-21 07:29:16,390 - INFO - wrapper - Writing example 0
2021-04-21 07:29:16,878 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:29:16,878 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 192
2021-04-21 07:29:16,895 - INFO - wrapper - Saving models.
2021-04-21 07:29:35,868 - INFO - wrapper - Writing example 0
2021-04-21 07:29:36,352 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:29:36,352 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 216
2021-04-21 07:29:36,353 - INFO - wrapper - Saving models.
2021-04-21 07:29:55,380 - INFO - wrapper - Writing example 0
2021-04-21 07:29:55,859 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:29:55,859 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 240
2021-04-21 07:29:55,859 - INFO - wrapper - Saving models.
2021-04-21 07:30:56,881 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 07:30:56,882 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-21 07:30:56,896 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 07:30:56,898 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 07:30:56,898 - INFO - wrapper - Writing example 0
2021-04-21 07:31:24,639 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 07:31:24,639 - INFO - modeling - eval_results: {'acc': 0.9135}
2021-04-21 07:36:05,742 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 07:36:05,742 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-21 07:36:05,746 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 07:36:05,746 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-21 07:36:05,749 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 07:36:05,749 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 07:36:05,749 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 07:36:05,749 - INFO - run_task_adaptation - text_b=None
2021-04-21 07:36:05,749 - INFO - run_task_adaptation - task=SST-2
2021-04-21 07:36:05,749 - INFO - run_task_adaptation - label=0
2021-04-21 07:36:05,749 - INFO - run_task_adaptation - **********************************
2021-04-21 07:36:07,757 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 07:36:42,892 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 07:36:42,893 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:37:13,574 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:37:15,055 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 07:37:15,055 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 100
2021-04-21 07:37:15,055 - INFO - transprompt_wrapper - Saving models.
2021-04-21 07:38:05,313 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:38:06,807 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-21 07:38:06,808 - INFO - transprompt_wrapper - 1
2021-04-21 07:38:36,494 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:38:37,985 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 07:38:37,986 - INFO - transprompt_wrapper - 2
2021-04-21 07:39:07,773 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:39:09,208 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 07:39:09,209 - INFO - transprompt_wrapper - 3
2021-04-21 07:39:38,922 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:39:40,279 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-21 07:39:40,279 - INFO - transprompt_wrapper - 4
2021-04-21 07:40:10,057 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:40:11,483 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 07:40:11,483 - INFO - transprompt_wrapper - 5
2021-04-21 07:40:41,028 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:40:42,455 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 07:40:42,455 - INFO - transprompt_wrapper - 6
2021-04-21 07:41:11,667 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:41:13,001 - INFO - transprompt_wrapper - {'acc': 0.8854166666666666}
2021-04-21 07:41:13,001 - INFO - transprompt_wrapper - 7
2021-04-21 07:41:42,213 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:41:43,637 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-21 07:41:43,637 - INFO - transprompt_wrapper - 8
2021-04-21 07:42:12,918 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:42:14,271 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-21 07:42:14,271 - INFO - transprompt_wrapper - 9
2021-04-21 07:42:14,557 - INFO - modeling - Saving complete
2021-04-21 07:42:14,557 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 07:42:14,557 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 07:42:57,032 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 07:42:57,032 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 07:42:57,032 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 07:42:57,032 - INFO - wrapper - Writing example 0
2021-04-21 07:43:15,886 - INFO - wrapper - Writing example 0
2021-04-21 07:43:16,369 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 07:43:16,369 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-21 07:43:16,370 - INFO - wrapper - Saving models.
2021-04-21 07:43:45,640 - INFO - wrapper - Writing example 0
2021-04-21 07:43:46,074 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 07:43:46,074 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 200
2021-04-21 07:43:46,074 - INFO - wrapper - Saving models.
2021-04-21 07:44:15,929 - INFO - wrapper - Writing example 0
2021-04-21 07:44:16,371 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 07:44:16,371 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 300
2021-04-21 07:44:16,371 - INFO - wrapper - Saving models.
2021-04-21 07:45:14,914 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 07:45:14,915 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-21 07:45:14,924 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-21 07:45:14,924 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 07:45:14,924 - INFO - wrapper - Writing example 0
2021-04-21 07:45:26,880 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 07:45:26,880 - INFO - modeling - eval_results: {'acc': 0.9357798165137615}
2021-04-21 07:45:26,882 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 07:45:26,882 - INFO - wrapper - Writing example 0
2021-04-21 07:45:46,491 - INFO - wrapper - Writing example 0
2021-04-21 07:45:46,965 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 07:45:46,965 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 100
2021-04-21 07:45:46,965 - INFO - wrapper - Saving models.
2021-04-21 07:46:20,438 - INFO - wrapper - Writing example 0
2021-04-21 07:46:20,914 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 07:46:20,914 - INFO - wrapper - best_dev_acc: 0.8438 | best_global_step: 200
2021-04-21 07:46:20,914 - INFO - wrapper - Saving models.
2021-04-21 07:46:55,886 - INFO - wrapper - Writing example 0
2021-04-21 07:46:56,411 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 07:46:56,411 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 300
2021-04-21 07:46:56,412 - INFO - wrapper - Saving models.
2021-04-21 07:48:01,074 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 07:48:01,075 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-21 07:48:01,091 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-21 07:48:01,091 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 07:48:01,092 - INFO - wrapper - Writing example 0
2021-04-21 07:48:29,136 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 07:48:29,137 - INFO - modeling - eval_results: {'acc': 0.863}
2021-04-21 07:48:29,139 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 07:48:29,139 - INFO - wrapper - Writing example 0
2021-04-21 07:48:48,140 - INFO - wrapper - Writing example 0
2021-04-21 07:48:48,658 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:48:48,658 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-21 07:48:48,658 - INFO - wrapper - Saving models.
2021-04-21 07:49:23,679 - INFO - wrapper - Writing example 0
2021-04-21 07:49:24,182 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:49:24,183 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-21 07:49:24,183 - INFO - wrapper - Saving models.
2021-04-21 07:49:58,508 - INFO - wrapper - Writing example 0
2021-04-21 07:49:58,942 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 07:49:58,942 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-21 07:49:58,942 - INFO - wrapper - Saving models.
2021-04-21 07:51:04,273 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 07:51:04,274 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-21 07:51:04,440 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 07:51:04,442 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 07:51:04,442 - INFO - wrapper - Writing example 0
2021-04-21 07:51:32,056 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 07:51:32,057 - INFO - modeling - eval_results: {'acc': 0.919}
2021-04-21 07:52:21,146 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 07:52:21,146 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-21 07:52:21,149 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 07:52:21,149 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-21 07:52:21,151 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 07:52:21,151 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 07:52:21,151 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 07:52:21,152 - INFO - run_task_adaptation - text_b=None
2021-04-21 07:52:21,152 - INFO - run_task_adaptation - task=SST-2
2021-04-21 07:52:21,152 - INFO - run_task_adaptation - label=0
2021-04-21 07:52:21,152 - INFO - run_task_adaptation - **********************************
2021-04-21 07:52:23,142 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 07:52:57,196 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 07:52:57,197 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:53:28,042 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:53:29,544 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 07:53:29,545 - INFO - transprompt_wrapper - best_dev_acc: 0.8854 | best_global_step: 100
2021-04-21 07:53:29,545 - INFO - transprompt_wrapper - Saving models.
2021-04-21 07:55:12,907 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 07:55:12,907 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-21 07:55:12,911 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 07:55:12,911 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-21 07:55:12,914 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 07:55:12,914 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 07:55:12,914 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 07:55:12,914 - INFO - run_task_adaptation - text_b=None
2021-04-21 07:55:12,914 - INFO - run_task_adaptation - task=SST-2
2021-04-21 07:55:12,914 - INFO - run_task_adaptation - label=0
2021-04-21 07:55:12,914 - INFO - run_task_adaptation - **********************************
2021-04-21 07:55:14,911 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 07:55:49,330 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 07:55:49,331 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:56:20,629 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:56:22,239 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 07:56:22,239 - INFO - transprompt_wrapper - best_dev_acc: 0.8958 | best_global_step: 100
2021-04-21 07:56:22,239 - INFO - transprompt_wrapper - Saving models.
2021-04-21 07:57:14,014 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:57:15,482 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 07:57:15,483 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 200
2021-04-21 07:57:15,483 - INFO - transprompt_wrapper - Saving models.
2021-04-21 07:58:05,826 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:58:07,283 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 07:58:07,284 - INFO - transprompt_wrapper - 1
2021-04-21 07:58:36,660 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:58:38,113 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-21 07:58:38,113 - INFO - transprompt_wrapper - 2
2021-04-21 07:59:07,780 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 07:59:09,234 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 07:59:09,235 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 500
2021-04-21 07:59:09,235 - INFO - transprompt_wrapper - Saving models.
2021-04-21 07:59:59,359 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:00:00,816 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 08:00:00,816 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 600
2021-04-21 08:00:00,816 - INFO - transprompt_wrapper - Saving models.
2021-04-21 08:00:51,017 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:00:52,468 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 08:00:52,468 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 700
2021-04-21 08:00:52,469 - INFO - transprompt_wrapper - Saving models.
2021-04-21 08:01:43,214 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:01:44,614 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-21 08:01:44,614 - INFO - transprompt_wrapper - 3
2021-04-21 08:02:14,368 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:02:15,792 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:02:15,792 - INFO - transprompt_wrapper - 4
2021-04-21 08:02:45,185 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:02:46,644 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:02:46,644 - INFO - transprompt_wrapper - 5
2021-04-21 08:02:46,933 - INFO - modeling - Saving complete
2021-04-21 08:02:46,933 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 08:02:46,933 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 08:03:37,991 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 08:03:37,992 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 08:03:37,992 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 08:03:37,992 - INFO - wrapper - Writing example 0
2021-04-21 08:03:58,298 - INFO - wrapper - Writing example 0
2021-04-21 08:03:58,815 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 08:03:58,816 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 100
2021-04-21 08:03:58,816 - INFO - wrapper - Saving models.
2021-04-21 08:04:34,013 - INFO - wrapper - Writing example 0
2021-04-21 08:04:34,507 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 08:04:34,507 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 200
2021-04-21 08:04:34,507 - INFO - wrapper - Saving models.
2021-04-21 08:05:09,529 - INFO - wrapper - Writing example 0
2021-04-21 08:05:10,063 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 08:05:10,063 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 300
2021-04-21 08:05:10,063 - INFO - wrapper - Saving models.
2021-04-21 08:06:23,753 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 08:06:23,754 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-21 08:06:23,926 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-21 08:06:23,926 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 08:06:23,926 - INFO - wrapper - Writing example 0
2021-04-21 08:06:36,826 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 08:06:36,826 - INFO - modeling - eval_results: {'acc': 0.9334862385321101}
2021-04-21 08:06:36,829 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 08:06:36,829 - INFO - wrapper - Writing example 0
2021-04-21 08:06:55,833 - INFO - wrapper - Writing example 0
2021-04-21 08:06:56,338 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 08:06:56,339 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-21 08:06:56,339 - INFO - wrapper - Saving models.
2021-04-21 08:07:30,908 - INFO - wrapper - Writing example 0
2021-04-21 08:07:31,424 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 08:07:31,424 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-21 08:07:31,424 - INFO - wrapper - Saving models.
2021-04-21 08:08:06,299 - INFO - wrapper - Writing example 0
2021-04-21 08:08:06,819 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 08:08:06,819 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 300
2021-04-21 08:08:06,820 - INFO - wrapper - Saving models.
2021-04-21 08:09:17,524 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 08:09:17,524 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-21 08:09:17,541 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-21 08:09:17,542 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 08:09:17,542 - INFO - wrapper - Writing example 0
2021-04-21 08:09:45,143 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 08:09:45,143 - INFO - modeling - eval_results: {'acc': 0.8745}
2021-04-21 08:09:45,145 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 08:09:45,146 - INFO - wrapper - Writing example 0
2021-04-21 08:10:03,802 - INFO - wrapper - Writing example 0
2021-04-21 08:10:04,288 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 08:10:04,288 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 100
2021-04-21 08:10:04,288 - INFO - wrapper - Saving models.
2021-04-21 08:10:38,934 - INFO - wrapper - Writing example 0
2021-04-21 08:10:39,434 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 08:10:39,434 - INFO - wrapper - 1
2021-04-21 08:10:59,310 - INFO - wrapper - Writing example 0
2021-04-21 08:10:59,807 - INFO - wrapper - {'acc': 0.90625}
2021-04-21 08:10:59,808 - INFO - wrapper - 2
2021-04-21 08:11:53,900 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 08:11:53,900 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-21 08:11:53,949 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 08:11:53,952 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 08:11:53,952 - INFO - wrapper - Writing example 0
2021-04-21 08:12:21,419 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 08:12:21,419 - INFO - modeling - eval_results: {'acc': 0.905}
2021-04-21 08:16:23,760 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-100', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=100, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 08:16:23,761 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-100 (num_examples=-1, set_type=train)
2021-04-21 08:16:23,764 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 08:16:23,764 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-100 (num_examples=-1, set_type=dev)
2021-04-21 08:16:23,766 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 08:16:23,766 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 08:16:23,767 - INFO - run_task_adaptation - text_a=- no proprietary headset jack
2021-04-21 08:16:23,767 - INFO - run_task_adaptation - text_b=None
2021-04-21 08:16:23,767 - INFO - run_task_adaptation - task=cr
2021-04-21 08:16:23,767 - INFO - run_task_adaptation - label=0
2021-04-21 08:16:23,767 - INFO - run_task_adaptation - **********************************
2021-04-21 08:16:26,214 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 08:17:02,459 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 08:17:02,459 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:17:32,945 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:17:34,369 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 08:17:34,369 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-21 08:17:34,369 - INFO - transprompt_wrapper - Saving models.
2021-04-21 08:18:24,293 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:18:25,799 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 08:18:25,799 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-21 08:18:25,799 - INFO - transprompt_wrapper - Saving models.
2021-04-21 08:19:16,753 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:19:18,209 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 08:19:18,210 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 300
2021-04-21 08:19:18,210 - INFO - transprompt_wrapper - Saving models.
2021-04-21 08:20:08,831 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:20:10,302 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:20:10,302 - INFO - transprompt_wrapper - 1
2021-04-21 08:20:40,195 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:20:41,628 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:20:41,628 - INFO - transprompt_wrapper - 2
2021-04-21 08:21:11,089 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:21:12,563 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:21:12,563 - INFO - transprompt_wrapper - 3
2021-04-21 08:21:42,172 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:21:43,595 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:21:43,595 - INFO - transprompt_wrapper - 4
2021-04-21 08:22:13,618 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:22:15,311 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:22:15,312 - INFO - transprompt_wrapper - 5
2021-04-21 08:22:45,244 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:22:46,745 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:22:46,746 - INFO - transprompt_wrapper - 6
2021-04-21 08:23:16,211 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:23:17,899 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-21 08:23:17,899 - INFO - transprompt_wrapper - 7
2021-04-21 08:23:18,191 - INFO - modeling - Saving complete
2021-04-21 08:23:18,191 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 08:23:18,191 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 08:24:03,580 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 08:24:03,580 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 08:24:03,580 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 08:24:03,580 - INFO - wrapper - Writing example 0
2021-04-21 08:24:22,206 - INFO - wrapper - Writing example 0
2021-04-21 08:24:22,699 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 08:24:22,699 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-21 08:24:22,699 - INFO - wrapper - Saving models.
2021-04-21 08:24:56,690 - INFO - wrapper - Writing example 0
2021-04-21 08:24:57,173 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 08:24:57,173 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-21 08:24:57,173 - INFO - wrapper - Saving models.
2021-04-21 08:25:32,500 - INFO - wrapper - Writing example 0
2021-04-21 08:25:33,001 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 08:25:33,001 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-21 08:25:33,001 - INFO - wrapper - Saving models.
2021-04-21 08:26:39,744 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 08:26:39,744 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-100 (num_examples=-1, set_type=test)
2021-04-21 08:26:39,753 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 08:26:39,753 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 08:26:39,753 - INFO - wrapper - Writing example 0
2021-04-21 08:26:51,639 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 08:26:51,639 - INFO - modeling - eval_results: {'acc': 0.9185779816513762}
2021-04-21 08:26:51,641 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 08:26:51,641 - INFO - wrapper - Writing example 0
2021-04-21 08:27:08,713 - INFO - wrapper - Writing example 0
2021-04-21 08:27:09,178 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 08:27:09,178 - INFO - wrapper - best_dev_acc: 0.8125 | best_global_step: 100
2021-04-21 08:27:09,178 - INFO - wrapper - Saving models.
2021-04-21 08:27:41,232 - INFO - wrapper - Writing example 0
2021-04-21 08:27:41,726 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 08:27:41,726 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-21 08:27:41,726 - INFO - wrapper - Saving models.
2021-04-21 08:28:13,420 - INFO - wrapper - Writing example 0
2021-04-21 08:28:13,854 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 08:28:13,854 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-21 08:28:13,854 - INFO - wrapper - Saving models.
2021-04-21 08:29:18,951 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 08:29:18,951 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-100 (num_examples=-1, set_type=test)
2021-04-21 08:29:19,074 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-21 08:29:19,075 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 08:29:19,075 - INFO - wrapper - Writing example 0
2021-04-21 08:29:46,667 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 08:29:46,667 - INFO - modeling - eval_results: {'acc': 0.7465}
2021-04-21 08:29:46,668 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 08:29:46,668 - INFO - wrapper - Writing example 0
2021-04-21 08:30:05,737 - INFO - wrapper - Writing example 0
2021-04-21 08:30:06,227 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 08:30:06,227 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 100
2021-04-21 08:30:06,227 - INFO - wrapper - Saving models.
2021-04-21 08:30:37,987 - INFO - wrapper - Writing example 0
2021-04-21 08:30:38,487 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 08:30:38,487 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 200
2021-04-21 08:30:38,487 - INFO - wrapper - Saving models.
2021-04-21 08:31:10,562 - INFO - wrapper - Writing example 0
2021-04-21 08:31:11,043 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 08:31:11,044 - INFO - wrapper - best_dev_acc: 0.9688 | best_global_step: 300
2021-04-21 08:31:11,044 - INFO - wrapper - Saving models.
2021-04-21 08:32:14,731 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 08:32:14,731 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-100 (num_examples=-1, set_type=test)
2021-04-21 08:32:14,744 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-21 08:32:14,746 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 08:32:14,746 - INFO - wrapper - Writing example 0
2021-04-21 08:32:42,513 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 08:32:42,513 - INFO - modeling - eval_results: {'acc': 0.9035}
2021-04-21 08:33:06,443 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 08:33:06,444 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=train)
2021-04-21 08:33:06,472 - INFO - task_processors - Returning 6075 train examples with label dist.: [(0, 2889), (1, 3186)]
2021-04-21 08:33:06,472 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=dev)
2021-04-21 08:33:06,519 - INFO - task_processors - Returning 11282 dev examples with label dist.: [(0, 5120), (1, 6162)]
2021-04-21 08:33:06,519 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 08:33:06,519 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 08:33:06,519 - INFO - run_task_adaptation - text_b=None
2021-04-21 08:33:06,519 - INFO - run_task_adaptation - task=SST-2
2021-04-21 08:33:06,519 - INFO - run_task_adaptation - label=0
2021-04-21 08:33:06,520 - INFO - run_task_adaptation - **********************************
2021-04-21 08:34:12,476 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 08:34:12,476 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-21 08:34:12,480 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 08:34:12,480 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-21 08:34:12,482 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-21 08:34:12,482 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 08:34:12,482 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 08:34:12,482 - INFO - run_task_adaptation - text_b=None
2021-04-21 08:34:12,482 - INFO - run_task_adaptation - task=SST-2
2021-04-21 08:34:12,482 - INFO - run_task_adaptation - label=0
2021-04-21 08:34:12,482 - INFO - run_task_adaptation - **********************************
2021-04-21 08:34:16,262 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 08:35:13,598 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 08:35:13,599 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=train)
2021-04-21 08:35:13,627 - INFO - task_processors - Returning 6075 train examples with label dist.: [(0, 2889), (1, 3186)]
2021-04-21 08:35:13,627 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=dev)
2021-04-21 08:35:13,676 - INFO - task_processors - Returning 11282 dev examples with label dist.: [(0, 5120), (1, 6162)]
2021-04-21 08:35:13,676 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 08:35:13,676 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 08:35:13,676 - INFO - run_task_adaptation - text_b=None
2021-04-21 08:35:13,676 - INFO - run_task_adaptation - task=SST-2
2021-04-21 08:35:13,676 - INFO - run_task_adaptation - label=0
2021-04-21 08:35:13,676 - INFO - run_task_adaptation - **********************************
2021-04-21 08:35:44,899 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 08:36:57,489 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 08:36:57,489 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:49:50,281 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 08:49:50,281 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=train)
2021-04-21 08:49:50,333 - INFO - task_processors - Returning 11618 train examples with label dist.: [(0, 5032), (1, 6586)]
2021-04-21 08:49:50,333 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=dev)
2021-04-21 08:49:50,357 - INFO - task_processors - Returning 5739 dev examples with label dist.: [(0, 2977), (1, 2762)]
2021-04-21 08:49:50,358 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 08:49:50,358 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 08:49:50,358 - INFO - run_task_adaptation - text_b=None
2021-04-21 08:49:50,358 - INFO - run_task_adaptation - task=SST-2
2021-04-21 08:49:50,358 - INFO - run_task_adaptation - label=0
2021-04-21 08:49:50,358 - INFO - run_task_adaptation - **********************************
2021-04-21 08:49:53,430 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 08:50:09,399 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 08:50:09,399 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 08:50:18,409 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 09:06:58,169 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 09:06:58,169 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=train)
2021-04-21 09:06:58,220 - INFO - task_processors - Returning 11965 train examples with label dist.: [(0, 5268), (1, 6697)]
2021-04-21 09:06:58,220 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=dev)
2021-04-21 09:06:58,244 - INFO - task_processors - Returning 5392 dev examples with label dist.: [(0, 2741), (1, 2651)]
2021-04-21 09:06:58,244 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 09:06:58,244 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 09:06:58,244 - INFO - run_task_adaptation - text_b=None
2021-04-21 09:06:58,244 - INFO - run_task_adaptation - task=SST-2
2021-04-21 09:06:58,245 - INFO - run_task_adaptation - label=0
2021-04-21 09:06:58,245 - INFO - run_task_adaptation - **********************************
2021-04-21 09:07:00,194 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 09:07:16,196 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 09:07:16,197 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:07:25,249 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 09:10:31,127 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 09:10:31,127 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=train)
2021-04-21 09:10:31,177 - INFO - task_processors - Returning 11965 train examples with label dist.: [(0, 5268), (1, 6697)]
2021-04-21 09:10:31,177 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=dev)
2021-04-21 09:10:31,200 - INFO - task_processors - Returning 5392 dev examples with label dist.: [(0, 2741), (1, 2651)]
2021-04-21 09:10:31,200 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 09:10:31,200 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-21 09:10:31,200 - INFO - run_task_adaptation - text_b=None
2021-04-21 09:10:31,200 - INFO - run_task_adaptation - task=SST-2
2021-04-21 09:10:31,201 - INFO - run_task_adaptation - label=0
2021-04-21 09:10:31,201 - INFO - run_task_adaptation - **********************************
2021-04-21 09:10:33,042 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 09:10:49,067 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 09:10:49,068 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:10:57,905 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 09:11:09,016 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 09:11:09,016 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-04-21 09:11:09,020 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-21 09:11:09,020 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-04-21 09:11:09,022 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-21 09:11:09,022 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 09:11:09,022 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-21 09:11:09,022 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-21 09:11:09,022 - INFO - run_task_adaptation - task=MNLI
2021-04-21 09:11:09,022 - INFO - run_task_adaptation - label=contradiction
2021-04-21 09:11:09,022 - INFO - run_task_adaptation - **********************************
2021-04-21 09:11:10,797 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 09:11:44,465 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 09:11:44,466 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:12:38,154 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:12:41,854 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 09:12:41,854 - INFO - transprompt_wrapper - best_dev_acc: 0.6875 | best_global_step: 100
2021-04-21 09:12:41,854 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:13:44,243 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:13:47,518 - INFO - transprompt_wrapper - {'acc': 0.6666666666666666}
2021-04-21 09:13:47,519 - INFO - transprompt_wrapper - 1
2021-04-21 09:14:39,316 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:14:42,572 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 09:14:42,572 - INFO - transprompt_wrapper - best_dev_acc: 0.6875 | best_global_step: 300
2021-04-21 09:14:42,572 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:15:53,718 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:15:56,966 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 09:15:56,966 - INFO - transprompt_wrapper - best_dev_acc: 0.6875 | best_global_step: 400
2021-04-21 09:15:56,966 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:17:06,948 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:17:10,039 - INFO - transprompt_wrapper - {'acc': 0.65625}
2021-04-21 09:17:10,039 - INFO - transprompt_wrapper - 4
2021-04-21 09:18:00,208 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:18:03,239 - INFO - transprompt_wrapper - {'acc': 0.6770833333333334}
2021-04-21 09:18:03,239 - INFO - transprompt_wrapper - 5
2021-04-21 09:18:54,716 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:18:57,882 - INFO - transprompt_wrapper - {'acc': 0.6666666666666666}
2021-04-21 09:18:57,882 - INFO - transprompt_wrapper - 6
2021-04-21 09:19:49,307 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:19:52,503 - INFO - transprompt_wrapper - {'acc': 0.6666666666666666}
2021-04-21 09:19:52,503 - INFO - transprompt_wrapper - 7
2021-04-21 09:20:43,904 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:20:47,022 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 09:20:47,022 - INFO - transprompt_wrapper - best_dev_acc: 0.7083 | best_global_step: 900
2021-04-21 09:20:47,022 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:21:57,723 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:22:00,967 - INFO - transprompt_wrapper - {'acc': 0.6979166666666666}
2021-04-21 09:22:00,968 - INFO - transprompt_wrapper - 1
2021-04-21 09:22:01,550 - INFO - modeling - Saving complete
2021-04-21 09:22:01,550 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 09:22:01,550 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 09:22:53,959 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 09:22:53,959 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 09:22:53,960 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-21 09:22:53,960 - INFO - wrapper - Writing example 0
2021-04-21 09:23:23,883 - INFO - wrapper - Writing example 0
2021-04-21 09:23:25,410 - INFO - wrapper - Saving trained model at output/adaptation/g2/mnli...
2021-04-21 09:23:25,410 - INFO - wrapper - best_dev_acc: 0.6458 | best_global_step: 100
2021-04-21 09:23:25,410 - INFO - wrapper - Saving models.
2021-04-21 09:24:01,819 - INFO - wrapper - Writing example 0
2021-04-21 09:24:03,372 - INFO - wrapper - {'acc': 0.5833333333333334}
2021-04-21 09:24:03,372 - INFO - wrapper - 1
2021-04-21 09:24:32,606 - INFO - wrapper - Writing example 0
2021-04-21 09:24:34,126 - INFO - wrapper - {'acc': 0.5416666666666666}
2021-04-21 09:24:34,126 - INFO - wrapper - 2
2021-04-21 09:25:27,017 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-21 09:25:27,018 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-04-21 09:25:27,547 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-21 09:25:27,547 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-21 09:25:27,547 - INFO - wrapper - Writing example 0
2021-04-21 09:25:37,877 - INFO - wrapper - Writing example 10000
2021-04-21 09:25:43,416 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:26:46,090 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 09:26:46,090 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 600
2021-04-21 09:26:46,090 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:35:02,878 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-21 09:35:02,879 - INFO - modeling - eval_results: {'acc': 0.6563851987580801}
2021-04-21 09:35:02,882 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-21 09:35:02,882 - INFO - wrapper - Writing example 0
2021-04-21 09:35:32,040 - INFO - wrapper - Writing example 0
2021-04-21 09:35:33,617 - INFO - wrapper - Saving trained model at output/adaptation/g2/snli...
2021-04-21 09:35:33,618 - INFO - wrapper - best_dev_acc: 0.6250 | best_global_step: 100
2021-04-21 09:35:33,618 - INFO - wrapper - Saving models.
2021-04-21 09:36:08,810 - INFO - wrapper - Writing example 0
2021-04-21 09:36:10,327 - INFO - wrapper - Saving trained model at output/adaptation/g2/snli...
2021-04-21 09:36:10,327 - INFO - wrapper - best_dev_acc: 0.6458 | best_global_step: 200
2021-04-21 09:36:10,327 - INFO - wrapper - Saving models.
2021-04-21 09:36:55,127 - INFO - wrapper - Writing example 0
2021-04-21 09:36:56,648 - INFO - wrapper - Saving trained model at output/adaptation/g2/snli...
2021-04-21 09:36:56,648 - INFO - wrapper - best_dev_acc: 0.6667 | best_global_step: 300
2021-04-21 09:36:56,648 - INFO - wrapper - Saving models.
2021-04-21 09:38:04,146 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-21 09:38:04,147 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-04-21 09:38:04,587 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-04-21 09:38:04,601 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-21 09:38:04,601 - INFO - wrapper - Writing example 0
2021-04-21 09:41:54,893 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:42:44,564 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-21 09:42:44,564 - INFO - modeling - eval_results: {'acc': 0.6880715301767933}
2021-04-21 09:42:49,496 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 09:42:49,496 - INFO - transprompt_wrapper - best_dev_acc: 0.9180 | best_global_step: 1200
2021-04-21 09:42:49,496 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:47:47,659 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 09:47:47,659 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-04-21 09:47:47,662 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-21 09:47:47,662 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-04-21 09:47:47,664 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-21 09:47:47,664 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 09:47:47,664 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-21 09:47:47,665 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-21 09:47:47,665 - INFO - run_task_adaptation - task=MNLI
2021-04-21 09:47:47,665 - INFO - run_task_adaptation - label=contradiction
2021-04-21 09:47:47,665 - INFO - run_task_adaptation - **********************************
2021-04-21 09:47:49,803 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 09:48:24,759 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 09:48:24,760 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:49:17,147 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:49:20,122 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 09:49:20,123 - INFO - transprompt_wrapper - best_dev_acc: 0.5938 | best_global_step: 100
2021-04-21 09:49:20,123 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:50:30,693 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:50:34,043 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 09:50:34,043 - INFO - transprompt_wrapper - best_dev_acc: 0.6667 | best_global_step: 200
2021-04-21 09:50:34,043 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:51:45,069 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:51:48,199 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 09:51:48,199 - INFO - transprompt_wrapper - best_dev_acc: 0.7083 | best_global_step: 300
2021-04-21 09:51:48,199 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:53:00,254 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:53:03,413 - INFO - transprompt_wrapper - {'acc': 0.65625}
2021-04-21 09:53:03,413 - INFO - transprompt_wrapper - 1
2021-04-21 09:53:55,020 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:53:58,321 - INFO - transprompt_wrapper - {'acc': 0.65625}
2021-04-21 09:53:58,321 - INFO - transprompt_wrapper - 2
2021-04-21 09:54:50,320 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:54:52,485 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:54:53,015 - INFO - transprompt_wrapper - {'acc': 0.6666666666666666}
2021-04-21 09:54:53,015 - INFO - transprompt_wrapper - 3
2021-04-21 09:55:34,848 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:55:37,330 - INFO - transprompt_wrapper - {'acc': 0.6770833333333334}
2021-04-21 09:55:37,330 - INFO - transprompt_wrapper - 4
2021-04-21 09:56:10,668 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 09:56:10,669 - INFO - transprompt_wrapper - best_dev_acc: 0.9210 | best_global_step: 1800
2021-04-21 09:56:10,669 - INFO - transprompt_wrapper - Saving models.
2021-04-21 09:56:17,402 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:56:18,845 - INFO - transprompt_wrapper - {'acc': 0.65625}
2021-04-21 09:56:18,846 - INFO - transprompt_wrapper - 5
2021-04-21 09:57:10,240 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:57:13,608 - INFO - transprompt_wrapper - {'acc': 0.6666666666666666}
2021-04-21 09:57:13,608 - INFO - transprompt_wrapper - 6
2021-04-21 09:58:05,201 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 09:58:08,586 - INFO - transprompt_wrapper - {'acc': 0.6666666666666666}
2021-04-21 09:58:08,586 - INFO - transprompt_wrapper - 7
2021-04-21 09:58:09,204 - INFO - modeling - Saving complete
2021-04-21 09:58:09,204 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 09:58:09,204 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 09:58:54,636 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 09:58:54,636 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 09:58:54,637 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-21 09:58:54,637 - INFO - wrapper - Writing example 0
2021-04-21 09:59:25,034 - INFO - wrapper - Writing example 0
2021-04-21 09:59:26,633 - INFO - wrapper - Saving trained model at output/adaptation/g2/mnli...
2021-04-21 09:59:26,633 - INFO - wrapper - best_dev_acc: 0.6250 | best_global_step: 100
2021-04-21 09:59:26,633 - INFO - wrapper - Saving models.
2021-04-21 10:00:12,308 - INFO - wrapper - Writing example 0
2021-04-21 10:00:13,928 - INFO - wrapper - Saving trained model at output/adaptation/g2/mnli...
2021-04-21 10:00:13,929 - INFO - wrapper - best_dev_acc: 0.6250 | best_global_step: 200
2021-04-21 10:00:13,929 - INFO - wrapper - Saving models.
2021-04-21 10:00:58,962 - INFO - wrapper - Writing example 0
2021-04-21 10:01:00,563 - INFO - wrapper - Saving trained model at output/adaptation/g2/mnli...
2021-04-21 10:01:00,563 - INFO - wrapper - best_dev_acc: 0.6250 | best_global_step: 300
2021-04-21 10:01:00,563 - INFO - wrapper - Saving models.
2021-04-21 10:02:08,941 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-21 10:02:08,941 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-42 (num_examples=-1, set_type=test)
2021-04-21 10:02:09,465 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('contradiction', 6453), ('neutral', 6252)]
2021-04-21 10:02:09,466 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-21 10:02:09,466 - INFO - wrapper - Writing example 0
2021-04-21 10:02:21,303 - INFO - wrapper - Writing example 10000
2021-04-21 10:10:18,343 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:11:15,913 - INFO - transprompt_wrapper - {'acc': 0.9167284866468842}
2021-04-21 10:11:15,913 - INFO - transprompt_wrapper - 1
2021-04-21 10:12:24,670 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-21 10:12:24,670 - INFO - modeling - eval_results: {'acc': 0.6324120730900392}
2021-04-21 10:12:24,673 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-21 10:12:24,674 - INFO - wrapper - Writing example 0
2021-04-21 10:12:55,658 - INFO - wrapper - Writing example 0
2021-04-21 10:12:57,313 - INFO - wrapper - Saving trained model at output/adaptation/g2/snli...
2021-04-21 10:12:57,313 - INFO - wrapper - best_dev_acc: 0.6042 | best_global_step: 100
2021-04-21 10:12:57,313 - INFO - wrapper - Saving models.
2021-04-21 10:13:44,834 - INFO - wrapper - Writing example 0
2021-04-21 10:13:46,459 - INFO - wrapper - Saving trained model at output/adaptation/g2/snli...
2021-04-21 10:13:46,459 - INFO - wrapper - best_dev_acc: 0.6875 | best_global_step: 200
2021-04-21 10:13:46,459 - INFO - wrapper - Saving models.
2021-04-21 10:14:43,705 - INFO - wrapper - Writing example 0
2021-04-21 10:14:45,139 - INFO - wrapper - {'acc': 0.6666666666666666}
2021-04-21 10:14:45,139 - INFO - wrapper - 1
2021-04-21 10:15:37,594 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-21 10:15:37,595 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-42 (num_examples=-1, set_type=test)
2021-04-21 10:15:37,656 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-21 10:15:37,684 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-21 10:15:37,685 - INFO - wrapper - Writing example 0
2021-04-21 10:20:47,587 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-21 10:20:47,587 - INFO - modeling - eval_results: {'acc': 0.7166226376752692}
2021-04-21 10:23:31,439 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:23:58,309 - INFO - transprompt_wrapper - {'acc': 0.9189540059347181}
2021-04-21 10:23:58,310 - INFO - transprompt_wrapper - 2
2021-04-21 10:32:48,226 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:33:15,417 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 10:33:15,417 - INFO - transprompt_wrapper - best_dev_acc: 0.9210 | best_global_step: 3600
2021-04-21 10:33:15,417 - INFO - transprompt_wrapper - Saving models.
2021-04-21 10:42:17,746 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:42:44,903 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 10:42:44,903 - INFO - transprompt_wrapper - best_dev_acc: 0.9253 | best_global_step: 4200
2021-04-21 10:42:44,903 - INFO - transprompt_wrapper - Saving models.
2021-04-21 10:51:19,633 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-12', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=12, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 10:51:19,633 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-12 (num_examples=-1, set_type=train)
2021-04-21 10:51:19,636 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-21 10:51:19,636 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-12 (num_examples=-1, set_type=dev)
2021-04-21 10:51:19,638 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-21 10:51:19,638 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 10:51:19,638 - INFO - run_task_adaptation - text_a=The monastery's museum traces the kingdom of Naples' long history in costumes, sculpture, paintings, and prints.
2021-04-21 10:51:19,638 - INFO - run_task_adaptation - text_b=The museum of the monastery does not show the long history of Naples and instead completely focuses on the history of other surrounding countries. 
2021-04-21 10:51:19,638 - INFO - run_task_adaptation - task=MNLI
2021-04-21 10:51:19,638 - INFO - run_task_adaptation - label=contradiction
2021-04-21 10:51:19,638 - INFO - run_task_adaptation - **********************************
2021-04-21 10:51:21,972 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 10:51:45,386 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:51:53,230 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 10:51:53,231 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:52:37,789 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:52:40,443 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 10:52:40,443 - INFO - transprompt_wrapper - best_dev_acc: 0.6667 | best_global_step: 100
2021-04-21 10:52:40,443 - INFO - transprompt_wrapper - Saving models.
2021-04-21 10:52:45,564 - INFO - transprompt_wrapper - {'acc': 0.9185830860534124}
2021-04-21 10:52:45,564 - INFO - transprompt_wrapper - 1
2021-04-21 10:53:52,882 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:53:56,253 - INFO - transprompt_wrapper - {'acc': 0.6458333333333334}
2021-04-21 10:53:56,253 - INFO - transprompt_wrapper - 1
2021-04-21 10:54:48,026 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:54:51,440 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 10:54:51,440 - INFO - transprompt_wrapper - best_dev_acc: 0.6667 | best_global_step: 300
2021-04-21 10:54:51,440 - INFO - transprompt_wrapper - Saving models.
2021-04-21 10:56:02,533 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:56:05,839 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g2...
2021-04-21 10:56:05,839 - INFO - transprompt_wrapper - best_dev_acc: 0.6875 | best_global_step: 400
2021-04-21 10:56:05,839 - INFO - transprompt_wrapper - Saving models.
2021-04-21 10:57:16,916 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:57:20,284 - INFO - transprompt_wrapper - {'acc': 0.6770833333333334}
2021-04-21 10:57:20,284 - INFO - transprompt_wrapper - 1
2021-04-21 10:58:11,370 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:58:14,603 - INFO - transprompt_wrapper - {'acc': 0.6354166666666666}
2021-04-21 10:58:14,603 - INFO - transprompt_wrapper - 2
2021-04-21 10:59:07,115 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 10:59:10,413 - INFO - transprompt_wrapper - {'acc': 0.6458333333333334}
2021-04-21 10:59:10,414 - INFO - transprompt_wrapper - 3
2021-04-21 11:00:02,960 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 11:00:06,190 - INFO - transprompt_wrapper - {'acc': 0.65625}
2021-04-21 11:00:06,190 - INFO - transprompt_wrapper - 4
2021-04-21 11:00:57,476 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 11:01:00,699 - INFO - transprompt_wrapper - {'acc': 0.65625}
2021-04-21 11:01:00,699 - INFO - transprompt_wrapper - 5
2021-04-21 11:01:53,834 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 11:01:56,937 - INFO - transprompt_wrapper - {'acc': 0.65625}
2021-04-21 11:01:56,937 - INFO - transprompt_wrapper - 6
2021-04-21 11:01:57,474 - INFO - modeling - Saving complete
2021-04-21 11:01:57,474 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 11:01:57,474 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 11:02:47,605 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 11:02:47,606 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 11:02:47,606 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-21 11:02:47,606 - INFO - wrapper - Writing example 0
2021-04-21 11:03:17,190 - INFO - wrapper - Writing example 0
2021-04-21 11:03:18,785 - INFO - wrapper - Saving trained model at output/adaptation/g2/mnli...
2021-04-21 11:03:18,785 - INFO - wrapper - best_dev_acc: 0.4375 | best_global_step: 100
2021-04-21 11:03:18,785 - INFO - wrapper - Saving models.
2021-04-21 11:04:04,443 - INFO - wrapper - Writing example 0
2021-04-21 11:04:05,793 - INFO - wrapper - Saving trained model at output/adaptation/g2/mnli...
2021-04-21 11:04:05,793 - INFO - wrapper - best_dev_acc: 0.6875 | best_global_step: 200
2021-04-21 11:04:05,793 - INFO - wrapper - Saving models.
2021-04-21 11:04:51,381 - INFO - wrapper - Writing example 0
2021-04-21 11:04:52,840 - INFO - wrapper - Saving trained model at output/adaptation/g2/mnli...
2021-04-21 11:04:52,840 - INFO - wrapper - best_dev_acc: 0.7083 | best_global_step: 300
2021-04-21 11:04:52,841 - INFO - wrapper - Saving models.
2021-04-21 11:06:04,156 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-21 11:06:04,156 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-12 (num_examples=-1, set_type=test)
2021-04-21 11:06:04,363 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-21 11:06:04,364 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-21 11:06:04,364 - INFO - wrapper - Writing example 0
2021-04-21 11:06:13,775 - INFO - wrapper - Writing example 10000
2021-04-21 11:07:18,238 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 11:08:16,778 - INFO - transprompt_wrapper - {'acc': 0.921179525222552}
2021-04-21 11:08:16,778 - INFO - transprompt_wrapper - 2
2021-04-21 11:16:10,332 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-21 11:16:10,333 - INFO - modeling - eval_results: {'acc': 0.6965948999847305}
2021-04-21 11:16:10,335 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-21 11:16:10,335 - INFO - wrapper - Writing example 0
2021-04-21 11:16:40,150 - INFO - wrapper - Writing example 0
2021-04-21 11:16:41,771 - INFO - wrapper - Saving trained model at output/adaptation/g2/snli...
2021-04-21 11:16:41,771 - INFO - wrapper - best_dev_acc: 0.7917 | best_global_step: 100
2021-04-21 11:16:41,771 - INFO - wrapper - Saving models.
2021-04-21 11:17:27,618 - INFO - wrapper - Writing example 0
2021-04-21 11:17:29,184 - INFO - wrapper - {'acc': 0.7708333333333334}
2021-04-21 11:17:29,184 - INFO - wrapper - 1
2021-04-21 11:17:59,056 - INFO - wrapper - Writing example 0
2021-04-21 11:18:00,523 - INFO - wrapper - Saving trained model at output/adaptation/g2/snli...
2021-04-21 11:18:00,523 - INFO - wrapper - best_dev_acc: 0.8125 | best_global_step: 300
2021-04-21 11:18:00,523 - INFO - wrapper - Saving models.
2021-04-21 11:19:12,428 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-21 11:19:12,428 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-12 (num_examples=-1, set_type=test)
2021-04-21 11:19:12,478 - INFO - task_processors - Returning 9842 test examples with label dist.: [('entailment', 3329), ('contradiction', 3278), ('neutral', 3235)]
2021-04-21 11:19:12,496 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-21 11:19:12,496 - INFO - wrapper - Writing example 0
2021-04-21 11:22:44,682 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 11:23:44,648 - INFO - transprompt_wrapper - {'acc': 0.9247032640949555}
2021-04-21 11:23:44,648 - INFO - transprompt_wrapper - 3
2021-04-21 11:24:08,395 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-21 11:24:08,395 - INFO - modeling - eval_results: {'acc': 0.7465962202804308}
2021-04-21 11:32:51,948 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 11:33:18,916 - INFO - transprompt_wrapper - {'acc': 0.9230341246290801}
2021-04-21 11:33:18,916 - INFO - transprompt_wrapper - 4
2021-04-21 11:39:13,459 - INFO - modeling - Saving complete
2021-04-21 11:39:13,459 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 11:39:13,459 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 11:39:32,114 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 11:39:32,122 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 11:39:32,125 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 11:39:32,125 - INFO - wrapper - Writing example 0
2021-04-21 11:43:30,823 - INFO - wrapper - Writing example 0
2021-04-21 11:43:38,711 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 11:43:38,711 - INFO - wrapper - best_dev_acc: 0.9344 | best_global_step: 600
2021-04-21 11:43:38,711 - INFO - wrapper - Saving models.
2021-04-21 11:47:36,532 - INFO - wrapper - Writing example 0
2021-04-21 11:47:44,151 - INFO - wrapper - {'acc': 0.9332953249714937}
2021-04-21 11:47:44,151 - INFO - wrapper - 1
2021-04-21 11:51:34,636 - INFO - wrapper - Writing example 0
2021-04-21 11:51:42,477 - INFO - wrapper - Saving trained model at output/adaptation/g1/sst-2...
2021-04-21 11:51:42,478 - INFO - wrapper - best_dev_acc: 0.9356 | best_global_step: 1800
2021-04-21 11:51:42,478 - INFO - wrapper - Saving models.
2021-04-21 11:52:08,057 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 11:52:08,057 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-21 11:52:08,066 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-21 11:52:08,066 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 11:52:08,066 - INFO - wrapper - Writing example 0
2021-04-21 11:52:11,859 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 11:52:11,859 - INFO - modeling - eval_results: {'acc': 0.9564220183486238}
2021-04-21 11:52:11,860 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 11:52:11,860 - INFO - wrapper - Writing example 0
2021-04-21 11:56:04,989 - INFO - wrapper - Writing example 0
2021-04-21 11:56:19,421 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 11:56:19,421 - INFO - wrapper - best_dev_acc: 0.9080 | best_global_step: 600
2021-04-21 11:56:19,421 - INFO - wrapper - Saving models.
2021-04-21 12:00:16,201 - INFO - wrapper - Writing example 0
2021-04-21 12:00:30,952 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 12:00:30,952 - INFO - wrapper - best_dev_acc: 0.9104 | best_global_step: 1200
2021-04-21 12:00:30,952 - INFO - wrapper - Saving models.
2021-04-21 12:04:29,675 - INFO - wrapper - Writing example 0
2021-04-21 12:04:44,627 - INFO - wrapper - Saving trained model at output/adaptation/g1/mr...
2021-04-21 12:04:44,627 - INFO - wrapper - best_dev_acc: 0.9104 | best_global_step: 1800
2021-04-21 12:04:44,627 - INFO - wrapper - Saving models.
2021-04-21 12:05:08,999 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 12:05:08,999 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-21 12:05:09,013 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-21 12:05:09,013 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 12:05:09,014 - INFO - wrapper - Writing example 0
2021-04-21 12:05:17,824 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 12:05:17,824 - INFO - modeling - eval_results: {'acc': 0.8985}
2021-04-21 12:05:17,825 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 12:05:17,825 - INFO - wrapper - Writing example 0
2021-04-21 12:09:08,806 - INFO - wrapper - Writing example 0
2021-04-21 12:09:10,059 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 12:09:10,059 - INFO - wrapper - best_dev_acc: 0.9403 | best_global_step: 600
2021-04-21 12:09:10,059 - INFO - wrapper - Saving models.
2021-04-21 12:13:05,717 - INFO - wrapper - Writing example 0
2021-04-21 12:13:06,937 - INFO - wrapper - Saving trained model at output/adaptation/g1/cr...
2021-04-21 12:13:06,938 - INFO - wrapper - best_dev_acc: 0.9440 | best_global_step: 1200
2021-04-21 12:13:06,938 - INFO - wrapper - Saving models.
2021-04-21 12:17:02,782 - INFO - wrapper - Writing example 0
2021-04-21 12:17:04,014 - INFO - wrapper - {'acc': 0.9402985074626866}
2021-04-21 12:17:04,014 - INFO - wrapper - 1
2021-04-21 12:17:25,771 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 12:17:25,772 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-21 12:17:25,830 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 12:17:25,833 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 12:17:25,833 - INFO - wrapper - Writing example 0
2021-04-21 12:17:34,697 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 12:17:34,697 - INFO - modeling - eval_results: {'acc': 0.905}
2021-04-21 13:29:54,517 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 13:29:54,517 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-42 (num_examples=-1, set_type=train)
2021-04-21 13:29:54,564 - INFO - task_processors - Returning 11965 train examples with label dist.: [(0, 5268), (1, 6697)]
2021-04-21 13:29:54,564 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-42 (num_examples=-1, set_type=dev)
2021-04-21 13:29:54,714 - INFO - task_processors - Returning 5392 dev examples with label dist.: [(0, 2741), (1, 2651)]
2021-04-21 13:29:54,714 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 13:29:54,714 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 13:29:54,714 - INFO - run_task_adaptation - text_b=None
2021-04-21 13:29:54,714 - INFO - run_task_adaptation - task=SST-2
2021-04-21 13:29:54,714 - INFO - run_task_adaptation - label=0
2021-04-21 13:29:54,714 - INFO - run_task_adaptation - **********************************
2021-04-21 13:29:57,862 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 13:30:17,283 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 13:30:17,284 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 13:30:24,725 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 13:39:18,936 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 13:39:45,234 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 13:39:45,234 - INFO - transprompt_wrapper - best_dev_acc: 0.9154 | best_global_step: 600
2021-04-21 13:39:45,234 - INFO - transprompt_wrapper - Saving models.
2021-04-21 13:48:44,640 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 13:49:11,015 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/adaptation/g1...
2021-04-21 13:49:11,015 - INFO - transprompt_wrapper - best_dev_acc: 0.9247 | best_global_step: 1200
2021-04-21 13:49:11,015 - INFO - transprompt_wrapper - Saving models.
2021-04-21 13:54:14,526 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 13:54:14,526 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-42 (num_examples=-1, set_type=train)
2021-04-21 13:54:14,578 - INFO - task_processors - Returning 11965 train examples with label dist.: [(0, 5268), (1, 6697)]
2021-04-21 13:54:14,579 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-42 (num_examples=-1, set_type=dev)
2021-04-21 13:54:14,801 - INFO - task_processors - Returning 5392 dev examples with label dist.: [(0, 2741), (1, 2651)]
2021-04-21 13:54:14,801 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 13:54:14,801 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 13:54:14,801 - INFO - run_task_adaptation - text_b=None
2021-04-21 13:54:14,801 - INFO - run_task_adaptation - task=SST-2
2021-04-21 13:54:14,801 - INFO - run_task_adaptation - label=0
2021-04-21 13:54:14,801 - INFO - run_task_adaptation - **********************************
2021-04-21 13:54:18,372 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 13:54:34,960 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 13:54:34,960 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 13:54:42,735 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 13:59:32,857 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 13:59:32,857 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-42 (num_examples=-1, set_type=train)
2021-04-21 13:59:32,903 - INFO - task_processors - Returning 11965 train examples with label dist.: [(0, 5268), (1, 6697)]
2021-04-21 13:59:32,903 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-42 (num_examples=-1, set_type=dev)
2021-04-21 13:59:33,044 - INFO - task_processors - Returning 5392 dev examples with label dist.: [(0, 2741), (1, 2651)]
2021-04-21 13:59:33,044 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 13:59:33,044 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 13:59:33,044 - INFO - run_task_adaptation - text_b=None
2021-04-21 13:59:33,044 - INFO - run_task_adaptation - task=SST-2
2021-04-21 13:59:33,044 - INFO - run_task_adaptation - label=0
2021-04-21 13:59:33,044 - INFO - run_task_adaptation - **********************************
2021-04-21 13:59:36,210 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 13:59:56,184 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 13:59:56,184 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:00:04,161 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 14:02:20,223 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-04-21 14:02:20,223 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-42 (num_examples=-1, set_type=train)
2021-04-21 14:02:20,269 - INFO - task_processors - Returning 11965 train examples with label dist.: [(0, 5268), (1, 6697)]
2021-04-21 14:02:20,269 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-42 (num_examples=-1, set_type=dev)
2021-04-21 14:02:20,420 - INFO - task_processors - Returning 5392 dev examples with label dist.: [(0, 2741), (1, 2651)]
2021-04-21 14:02:20,420 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 14:02:20,420 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-21 14:02:20,420 - INFO - run_task_adaptation - text_b=None
2021-04-21 14:02:20,420 - INFO - run_task_adaptation - task=SST-2
2021-04-21 14:02:20,420 - INFO - run_task_adaptation - label=0
2021-04-21 14:02:20,420 - INFO - run_task_adaptation - **********************************
2021-04-21 14:02:23,751 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 14:02:40,673 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 14:02:40,674 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:02:48,302 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 14:11:29,495 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:11:32,244 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=28000, pet_max_meta_steps=50000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-21 14:11:32,244 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=train)
2021-04-21 14:11:42,376 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-21 14:11:42,376 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=dev)
2021-04-21 14:11:45,040 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-21 14:11:45,041 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 14:11:45,041 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-21 14:11:45,041 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-21 14:11:45,041 - INFO - run_task_adaptation - task=MNLI
2021-04-21 14:11:45,041 - INFO - run_task_adaptation - label=contradiction
2021-04-21 14:11:45,041 - INFO - run_task_adaptation - **********************************
2021-04-21 14:11:50,885 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 14:11:56,791 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-04-21 14:11:56,792 - INFO - transprompt_wrapper - best_dev_acc: 0.9154 | best_global_step: 600
2021-04-21 14:11:56,792 - INFO - transprompt_wrapper - Saving models.
2021-04-21 14:12:12,255 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 14:12:12,255 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:17:48,602 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-21 14:17:48,602 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=train)
2021-04-21 14:17:48,605 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-04-21 14:17:48,605 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=dev)
2021-04-21 14:17:48,607 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-04-21 14:17:48,607 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 14:17:48,607 - INFO - run_task_adaptation - text_a=Bob Hope , the master of one-line quips , died Sunday night " with a smile on his face , " his daughter said yesterday .
2021-04-21 14:17:48,607 - INFO - run_task_adaptation - text_b=BOB HOPE , master of the one-liner and Americas favourite comedian , died with a smile on his face yesterday just months after celebrating his 100th birthday .
2021-04-21 14:17:48,607 - INFO - run_task_adaptation - task=MRPC
2021-04-21 14:17:48,607 - INFO - run_task_adaptation - label=0
2021-04-21 14:17:48,607 - INFO - run_task_adaptation - **********************************
2021-04-21 14:17:52,299 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 14:18:28,269 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 14:18:28,270 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:19:21,376 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:19:23,502 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-21 14:19:23,503 - INFO - transprompt_wrapper - best_dev_acc: 0.5469 | best_global_step: 100
2021-04-21 14:19:23,503 - INFO - transprompt_wrapper - Saving models.
2021-04-21 14:20:25,717 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:20:27,759 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-21 14:20:27,759 - INFO - transprompt_wrapper - best_dev_acc: 0.6406 | best_global_step: 200
2021-04-21 14:20:27,759 - INFO - transprompt_wrapper - Saving models.
2021-04-21 14:21:37,359 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:21:39,414 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-21 14:21:39,414 - INFO - transprompt_wrapper - best_dev_acc: 0.6406 | best_global_step: 300
2021-04-21 14:21:39,414 - INFO - transprompt_wrapper - Saving models.
2021-04-21 14:22:48,780 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:22:51,130 - INFO - transprompt_wrapper - {'acc': 0.609375}
2021-04-21 14:22:51,131 - INFO - transprompt_wrapper - 2
2021-04-21 14:23:05,159 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:23:33,849 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:23:35,572 - INFO - transprompt_wrapper - {'acc': 0.546875}
2021-04-21 14:23:35,572 - INFO - transprompt_wrapper - 3
2021-04-21 14:24:18,730 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:24:20,399 - INFO - transprompt_wrapper - {'acc': 0.625}
2021-04-21 14:24:20,399 - INFO - transprompt_wrapper - 4
2021-04-21 14:24:21,696 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-04-21 14:24:21,697 - INFO - transprompt_wrapper - best_dev_acc: 0.9221 | best_global_step: 1200
2021-04-21 14:24:21,697 - INFO - transprompt_wrapper - Saving models.
2021-04-21 14:25:03,830 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:25:06,157 - INFO - transprompt_wrapper - {'acc': 0.578125}
2021-04-21 14:25:06,157 - INFO - transprompt_wrapper - 5
2021-04-21 14:25:56,192 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:25:58,523 - INFO - transprompt_wrapper - {'acc': 0.609375}
2021-04-21 14:25:58,523 - INFO - transprompt_wrapper - 6
2021-04-21 14:26:49,035 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:26:51,023 - INFO - transprompt_wrapper - {'acc': 0.609375}
2021-04-21 14:26:51,023 - INFO - transprompt_wrapper - 7
2021-04-21 14:27:41,880 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:27:44,032 - INFO - transprompt_wrapper - {'acc': 0.609375}
2021-04-21 14:27:44,032 - INFO - transprompt_wrapper - 8
2021-04-21 14:27:44,582 - INFO - modeling - Saving complete
2021-04-21 14:27:44,583 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 14:27:44,583 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 14:28:28,094 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 14:28:28,094 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 14:28:28,094 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-04-21 14:28:28,094 - INFO - wrapper - Writing example 0
2021-04-21 14:28:57,429 - INFO - wrapper - Writing example 0
2021-04-21 14:28:58,253 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g3/mrpc...
2021-04-21 14:28:58,253 - INFO - wrapper - best_dev_acc: 0.4688 | best_global_step: 100
2021-04-21 14:28:58,253 - INFO - wrapper - Saving models.
2021-04-21 14:29:32,706 - INFO - wrapper - Writing example 0
2021-04-21 14:29:33,744 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g3/mrpc...
2021-04-21 14:29:33,744 - INFO - wrapper - best_dev_acc: 0.4688 | best_global_step: 200
2021-04-21 14:29:33,744 - INFO - wrapper - Saving models.
2021-04-21 14:30:17,322 - INFO - wrapper - Writing example 0
2021-04-21 14:30:18,252 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g3/mrpc...
2021-04-21 14:30:18,252 - INFO - wrapper - best_dev_acc: 0.4688 | best_global_step: 300
2021-04-21 14:30:18,252 - INFO - wrapper - Saving models.
2021-04-21 14:31:19,732 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mrpc
2021-04-21 14:31:19,732 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MRPC/16-42 (num_examples=-1, set_type=test)
2021-04-21 14:31:19,739 - INFO - task_processors - Returning 408 test examples with label dist.: [(1, 279), (0, 129)]
2021-04-21 14:31:19,739 - INFO - modeling - Group g3: Task mrpc 's Test examples number: 408
2021-04-21 14:31:19,739 - INFO - wrapper - Writing example 0
2021-04-21 14:31:31,930 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=mrpc) ---
2021-04-21 14:31:31,930 - INFO - modeling - eval_results: {'acc': 0.6887254901960784}
2021-04-21 14:31:31,931 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task qqp =========
2021-04-21 14:31:31,932 - INFO - wrapper - Writing example 0
2021-04-21 14:32:01,557 - INFO - wrapper - Writing example 0
2021-04-21 14:32:02,830 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g3/qqp...
2021-04-21 14:32:02,831 - INFO - wrapper - best_dev_acc: 0.7500 | best_global_step: 100
2021-04-21 14:32:02,831 - INFO - wrapper - Saving models.
2021-04-21 14:32:37,491 - INFO - wrapper - Writing example 0
2021-04-21 14:32:38,536 - INFO - wrapper - {'acc': 0.59375}
2021-04-21 14:32:38,537 - INFO - wrapper - 1
2021-04-21 14:33:09,092 - INFO - wrapper - Writing example 0
2021-04-21 14:33:10,122 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g3/qqp...
2021-04-21 14:33:10,122 - INFO - wrapper - best_dev_acc: 0.7500 | best_global_step: 300
2021-04-21 14:33:10,122 - INFO - wrapper - Saving models.
2021-04-21 14:34:12,836 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task qqp
2021-04-21 14:34:12,836 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/QQP/16-42 (num_examples=-1, set_type=test)
2021-04-21 14:34:13,471 - INFO - task_processors - Returning 40429 test examples with label dist.: [(0, 25544), (1, 14885)]
2021-04-21 14:34:13,472 - INFO - modeling - Group g3: Task qqp 's Test examples number: 40429
2021-04-21 14:34:13,472 - INFO - wrapper - Writing example 0
2021-04-21 14:36:47,362 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:37:13,705 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-04-21 14:37:13,705 - INFO - transprompt_wrapper - best_dev_acc: 0.9269 | best_global_step: 1800
2021-04-21 14:37:13,705 - INFO - transprompt_wrapper - Saving models.
2021-04-21 14:46:01,456 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:46:27,918 - INFO - transprompt_wrapper - {'acc': 0.9132047477744807}
2021-04-21 14:46:27,918 - INFO - transprompt_wrapper - 1
2021-04-21 14:55:22,782 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 14:55:48,879 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-04-21 14:55:48,880 - INFO - transprompt_wrapper - best_dev_acc: 0.9297 | best_global_step: 3000
2021-04-21 14:55:48,880 - INFO - transprompt_wrapper - Saving models.
2021-04-21 14:57:15,434 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=28000, pet_max_meta_steps=50000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-21 14:57:15,435 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=train)
2021-04-21 14:57:25,142 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-21 14:57:25,142 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=dev)
2021-04-21 14:57:27,681 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-21 14:57:27,681 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 14:57:27,681 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-21 14:57:27,681 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-21 14:57:27,681 - INFO - run_task_adaptation - task=MNLI
2021-04-21 14:57:27,681 - INFO - run_task_adaptation - label=contradiction
2021-04-21 14:57:27,681 - INFO - run_task_adaptation - **********************************
2021-04-21 14:57:31,158 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 14:57:55,988 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 14:57:55,988 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 15:00:34,829 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=28000, pet_max_meta_steps=50000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-21 15:00:34,829 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=train)
2021-04-21 15:00:45,883 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-21 15:00:45,884 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=dev)
2021-04-21 15:00:49,301 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-21 15:00:49,301 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 15:00:49,301 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-21 15:00:49,301 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-21 15:00:49,301 - INFO - run_task_adaptation - task=MNLI
2021-04-21 15:00:49,301 - INFO - run_task_adaptation - label=contradiction
2021-04-21 15:00:49,301 - INFO - run_task_adaptation - **********************************
2021-04-21 15:00:52,047 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 15:01:15,274 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 15:01:15,274 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 15:04:48,710 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 15:05:14,861 - INFO - transprompt_wrapper - {'acc': 0.9234050445103857}
2021-04-21 15:05:14,861 - INFO - transprompt_wrapper - 1
2021-04-21 15:14:00,261 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 15:14:26,925 - INFO - transprompt_wrapper - {'acc': 0.925259643916914}
2021-04-21 15:14:26,925 - INFO - transprompt_wrapper - 2
2021-04-21 15:23:15,098 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 15:23:40,951 - INFO - transprompt_wrapper - {'acc': 0.9269287833827893}
2021-04-21 15:23:40,951 - INFO - transprompt_wrapper - 3
2021-04-21 15:32:33,188 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 15:32:59,332 - INFO - transprompt_wrapper - {'acc': 0.9245178041543026}
2021-04-21 15:32:59,332 - INFO - transprompt_wrapper - 4
2021-04-21 15:41:53,119 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 15:42:19,132 - INFO - transprompt_wrapper - {'acc': 0.9295252225519288}
2021-04-21 15:42:19,133 - INFO - transprompt_wrapper - 5
2021-04-21 15:51:05,196 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 15:51:31,857 - INFO - transprompt_wrapper - {'acc': 0.9267433234421365}
2021-04-21 15:51:31,858 - INFO - transprompt_wrapper - 6
2021-04-21 15:57:29,785 - INFO - modeling - Saving complete
2021-04-21 15:57:29,785 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-21 15:57:29,785 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-21 15:57:49,579 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-21 15:57:49,587 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-21 15:57:49,590 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-21 15:57:49,590 - INFO - wrapper - Writing example 0
2021-04-21 15:58:51,402 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=28000, pet_max_meta_steps=50000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-21 15:58:51,402 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=train)
2021-04-21 15:59:05,334 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-21 15:59:05,334 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=dev)
2021-04-21 15:59:08,745 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-21 15:59:08,745 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 15:59:08,748 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-21 15:59:08,749 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-21 15:59:08,749 - INFO - run_task_adaptation - task=MNLI
2021-04-21 15:59:08,749 - INFO - run_task_adaptation - label=contradiction
2021-04-21 15:59:08,749 - INFO - run_task_adaptation - **********************************
2021-04-21 15:59:13,323 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 15:59:34,793 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 15:59:34,794 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 16:01:46,908 - INFO - wrapper - Writing example 0
2021-04-21 16:01:54,227 - INFO - wrapper - Saving trained model at output/full/adaptation/g1/sst-2...
2021-04-21 16:01:54,227 - INFO - wrapper - best_dev_acc: 0.9487 | best_global_step: 600
2021-04-21 16:01:54,227 - INFO - wrapper - Saving models.
2021-04-21 16:05:50,530 - INFO - wrapper - Writing example 0
2021-04-21 16:05:58,098 - INFO - wrapper - Saving trained model at output/full/adaptation/g1/sst-2...
2021-04-21 16:05:58,099 - INFO - wrapper - best_dev_acc: 0.9527 | best_global_step: 1200
2021-04-21 16:05:58,099 - INFO - wrapper - Saving models.
2021-04-21 16:09:58,344 - INFO - wrapper - Writing example 0
2021-04-21 16:10:05,647 - INFO - wrapper - {'acc': 0.9498289623717218}
2021-04-21 16:10:05,647 - INFO - wrapper - 1
2021-04-21 16:10:22,489 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=28000, pet_max_meta_steps=50000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-21 16:10:22,489 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=train)
2021-04-21 16:10:26,386 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-21 16:10:26,386 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-21 16:10:26,396 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-21 16:10:26,396 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-21 16:10:26,397 - INFO - wrapper - Writing example 0
2021-04-21 16:10:30,605 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-21 16:10:30,605 - INFO - modeling - eval_results: {'acc': 0.9426605504587156}
2021-04-21 16:10:30,606 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-21 16:10:30,607 - INFO - wrapper - Writing example 0
2021-04-21 16:10:33,527 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-21 16:10:33,527 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=dev)
2021-04-21 16:10:36,624 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-21 16:10:36,624 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 16:10:36,624 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-21 16:10:36,625 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-21 16:10:36,625 - INFO - run_task_adaptation - task=MNLI
2021-04-21 16:10:36,625 - INFO - run_task_adaptation - label=contradiction
2021-04-21 16:10:36,625 - INFO - run_task_adaptation - **********************************
2021-04-21 16:10:39,915 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 16:11:01,732 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 16:11:01,733 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 16:14:30,592 - INFO - wrapper - Writing example 0
2021-04-21 16:14:44,702 - INFO - wrapper - Saving trained model at output/full/adaptation/g1/mr...
2021-04-21 16:14:44,702 - INFO - wrapper - best_dev_acc: 0.9089 | best_global_step: 600
2021-04-21 16:14:44,702 - INFO - wrapper - Saving models.
2021-04-21 16:18:42,783 - INFO - wrapper - Writing example 0
2021-04-21 16:18:56,795 - INFO - wrapper - Saving trained model at output/full/adaptation/g1/mr...
2021-04-21 16:18:56,796 - INFO - wrapper - best_dev_acc: 0.9110 | best_global_step: 1200
2021-04-21 16:18:56,796 - INFO - wrapper - Saving models.
2021-04-21 16:22:55,968 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=28000, pet_max_meta_steps=50000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-21 16:22:55,968 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=train)
2021-04-21 16:22:57,570 - INFO - wrapper - Writing example 0
2021-04-21 16:23:05,949 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-21 16:23:05,949 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=dev)
2021-04-21 16:23:08,590 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-21 16:23:08,590 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 16:23:08,590 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-21 16:23:08,590 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-21 16:23:08,590 - INFO - run_task_adaptation - task=MNLI
2021-04-21 16:23:08,590 - INFO - run_task_adaptation - label=contradiction
2021-04-21 16:23:08,590 - INFO - run_task_adaptation - **********************************
2021-04-21 16:23:11,689 - INFO - wrapper - Saving trained model at output/full/adaptation/g1/mr...
2021-04-21 16:23:11,689 - INFO - wrapper - best_dev_acc: 0.9148 | best_global_step: 1800
2021-04-21 16:23:11,689 - INFO - wrapper - Saving models.
2021-04-21 16:23:12,363 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 16:23:30,829 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 16:23:30,830 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 16:23:39,306 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-21 16:23:39,306 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-21 16:23:39,322 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 16:23:39,323 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-21 16:23:39,323 - INFO - wrapper - Writing example 0
2021-04-21 16:23:40,154 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 16:23:47,887 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-21 16:23:47,887 - INFO - modeling - eval_results: {'acc': 0.8895}
2021-04-21 16:23:47,888 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-21 16:23:47,889 - INFO - wrapper - Writing example 0
2021-04-21 16:23:48,671 - INFO - transprompt_wrapper - Writing example 20000
2021-04-21 16:23:57,019 - INFO - transprompt_wrapper - Writing example 30000
2021-04-21 16:24:05,247 - INFO - transprompt_wrapper - Writing example 40000
2021-04-21 16:24:40,828 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=28000, pet_max_meta_steps=50000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-21 16:24:40,828 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=train)
2021-04-21 16:24:51,858 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-21 16:24:51,858 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=dev)
2021-04-21 16:24:55,386 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-21 16:24:55,386 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-21 16:24:55,386 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-21 16:24:55,386 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-21 16:24:55,386 - INFO - run_task_adaptation - task=MNLI
2021-04-21 16:24:55,386 - INFO - run_task_adaptation - label=contradiction
2021-04-21 16:24:55,386 - INFO - run_task_adaptation - **********************************
2021-04-21 16:24:59,710 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-21 16:25:22,310 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-21 16:25:22,310 - INFO - transprompt_wrapper - Writing example 0
2021-04-21 16:25:31,748 - INFO - transprompt_wrapper - Writing example 10000
2021-04-21 16:25:40,012 - INFO - transprompt_wrapper - Writing example 20000
2021-04-21 16:25:48,086 - INFO - transprompt_wrapper - Writing example 30000
2021-04-21 16:25:56,093 - INFO - transprompt_wrapper - Writing example 40000
2021-04-21 16:26:04,102 - INFO - transprompt_wrapper - Writing example 50000
2021-04-21 16:26:11,975 - INFO - transprompt_wrapper - Writing example 60000
2021-04-21 16:26:23,294 - INFO - transprompt_wrapper - Writing example 70000
2021-04-21 16:26:31,167 - INFO - transprompt_wrapper - Writing example 80000
2021-04-21 16:26:39,031 - INFO - transprompt_wrapper - Writing example 90000
2021-04-21 16:26:46,829 - INFO - transprompt_wrapper - Writing example 100000
2021-04-21 16:26:54,676 - INFO - transprompt_wrapper - Writing example 110000
2021-04-21 16:27:39,975 - INFO - wrapper - Writing example 0
2021-04-21 16:27:41,168 - INFO - wrapper - Saving trained model at output/full/adaptation/g1/cr...
2021-04-21 16:27:41,169 - INFO - wrapper - best_dev_acc: 0.9440 | best_global_step: 600
2021-04-21 16:27:41,169 - INFO - wrapper - Saving models.
2021-04-21 16:31:31,835 - INFO - wrapper - Writing example 0
2021-04-21 16:31:32,997 - INFO - wrapper - {'acc': 0.9402985074626866}
2021-04-21 16:31:32,998 - INFO - wrapper - 1
2021-04-21 16:35:21,134 - INFO - wrapper - Writing example 0
2021-04-21 16:35:22,309 - INFO - wrapper - Saving trained model at output/full/adaptation/g1/cr...
2021-04-21 16:35:22,309 - INFO - wrapper - best_dev_acc: 0.9440 | best_global_step: 1800
2021-04-21 16:35:22,309 - INFO - wrapper - Saving models.
2021-04-21 16:35:48,893 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-21 16:35:48,893 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-21 16:35:48,907 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-21 16:35:48,908 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-21 16:35:48,908 - INFO - wrapper - Writing example 0
2021-04-21 16:35:57,154 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-21 16:35:57,155 - INFO - modeling - eval_results: {'acc': 0.8995}
2021-04-22 02:36:16,902 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=28000, pet_max_meta_steps=50000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-22 02:36:16,902 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=train)
2021-04-22 02:36:28,086 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-22 02:36:28,086 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-42 (num_examples=-1, set_type=dev)
2021-04-22 02:36:30,659 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-22 02:36:30,659 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 02:36:30,659 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-22 02:36:30,659 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-22 02:36:30,659 - INFO - run_task_adaptation - task=MNLI
2021-04-22 02:36:30,659 - INFO - run_task_adaptation - label=contradiction
2021-04-22 02:36:30,659 - INFO - run_task_adaptation - **********************************
2021-04-22 02:36:33,493 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 02:36:50,239 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 02:36:50,239 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 02:36:59,385 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 02:37:07,385 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 02:37:15,201 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 02:37:22,926 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 02:37:30,612 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 02:37:41,025 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 02:37:48,643 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 02:37:56,245 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 02:38:03,853 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 02:38:11,401 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 02:38:18,943 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 02:38:25,953 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 02:38:32,880 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 02:38:45,487 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 02:38:52,645 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 02:38:59,772 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 02:39:06,879 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 02:39:13,985 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 02:39:21,091 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 02:39:28,195 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 02:39:35,269 - INFO - transprompt_wrapper - Writing example 210000
2021-04-22 02:39:42,361 - INFO - transprompt_wrapper - Writing example 220000
2021-04-22 02:39:49,447 - INFO - transprompt_wrapper - Writing example 230000
2021-04-22 02:39:56,529 - INFO - transprompt_wrapper - Writing example 240000
2021-04-22 02:40:10,254 - INFO - transprompt_wrapper - Writing example 250000
2021-04-22 02:40:17,888 - INFO - transprompt_wrapper - Writing example 260000
2021-04-22 02:40:25,805 - INFO - transprompt_wrapper - Writing example 270000
2021-04-22 02:40:33,326 - INFO - transprompt_wrapper - Writing example 280000
2021-04-22 02:40:40,802 - INFO - transprompt_wrapper - Writing example 290000
2021-04-22 02:40:48,277 - INFO - transprompt_wrapper - Writing example 300000
2021-04-22 02:40:55,721 - INFO - transprompt_wrapper - Writing example 310000
2021-04-22 02:41:03,155 - INFO - transprompt_wrapper - Writing example 320000
2021-04-22 02:41:10,581 - INFO - transprompt_wrapper - Writing example 330000
2021-04-22 02:41:18,008 - INFO - transprompt_wrapper - Writing example 340000
2021-04-22 02:41:25,440 - INFO - transprompt_wrapper - Writing example 350000
2021-04-22 02:41:32,738 - INFO - transprompt_wrapper - Writing example 360000
2021-04-22 02:41:48,559 - INFO - transprompt_wrapper - Writing example 370000
2021-04-22 02:41:55,401 - INFO - transprompt_wrapper - Writing example 380000
2021-04-22 02:42:02,265 - INFO - transprompt_wrapper - Writing example 390000
2021-04-22 02:42:09,123 - INFO - transprompt_wrapper - Writing example 400000
2021-04-22 02:42:15,988 - INFO - transprompt_wrapper - Writing example 410000
2021-04-22 02:42:22,837 - INFO - transprompt_wrapper - Writing example 420000
2021-04-22 02:42:29,683 - INFO - transprompt_wrapper - Writing example 430000
2021-04-22 02:42:36,604 - INFO - transprompt_wrapper - Writing example 440000
2021-04-22 02:42:43,753 - INFO - transprompt_wrapper - Writing example 450000
2021-04-22 02:42:50,659 - INFO - transprompt_wrapper - Writing example 460000
2021-04-22 02:42:57,554 - INFO - transprompt_wrapper - Writing example 470000
2021-04-22 02:43:04,428 - INFO - transprompt_wrapper - Writing example 480000
2021-04-22 02:43:11,300 - INFO - transprompt_wrapper - Writing example 490000
2021-04-22 02:43:18,577 - INFO - transprompt_wrapper - Writing example 500000
2021-04-22 02:43:26,067 - INFO - transprompt_wrapper - Writing example 510000
2021-04-22 02:43:33,525 - INFO - transprompt_wrapper - Writing example 520000
2021-04-22 02:43:53,509 - INFO - transprompt_wrapper - Writing example 530000
2021-04-22 02:44:00,979 - INFO - transprompt_wrapper - Writing example 540000
2021-04-22 02:44:08,400 - INFO - transprompt_wrapper - Writing example 550000
2021-04-22 02:44:15,866 - INFO - transprompt_wrapper - Writing example 560000
2021-04-22 02:44:23,303 - INFO - transprompt_wrapper - Writing example 570000
2021-04-22 02:44:30,742 - INFO - transprompt_wrapper - Writing example 580000
2021-04-22 02:44:38,168 - INFO - transprompt_wrapper - Writing example 590000
2021-04-22 02:44:45,605 - INFO - transprompt_wrapper - Writing example 600000
2021-04-22 02:44:52,767 - INFO - transprompt_wrapper - Writing example 610000
2021-04-22 02:44:59,680 - INFO - transprompt_wrapper - Writing example 620000
2021-04-22 02:45:06,604 - INFO - transprompt_wrapper - Writing example 630000
2021-04-22 02:45:13,537 - INFO - transprompt_wrapper - Writing example 640000
2021-04-22 02:45:20,464 - INFO - transprompt_wrapper - Writing example 650000
2021-04-22 02:45:27,384 - INFO - transprompt_wrapper - Writing example 660000
2021-04-22 02:45:34,310 - INFO - transprompt_wrapper - Writing example 670000
2021-04-22 02:45:41,248 - INFO - transprompt_wrapper - Writing example 680000
2021-04-22 02:45:48,184 - INFO - transprompt_wrapper - Writing example 690000
2021-04-22 02:45:55,123 - INFO - transprompt_wrapper - Writing example 700000
2021-04-22 02:46:02,049 - INFO - transprompt_wrapper - Writing example 710000
2021-04-22 02:46:27,992 - INFO - transprompt_wrapper - Writing example 720000
2021-04-22 02:46:34,984 - INFO - transprompt_wrapper - Writing example 730000
2021-04-22 03:13:15,066 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 03:13:15,066 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 03:13:15,069 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 03:13:15,069 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 03:13:15,071 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 03:13:15,071 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 03:13:15,071 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 03:13:15,071 - INFO - run_task_adaptation - text_b=None
2021-04-22 03:13:15,071 - INFO - run_task_adaptation - task=SST-2
2021-04-22 03:13:15,071 - INFO - run_task_adaptation - label=0
2021-04-22 03:13:15,071 - INFO - run_task_adaptation - **********************************
2021-04-22 03:13:18,179 - INFO - wrapper - ========= This is 'Prompt Encoder' =========
2021-04-22 03:13:50,990 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 03:13:50,990 - INFO - wrapper - Writing example 0
2021-04-22 03:14:40,810 - INFO - wrapper - Writing example 0
2021-04-22 03:14:44,193 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1...
2021-04-22 03:14:44,193 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-22 03:14:44,193 - INFO - wrapper - Saving models.
2021-04-22 03:15:41,005 - INFO - wrapper - Writing example 0
2021-04-22 03:15:44,267 - INFO - wrapper - {'acc': 0.8645833333333334}
2021-04-22 03:15:44,267 - INFO - wrapper - 1
2021-04-22 03:16:34,506 - INFO - wrapper - Writing example 0
2021-04-22 03:16:37,874 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-22 03:16:37,874 - INFO - wrapper - 2
2021-04-22 03:17:27,966 - INFO - wrapper - Writing example 0
2021-04-22 03:17:31,229 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-22 03:17:31,230 - INFO - wrapper - 3
2021-04-22 03:18:20,794 - INFO - wrapper - Writing example 0
2021-04-22 03:18:23,961 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-22 03:18:23,961 - INFO - wrapper - 4
2021-04-22 03:19:13,386 - INFO - wrapper - Writing example 0
2021-04-22 03:19:16,271 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-22 03:19:16,271 - INFO - wrapper - 5
2021-04-22 03:20:05,732 - INFO - wrapper - Writing example 0
2021-04-22 03:20:08,766 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-22 03:20:08,767 - INFO - wrapper - 6
2021-04-22 03:20:58,303 - INFO - wrapper - Writing example 0
2021-04-22 03:21:01,546 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-22 03:21:01,547 - INFO - wrapper - 7
2021-04-22 03:21:50,569 - INFO - wrapper - Writing example 0
2021-04-22 03:21:54,003 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-22 03:21:54,003 - INFO - wrapper - 8
2021-04-22 03:22:43,579 - INFO - wrapper - Writing example 0
2021-04-22 03:22:46,995 - INFO - wrapper - {'acc': 0.8958333333333334}
2021-04-22 03:22:46,995 - INFO - wrapper - 9
2021-04-22 03:22:47,614 - INFO - modeling - Saving complete
2021-04-22 03:22:47,614 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 03:22:47,614 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 03:22:47,701 - INFO - wrapper - ========= This is 'Prompt Encoder' =========
2021-04-22 03:23:33,295 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 03:23:33,295 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 03:23:33,295 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 03:23:33,295 - INFO - wrapper - Writing example 0
2021-04-22 03:24:03,972 - INFO - wrapper - Writing example 0
2021-04-22 03:24:05,010 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 03:24:05,010 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-22 03:24:05,010 - INFO - wrapper - Saving models.
2021-04-22 03:24:38,011 - INFO - wrapper - Writing example 0
2021-04-22 03:24:39,214 - INFO - wrapper - {'acc': 0.90625}
2021-04-22 03:24:39,214 - INFO - wrapper - 1
2021-04-22 03:25:09,540 - INFO - wrapper - Writing example 0
2021-04-22 03:25:10,809 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 03:25:10,809 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-22 03:25:10,809 - INFO - wrapper - Saving models.
2021-04-22 03:25:26,103 - INFO - wrapper - ========= This is 'Prompt Encoder' =========
2021-04-22 03:26:10,776 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 03:26:10,777 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-22 03:26:10,785 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-22 03:26:10,785 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 03:26:10,785 - INFO - wrapper - Writing example 0
2021-04-22 03:26:39,501 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 03:26:39,501 - INFO - modeling - eval_results: {'acc': 0.9162844036697247}
2021-04-22 03:26:39,503 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 03:26:39,504 - INFO - wrapper - Writing example 0
2021-04-22 03:27:10,558 - INFO - wrapper - Writing example 0
2021-04-22 03:27:11,376 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1/mr...
2021-04-22 03:27:11,376 - INFO - wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-22 03:27:11,376 - INFO - wrapper - Saving models.
2021-04-22 03:27:47,523 - INFO - wrapper - Writing example 0
2021-04-22 03:27:48,809 - INFO - wrapper - {'acc': 0.875}
2021-04-22 03:27:48,809 - INFO - wrapper - 1
2021-04-22 03:28:19,058 - INFO - wrapper - Writing example 0
2021-04-22 03:28:20,185 - INFO - wrapper - {'acc': 0.875}
2021-04-22 03:28:20,185 - INFO - wrapper - 2
2021-04-22 03:28:20,634 - INFO - wrapper - ========= This is 'Prompt Encoder' =========
2021-04-22 03:29:07,796 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-22 03:29:07,796 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-22 03:29:07,811 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-22 03:29:07,812 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-22 03:29:07,812 - INFO - wrapper - Writing example 0
2021-04-22 03:30:13,754 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-22 03:30:13,754 - INFO - modeling - eval_results: {'acc': 0.8735}
2021-04-22 03:30:13,775 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-22 03:30:13,775 - INFO - wrapper - Writing example 0
2021-04-22 03:30:43,883 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 03:30:43,883 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-22 03:30:43,886 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 03:30:43,886 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-22 03:30:43,888 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 03:30:43,889 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 03:30:43,889 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-22 03:30:43,889 - INFO - run_task_adaptation - text_b=None
2021-04-22 03:30:43,889 - INFO - run_task_adaptation - task=SST-2
2021-04-22 03:30:43,889 - INFO - run_task_adaptation - label=0
2021-04-22 03:30:43,889 - INFO - run_task_adaptation - **********************************
2021-04-22 03:30:46,215 - INFO - wrapper - ========= This is 'Prompt Encoder' =========
2021-04-22 03:31:18,847 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 03:31:18,847 - INFO - wrapper - Writing example 0
2021-04-22 03:32:09,960 - INFO - wrapper - Writing example 0
2021-04-22 03:32:12,988 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1...
2021-04-22 03:32:12,988 - INFO - wrapper - best_dev_acc: 0.8542 | best_global_step: 100
2021-04-22 03:32:12,988 - INFO - wrapper - Saving models.
2021-04-22 03:33:18,757 - INFO - wrapper - Writing example 0
2021-04-22 03:33:22,020 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1...
2021-04-22 03:33:22,020 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-22 03:33:22,020 - INFO - wrapper - Saving models.
2021-04-22 03:34:28,167 - INFO - wrapper - Writing example 0
2021-04-22 03:34:31,535 - INFO - wrapper - {'acc': 0.8645833333333334}
2021-04-22 03:34:31,535 - INFO - wrapper - 1
2021-04-22 03:35:21,238 - INFO - wrapper - Writing example 0
2021-04-22 03:35:24,201 - INFO - wrapper - {'acc': 0.84375}
2021-04-22 03:35:24,202 - INFO - wrapper - 2
2021-04-22 03:36:13,509 - INFO - wrapper - Writing example 0
2021-04-22 03:36:16,441 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1...
2021-04-22 03:36:16,442 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 500
2021-04-22 03:36:16,442 - INFO - wrapper - Saving models.
2021-04-22 03:37:22,549 - INFO - wrapper - Writing example 0
2021-04-22 03:37:25,972 - INFO - wrapper - {'acc': 0.8645833333333334}
2021-04-22 03:37:25,972 - INFO - wrapper - 4
2021-04-22 03:38:15,078 - INFO - wrapper - Writing example 0
2021-04-22 03:38:18,220 - INFO - wrapper - {'acc': 0.8645833333333334}
2021-04-22 03:38:18,220 - INFO - wrapper - 5
2021-04-22 03:39:06,668 - INFO - wrapper - Writing example 0
2021-04-22 03:39:09,787 - INFO - wrapper - {'acc': 0.8645833333333334}
2021-04-22 03:39:09,787 - INFO - wrapper - 6
2021-04-22 03:39:59,176 - INFO - wrapper - Writing example 0
2021-04-22 03:40:02,556 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1...
2021-04-22 03:40:02,556 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 900
2021-04-22 03:40:02,556 - INFO - wrapper - Saving models.
2021-04-22 03:41:09,476 - INFO - wrapper - Writing example 0
2021-04-22 03:41:12,899 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1...
2021-04-22 03:41:12,899 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 1000
2021-04-22 03:41:12,899 - INFO - wrapper - Saving models.
2021-04-22 03:41:30,310 - INFO - modeling - Saving complete
2021-04-22 03:41:30,310 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 03:41:30,310 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 03:41:30,399 - INFO - wrapper - ========= This is 'Prompt Encoder' =========
2021-04-22 03:42:12,172 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 03:42:12,173 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 03:42:12,173 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 03:42:12,173 - INFO - wrapper - Writing example 0
2021-04-22 03:42:42,221 - INFO - wrapper - Writing example 0
2021-04-22 03:42:43,325 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 03:42:43,325 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-22 03:42:43,325 - INFO - wrapper - Saving models.
2021-04-22 03:43:28,120 - INFO - wrapper - Writing example 0
2021-04-22 03:43:29,134 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 03:43:29,134 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-22 03:43:29,134 - INFO - wrapper - Saving models.
2021-04-22 03:44:14,987 - INFO - wrapper - Writing example 0
2021-04-22 03:44:16,290 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 03:44:16,290 - INFO - wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-22 03:44:16,290 - INFO - wrapper - Saving models.
2021-04-22 03:44:31,349 - INFO - wrapper - ========= This is 'Prompt Encoder' =========
2021-04-22 03:45:17,094 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 03:45:17,095 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-22 03:45:17,103 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-22 03:45:17,103 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 03:45:17,103 - INFO - wrapper - Writing example 0
2021-04-22 03:45:45,681 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 03:45:45,682 - INFO - modeling - eval_results: {'acc': 0.9059633027522935}
2021-04-22 03:45:45,683 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 03:45:45,684 - INFO - wrapper - Writing example 0
2021-04-22 03:46:16,285 - INFO - wrapper - Writing example 0
2021-04-22 03:46:17,538 - INFO - wrapper - Saving trained model at output/few-shot/adaptation/g1/mr...
2021-04-22 03:46:17,538 - INFO - wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-22 03:46:17,538 - INFO - wrapper - Saving models.
2021-04-22 03:49:50,708 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 03:49:50,709 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 03:49:50,712 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 03:49:50,712 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 03:49:50,714 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 03:49:50,714 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 03:49:50,714 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 03:49:50,714 - INFO - run_task_adaptation - text_b=None
2021-04-22 03:49:50,714 - INFO - run_task_adaptation - task=SST-2
2021-04-22 03:49:50,714 - INFO - run_task_adaptation - label=0
2021-04-22 03:49:50,714 - INFO - run_task_adaptation - **********************************
2021-04-22 03:49:53,153 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 03:50:26,903 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 03:50:26,903 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:51:23,516 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:51:26,912 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 03:51:26,912 - INFO - transprompt_wrapper - best_dev_acc: 0.8333 | best_global_step: 100
2021-04-22 03:51:26,913 - INFO - transprompt_wrapper - Saving models.
2021-04-22 03:52:44,049 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:52:47,834 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 03:52:47,835 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 200
2021-04-22 03:52:47,835 - INFO - transprompt_wrapper - Saving models.
2021-04-22 03:52:49,110 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:52:57,224 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 03:53:04,758 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 03:53:11,757 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 03:53:18,754 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 03:53:25,732 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 03:53:32,675 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 03:53:37,311 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:53:38,665 - INFO - transprompt_wrapper - {'acc': 0.8854166666666666}
2021-04-22 03:53:38,665 - INFO - transprompt_wrapper - 1
2021-04-22 03:53:39,715 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 03:53:47,184 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 03:53:54,461 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 03:54:01,330 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 03:54:07,610 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:54:08,228 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 03:54:08,962 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 03:54:08,962 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 400
2021-04-22 03:54:08,962 - INFO - transprompt_wrapper - Saving models.
2021-04-22 03:54:15,121 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 03:54:21,967 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 03:54:29,096 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 03:54:36,608 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 03:54:43,815 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 03:54:50,739 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 03:54:57,691 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:54:57,711 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 03:54:59,047 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 03:54:59,048 - INFO - transprompt_wrapper - 1
2021-04-22 03:55:04,685 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 03:55:11,618 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 03:55:31,181 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:55:34,106 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 03:55:34,106 - INFO - transprompt_wrapper - 2
2021-04-22 03:56:22,949 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:56:25,916 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 03:56:25,916 - INFO - transprompt_wrapper - 3
2021-04-22 03:57:15,029 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:57:17,906 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 03:57:17,906 - INFO - transprompt_wrapper - 4
2021-04-22 03:58:07,202 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:58:10,113 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 03:58:10,114 - INFO - transprompt_wrapper - 5
2021-04-22 03:58:59,358 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 03:59:02,266 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 03:59:02,266 - INFO - transprompt_wrapper - 6
2021-04-22 03:59:02,589 - INFO - modeling - Saving complete
2021-04-22 03:59:02,589 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 03:59:02,589 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 03:59:02,672 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 03:59:51,090 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 03:59:51,091 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 03:59:51,091 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 03:59:51,091 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:00:19,402 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:00:20,542 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:00:20,542 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 100
2021-04-22 04:00:20,542 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:01:06,801 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:01:07,882 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:01:07,882 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 200
2021-04-22 04:01:07,884 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:01:53,775 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:01:54,905 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:01:54,905 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 300
2021-04-22 04:01:54,905 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:07:50,249 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 04:07:50,249 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 04:07:50,252 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 04:07:50,252 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 04:07:50,254 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 04:07:50,254 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 04:07:50,254 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 04:07:50,254 - INFO - run_task_adaptation - text_b=None
2021-04-22 04:07:50,254 - INFO - run_task_adaptation - task=SST-2
2021-04-22 04:07:50,254 - INFO - run_task_adaptation - label=0
2021-04-22 04:07:50,254 - INFO - run_task_adaptation - **********************************
2021-04-22 04:07:52,703 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:08:26,524 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 04:08:26,620 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:09:09,176 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 04:09:09,177 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 04:09:09,177 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 04:09:09,177 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:09:37,901 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:09:39,092 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:09:39,092 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-22 04:09:39,092 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:10:24,409 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:10:25,550 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:10:25,551 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-22 04:10:25,551 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:11:11,975 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:11:13,134 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:11:13,135 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-22 04:11:13,135 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:11:31,369 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:12:18,875 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 04:12:18,875 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-22 04:12:18,885 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-22 04:12:18,885 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 04:12:18,885 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:12:45,050 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 04:12:45,051 - INFO - modeling - eval_results: {'acc': 0.9323394495412844}
2021-04-22 04:12:45,052 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 04:12:45,052 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:13:11,319 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:13:12,277 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 04:13:12,277 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-22 04:13:12,277 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:13:57,339 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:13:58,471 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 04:13:58,471 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-22 04:13:58,471 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:14:44,502 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:14:45,642 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 04:14:45,642 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-22 04:14:45,642 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:15:04,286 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:15:53,814 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-22 04:15:53,815 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-22 04:15:53,829 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-22 04:15:53,830 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-22 04:15:53,830 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:16:52,157 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-22 04:16:52,157 - INFO - modeling - eval_results: {'acc': 0.8815}
2021-04-22 04:16:52,158 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-22 04:16:52,159 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:17:21,480 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:17:22,620 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 04:17:22,620 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-22 04:17:22,620 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:17:56,472 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:17:57,540 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 04:17:57,540 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-22 04:17:57,540 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:18:45,807 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:18:46,702 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 04:18:46,702 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-22 04:18:46,702 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:19:05,009 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:19:50,610 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-22 04:19:50,611 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-22 04:19:50,905 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-22 04:19:50,906 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-22 04:19:50,907 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:20:48,945 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-22 04:20:48,946 - INFO - modeling - eval_results: {'acc': 0.9085}
2021-04-22 04:22:12,795 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 04:22:12,796 - INFO - transprompt_wrapper - best_dev_acc: 0.8563 | best_global_step: 2500
2021-04-22 04:22:12,796 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:27:10,936 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=60, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=180, pet_max_meta_steps=512, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=80, weight_decay=0.1)
2021-04-22 04:27:10,937 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-22 04:27:10,940 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 04:27:10,940 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-22 04:27:10,942 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 04:27:10,942 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 04:27:10,942 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-22 04:27:10,942 - INFO - run_task_adaptation - text_b=None
2021-04-22 04:27:10,942 - INFO - run_task_adaptation - task=SST-2
2021-04-22 04:27:10,942 - INFO - run_task_adaptation - label=0
2021-04-22 04:27:10,942 - INFO - run_task_adaptation - **********************************
2021-04-22 04:27:13,545 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:27:47,168 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 04:27:47,168 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:28:31,868 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:28:36,377 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 04:28:36,377 - INFO - transprompt_wrapper - best_dev_acc: 0.8646 | best_global_step: 60
2021-04-22 04:28:36,377 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:29:40,892 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:29:45,450 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-22 04:29:45,451 - INFO - transprompt_wrapper - 1
2021-04-22 04:30:29,324 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:30:33,835 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 04:30:33,837 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 180
2021-04-22 04:30:33,837 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:31:38,033 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:31:42,384 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-22 04:31:42,384 - INFO - transprompt_wrapper - 1
2021-04-22 04:32:26,642 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:32:31,177 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-22 04:32:31,177 - INFO - transprompt_wrapper - 2
2021-04-22 04:33:15,740 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:33:20,223 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-22 04:33:20,223 - INFO - transprompt_wrapper - 3
2021-04-22 04:34:02,952 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:34:07,449 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-22 04:34:07,449 - INFO - transprompt_wrapper - 4
2021-04-22 04:34:50,442 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:34:54,975 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-22 04:34:54,976 - INFO - transprompt_wrapper - 5
2021-04-22 04:35:19,113 - INFO - modeling - Saving complete
2021-04-22 04:35:19,114 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 04:35:19,114 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 04:35:19,201 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:36:03,310 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 04:36:03,311 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 04:36:03,311 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 04:36:03,311 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:36:25,321 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:36:26,877 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:36:26,877 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 60
2021-04-22 04:36:26,877 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:37:05,528 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:37:07,103 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:37:07,103 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 120
2021-04-22 04:37:07,103 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:37:46,952 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:37:48,696 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:37:48,697 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 180
2021-04-22 04:37:48,697 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:38:07,544 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:38:53,622 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 04:38:53,622 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-22 04:38:53,631 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-22 04:38:53,631 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 04:38:53,631 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:39:34,551 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 04:39:34,551 - INFO - modeling - eval_results: {'acc': 0.9162844036697247}
2021-04-22 04:39:34,553 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 04:39:34,554 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:42:49,518 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=24, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=192, pet_max_meta_steps=256, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=12, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=60, weight_decay=0.1)
2021-04-22 04:42:49,518 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 04:42:49,522 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 04:42:49,522 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 04:42:49,524 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 04:42:49,524 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 04:42:49,524 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 04:42:49,524 - INFO - run_task_adaptation - text_b=None
2021-04-22 04:42:49,524 - INFO - run_task_adaptation - task=SST-2
2021-04-22 04:42:49,524 - INFO - run_task_adaptation - label=0
2021-04-22 04:42:49,524 - INFO - run_task_adaptation - **********************************
2021-04-22 04:42:52,486 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:43:27,915 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 04:43:27,916 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:43:50,263 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:43:54,002 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 04:43:54,002 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 24
2021-04-22 04:43:54,002 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:44:37,027 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:44:40,471 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 04:44:40,471 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 48
2021-04-22 04:44:40,471 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:45:23,270 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:45:26,761 - INFO - transprompt_wrapper - {'acc': 0.8541666666666666}
2021-04-22 04:45:26,762 - INFO - transprompt_wrapper - 1
2021-04-22 04:45:48,746 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:45:52,396 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 04:45:52,396 - INFO - transprompt_wrapper - 2
2021-04-22 04:46:14,128 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:46:17,868 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 04:46:17,868 - INFO - transprompt_wrapper - 3
2021-04-22 04:46:39,573 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:46:43,324 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:46:43,324 - INFO - transprompt_wrapper - 4
2021-04-22 04:47:05,083 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:47:08,818 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 04:47:08,818 - INFO - transprompt_wrapper - 5
2021-04-22 04:47:30,365 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:47:34,137 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:47:34,137 - INFO - transprompt_wrapper - 6
2021-04-22 04:47:55,818 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:47:59,480 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 04:47:59,481 - INFO - transprompt_wrapper - 7
2021-04-22 04:48:21,244 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:48:24,619 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 04:48:24,619 - INFO - transprompt_wrapper - 8
2021-04-22 04:48:40,076 - INFO - modeling - Saving complete
2021-04-22 04:48:40,076 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 04:48:40,076 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 04:48:40,180 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:49:28,330 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 04:49:28,330 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 04:49:28,330 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 04:49:28,330 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:49:36,088 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:49:37,374 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:49:37,374 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 24
2021-04-22 04:49:37,374 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:50:03,567 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:50:04,854 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:50:04,854 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 48
2021-04-22 04:50:04,855 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:50:28,821 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:50:29,757 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:50:29,757 - INFO - transprompt_wrapper - 1
2021-04-22 04:50:37,219 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:50:38,470 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:50:38,470 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 96
2021-04-22 04:50:38,470 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:51:04,373 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:51:05,717 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:51:05,717 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 120
2021-04-22 04:51:05,717 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:51:31,484 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:51:32,613 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:51:32,613 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 144
2021-04-22 04:51:32,613 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:51:58,560 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:52:00,074 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:52:00,074 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 168
2021-04-22 04:52:00,074 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:52:25,804 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:52:26,752 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 04:52:26,752 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 192
2021-04-22 04:52:26,752 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:52:45,772 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:53:34,922 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 04:53:34,923 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-22 04:53:34,931 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-22 04:53:34,931 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 04:53:34,931 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:54:05,864 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 04:54:05,865 - INFO - modeling - eval_results: {'acc': 0.9254587155963303}
2021-04-22 04:54:05,868 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 04:54:05,868 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:54:14,202 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:54:15,123 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 04:54:15,124 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 24
2021-04-22 04:54:15,124 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:54:41,078 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:54:42,387 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 04:54:42,387 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 48
2021-04-22 04:54:42,387 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:55:08,945 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:55:10,030 - INFO - transprompt_wrapper - {'acc': 0.75}
2021-04-22 04:55:10,030 - INFO - transprompt_wrapper - 1
2021-04-22 04:55:18,000 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:55:19,296 - INFO - transprompt_wrapper - {'acc': 0.71875}
2021-04-22 04:55:19,296 - INFO - transprompt_wrapper - 2
2021-04-22 04:55:27,181 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:55:28,511 - INFO - transprompt_wrapper - {'acc': 0.8125}
2021-04-22 04:55:28,511 - INFO - transprompt_wrapper - 3
2021-04-22 04:55:36,086 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:55:37,527 - INFO - transprompt_wrapper - {'acc': 0.8125}
2021-04-22 04:55:37,528 - INFO - transprompt_wrapper - 4
2021-04-22 04:55:45,282 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:55:46,662 - INFO - transprompt_wrapper - {'acc': 0.8125}
2021-04-22 04:55:46,662 - INFO - transprompt_wrapper - 5
2021-04-22 04:55:54,452 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:55:55,346 - INFO - transprompt_wrapper - {'acc': 0.8125}
2021-04-22 04:55:55,346 - INFO - transprompt_wrapper - 6
2021-04-22 04:55:55,647 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 04:56:44,687 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-22 04:56:44,687 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-22 04:56:44,703 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-22 04:56:44,703 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-22 04:56:44,703 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:57:56,533 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-22 04:57:56,533 - INFO - modeling - eval_results: {'acc': 0.873}
2021-04-22 04:57:56,535 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-22 04:57:56,535 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:58:04,359 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:58:05,588 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 04:58:05,588 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 24
2021-04-22 04:58:05,588 - INFO - transprompt_wrapper - Saving models.
2021-04-22 04:58:31,442 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:58:32,528 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:58:32,528 - INFO - transprompt_wrapper - 1
2021-04-22 04:58:40,544 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:58:41,859 - INFO - transprompt_wrapper - {'acc': 0.8125}
2021-04-22 04:58:41,859 - INFO - transprompt_wrapper - 2
2021-04-22 04:58:49,609 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:58:51,074 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:58:51,075 - INFO - transprompt_wrapper - 3
2021-04-22 04:58:58,929 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:59:00,056 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:59:00,056 - INFO - transprompt_wrapper - 4
2021-04-22 04:59:07,850 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:59:09,151 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:59:09,152 - INFO - transprompt_wrapper - 5
2021-04-22 04:59:17,217 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:59:18,171 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:59:18,171 - INFO - transprompt_wrapper - 6
2021-04-22 04:59:26,348 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 04:59:27,585 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 04:59:27,585 - INFO - transprompt_wrapper - 7
2021-04-22 04:59:28,040 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 05:00:16,548 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-22 05:00:16,548 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-22 05:00:16,863 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-22 05:00:16,865 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-22 05:00:16,865 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:01:27,948 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-22 05:01:27,948 - INFO - modeling - eval_results: {'acc': 0.903}
2021-04-22 05:09:36,638 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 05:09:36,639 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 05:09:36,642 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 05:09:36,642 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 05:09:36,643 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 05:09:36,643 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 05:09:36,644 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 05:09:36,644 - INFO - run_task_adaptation - text_b=None
2021-04-22 05:09:36,644 - INFO - run_task_adaptation - task=SST-2
2021-04-22 05:09:36,644 - INFO - run_task_adaptation - label=0
2021-04-22 05:09:36,644 - INFO - run_task_adaptation - **********************************
2021-04-22 05:09:39,584 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 05:10:19,545 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 05:10:19,546 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:11:17,837 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:11:21,106 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 05:11:21,107 - INFO - transprompt_wrapper - best_dev_acc: 0.8333 | best_global_step: 100
2021-04-22 05:11:21,107 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:12:38,110 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:12:41,824 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 05:12:41,824 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 200
2021-04-22 05:12:41,824 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:13:58,934 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:14:02,637 - INFO - transprompt_wrapper - {'acc': 0.8854166666666666}
2021-04-22 05:14:02,637 - INFO - transprompt_wrapper - 1
2021-04-22 05:14:59,063 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:15:02,799 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 05:15:02,800 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 400
2021-04-22 05:15:02,800 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:16:19,683 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:16:22,963 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 05:16:22,963 - INFO - transprompt_wrapper - 1
2021-04-22 05:17:18,015 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:17:21,375 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 05:17:21,376 - INFO - transprompt_wrapper - 2
2021-04-22 05:18:17,563 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:18:21,342 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 05:18:21,343 - INFO - transprompt_wrapper - 3
2021-04-22 05:19:17,724 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:19:21,373 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 05:19:21,374 - INFO - transprompt_wrapper - 4
2021-04-22 05:20:16,762 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:20:20,269 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 05:20:20,269 - INFO - transprompt_wrapper - 5
2021-04-22 05:21:16,494 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:21:19,598 - INFO - transprompt_wrapper - {'acc': 0.9166666666666666}
2021-04-22 05:21:19,598 - INFO - transprompt_wrapper - 6
2021-04-22 05:21:20,105 - INFO - modeling - Saving complete
2021-04-22 05:21:20,105 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 05:21:20,106 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 05:21:20,192 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 05:22:05,210 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 05:22:05,211 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 05:22:05,211 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 05:22:05,211 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:22:37,639 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:22:38,959 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 05:22:38,959 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 100
2021-04-22 05:22:38,959 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:23:29,494 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:23:30,630 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 05:23:30,630 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 200
2021-04-22 05:23:30,630 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:24:20,685 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:24:22,316 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 05:24:22,316 - INFO - transprompt_wrapper - best_dev_acc: 0.8438 | best_global_step: 300
2021-04-22 05:24:22,316 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:24:40,422 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 05:25:27,957 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 05:25:27,958 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-22 05:25:27,966 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-22 05:25:27,966 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 05:25:27,966 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:25:59,516 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 05:25:59,516 - INFO - modeling - eval_results: {'acc': 0.8577981651376146}
2021-04-22 05:25:59,518 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 05:25:59,519 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:26:29,736 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:26:30,718 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 05:26:30,718 - INFO - transprompt_wrapper - best_dev_acc: 0.8125 | best_global_step: 100
2021-04-22 05:26:30,718 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:27:21,429 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:27:22,768 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 05:27:22,768 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-22 05:27:22,768 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:28:12,873 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:28:13,931 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 05:28:13,931 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 300
2021-04-22 05:28:13,931 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:28:32,784 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 05:29:23,534 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-22 05:29:23,534 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-22 05:29:23,549 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-22 05:29:23,550 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-22 05:29:23,550 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:30:34,416 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-22 05:30:34,416 - INFO - modeling - eval_results: {'acc': 0.8595}
2021-04-22 05:30:34,418 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-22 05:30:34,419 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:31:08,118 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:31:09,089 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 05:31:09,089 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-22 05:31:09,089 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:31:21,493 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:31:32,741 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 05:31:40,761 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 05:31:46,750 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:31:47,219 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 05:31:47,219 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-22 05:31:47,219 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:31:47,994 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 05:31:55,188 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 05:32:02,344 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 05:32:09,480 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 05:32:16,766 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 05:32:24,502 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:32:24,946 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 05:32:24,946 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-22 05:32:24,946 - INFO - transprompt_wrapper - Saving models.
2021-04-22 05:32:28,447 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 05:32:35,912 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 05:32:43,016 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 05:32:43,428 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 05:32:50,088 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 05:32:57,138 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 05:33:04,252 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 05:33:11,601 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 05:33:19,218 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 05:33:26,596 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 05:33:28,575 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-22 05:33:28,575 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-22 05:33:28,829 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-22 05:33:28,830 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-22 05:33:28,830 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 05:33:38,864 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 05:33:45,993 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 05:33:53,118 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 05:33:56,482 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-22 05:33:56,482 - INFO - modeling - eval_results: {'acc': 0.904}
2021-04-22 05:34:00,308 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 05:54:19,044 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 05:54:19,044 - INFO - transprompt_wrapper - best_dev_acc: 0.8696 | best_global_step: 5000
2021-04-22 05:54:19,044 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:01:11,300 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 06:01:11,300 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 06:01:11,303 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 06:01:11,303 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 06:01:11,305 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 06:01:11,305 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 06:01:11,305 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 06:01:11,305 - INFO - run_task_adaptation - text_b=None
2021-04-22 06:01:11,305 - INFO - run_task_adaptation - task=SST-2
2021-04-22 06:01:11,305 - INFO - run_task_adaptation - label=0
2021-04-22 06:01:11,305 - INFO - run_task_adaptation - **********************************
2021-04-22 06:01:16,356 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:01:50,102 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 06:01:50,102 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:02:46,709 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:02:50,144 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:02:50,145 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-22 06:02:50,145 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:04:07,611 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:04:11,012 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:04:11,012 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-22 06:04:11,014 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:05:26,495 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:05:29,595 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:05:29,595 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 300
2021-04-22 06:05:29,595 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:06:46,101 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:06:49,222 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-22 06:06:49,222 - INFO - transprompt_wrapper - 1
2021-04-22 06:07:45,002 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:07:48,611 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 06:07:48,611 - INFO - transprompt_wrapper - 2
2021-04-22 06:08:43,382 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:08:47,070 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 06:08:47,070 - INFO - transprompt_wrapper - 3
2021-04-22 06:09:42,069 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:09:45,743 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 06:09:45,743 - INFO - transprompt_wrapper - 4
2021-04-22 06:10:40,550 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:10:44,143 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 06:10:44,143 - INFO - transprompt_wrapper - 5
2021-04-22 06:11:38,959 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:11:42,573 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 06:11:42,573 - INFO - transprompt_wrapper - 6
2021-04-22 06:12:37,506 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:12:41,054 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 06:12:41,054 - INFO - transprompt_wrapper - 7
2021-04-22 06:12:41,617 - INFO - modeling - Saving complete
2021-04-22 06:12:41,617 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 06:12:41,617 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 06:12:41,700 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:13:25,627 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 06:13:25,627 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 06:13:25,627 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 06:13:25,627 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:13:56,424 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:13:57,487 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 06:13:57,487 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-22 06:13:57,487 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:14:46,872 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:14:48,038 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 06:14:48,039 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-22 06:14:48,039 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:15:37,438 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:15:38,480 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 06:15:38,481 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-22 06:15:38,481 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:15:56,419 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:16:47,644 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 06:16:47,645 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-22 06:16:47,772 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-22 06:16:47,773 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 06:16:47,773 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:17:18,400 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 06:17:18,400 - INFO - modeling - eval_results: {'acc': 0.9254587155963303}
2021-04-22 06:17:18,402 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 06:17:18,403 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:17:50,149 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:17:51,163 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 06:17:51,163 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-22 06:17:51,164 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:18:42,098 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:18:43,016 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 06:18:43,016 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-22 06:18:43,016 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:19:33,293 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:19:34,708 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 06:19:34,708 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 300
2021-04-22 06:19:34,708 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:19:52,698 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:20:42,230 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-22 06:20:42,230 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-22 06:20:42,246 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-22 06:20:42,247 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-22 06:20:42,247 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:21:52,943 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-22 06:21:52,943 - INFO - modeling - eval_results: {'acc': 0.8715}
2021-04-22 06:21:52,945 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-22 06:21:52,946 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:22:25,544 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:22:26,967 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 06:22:26,967 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-22 06:22:26,967 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:23:18,046 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:23:19,027 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 06:23:19,028 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-22 06:23:19,028 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:24:10,233 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:24:11,454 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 06:24:11,454 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-22 06:24:11,456 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:24:30,393 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:25:18,280 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-22 06:25:18,281 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-22 06:25:18,295 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-22 06:25:18,296 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-22 06:25:18,296 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:26:28,428 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-22 06:26:28,429 - INFO - modeling - eval_results: {'acc': 0.9055}
2021-04-22 06:29:59,899 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-12', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=12, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 06:29:59,899 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-12 (num_examples=-1, set_type=train)
2021-04-22 06:29:59,903 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 06:29:59,903 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-12 (num_examples=-1, set_type=dev)
2021-04-22 06:29:59,905 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 06:29:59,905 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 06:29:59,905 - INFO - run_task_adaptation - text_a=unfortunately , we 'd prefer a simple misfire .
2021-04-22 06:29:59,906 - INFO - run_task_adaptation - text_b=None
2021-04-22 06:29:59,906 - INFO - run_task_adaptation - task=SST-2
2021-04-22 06:29:59,906 - INFO - run_task_adaptation - label=0
2021-04-22 06:29:59,906 - INFO - run_task_adaptation - **********************************
2021-04-22 06:30:03,231 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:30:36,155 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 06:30:36,155 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:31:32,679 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:31:36,133 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:31:36,134 - INFO - transprompt_wrapper - best_dev_acc: 0.8958 | best_global_step: 100
2021-04-22 06:31:36,134 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:32:53,227 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:32:56,271 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-22 06:32:56,272 - INFO - transprompt_wrapper - 1
2021-04-22 06:33:52,943 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:33:56,273 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:33:56,274 - INFO - transprompt_wrapper - best_dev_acc: 0.8958 | best_global_step: 300
2021-04-22 06:33:56,274 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:35:16,563 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:35:19,731 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:35:19,731 - INFO - transprompt_wrapper - best_dev_acc: 0.8958 | best_global_step: 400
2021-04-22 06:35:19,731 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:36:37,816 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:36:41,418 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:36:41,418 - INFO - transprompt_wrapper - best_dev_acc: 0.9271 | best_global_step: 500
2021-04-22 06:36:41,418 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:38:00,782 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:38:04,437 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:38:04,437 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 600
2021-04-22 06:38:04,437 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:39:23,427 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:39:26,879 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:39:26,879 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 700
2021-04-22 06:39:26,879 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:40:46,932 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:40:50,371 - INFO - transprompt_wrapper - {'acc': 0.9270833333333334}
2021-04-22 06:40:50,371 - INFO - transprompt_wrapper - 2
2021-04-22 06:41:46,200 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:41:49,964 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:41:49,964 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 900
2021-04-22 06:41:49,964 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:43:09,119 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:43:12,590 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 06:43:12,590 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 1000
2021-04-22 06:43:12,590 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:43:36,965 - INFO - modeling - Saving complete
2021-04-22 06:43:36,965 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 06:43:36,965 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 06:43:37,054 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:44:25,750 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 06:44:25,751 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 06:44:25,751 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 06:44:25,751 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:44:57,992 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:44:59,080 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 06:44:59,081 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-22 06:44:59,081 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:45:49,456 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:45:50,778 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 06:45:50,778 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-22 06:45:50,778 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:46:40,816 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:46:41,842 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 06:46:41,842 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-22 06:46:41,842 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:46:59,989 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:47:48,637 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 06:47:48,637 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-12 (num_examples=-1, set_type=test)
2021-04-22 06:47:48,751 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-22 06:47:48,751 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 06:47:48,751 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:48:19,314 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 06:48:19,314 - INFO - modeling - eval_results: {'acc': 0.908256880733945}
2021-04-22 06:48:19,317 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 06:48:19,317 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:48:51,733 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:48:52,720 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 06:48:52,720 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-22 06:48:52,720 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:49:41,201 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:49:42,497 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 06:49:42,497 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-22 06:49:42,497 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:50:31,121 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:50:32,428 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 06:50:32,428 - INFO - transprompt_wrapper - best_dev_acc: 0.8750 | best_global_step: 300
2021-04-22 06:50:32,428 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:50:50,258 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:51:36,368 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-22 06:51:36,368 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-12 (num_examples=-1, set_type=test)
2021-04-22 06:51:36,380 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-22 06:51:36,380 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-22 06:51:36,380 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:52:45,684 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-22 06:52:45,684 - INFO - modeling - eval_results: {'acc': 0.875}
2021-04-22 06:52:45,686 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-22 06:52:45,687 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:53:17,070 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:53:18,104 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 06:53:18,104 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-22 06:53:18,104 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:54:09,126 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:54:10,274 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 06:54:10,274 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-22 06:54:10,274 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:55:01,093 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:55:02,395 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-22 06:55:02,395 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-22 06:55:02,395 - INFO - transprompt_wrapper - Saving models.
2021-04-22 06:55:20,154 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 06:56:05,274 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-22 06:56:05,274 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-12 (num_examples=-1, set_type=test)
2021-04-22 06:56:05,286 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-22 06:56:05,288 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-22 06:56:05,288 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 06:57:16,627 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-22 06:57:16,627 - INFO - modeling - eval_results: {'acc': 0.9}
2021-04-22 07:03:35,134 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 07:03:42,722 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 07:03:50,068 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 07:03:56,953 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 07:04:03,831 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 07:04:10,710 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 07:04:20,339 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 07:04:27,402 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 07:04:35,015 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 07:04:42,266 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 07:04:49,186 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 07:04:56,055 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 07:05:02,918 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 07:05:09,827 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 07:05:16,995 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 07:05:28,919 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 07:05:36,892 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 07:05:44,072 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 07:05:51,317 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 07:05:58,677 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 07:06:05,782 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 07:26:15,059 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 07:26:15,060 - INFO - transprompt_wrapper - best_dev_acc: 0.8760 | best_global_step: 7500
2021-04-22 07:26:15,060 - INFO - transprompt_wrapper - Saving models.
2021-04-22 07:56:55,129 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 07:56:55,129 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-04-22 07:56:55,133 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-22 07:56:55,133 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-04-22 07:56:55,135 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-22 07:56:55,135 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 07:56:55,135 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-22 07:56:55,135 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-22 07:56:55,135 - INFO - run_task_adaptation - task=MNLI
2021-04-22 07:56:55,135 - INFO - run_task_adaptation - label=contradiction
2021-04-22 07:56:55,135 - INFO - run_task_adaptation - **********************************
2021-04-22 07:56:58,873 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 07:57:16,833 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 07:57:16,835 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-04-22 07:57:16,839 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-22 07:57:16,839 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-04-22 07:57:16,840 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-22 07:57:16,841 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 07:57:16,841 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-22 07:57:16,841 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-22 07:57:16,841 - INFO - run_task_adaptation - task=MNLI
2021-04-22 07:57:16,841 - INFO - run_task_adaptation - label=contradiction
2021-04-22 07:57:16,841 - INFO - run_task_adaptation - **********************************
2021-04-22 07:57:19,533 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 07:57:51,655 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 07:57:51,655 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 07:58:48,883 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 07:58:52,278 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-22 07:58:52,278 - INFO - transprompt_wrapper - best_dev_acc: 0.5938 | best_global_step: 100
2021-04-22 07:58:52,278 - INFO - transprompt_wrapper - Saving models.
2021-04-22 07:59:59,443 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:00:02,899 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-22 08:00:02,899 - INFO - transprompt_wrapper - best_dev_acc: 0.7083 | best_global_step: 200
2021-04-22 08:00:02,899 - INFO - transprompt_wrapper - Saving models.
2021-04-22 08:01:15,713 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:01:19,253 - INFO - transprompt_wrapper - {'acc': 0.6666666666666666}
2021-04-22 08:01:19,253 - INFO - transprompt_wrapper - 1
2021-04-22 08:02:13,507 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:02:17,256 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-22 08:02:17,256 - INFO - transprompt_wrapper - best_dev_acc: 0.7083 | best_global_step: 400
2021-04-22 08:02:17,256 - INFO - transprompt_wrapper - Saving models.
2021-04-22 08:03:30,071 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:03:33,500 - INFO - transprompt_wrapper - {'acc': 0.6875}
2021-04-22 08:03:33,500 - INFO - transprompt_wrapper - 3
2021-04-22 08:04:27,871 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:04:31,678 - INFO - transprompt_wrapper - {'acc': 0.6875}
2021-04-22 08:04:31,678 - INFO - transprompt_wrapper - 4
2021-04-22 08:05:26,031 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:05:29,738 - INFO - transprompt_wrapper - {'acc': 0.6979166666666666}
2021-04-22 08:05:29,738 - INFO - transprompt_wrapper - 5
2021-04-22 08:06:23,950 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:06:27,505 - INFO - transprompt_wrapper - {'acc': 0.6875}
2021-04-22 08:06:27,505 - INFO - transprompt_wrapper - 6
2021-04-22 08:07:21,809 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:07:25,022 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-22 08:07:25,023 - INFO - transprompt_wrapper - best_dev_acc: 0.7188 | best_global_step: 900
2021-04-22 08:07:25,023 - INFO - transprompt_wrapper - Saving models.
2021-04-22 08:08:37,652 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:08:41,335 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-22 08:08:41,335 - INFO - transprompt_wrapper - best_dev_acc: 0.7188 | best_global_step: 1000
2021-04-22 08:08:41,335 - INFO - transprompt_wrapper - Saving models.
2021-04-22 08:09:00,285 - INFO - modeling - Saving complete
2021-04-22 08:09:00,285 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 08:09:00,285 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 08:09:00,377 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 08:09:46,778 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 08:09:46,779 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 08:09:46,779 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-22 08:09:46,779 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:10:19,021 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:10:20,750 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-22 08:10:20,750 - INFO - transprompt_wrapper - best_dev_acc: 0.6667 | best_global_step: 100
2021-04-22 08:10:20,750 - INFO - transprompt_wrapper - Saving models.
2021-04-22 08:10:56,208 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:10:58,067 - INFO - transprompt_wrapper - {'acc': 0.625}
2021-04-22 08:10:58,067 - INFO - transprompt_wrapper - 1
2021-04-22 08:11:29,366 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:11:31,260 - INFO - transprompt_wrapper - {'acc': 0.625}
2021-04-22 08:11:31,260 - INFO - transprompt_wrapper - 2
2021-04-22 08:11:31,567 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 08:12:17,649 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-22 08:12:17,649 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-04-22 08:12:18,237 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-22 08:12:18,237 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-22 08:12:18,237 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:12:26,815 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 08:24:09,056 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-22 08:24:09,056 - INFO - modeling - eval_results: {'acc': 0.6609151524405762}
2021-04-22 08:24:09,058 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-22 08:24:09,059 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:24:42,747 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:24:44,383 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-22 08:24:44,383 - INFO - transprompt_wrapper - best_dev_acc: 0.8542 | best_global_step: 100
2021-04-22 08:24:44,383 - INFO - transprompt_wrapper - Saving models.
2021-04-22 08:25:24,817 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:25:26,696 - INFO - transprompt_wrapper - {'acc': 0.6041666666666666}
2021-04-22 08:25:26,696 - INFO - transprompt_wrapper - 1
2021-04-22 08:25:59,456 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:26:01,047 - INFO - transprompt_wrapper - {'acc': 0.75}
2021-04-22 08:26:01,048 - INFO - transprompt_wrapper - 2
2021-04-22 08:26:01,561 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 08:26:52,074 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-22 08:26:52,074 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-04-22 08:26:52,163 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-04-22 08:26:52,176 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-22 08:26:52,177 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:30:51,109 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:30:58,574 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 08:31:06,041 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 08:31:15,333 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 08:31:22,301 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 08:31:29,231 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 08:31:31,242 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-22 08:31:31,242 - INFO - modeling - eval_results: {'acc': 0.7711847185531396}
2021-04-22 08:31:36,160 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 08:31:43,258 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 08:31:50,652 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 08:31:57,898 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 08:32:04,811 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 08:32:15,416 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 08:32:22,266 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 08:32:29,156 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 08:32:36,303 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 08:32:43,706 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 08:32:50,890 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 08:32:57,844 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 08:33:04,794 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 08:33:11,704 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 08:33:24,178 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 08:53:26,128 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 08:53:26,128 - INFO - transprompt_wrapper - best_dev_acc: 0.8795 | best_global_step: 10000
2021-04-22 08:53:26,128 - INFO - transprompt_wrapper - Saving models.
2021-04-22 08:54:32,568 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 08:54:32,568 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 08:54:32,572 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 08:54:32,572 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 08:54:32,574 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 08:54:32,574 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 08:54:32,574 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 08:54:32,574 - INFO - run_task_adaptation - text_b=None
2021-04-22 08:54:32,574 - INFO - run_task_adaptation - task=SST-2
2021-04-22 08:54:32,574 - INFO - run_task_adaptation - label=0
2021-04-22 08:54:32,574 - INFO - run_task_adaptation - **********************************
2021-04-22 08:54:35,386 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 08:55:11,198 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 08:55:11,199 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:56:07,486 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:56:10,796 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 08:56:10,796 - INFO - transprompt_wrapper - best_dev_acc: 0.8229 | best_global_step: 100
2021-04-22 08:56:10,796 - INFO - transprompt_wrapper - Saving models.
2021-04-22 08:57:27,772 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:57:31,324 - INFO - transprompt_wrapper - {'acc': 0.6770833333333334}
2021-04-22 08:57:31,324 - INFO - transprompt_wrapper - 1
2021-04-22 08:58:27,694 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:58:30,938 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 08:58:30,938 - INFO - transprompt_wrapper - 2
2021-04-22 08:59:27,322 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 08:59:30,410 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 08:59:30,411 - INFO - transprompt_wrapper - 3
2021-04-22 09:00:26,333 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:00:29,614 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 09:00:29,614 - INFO - transprompt_wrapper - 4
2021-04-22 09:01:26,438 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:01:29,826 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 09:01:29,826 - INFO - transprompt_wrapper - 5
2021-04-22 09:02:25,139 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:02:28,774 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 09:02:28,774 - INFO - transprompt_wrapper - 6
2021-04-22 09:03:24,769 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:03:28,228 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 09:03:28,229 - INFO - transprompt_wrapper - 7
2021-04-22 09:04:24,820 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:04:27,922 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 09:04:27,922 - INFO - transprompt_wrapper - 8
2021-04-22 09:05:25,353 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:05:28,524 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 09:05:28,524 - INFO - transprompt_wrapper - 9
2021-04-22 09:05:28,945 - INFO - modeling - Saving complete
2021-04-22 09:05:28,945 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 09:05:28,945 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 09:05:29,038 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:06:47,781 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 09:06:47,781 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 09:06:47,784 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 09:06:47,784 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 09:06:47,786 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 09:06:47,786 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 09:06:47,786 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 09:06:47,786 - INFO - run_task_adaptation - text_b=None
2021-04-22 09:06:47,786 - INFO - run_task_adaptation - task=SST-2
2021-04-22 09:06:47,786 - INFO - run_task_adaptation - label=0
2021-04-22 09:06:47,786 - INFO - run_task_adaptation - **********************************
2021-04-22 09:06:51,857 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:07:28,987 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 09:07:28,988 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:08:26,337 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:08:30,029 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 09:08:30,029 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 100
2021-04-22 09:08:30,029 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:09:49,901 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:09:53,375 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 09:09:53,375 - INFO - transprompt_wrapper - 1
2021-04-22 09:10:48,837 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:10:52,274 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 09:10:52,274 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 300
2021-04-22 09:10:52,274 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:12:11,238 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:12:14,895 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 09:12:14,896 - INFO - transprompt_wrapper - 3
2021-04-22 09:13:10,575 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:13:13,830 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 09:13:13,830 - INFO - transprompt_wrapper - 4
2021-04-22 09:14:10,164 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:14:13,593 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 09:14:13,593 - INFO - transprompt_wrapper - 5
2021-04-22 09:15:09,606 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:15:13,356 - INFO - transprompt_wrapper - {'acc': 0.8854166666666666}
2021-04-22 09:15:13,356 - INFO - transprompt_wrapper - 6
2021-04-22 09:16:08,487 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:16:11,981 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 09:16:11,981 - INFO - transprompt_wrapper - 7
2021-04-22 09:17:06,947 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:17:10,712 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 09:17:10,712 - INFO - transprompt_wrapper - 8
2021-04-22 09:18:06,431 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:18:09,702 - INFO - transprompt_wrapper - {'acc': 0.90625}
2021-04-22 09:18:09,703 - INFO - transprompt_wrapper - 9
2021-04-22 09:18:10,213 - INFO - modeling - Saving complete
2021-04-22 09:18:10,213 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 09:18:10,213 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 09:18:10,309 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:19:07,237 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 09:19:07,237 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 09:19:07,237 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-22 09:19:07,238 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:19:42,125 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:19:43,348 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 09:19:43,348 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-22 09:19:43,348 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:20:34,159 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:20:35,617 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 09:20:35,617 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-22 09:20:35,618 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:21:26,814 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:21:27,816 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-22 09:21:27,817 - INFO - transprompt_wrapper - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-22 09:21:27,817 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:21:45,999 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:22:34,550 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-22 09:22:34,550 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-22 09:22:34,559 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-22 09:22:34,559 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-22 09:22:34,559 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:23:05,379 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-22 09:23:05,379 - INFO - modeling - eval_results: {'acc': 0.8830275229357798}
2021-04-22 09:23:05,381 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-22 09:23:05,381 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:23:37,915 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:23:39,332 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-22 09:23:39,332 - INFO - transprompt_wrapper - best_dev_acc: 0.8125 | best_global_step: 100
2021-04-22 09:23:39,332 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:24:54,078 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 09:24:54,078 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-22 09:24:54,083 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 09:24:54,083 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-22 09:24:54,086 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-22 09:24:54,086 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 09:24:54,086 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-22 09:24:54,086 - INFO - run_task_adaptation - text_b=None
2021-04-22 09:24:54,086 - INFO - run_task_adaptation - task=SST-2
2021-04-22 09:24:54,086 - INFO - run_task_adaptation - label=0
2021-04-22 09:24:54,086 - INFO - run_task_adaptation - **********************************
2021-04-22 09:24:56,792 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:25:32,907 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 09:25:32,908 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:26:29,994 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:26:33,683 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 09:26:33,683 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-22 09:26:33,683 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:27:49,679 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:27:53,341 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 09:27:53,342 - INFO - transprompt_wrapper - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-22 09:27:53,342 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:29:11,995 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:29:15,428 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-22 09:29:15,429 - INFO - transprompt_wrapper - best_dev_acc: 0.9167 | best_global_step: 300
2021-04-22 09:29:15,429 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:30:33,590 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:30:37,155 - INFO - transprompt_wrapper - {'acc': 0.8645833333333334}
2021-04-22 09:30:37,155 - INFO - transprompt_wrapper - 1
2021-04-22 09:31:31,790 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:31:34,901 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 09:31:34,901 - INFO - transprompt_wrapper - 2
2021-04-22 09:32:29,932 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:32:33,338 - INFO - transprompt_wrapper - {'acc': 0.8958333333333334}
2021-04-22 09:32:33,338 - INFO - transprompt_wrapper - 3
2021-04-22 09:36:10,286 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 09:36:10,286 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=train)
2021-04-22 09:36:10,290 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-04-22 09:36:10,290 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=dev)
2021-04-22 09:36:10,293 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-04-22 09:36:10,293 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 09:36:10,293 - INFO - run_task_adaptation - text_a=Bob Hope , the master of one-line quips , died Sunday night " with a smile on his face , " his daughter said yesterday .
2021-04-22 09:36:10,293 - INFO - run_task_adaptation - text_b=BOB HOPE , master of the one-liner and Americas favourite comedian , died with a smile on his face yesterday just months after celebrating his 100th birthday .
2021-04-22 09:36:10,293 - INFO - run_task_adaptation - task=MRPC
2021-04-22 09:36:10,293 - INFO - run_task_adaptation - label=0
2021-04-22 09:36:10,293 - INFO - run_task_adaptation - **********************************
2021-04-22 09:36:12,950 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:36:49,653 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 09:36:49,654 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:37:45,040 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:37:47,436 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 09:37:47,437 - INFO - transprompt_wrapper - best_dev_acc: 0.5625 | best_global_step: 100
2021-04-22 09:37:47,437 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:39:04,055 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:39:06,434 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 09:39:06,435 - INFO - transprompt_wrapper - best_dev_acc: 0.6250 | best_global_step: 200
2021-04-22 09:39:06,435 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:40:18,806 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:40:21,093 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 09:40:21,094 - INFO - transprompt_wrapper - best_dev_acc: 0.6406 | best_global_step: 300
2021-04-22 09:40:21,096 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:41:32,427 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:41:34,628 - INFO - transprompt_wrapper - {'acc': 0.625}
2021-04-22 09:41:34,628 - INFO - transprompt_wrapper - 1
2021-04-22 09:42:27,861 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:42:30,169 - INFO - transprompt_wrapper - {'acc': 0.609375}
2021-04-22 09:42:30,169 - INFO - transprompt_wrapper - 2
2021-04-22 09:43:23,350 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:43:25,619 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 09:43:25,619 - INFO - transprompt_wrapper - best_dev_acc: 0.6406 | best_global_step: 600
2021-04-22 09:43:25,619 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:44:38,268 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:44:40,128 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 09:44:40,129 - INFO - transprompt_wrapper - best_dev_acc: 0.6406 | best_global_step: 700
2021-04-22 09:44:40,129 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:45:52,532 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:45:54,749 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 09:45:54,749 - INFO - transprompt_wrapper - best_dev_acc: 0.6562 | best_global_step: 800
2021-04-22 09:45:54,750 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:47:06,909 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:47:09,239 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 09:47:09,239 - INFO - transprompt_wrapper - best_dev_acc: 0.6562 | best_global_step: 900
2021-04-22 09:47:09,239 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:48:20,850 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:48:23,181 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 09:48:23,181 - INFO - transprompt_wrapper - best_dev_acc: 0.6562 | best_global_step: 1000
2021-04-22 09:48:23,181 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:48:42,266 - INFO - modeling - Saving complete
2021-04-22 09:48:42,266 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 09:48:42,266 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 09:48:42,346 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:49:33,280 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 09:49:33,280 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 09:49:33,281 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-04-22 09:49:33,281 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:50:05,575 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:50:07,022 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-04-22 09:50:07,023 - INFO - transprompt_wrapper - best_dev_acc: 0.5625 | best_global_step: 100
2021-04-22 09:50:07,023 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:50:56,512 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:50:57,595 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-04-22 09:50:57,595 - INFO - transprompt_wrapper - best_dev_acc: 0.5938 | best_global_step: 200
2021-04-22 09:50:57,595 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:51:46,900 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:51:48,393 - INFO - transprompt_wrapper - {'acc': 0.5625}
2021-04-22 09:51:48,393 - INFO - transprompt_wrapper - 1
2021-04-22 09:51:48,821 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:52:41,054 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mrpc
2021-04-22 09:52:41,054 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MRPC/16-42 (num_examples=-1, set_type=test)
2021-04-22 09:52:41,062 - INFO - task_processors - Returning 408 test examples with label dist.: [(1, 279), (0, 129)]
2021-04-22 09:52:41,062 - INFO - modeling - Group g3: Task mrpc 's Test examples number: 408
2021-04-22 09:52:41,062 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:52:56,585 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=mrpc) ---
2021-04-22 09:52:56,585 - INFO - modeling - eval_results: {'acc': 0.6838235294117647}
2021-04-22 09:52:56,589 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task qqp =========
2021-04-22 09:52:56,589 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:53:29,894 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:53:30,804 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-22 09:53:30,804 - INFO - transprompt_wrapper - best_dev_acc: 0.6875 | best_global_step: 100
2021-04-22 09:53:30,804 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:54:19,216 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:54:20,496 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-22 09:54:20,496 - INFO - transprompt_wrapper - best_dev_acc: 0.6875 | best_global_step: 200
2021-04-22 09:54:20,497 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:55:08,400 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 09:55:09,657 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-22 09:55:09,657 - INFO - transprompt_wrapper - best_dev_acc: 0.6875 | best_global_step: 300
2021-04-22 09:55:09,657 - INFO - transprompt_wrapper - Saving models.
2021-04-22 09:55:25,970 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 09:56:17,468 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task qqp
2021-04-22 09:56:17,469 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/QQP/16-42 (num_examples=-1, set_type=test)
2021-04-22 09:56:18,215 - INFO - task_processors - Returning 40429 test examples with label dist.: [(0, 25544), (1, 14885)]
2021-04-22 09:56:18,216 - INFO - modeling - Group g3: Task qqp 's Test examples number: 40429
2021-04-22 09:56:18,216 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:04:52,323 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 10:04:52,324 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=train)
2021-04-22 10:04:52,328 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-04-22 10:04:52,328 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-42 (num_examples=-1, set_type=dev)
2021-04-22 10:04:52,330 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-04-22 10:04:52,330 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 10:04:52,330 - INFO - run_task_adaptation - text_a=Bob Hope , the master of one-line quips , died Sunday night " with a smile on his face , " his daughter said yesterday .
2021-04-22 10:04:52,330 - INFO - run_task_adaptation - text_b=BOB HOPE , master of the one-liner and Americas favourite comedian , died with a smile on his face yesterday just months after celebrating his 100th birthday .
2021-04-22 10:04:52,330 - INFO - run_task_adaptation - task=MRPC
2021-04-22 10:04:52,330 - INFO - run_task_adaptation - label=0
2021-04-22 10:04:52,331 - INFO - run_task_adaptation - **********************************
2021-04-22 10:05:05,176 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 10:05:51,229 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 10:05:51,325 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 10:06:52,573 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 10:06:52,574 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 10:06:52,574 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-04-22 10:06:52,574 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:07:25,708 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:07:26,908 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-04-22 10:07:26,908 - INFO - transprompt_wrapper - best_dev_acc: 0.4062 | best_global_step: 100
2021-04-22 10:07:26,908 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:07:35,208 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:07:43,040 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 10:07:51,089 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 10:07:58,135 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 10:08:05,084 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:08:05,174 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 10:08:05,608 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-04-22 10:08:05,608 - INFO - transprompt_wrapper - best_dev_acc: 0.5625 | best_global_step: 200
2021-04-22 10:08:05,608 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:08:12,131 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 10:08:19,074 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 10:08:26,096 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 10:08:33,600 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 10:08:40,839 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 10:08:43,528 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:08:44,010 - INFO - transprompt_wrapper - {'acc': 0.5}
2021-04-22 10:08:44,011 - INFO - transprompt_wrapper - 1
2021-04-22 10:08:44,330 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 10:08:51,361 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 10:08:58,826 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 10:09:05,871 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 10:09:12,915 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 10:09:20,304 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 10:09:27,903 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 10:09:35,246 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 10:09:42,361 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 10:09:45,169 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mrpc
2021-04-22 10:09:45,169 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MRPC/16-42 (num_examples=-1, set_type=test)
2021-04-22 10:09:45,178 - INFO - task_processors - Returning 408 test examples with label dist.: [(1, 279), (0, 129)]
2021-04-22 10:09:45,178 - INFO - modeling - Group g3: Task mrpc 's Test examples number: 408
2021-04-22 10:09:45,178 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:09:49,499 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 10:09:51,152 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=mrpc) ---
2021-04-22 10:09:51,153 - INFO - modeling - eval_results: {'acc': 0.6323529411764706}
2021-04-22 10:09:51,155 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task qqp =========
2021-04-22 10:09:51,155 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:10:02,012 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 10:10:09,188 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 10:10:10,782 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:10:11,260 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-22 10:10:11,260 - INFO - transprompt_wrapper - best_dev_acc: 0.7500 | best_global_step: 100
2021-04-22 10:10:11,260 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:10:56,882 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:10:57,917 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-22 10:10:57,917 - INFO - transprompt_wrapper - best_dev_acc: 0.7500 | best_global_step: 200
2021-04-22 10:10:57,918 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:11:44,191 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:11:45,278 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-22 10:11:45,279 - INFO - transprompt_wrapper - best_dev_acc: 0.7500 | best_global_step: 300
2021-04-22 10:11:45,279 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:12:02,094 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 10:12:59,191 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task qqp
2021-04-22 10:12:59,191 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/QQP/16-42 (num_examples=-1, set_type=test)
2021-04-22 10:13:00,103 - INFO - task_processors - Returning 40429 test examples with label dist.: [(0, 25544), (1, 14885)]
2021-04-22 10:13:00,104 - INFO - modeling - Group g3: Task qqp 's Test examples number: 40429
2021-04-22 10:13:00,104 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:13:06,528 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 10:13:12,737 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 10:13:18,760 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 10:13:23,927 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 10:32:36,721 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=qqp) ---
2021-04-22 10:32:36,721 - INFO - modeling - eval_results: {'acc': 0.730168938138465}
2021-04-22 10:35:21,517 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 10:35:21,517 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-04-22 10:35:21,522 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-22 10:35:21,522 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-04-22 10:35:21,524 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-22 10:35:21,525 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 10:35:21,525 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-22 10:35:21,525 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-22 10:35:21,525 - INFO - run_task_adaptation - task=MNLI
2021-04-22 10:35:21,525 - INFO - run_task_adaptation - label=contradiction
2021-04-22 10:35:21,525 - INFO - run_task_adaptation - **********************************
2021-04-22 10:35:24,220 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 10:35:58,514 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 10:35:58,514 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:36:46,557 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:36:49,462 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-22 10:36:49,462 - INFO - transprompt_wrapper - best_dev_acc: 0.6250 | best_global_step: 100
2021-04-22 10:36:49,462 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:37:55,329 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:37:58,260 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-22 10:37:58,260 - INFO - transprompt_wrapper - best_dev_acc: 0.6771 | best_global_step: 200
2021-04-22 10:37:58,260 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:39:02,568 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:39:05,496 - INFO - transprompt_wrapper - {'acc': 0.625}
2021-04-22 10:39:05,496 - INFO - transprompt_wrapper - 1
2021-04-22 10:39:54,092 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:39:56,996 - INFO - transprompt_wrapper - {'acc': 0.625}
2021-04-22 10:39:56,997 - INFO - transprompt_wrapper - 2
2021-04-22 10:40:43,285 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:40:46,175 - INFO - transprompt_wrapper - {'acc': 0.6458333333333334}
2021-04-22 10:40:46,175 - INFO - transprompt_wrapper - 3
2021-04-22 10:41:31,964 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:41:34,909 - INFO - transprompt_wrapper - {'acc': 0.6145833333333334}
2021-04-22 10:41:34,909 - INFO - transprompt_wrapper - 4
2021-04-22 10:42:21,222 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:42:24,143 - INFO - transprompt_wrapper - {'acc': 0.6354166666666666}
2021-04-22 10:42:24,143 - INFO - transprompt_wrapper - 5
2021-04-22 10:43:10,309 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:43:13,264 - INFO - transprompt_wrapper - {'acc': 0.6354166666666666}
2021-04-22 10:43:13,265 - INFO - transprompt_wrapper - 6
2021-04-22 10:43:59,458 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:44:02,356 - INFO - transprompt_wrapper - {'acc': 0.6354166666666666}
2021-04-22 10:44:02,357 - INFO - transprompt_wrapper - 7
2021-04-22 10:44:48,701 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:44:51,585 - INFO - transprompt_wrapper - {'acc': 0.6354166666666666}
2021-04-22 10:44:51,586 - INFO - transprompt_wrapper - 8
2021-04-22 10:44:51,913 - INFO - modeling - Saving complete
2021-04-22 10:44:51,913 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 10:44:51,913 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 10:44:51,997 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 10:45:44,976 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 10:45:44,977 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 10:45:44,977 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-22 10:45:44,977 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:46:15,129 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:46:16,642 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-22 10:46:16,642 - INFO - transprompt_wrapper - best_dev_acc: 0.5208 | best_global_step: 100
2021-04-22 10:46:16,642 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:46:26,095 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 10:46:26,095 - INFO - transprompt_wrapper - best_dev_acc: 0.8815 | best_global_step: 12500
2021-04-22 10:46:26,095 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:47:08,552 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:47:10,434 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-22 10:47:10,434 - INFO - transprompt_wrapper - best_dev_acc: 0.5833 | best_global_step: 200
2021-04-22 10:47:10,434 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:48:00,071 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:48:01,660 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-22 10:48:01,660 - INFO - transprompt_wrapper - best_dev_acc: 0.5833 | best_global_step: 300
2021-04-22 10:48:01,660 - INFO - transprompt_wrapper - Saving models.
2021-04-22 10:48:18,723 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 10:49:10,447 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-22 10:49:10,447 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-04-22 10:49:10,856 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-22 10:49:10,857 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-22 10:49:10,857 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 10:49:19,785 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 11:00:47,827 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-22 11:00:47,827 - INFO - modeling - eval_results: {'acc': 0.6306815289866138}
2021-04-22 11:00:47,850 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-22 11:00:47,850 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 11:01:20,787 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 11:01:22,678 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-22 11:01:22,678 - INFO - transprompt_wrapper - best_dev_acc: 0.6250 | best_global_step: 100
2021-04-22 11:01:22,678 - INFO - transprompt_wrapper - Saving models.
2021-04-22 11:02:13,132 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 11:02:15,017 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-22 11:02:15,018 - INFO - transprompt_wrapper - best_dev_acc: 0.7292 | best_global_step: 200
2021-04-22 11:02:15,018 - INFO - transprompt_wrapper - Saving models.
2021-04-22 11:03:05,763 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 11:03:07,395 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-22 11:03:07,395 - INFO - transprompt_wrapper - best_dev_acc: 0.7500 | best_global_step: 300
2021-04-22 11:03:07,395 - INFO - transprompt_wrapper - Saving models.
2021-04-22 11:03:25,704 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 11:04:19,770 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-22 11:04:19,770 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-04-22 11:04:19,818 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-04-22 11:04:19,837 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-22 11:04:19,837 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 11:10:17,450 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-22 11:10:17,450 - INFO - modeling - eval_results: {'acc': 0.7336923389554969}
2021-04-22 11:46:24,595 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 11:46:32,302 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 11:46:39,985 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 11:46:47,360 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 11:46:54,597 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 11:47:01,927 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 11:47:08,963 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 11:47:16,428 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 11:47:24,183 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 11:47:35,621 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 11:47:42,926 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 11:47:50,389 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 11:47:57,663 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 11:48:04,840 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 11:48:12,337 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 11:48:19,907 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 11:48:27,193 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 11:48:34,237 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 11:48:46,878 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 11:48:54,013 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 11:49:01,520 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 12:09:16,163 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 12:09:16,163 - INFO - transprompt_wrapper - best_dev_acc: 0.8841 | best_global_step: 15000
2021-04-22 12:09:16,163 - INFO - transprompt_wrapper - Saving models.
2021-04-22 13:01:02,450 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 13:01:09,992 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 13:01:17,748 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 13:01:25,328 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 13:01:32,527 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 13:01:39,687 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 13:01:46,789 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 13:01:54,203 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 13:02:06,462 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 13:02:13,954 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 13:02:20,992 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 13:02:28,011 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 13:02:35,003 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 13:02:42,005 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 13:02:49,335 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 13:02:56,930 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 13:03:04,281 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 13:03:16,920 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 13:03:24,077 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 13:03:31,417 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 13:03:38,646 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 13:23:47,910 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 13:23:47,911 - INFO - transprompt_wrapper - best_dev_acc: 0.8852 | best_global_step: 17500
2021-04-22 13:23:47,911 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:14:57,504 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:15:05,263 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 14:15:12,676 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 14:15:19,558 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 14:15:26,453 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 14:15:33,569 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 14:15:43,456 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 14:15:50,566 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 14:15:58,060 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 14:16:05,630 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 14:16:12,567 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 14:16:19,520 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 14:16:26,417 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 14:16:33,430 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 14:16:45,298 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 14:16:52,827 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 14:17:00,058 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 14:17:07,251 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 14:17:14,312 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 14:17:21,357 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 14:17:28,405 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 14:34:45,519 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-22 14:34:45,519 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=train)
2021-04-22 14:34:45,522 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-04-22 14:34:45,523 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=dev)
2021-04-22 14:34:45,524 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-04-22 14:34:45,524 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-22 14:34:45,524 - INFO - run_task_adaptation - text_a=Egypt , Mongolia , the Seychelles , Tunisia and at least three other governments have signed unpublicized agreements .
2021-04-22 14:34:45,524 - INFO - run_task_adaptation - text_b=At least seven other governments have signed agreements , but have asked not to have them publicized .
2021-04-22 14:34:45,525 - INFO - run_task_adaptation - task=MRPC
2021-04-22 14:34:45,525 - INFO - run_task_adaptation - label=0
2021-04-22 14:34:45,525 - INFO - run_task_adaptation - **********************************
2021-04-22 14:34:49,680 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 14:35:27,790 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-22 14:35:27,791 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:36:15,810 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:36:17,792 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:36:17,792 - INFO - transprompt_wrapper - best_dev_acc: 0.5938 | best_global_step: 100
2021-04-22 14:36:17,792 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:37:23,402 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:37:25,453 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:37:25,454 - INFO - transprompt_wrapper - best_dev_acc: 0.6719 | best_global_step: 200
2021-04-22 14:37:25,454 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:38:31,801 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:38:33,884 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:38:33,884 - INFO - transprompt_wrapper - best_dev_acc: 0.6719 | best_global_step: 300
2021-04-22 14:38:33,884 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:39:33,385 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 14:39:33,386 - INFO - transprompt_wrapper - best_dev_acc: 0.8861 | best_global_step: 20000
2021-04-22 14:39:33,386 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:39:36,960 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:39:37,874 - INFO - transprompt_wrapper - {'acc': 0.640625}
2021-04-22 14:39:37,874 - INFO - transprompt_wrapper - 2
2021-04-22 14:40:30,646 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:40:32,960 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:40:32,961 - INFO - transprompt_wrapper - best_dev_acc: 0.6719 | best_global_step: 500
2021-04-22 14:40:32,961 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:41:45,730 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:41:48,147 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:41:48,147 - INFO - transprompt_wrapper - best_dev_acc: 0.6719 | best_global_step: 600
2021-04-22 14:41:48,147 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:43:02,710 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:43:05,059 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:43:05,060 - INFO - transprompt_wrapper - best_dev_acc: 0.6719 | best_global_step: 700
2021-04-22 14:43:05,060 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:44:18,311 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:44:20,668 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:44:20,668 - INFO - transprompt_wrapper - best_dev_acc: 0.6719 | best_global_step: 800
2021-04-22 14:44:20,668 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:45:33,930 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:45:36,318 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:45:36,318 - INFO - transprompt_wrapper - best_dev_acc: 0.6719 | best_global_step: 900
2021-04-22 14:45:36,318 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:46:48,298 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 14:46:50,687 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-22 14:46:50,688 - INFO - transprompt_wrapper - best_dev_acc: 0.6719 | best_global_step: 1000
2021-04-22 14:46:50,688 - INFO - transprompt_wrapper - Saving models.
2021-04-22 14:47:10,057 - INFO - modeling - Saving complete
2021-04-22 14:47:10,057 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-22 14:47:10,057 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-22 14:47:10,151 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-22 14:48:03,606 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-22 14:48:03,606 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-22 14:48:03,606 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-04-22 14:48:03,606 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 15:33:35,575 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 15:33:43,168 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 15:33:50,576 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 15:33:59,871 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 15:34:06,846 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 15:34:13,780 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 15:34:20,740 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 15:34:27,886 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 15:34:35,372 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 15:34:42,661 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 15:34:49,592 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 15:35:00,123 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 15:35:07,005 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 15:35:13,904 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 15:35:21,075 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 15:35:28,515 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 15:35:35,716 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 15:35:42,680 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 15:35:49,647 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 15:35:56,569 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 15:36:09,099 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 15:56:08,376 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 15:56:08,376 - INFO - transprompt_wrapper - best_dev_acc: 0.8874 | best_global_step: 22500
2021-04-22 15:56:08,376 - INFO - transprompt_wrapper - Saving models.
2021-04-22 16:47:18,079 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 16:47:25,643 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 16:47:33,059 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 16:47:40,042 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 16:47:46,965 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 16:47:53,849 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 16:48:00,730 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 16:48:07,904 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 16:48:15,337 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 16:48:22,593 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 16:48:33,070 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 16:48:40,061 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 16:48:46,955 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 16:48:53,870 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 16:49:01,080 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 16:49:08,641 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 16:49:15,865 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 16:49:22,851 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 16:49:29,854 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 16:49:42,371 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 16:49:49,372 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 17:09:49,364 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 17:09:49,364 - INFO - transprompt_wrapper - best_dev_acc: 0.8892 | best_global_step: 25000
2021-04-22 17:09:49,364 - INFO - transprompt_wrapper - Saving models.
2021-04-22 18:00:46,284 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 18:00:54,044 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 18:01:01,391 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 18:01:08,335 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 18:01:15,251 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 18:01:22,162 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 18:01:29,066 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 18:01:36,101 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 18:01:43,536 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 18:01:54,133 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 18:02:01,076 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 18:02:07,992 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 18:02:14,896 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 18:02:21,839 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 18:02:29,055 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 18:02:36,525 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 18:02:43,748 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 18:02:50,789 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 18:03:03,041 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 18:03:09,991 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 18:03:16,975 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 18:23:15,791 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 18:23:15,792 - INFO - transprompt_wrapper - best_dev_acc: 0.8898 | best_global_step: 27500
2021-04-22 18:23:15,792 - INFO - transprompt_wrapper - Saving models.
2021-04-22 19:14:25,662 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 19:14:33,221 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 19:14:40,683 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 19:14:47,583 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 19:14:54,493 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 19:15:01,386 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 19:15:08,373 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 19:15:18,371 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 19:15:25,800 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 19:15:33,462 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 19:15:40,424 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 19:15:47,359 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 19:15:54,266 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 19:16:01,195 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 19:16:08,444 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 19:16:15,927 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 19:16:27,966 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 19:16:34,978 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 19:16:42,326 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 19:16:49,363 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 19:16:56,405 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 19:36:56,497 - INFO - transprompt_wrapper - {'acc': 0.8895028169430987}
2021-04-22 19:36:56,497 - INFO - transprompt_wrapper - 1
2021-04-22 20:27:51,412 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 20:27:59,185 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 20:28:06,551 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 20:28:13,414 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 20:28:20,270 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 20:28:27,191 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 20:28:36,609 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 20:28:43,634 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 20:28:51,078 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 20:28:58,386 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 20:29:05,251 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 20:29:12,113 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 20:29:19,017 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 20:29:30,212 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 20:29:37,362 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 20:29:44,850 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 20:29:52,051 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 20:29:58,973 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 20:30:05,928 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 20:30:12,891 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 20:30:19,846 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 20:50:19,102 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 20:50:19,103 - INFO - transprompt_wrapper - best_dev_acc: 0.8905 | best_global_step: 32500
2021-04-22 20:50:19,103 - INFO - transprompt_wrapper - Saving models.
2021-04-22 21:41:30,064 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 21:41:37,627 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 21:41:46,926 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 21:41:53,912 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 21:42:00,983 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 21:42:07,918 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 21:42:14,859 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 21:42:21,937 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 21:42:29,632 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 21:42:40,338 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 21:42:47,258 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 21:42:54,187 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 21:43:01,183 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 21:43:08,392 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 21:43:15,633 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 21:43:23,122 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 21:43:30,402 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 21:43:37,377 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 21:43:49,501 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 21:43:56,684 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 21:44:03,664 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 22:04:00,807 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-22 22:04:00,807 - INFO - transprompt_wrapper - best_dev_acc: 0.8911 | best_global_step: 35000
2021-04-22 22:04:00,807 - INFO - transprompt_wrapper - Saving models.
2021-04-22 22:55:02,149 - INFO - transprompt_wrapper - Writing example 0
2021-04-22 22:55:09,763 - INFO - transprompt_wrapper - Writing example 10000
2021-04-22 22:55:17,119 - INFO - transprompt_wrapper - Writing example 20000
2021-04-22 22:55:23,980 - INFO - transprompt_wrapper - Writing example 30000
2021-04-22 22:55:30,837 - INFO - transprompt_wrapper - Writing example 40000
2021-04-22 22:55:37,777 - INFO - transprompt_wrapper - Writing example 50000
2021-04-22 22:55:44,667 - INFO - transprompt_wrapper - Writing example 60000
2021-04-22 22:55:51,668 - INFO - transprompt_wrapper - Writing example 70000
2021-04-22 22:56:02,186 - INFO - transprompt_wrapper - Writing example 80000
2021-04-22 22:56:09,507 - INFO - transprompt_wrapper - Writing example 90000
2021-04-22 22:56:16,379 - INFO - transprompt_wrapper - Writing example 100000
2021-04-22 22:56:23,287 - INFO - transprompt_wrapper - Writing example 110000
2021-04-22 22:56:30,195 - INFO - transprompt_wrapper - Writing example 120000
2021-04-22 22:56:37,072 - INFO - transprompt_wrapper - Writing example 130000
2021-04-22 22:56:44,225 - INFO - transprompt_wrapper - Writing example 140000
2021-04-22 22:56:51,735 - INFO - transprompt_wrapper - Writing example 150000
2021-04-22 22:57:03,892 - INFO - transprompt_wrapper - Writing example 160000
2021-04-22 22:57:10,837 - INFO - transprompt_wrapper - Writing example 170000
2021-04-22 22:57:17,831 - INFO - transprompt_wrapper - Writing example 180000
2021-04-22 22:57:24,829 - INFO - transprompt_wrapper - Writing example 190000
2021-04-22 22:57:31,828 - INFO - transprompt_wrapper - Writing example 200000
2021-04-22 23:17:30,000 - INFO - transprompt_wrapper - {'acc': 0.8909186885181202}
2021-04-22 23:17:30,000 - INFO - transprompt_wrapper - 1
2021-04-23 00:08:26,055 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 00:08:33,731 - INFO - transprompt_wrapper - Writing example 10000
2021-04-23 00:08:41,095 - INFO - transprompt_wrapper - Writing example 20000
2021-04-23 00:08:47,981 - INFO - transprompt_wrapper - Writing example 30000
2021-04-23 00:08:54,855 - INFO - transprompt_wrapper - Writing example 40000
2021-04-23 00:09:01,798 - INFO - transprompt_wrapper - Writing example 50000
2021-04-23 00:09:11,423 - INFO - transprompt_wrapper - Writing example 60000
2021-04-23 00:09:18,469 - INFO - transprompt_wrapper - Writing example 70000
2021-04-23 00:09:25,904 - INFO - transprompt_wrapper - Writing example 80000
2021-04-23 00:09:33,174 - INFO - transprompt_wrapper - Writing example 90000
2021-04-23 00:09:40,032 - INFO - transprompt_wrapper - Writing example 100000
2021-04-23 00:09:46,905 - INFO - transprompt_wrapper - Writing example 110000
2021-04-23 00:09:53,788 - INFO - transprompt_wrapper - Writing example 120000
2021-04-23 00:10:00,633 - INFO - transprompt_wrapper - Writing example 130000
2021-04-23 00:10:12,171 - INFO - transprompt_wrapper - Writing example 140000
2021-04-23 00:10:19,886 - INFO - transprompt_wrapper - Writing example 150000
2021-04-23 00:10:27,098 - INFO - transprompt_wrapper - Writing example 160000
2021-04-23 00:10:34,026 - INFO - transprompt_wrapper - Writing example 170000
2021-04-23 00:10:41,007 - INFO - transprompt_wrapper - Writing example 180000
2021-04-23 00:10:47,982 - INFO - transprompt_wrapper - Writing example 190000
2021-04-23 00:10:55,372 - INFO - transprompt_wrapper - Writing example 200000
2021-04-23 00:30:53,509 - INFO - transprompt_wrapper - {'acc': 0.8910222888772681}
2021-04-23 00:30:53,509 - INFO - transprompt_wrapper - 2
2021-04-23 01:21:35,197 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 01:21:42,574 - INFO - transprompt_wrapper - Writing example 10000
2021-04-23 01:21:49,953 - INFO - transprompt_wrapper - Writing example 20000
2021-04-23 01:21:58,904 - INFO - transprompt_wrapper - Writing example 30000
2021-04-23 01:22:05,803 - INFO - transprompt_wrapper - Writing example 40000
2021-04-23 01:22:12,704 - INFO - transprompt_wrapper - Writing example 50000
2021-04-23 01:22:19,606 - INFO - transprompt_wrapper - Writing example 60000
2021-04-23 01:22:26,706 - INFO - transprompt_wrapper - Writing example 70000
2021-04-23 01:22:34,111 - INFO - transprompt_wrapper - Writing example 80000
2021-04-23 01:22:41,378 - INFO - transprompt_wrapper - Writing example 90000
2021-04-23 01:22:48,291 - INFO - transprompt_wrapper - Writing example 100000
2021-04-23 01:22:58,825 - INFO - transprompt_wrapper - Writing example 110000
2021-04-23 01:23:05,696 - INFO - transprompt_wrapper - Writing example 120000
2021-04-23 01:23:12,586 - INFO - transprompt_wrapper - Writing example 130000
2021-04-23 01:23:19,792 - INFO - transprompt_wrapper - Writing example 140000
2021-04-23 01:23:27,250 - INFO - transprompt_wrapper - Writing example 150000
2021-04-23 01:23:34,426 - INFO - transprompt_wrapper - Writing example 160000
2021-04-23 01:23:41,372 - INFO - transprompt_wrapper - Writing example 170000
2021-04-23 01:23:48,344 - INFO - transprompt_wrapper - Writing example 180000
2021-04-23 01:23:55,270 - INFO - transprompt_wrapper - Writing example 190000
2021-04-23 01:24:07,726 - INFO - transprompt_wrapper - Writing example 200000
2021-04-23 01:44:06,730 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-23 01:44:06,730 - INFO - transprompt_wrapper - best_dev_acc: 0.8920 | best_global_step: 42500
2021-04-23 01:44:06,730 - INFO - transprompt_wrapper - Saving models.
2021-04-23 02:34:57,249 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 02:35:04,949 - INFO - transprompt_wrapper - Writing example 10000
2021-04-23 02:35:12,416 - INFO - transprompt_wrapper - Writing example 20000
2021-04-23 02:35:19,334 - INFO - transprompt_wrapper - Writing example 30000
2021-04-23 02:35:26,210 - INFO - transprompt_wrapper - Writing example 40000
2021-04-23 02:35:33,291 - INFO - transprompt_wrapper - Writing example 50000
2021-04-23 02:35:40,164 - INFO - transprompt_wrapper - Writing example 60000
2021-04-23 02:35:47,199 - INFO - transprompt_wrapper - Writing example 70000
2021-04-23 02:35:54,613 - INFO - transprompt_wrapper - Writing example 80000
2021-04-23 02:36:02,152 - INFO - transprompt_wrapper - Writing example 90000
2021-04-23 02:36:12,623 - INFO - transprompt_wrapper - Writing example 100000
2021-04-23 02:36:19,489 - INFO - transprompt_wrapper - Writing example 110000
2021-04-23 02:36:26,379 - INFO - transprompt_wrapper - Writing example 120000
2021-04-23 02:36:33,389 - INFO - transprompt_wrapper - Writing example 130000
2021-04-23 02:36:40,650 - INFO - transprompt_wrapper - Writing example 140000
2021-04-23 02:36:48,112 - INFO - transprompt_wrapper - Writing example 150000
2021-04-23 02:36:55,332 - INFO - transprompt_wrapper - Writing example 160000
2021-04-23 02:37:02,319 - INFO - transprompt_wrapper - Writing example 170000
2021-04-23 02:37:09,345 - INFO - transprompt_wrapper - Writing example 180000
2021-04-23 02:37:21,658 - INFO - transprompt_wrapper - Writing example 190000
2021-04-23 02:37:28,643 - INFO - transprompt_wrapper - Writing example 200000
2021-04-23 02:57:27,593 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-23 02:57:27,593 - INFO - transprompt_wrapper - best_dev_acc: 0.8923 | best_global_step: 45000
2021-04-23 02:57:27,593 - INFO - transprompt_wrapper - Saving models.
2021-04-23 03:48:16,178 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 03:48:23,772 - INFO - transprompt_wrapper - Writing example 10000
2021-04-23 03:48:31,313 - INFO - transprompt_wrapper - Writing example 20000
2021-04-23 03:48:38,237 - INFO - transprompt_wrapper - Writing example 30000
2021-04-23 03:48:45,345 - INFO - transprompt_wrapper - Writing example 40000
2021-04-23 03:48:52,223 - INFO - transprompt_wrapper - Writing example 50000
2021-04-23 03:48:59,175 - INFO - transprompt_wrapper - Writing example 60000
2021-04-23 03:49:06,202 - INFO - transprompt_wrapper - Writing example 70000
2021-04-23 03:49:13,591 - INFO - transprompt_wrapper - Writing example 80000
2021-04-23 03:49:24,198 - INFO - transprompt_wrapper - Writing example 90000
2021-04-23 03:49:31,122 - INFO - transprompt_wrapper - Writing example 100000
2021-04-23 03:49:37,988 - INFO - transprompt_wrapper - Writing example 110000
2021-04-23 03:49:44,864 - INFO - transprompt_wrapper - Writing example 120000
2021-04-23 03:49:51,770 - INFO - transprompt_wrapper - Writing example 130000
2021-04-23 03:49:58,954 - INFO - transprompt_wrapper - Writing example 140000
2021-04-23 03:50:06,389 - INFO - transprompt_wrapper - Writing example 150000
2021-04-23 03:50:13,612 - INFO - transprompt_wrapper - Writing example 160000
2021-04-23 03:50:25,817 - INFO - transprompt_wrapper - Writing example 170000
2021-04-23 03:50:32,795 - INFO - transprompt_wrapper - Writing example 180000
2021-04-23 03:50:39,759 - INFO - transprompt_wrapper - Writing example 190000
2021-04-23 03:50:46,784 - INFO - transprompt_wrapper - Writing example 200000
2021-04-23 04:10:46,557 - INFO - transprompt_wrapper - {'acc': 0.8920533591183116}
2021-04-23 04:10:46,557 - INFO - transprompt_wrapper - 1
2021-04-23 05:01:25,444 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 05:01:32,970 - INFO - transprompt_wrapper - Writing example 10000
2021-04-23 05:01:40,369 - INFO - transprompt_wrapper - Writing example 20000
2021-04-23 05:01:47,324 - INFO - transprompt_wrapper - Writing example 30000
2021-04-23 05:01:54,252 - INFO - transprompt_wrapper - Writing example 40000
2021-04-23 05:02:01,203 - INFO - transprompt_wrapper - Writing example 50000
2021-04-23 05:02:08,142 - INFO - transprompt_wrapper - Writing example 60000
2021-04-23 05:02:15,232 - INFO - transprompt_wrapper - Writing example 70000
2021-04-23 05:02:25,829 - INFO - transprompt_wrapper - Writing example 80000
2021-04-23 05:02:33,179 - INFO - transprompt_wrapper - Writing example 90000
2021-04-23 05:02:40,189 - INFO - transprompt_wrapper - Writing example 100000
2021-04-23 05:02:47,153 - INFO - transprompt_wrapper - Writing example 110000
2021-04-23 05:02:54,106 - INFO - transprompt_wrapper - Writing example 120000
2021-04-23 05:03:01,065 - INFO - transprompt_wrapper - Writing example 130000
2021-04-23 05:03:08,348 - INFO - transprompt_wrapper - Writing example 140000
2021-04-23 05:03:15,882 - INFO - transprompt_wrapper - Writing example 150000
2021-04-23 05:03:28,106 - INFO - transprompt_wrapper - Writing example 160000
2021-04-23 05:03:35,260 - INFO - transprompt_wrapper - Writing example 170000
2021-04-23 05:03:42,285 - INFO - transprompt_wrapper - Writing example 180000
2021-04-23 05:03:49,287 - INFO - transprompt_wrapper - Writing example 190000
2021-04-23 05:03:56,318 - INFO - transprompt_wrapper - Writing example 200000
2021-04-23 05:23:55,691 - INFO - transprompt_wrapper - {'acc': 0.8921964262809444}
2021-04-23 05:23:55,691 - INFO - transprompt_wrapper - 2
2021-04-23 05:23:57,557 - INFO - modeling - Saving complete
2021-04-23 05:23:57,557 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-23 05:23:57,557 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-23 05:24:19,006 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-23 05:24:19,418 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-23 05:24:19,529 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-23 05:24:19,529 - INFO - wrapper - Writing example 0
2021-04-23 05:24:28,617 - INFO - wrapper - Writing example 10000
2021-04-23 05:24:36,732 - INFO - wrapper - Writing example 20000
2021-04-23 05:24:44,689 - INFO - wrapper - Writing example 30000
2021-04-23 05:24:52,513 - INFO - wrapper - Writing example 40000
2021-04-23 05:25:00,283 - INFO - wrapper - Writing example 50000
2021-04-23 05:25:10,909 - INFO - wrapper - Writing example 60000
2021-04-23 05:25:18,713 - INFO - wrapper - Writing example 70000
2021-04-23 05:25:26,447 - INFO - wrapper - Writing example 80000
2021-04-23 05:25:34,115 - INFO - wrapper - Writing example 90000
2021-04-23 05:25:41,779 - INFO - wrapper - Writing example 100000
2021-04-23 05:25:49,441 - INFO - wrapper - Writing example 110000
2021-04-23 05:25:56,991 - INFO - wrapper - Writing example 120000
2021-04-23 05:26:04,518 - INFO - wrapper - Writing example 130000
2021-04-23 05:26:16,463 - INFO - wrapper - Writing example 140000
2021-04-23 05:26:24,018 - INFO - wrapper - Writing example 150000
2021-04-23 05:26:31,561 - INFO - wrapper - Writing example 160000
2021-04-23 05:26:39,104 - INFO - wrapper - Writing example 170000
2021-04-23 05:26:46,637 - INFO - wrapper - Writing example 180000
2021-04-23 05:26:54,168 - INFO - wrapper - Writing example 190000
2021-04-23 05:27:02,255 - INFO - wrapper - Writing example 200000
2021-04-23 05:27:09,790 - INFO - wrapper - Writing example 210000
2021-04-23 05:27:17,312 - INFO - wrapper - Writing example 220000
2021-04-23 05:27:24,849 - INFO - wrapper - Writing example 230000
2021-04-23 05:27:39,040 - INFO - wrapper - Writing example 240000
2021-04-23 05:27:46,639 - INFO - wrapper - Writing example 250000
2021-04-23 05:27:54,320 - INFO - wrapper - Writing example 260000
2021-04-23 05:28:01,989 - INFO - wrapper - Writing example 270000
2021-04-23 05:28:09,611 - INFO - wrapper - Writing example 280000
2021-04-23 05:28:17,205 - INFO - wrapper - Writing example 290000
2021-04-23 05:28:24,836 - INFO - wrapper - Writing example 300000
2021-04-23 05:28:32,461 - INFO - wrapper - Writing example 310000
2021-04-23 05:28:40,043 - INFO - wrapper - Writing example 320000
2021-04-23 05:28:47,644 - INFO - wrapper - Writing example 330000
2021-04-23 06:12:15,874 - INFO - wrapper - Writing example 0
2021-04-23 06:12:23,511 - INFO - wrapper - Writing example 10000
2021-04-23 06:12:31,071 - INFO - wrapper - Writing example 20000
2021-04-23 06:12:40,629 - INFO - wrapper - Writing example 30000
2021-04-23 06:12:48,076 - INFO - wrapper - Writing example 40000
2021-04-23 06:12:55,588 - INFO - wrapper - Writing example 50000
2021-04-23 06:18:09,070 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/mnli...
2021-04-23 06:18:09,070 - INFO - wrapper - best_dev_acc: 0.8668 | best_global_step: 2500
2021-04-23 06:18:09,071 - INFO - wrapper - Saving models.
2021-04-23 07:01:10,220 - INFO - wrapper - Writing example 0
2021-04-23 07:01:17,851 - INFO - wrapper - Writing example 10000
2021-04-23 07:01:25,329 - INFO - wrapper - Writing example 20000
2021-04-23 07:01:35,051 - INFO - wrapper - Writing example 30000
2021-04-23 07:01:42,616 - INFO - wrapper - Writing example 40000
2021-04-23 07:01:50,275 - INFO - wrapper - Writing example 50000
2021-04-23 07:07:03,623 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/mnli...
2021-04-23 07:07:03,623 - INFO - wrapper - best_dev_acc: 0.8712 | best_global_step: 5000
2021-04-23 07:07:03,623 - INFO - wrapper - Saving models.
2021-04-23 07:43:38,322 - INFO - run_task_generalization - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-23 07:43:38,322 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-23 07:43:38,325 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-23 07:43:38,325 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-23 07:43:38,327 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-23 07:43:38,327 - INFO - run_task_generalization - ************Training Example:**************
2021-04-23 07:43:38,327 - INFO - run_task_generalization - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-23 07:43:38,327 - INFO - run_task_generalization - text_b=None
2021-04-23 07:43:38,327 - INFO - run_task_generalization - task=SST-2
2021-04-23 07:43:38,327 - INFO - run_task_generalization - label=0
2021-04-23 07:43:38,327 - INFO - run_task_generalization - **********************************
2021-04-23 07:43:38,327 - INFO - run_task_generalization - ======== Meta-learning on task SST-2,mr,cr, Task generalization on unseen tasks: g1 ========
2021-04-23 07:43:41,384 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-23 07:44:14,523 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-23 07:44:14,523 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:45:16,700 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:45:20,556 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:45:20,556 - INFO - transprompt_wrapper - best_dev_acc: 0.9896 | best_global_step: 100
2021-04-23 07:45:20,556 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:46:27,475 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:46:31,518 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:46:31,518 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-23 07:46:31,518 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:47:52,392 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:47:56,277 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:47:56,277 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-23 07:47:56,277 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:49:18,821 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:49:22,730 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:49:22,730 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-23 07:49:22,730 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:50:44,559 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:50:48,529 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:50:48,529 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-23 07:50:48,529 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:52:10,101 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:52:14,118 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:52:14,119 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 600
2021-04-23 07:52:14,119 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:53:34,973 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:53:38,948 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:53:38,948 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 700
2021-04-23 07:53:38,948 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:54:19,771 - INFO - wrapper - Writing example 0
2021-04-23 07:54:27,411 - INFO - wrapper - Writing example 10000
2021-04-23 07:54:35,352 - INFO - wrapper - Writing example 20000
2021-04-23 07:54:38,935 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:54:40,277 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:54:40,277 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 800
2021-04-23 07:54:40,277 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:54:42,913 - INFO - wrapper - Writing example 30000
2021-04-23 07:54:53,207 - INFO - wrapper - Writing example 40000
2021-04-23 07:55:01,430 - INFO - wrapper - Writing example 50000
2021-04-23 07:55:47,497 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:55:51,126 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:55:51,126 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 900
2021-04-23 07:55:51,126 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:57:08,828 - INFO - transprompt_wrapper - Writing example 0
2021-04-23 07:57:12,681 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-23 07:57:12,681 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 1000
2021-04-23 07:57:12,682 - INFO - transprompt_wrapper - Saving models.
2021-04-23 07:57:34,352 - INFO - modeling - Saving complete
2021-04-23 07:57:34,353 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-23 07:57:34,353 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-23 07:57:34,435 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-23 07:58:22,907 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task g1 =========
2021-04-23 07:58:22,907 - WARNING - modeling - Training method was called without training examples
2021-04-23 08:01:13,380 - INFO - wrapper - {'acc': 0.8691983838658202}
2021-04-23 08:01:13,380 - INFO - wrapper - 1
2021-04-23 08:44:11,373 - INFO - wrapper - Writing example 0
2021-04-23 08:44:18,968 - INFO - wrapper - Writing example 10000
2021-04-23 08:44:26,336 - INFO - wrapper - Writing example 20000
2021-04-23 08:44:33,945 - INFO - wrapper - Writing example 30000
2021-04-23 08:44:41,473 - INFO - wrapper - Writing example 40000
2021-04-23 08:44:51,675 - INFO - wrapper - Writing example 50000
2021-04-23 08:50:04,867 - INFO - wrapper - {'acc': 0.8705904322140359}
2021-04-23 08:50:04,868 - INFO - wrapper - 2
2021-04-23 09:33:29,537 - INFO - wrapper - Writing example 0
2021-04-23 09:33:37,086 - INFO - wrapper - Writing example 10000
2021-04-23 09:33:44,432 - INFO - wrapper - Writing example 20000
2021-04-23 09:33:51,789 - INFO - wrapper - Writing example 30000
2021-04-23 09:33:59,173 - INFO - wrapper - Writing example 40000
2021-04-23 09:34:06,575 - INFO - wrapper - Writing example 50000
2021-04-23 09:39:19,971 - INFO - wrapper - {'acc': 0.8700132414355074}
2021-04-23 09:39:19,971 - INFO - wrapper - 3
2021-04-23 10:23:15,221 - INFO - wrapper - Writing example 0
2021-04-23 10:23:24,515 - INFO - wrapper - Writing example 10000
2021-04-23 10:23:31,956 - INFO - wrapper - Writing example 20000
2021-04-23 10:23:39,386 - INFO - wrapper - Writing example 30000
2021-04-23 10:23:46,840 - INFO - wrapper - Writing example 40000
2021-04-23 10:23:54,309 - INFO - wrapper - Writing example 50000
2021-04-23 10:29:10,914 - INFO - wrapper - {'acc': 0.8692153600651886}
2021-04-23 10:29:10,914 - INFO - wrapper - 4
2021-04-23 11:12:26,954 - INFO - wrapper - Writing example 0
2021-04-23 11:12:34,974 - INFO - wrapper - Writing example 10000
2021-04-23 11:12:44,210 - INFO - wrapper - Writing example 20000
2021-04-23 11:12:51,645 - INFO - wrapper - Writing example 30000
2021-04-23 11:12:59,109 - INFO - wrapper - Writing example 40000
2021-04-23 11:13:06,601 - INFO - wrapper - Writing example 50000
2021-04-23 11:18:19,808 - INFO - wrapper - {'acc': 0.867619597324551}
2021-04-23 11:18:19,809 - INFO - wrapper - 5
2021-04-23 12:01:11,119 - INFO - wrapper - Writing example 0
2021-04-23 12:01:18,527 - INFO - wrapper - Writing example 10000
2021-04-23 12:01:25,947 - INFO - wrapper - Writing example 20000
2021-04-23 12:01:35,643 - INFO - wrapper - Writing example 30000
2021-04-23 12:01:43,374 - INFO - wrapper - Writing example 40000
2021-04-23 12:01:50,825 - INFO - wrapper - Writing example 50000
2021-04-23 12:07:04,279 - INFO - wrapper - {'acc': 0.8673140257359182}
2021-04-23 12:07:04,279 - INFO - wrapper - 6
2021-04-23 12:50:08,514 - INFO - wrapper - Writing example 0
2021-04-23 12:50:15,938 - INFO - wrapper - Writing example 10000
2021-04-23 12:50:23,308 - INFO - wrapper - Writing example 20000
2021-04-23 12:50:30,689 - INFO - wrapper - Writing example 30000
2021-04-23 12:50:40,313 - INFO - wrapper - Writing example 40000
2021-04-23 12:50:47,802 - INFO - wrapper - Writing example 50000
2021-04-23 12:56:00,987 - INFO - wrapper - {'acc': 0.8695548840525583}
2021-04-23 12:56:00,987 - INFO - wrapper - 7
2021-04-23 13:39:05,827 - INFO - wrapper - Writing example 0
2021-04-23 13:39:13,473 - INFO - wrapper - Writing example 10000
2021-04-23 13:39:20,909 - INFO - wrapper - Writing example 20000
2021-04-23 13:39:28,382 - INFO - wrapper - Writing example 30000
2021-04-23 13:39:35,874 - INFO - wrapper - Writing example 40000
2021-04-23 13:39:45,865 - INFO - wrapper - Writing example 50000
2021-04-23 13:44:59,349 - INFO - wrapper - {'acc': 0.8685193358910807}
2021-04-23 13:44:59,349 - INFO - wrapper - 8
2021-04-23 14:27:57,440 - INFO - wrapper - Writing example 0
2021-04-23 14:28:05,072 - INFO - wrapper - Writing example 10000
2021-04-23 14:28:12,496 - INFO - wrapper - Writing example 20000
2021-04-23 14:28:19,918 - INFO - wrapper - Writing example 30000
2021-04-23 14:28:27,352 - INFO - wrapper - Writing example 40000
2021-04-23 14:28:34,798 - INFO - wrapper - Writing example 50000
2021-04-23 14:33:51,080 - INFO - wrapper - {'acc': 0.8690455980715037}
2021-04-23 14:33:51,081 - INFO - wrapper - 9
2021-04-23 14:42:54,446 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-23 14:42:54,447 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-42 (num_examples=-1, set_type=test)
2021-04-23 14:42:54,547 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('contradiction', 6453), ('neutral', 6252)]
2021-04-23 14:42:54,547 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-23 14:42:54,547 - INFO - wrapper - Writing example 0
2021-04-23 14:43:02,766 - INFO - wrapper - Writing example 10000
2021-04-23 14:44:52,959 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-23 14:44:52,959 - INFO - modeling - eval_results: {'acc': 0.7975772382552043}
2021-04-23 14:44:52,960 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-23 14:44:52,961 - INFO - wrapper - Writing example 0
2021-04-23 14:45:00,002 - INFO - wrapper - Writing example 10000
2021-04-23 14:45:07,008 - INFO - wrapper - Writing example 20000
2021-04-23 14:45:13,986 - INFO - wrapper - Writing example 30000
2021-04-23 14:45:21,415 - INFO - wrapper - Writing example 40000
2021-04-23 14:45:31,157 - INFO - wrapper - Writing example 50000
2021-04-23 14:45:38,239 - INFO - wrapper - Writing example 60000
2021-04-23 14:45:45,330 - INFO - wrapper - Writing example 70000
2021-04-23 14:45:52,530 - INFO - wrapper - Writing example 80000
2021-04-23 14:45:59,610 - INFO - wrapper - Writing example 90000
2021-04-23 14:46:06,637 - INFO - wrapper - Writing example 100000
2021-04-23 14:46:13,714 - INFO - wrapper - Writing example 110000
2021-04-23 14:46:20,798 - INFO - wrapper - Writing example 120000
2021-04-23 14:46:32,124 - INFO - wrapper - Writing example 130000
2021-04-23 14:46:39,055 - INFO - wrapper - Writing example 140000
2021-04-23 14:46:45,980 - INFO - wrapper - Writing example 150000
2021-04-23 14:46:52,936 - INFO - wrapper - Writing example 160000
2021-04-23 14:46:59,928 - INFO - wrapper - Writing example 170000
2021-04-23 14:47:06,877 - INFO - wrapper - Writing example 180000
2021-04-23 14:47:13,801 - INFO - wrapper - Writing example 190000
2021-04-23 14:47:20,718 - INFO - wrapper - Writing example 200000
2021-04-23 14:47:27,623 - INFO - wrapper - Writing example 210000
2021-04-23 14:47:34,565 - INFO - wrapper - Writing example 220000
2021-04-23 14:47:47,788 - INFO - wrapper - Writing example 230000
2021-04-23 14:47:54,905 - INFO - wrapper - Writing example 240000
2021-04-23 14:48:01,936 - INFO - wrapper - Writing example 250000
2021-04-23 14:48:08,827 - INFO - wrapper - Writing example 260000
2021-04-23 14:48:15,721 - INFO - wrapper - Writing example 270000
2021-04-23 14:48:22,678 - INFO - wrapper - Writing example 280000
2021-04-23 14:48:29,722 - INFO - wrapper - Writing example 290000
2021-04-23 14:48:37,064 - INFO - wrapper - Writing example 300000
2021-04-23 14:48:44,142 - INFO - wrapper - Writing example 310000
2021-04-23 14:48:51,226 - INFO - wrapper - Writing example 320000
2021-04-23 14:48:58,261 - INFO - wrapper - Writing example 330000
2021-04-23 14:49:05,302 - INFO - wrapper - Writing example 340000
2021-04-23 14:49:12,316 - INFO - wrapper - Writing example 350000
2021-04-23 14:49:28,400 - INFO - wrapper - Writing example 360000
2021-04-23 14:49:35,376 - INFO - wrapper - Writing example 370000
2021-04-23 14:49:42,398 - INFO - wrapper - Writing example 380000
2021-04-23 14:49:49,367 - INFO - wrapper - Writing example 390000
2021-04-23 14:49:56,351 - INFO - wrapper - Writing example 400000
2021-04-23 15:33:36,294 - INFO - wrapper - Writing example 0
2021-04-23 15:33:43,491 - INFO - wrapper - Writing example 10000
2021-04-23 15:33:50,453 - INFO - wrapper - Writing example 20000
2021-04-23 15:33:57,409 - INFO - wrapper - Writing example 30000
2021-04-23 15:34:04,348 - INFO - wrapper - Writing example 40000
2021-04-23 15:34:11,284 - INFO - wrapper - Writing example 50000
2021-04-23 15:34:18,270 - INFO - wrapper - Writing example 60000
2021-04-23 15:34:25,139 - INFO - wrapper - Writing example 70000
2021-04-23 15:34:32,047 - INFO - wrapper - Writing example 80000
2021-04-23 15:34:38,927 - INFO - wrapper - Writing example 90000
2021-04-23 15:34:49,511 - INFO - wrapper - Writing example 100000
2021-04-23 15:34:56,585 - INFO - wrapper - Writing example 110000
2021-04-23 15:35:03,574 - INFO - wrapper - Writing example 120000
2021-04-23 15:35:10,534 - INFO - wrapper - Writing example 130000
2021-04-23 15:35:17,500 - INFO - wrapper - Writing example 140000
2021-04-23 15:47:51,027 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/snli...
2021-04-23 15:47:51,028 - INFO - wrapper - best_dev_acc: 0.8964 | best_global_step: 2500
2021-04-23 15:47:51,028 - INFO - wrapper - Saving models.
2021-04-23 16:30:03,095 - INFO - wrapper - Writing example 0
2021-04-23 16:30:09,999 - INFO - wrapper - Writing example 10000
2021-04-23 16:30:17,095 - INFO - wrapper - Writing example 20000
2021-04-23 16:30:24,120 - INFO - wrapper - Writing example 30000
2021-04-23 16:30:33,652 - INFO - wrapper - Writing example 40000
2021-04-23 16:30:40,628 - INFO - wrapper - Writing example 50000
2021-04-23 16:30:47,855 - INFO - wrapper - Writing example 60000
2021-04-23 16:30:55,188 - INFO - wrapper - Writing example 70000
2021-04-23 16:31:02,571 - INFO - wrapper - Writing example 80000
2021-04-23 16:31:09,976 - INFO - wrapper - Writing example 90000
2021-04-23 16:31:17,427 - INFO - wrapper - Writing example 100000
2021-04-23 16:31:24,945 - INFO - wrapper - Writing example 110000
2021-04-23 16:31:37,208 - INFO - wrapper - Writing example 120000
2021-04-23 16:31:44,432 - INFO - wrapper - Writing example 130000
2021-04-23 16:31:51,850 - INFO - wrapper - Writing example 140000
2021-04-23 16:44:27,467 - INFO - wrapper - {'acc': 0.8956507830537707}
2021-04-23 16:44:27,467 - INFO - wrapper - 1
2021-04-23 17:27:41,205 - INFO - wrapper - Writing example 0
2021-04-23 17:27:48,357 - INFO - wrapper - Writing example 10000
2021-04-23 17:27:55,259 - INFO - wrapper - Writing example 20000
2021-04-23 17:28:02,148 - INFO - wrapper - Writing example 30000
2021-04-23 17:28:09,039 - INFO - wrapper - Writing example 40000
2021-04-23 17:28:15,943 - INFO - wrapper - Writing example 50000
2021-04-23 17:28:22,833 - INFO - wrapper - Writing example 60000
2021-04-23 17:28:33,171 - INFO - wrapper - Writing example 70000
2021-04-23 17:28:40,109 - INFO - wrapper - Writing example 80000
2021-04-23 17:28:47,063 - INFO - wrapper - Writing example 90000
2021-04-23 17:28:54,017 - INFO - wrapper - Writing example 100000
2021-04-23 17:29:01,043 - INFO - wrapper - Writing example 110000
2021-04-23 17:29:08,064 - INFO - wrapper - Writing example 120000
2021-04-23 17:29:15,059 - INFO - wrapper - Writing example 130000
2021-04-23 17:29:22,048 - INFO - wrapper - Writing example 140000
2021-04-23 17:41:53,925 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/snli...
2021-04-23 17:41:53,925 - INFO - wrapper - best_dev_acc: 0.8979 | best_global_step: 7500
2021-04-23 17:41:53,925 - INFO - wrapper - Saving models.
2021-04-23 18:25:16,426 - INFO - wrapper - Writing example 0
2021-04-23 18:25:23,552 - INFO - wrapper - Writing example 10000
2021-04-23 18:25:30,420 - INFO - wrapper - Writing example 20000
2021-04-23 18:25:37,303 - INFO - wrapper - Writing example 30000
2021-04-23 18:25:44,192 - INFO - wrapper - Writing example 40000
2021-04-23 18:25:51,062 - INFO - wrapper - Writing example 50000
2021-04-23 18:25:57,900 - INFO - wrapper - Writing example 60000
2021-04-23 18:26:07,671 - INFO - wrapper - Writing example 70000
2021-04-23 18:26:14,604 - INFO - wrapper - Writing example 80000
2021-04-23 18:26:21,517 - INFO - wrapper - Writing example 90000
2021-04-23 18:26:28,431 - INFO - wrapper - Writing example 100000
2021-04-23 18:26:35,404 - INFO - wrapper - Writing example 110000
2021-04-23 18:26:42,392 - INFO - wrapper - Writing example 120000
2021-04-23 18:26:49,367 - INFO - wrapper - Writing example 130000
2021-04-23 18:26:56,325 - INFO - wrapper - Writing example 140000
2021-04-23 18:39:27,960 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/snli...
2021-04-23 18:39:27,960 - INFO - wrapper - best_dev_acc: 0.8982 | best_global_step: 10000
2021-04-23 18:39:27,960 - INFO - wrapper - Saving models.
2021-04-23 19:22:54,085 - INFO - wrapper - Writing example 0
2021-04-23 19:23:01,120 - INFO - wrapper - Writing example 10000
2021-04-23 19:23:07,955 - INFO - wrapper - Writing example 20000
2021-04-23 19:23:14,806 - INFO - wrapper - Writing example 30000
2021-04-23 19:23:21,640 - INFO - wrapper - Writing example 40000
2021-04-23 19:23:28,470 - INFO - wrapper - Writing example 50000
2021-04-23 19:23:35,271 - INFO - wrapper - Writing example 60000
2021-04-23 19:23:45,034 - INFO - wrapper - Writing example 70000
2021-04-23 19:23:51,943 - INFO - wrapper - Writing example 80000
2021-04-23 19:23:58,836 - INFO - wrapper - Writing example 90000
2021-04-23 19:24:05,735 - INFO - wrapper - Writing example 100000
2021-04-23 19:24:12,695 - INFO - wrapper - Writing example 110000
2021-04-23 19:24:19,634 - INFO - wrapper - Writing example 120000
2021-04-23 19:24:26,586 - INFO - wrapper - Writing example 130000
2021-04-23 19:24:33,518 - INFO - wrapper - Writing example 140000
2021-04-23 19:37:04,085 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/snli...
2021-04-23 19:37:04,085 - INFO - wrapper - best_dev_acc: 0.8985 | best_global_step: 12500
2021-04-23 19:37:04,085 - INFO - wrapper - Saving models.
2021-04-23 20:20:24,316 - INFO - wrapper - Writing example 0
2021-04-23 20:20:31,194 - INFO - wrapper - Writing example 10000
2021-04-23 20:20:38,054 - INFO - wrapper - Writing example 20000
2021-04-23 20:20:44,932 - INFO - wrapper - Writing example 30000
2021-04-23 20:20:51,800 - INFO - wrapper - Writing example 40000
2021-04-23 20:20:58,677 - INFO - wrapper - Writing example 50000
2021-04-23 20:21:05,511 - INFO - wrapper - Writing example 60000
2021-04-23 20:21:15,150 - INFO - wrapper - Writing example 70000
2021-04-23 20:21:22,074 - INFO - wrapper - Writing example 80000
2021-04-23 20:21:28,994 - INFO - wrapper - Writing example 90000
2021-04-23 20:21:35,925 - INFO - wrapper - Writing example 100000
2021-04-23 20:21:42,917 - INFO - wrapper - Writing example 110000
2021-04-23 20:21:49,890 - INFO - wrapper - Writing example 120000
2021-04-23 20:21:56,871 - INFO - wrapper - Writing example 130000
2021-04-23 20:22:03,852 - INFO - wrapper - Writing example 140000
2021-04-23 20:34:38,989 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/snli...
2021-04-23 20:34:38,990 - INFO - wrapper - best_dev_acc: 0.8990 | best_global_step: 15000
2021-04-23 20:34:38,990 - INFO - wrapper - Saving models.
2021-04-23 21:18:05,876 - INFO - wrapper - Writing example 0
2021-04-23 21:18:12,922 - INFO - wrapper - Writing example 10000
2021-04-23 21:18:19,761 - INFO - wrapper - Writing example 20000
2021-04-23 21:18:26,628 - INFO - wrapper - Writing example 30000
2021-04-23 21:18:33,470 - INFO - wrapper - Writing example 40000
2021-04-23 21:18:40,304 - INFO - wrapper - Writing example 50000
2021-04-23 21:18:47,110 - INFO - wrapper - Writing example 60000
2021-04-23 21:18:53,929 - INFO - wrapper - Writing example 70000
2021-04-23 21:19:00,760 - INFO - wrapper - Writing example 80000
2021-04-23 21:19:07,600 - INFO - wrapper - Writing example 90000
2021-04-23 21:19:18,002 - INFO - wrapper - Writing example 100000
2021-04-23 21:19:24,957 - INFO - wrapper - Writing example 110000
2021-04-23 21:19:31,901 - INFO - wrapper - Writing example 120000
2021-04-23 21:19:38,859 - INFO - wrapper - Writing example 130000
2021-04-23 21:19:45,804 - INFO - wrapper - Writing example 140000
2021-04-23 21:32:15,994 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/snli...
2021-04-23 21:32:15,994 - INFO - wrapper - best_dev_acc: 0.8994 | best_global_step: 17500
2021-04-23 21:32:15,994 - INFO - wrapper - Saving models.
2021-04-23 22:15:44,338 - INFO - wrapper - Writing example 0
2021-04-23 22:15:51,424 - INFO - wrapper - Writing example 10000
2021-04-23 22:15:58,306 - INFO - wrapper - Writing example 20000
2021-04-23 22:16:05,193 - INFO - wrapper - Writing example 30000
2021-04-23 22:16:14,376 - INFO - wrapper - Writing example 40000
2021-04-23 22:16:21,293 - INFO - wrapper - Writing example 50000
2021-04-23 22:16:28,165 - INFO - wrapper - Writing example 60000
2021-04-23 22:16:35,046 - INFO - wrapper - Writing example 70000
2021-04-23 22:16:41,944 - INFO - wrapper - Writing example 80000
2021-04-23 22:16:48,826 - INFO - wrapper - Writing example 90000
2021-04-23 22:16:55,735 - INFO - wrapper - Writing example 100000
2021-04-23 22:17:06,532 - INFO - wrapper - Writing example 110000
2021-04-23 22:17:13,528 - INFO - wrapper - Writing example 120000
2021-04-23 22:17:20,491 - INFO - wrapper - Writing example 130000
2021-04-23 22:17:27,464 - INFO - wrapper - Writing example 140000
2021-04-23 22:29:58,340 - INFO - wrapper - {'acc': 0.8993852402013964}
2021-04-23 22:29:58,340 - INFO - wrapper - 1
2021-04-23 23:11:27,392 - INFO - wrapper - Writing example 0
2021-04-23 23:11:34,268 - INFO - wrapper - Writing example 10000
2021-04-23 23:11:41,157 - INFO - wrapper - Writing example 20000
2021-04-23 23:11:48,028 - INFO - wrapper - Writing example 30000
2021-04-23 23:11:54,885 - INFO - wrapper - Writing example 40000
2021-04-23 23:12:01,748 - INFO - wrapper - Writing example 50000
2021-04-23 23:12:11,325 - INFO - wrapper - Writing example 60000
2021-04-23 23:12:18,214 - INFO - wrapper - Writing example 70000
2021-04-23 23:12:25,132 - INFO - wrapper - Writing example 80000
2021-04-23 23:12:32,029 - INFO - wrapper - Writing example 90000
2021-04-23 23:12:38,943 - INFO - wrapper - Writing example 100000
2021-04-23 23:12:45,939 - INFO - wrapper - Writing example 110000
2021-04-23 23:12:52,924 - INFO - wrapper - Writing example 120000
2021-04-23 23:12:59,886 - INFO - wrapper - Writing example 130000
2021-04-23 23:13:11,305 - INFO - wrapper - Writing example 140000
2021-04-23 23:25:41,919 - INFO - wrapper - {'acc': 0.8990583882722746}
2021-04-23 23:25:41,919 - INFO - wrapper - 2
2021-04-24 00:07:59,348 - INFO - wrapper - Writing example 0
2021-04-24 00:08:06,316 - INFO - wrapper - Writing example 10000
2021-04-24 00:08:13,166 - INFO - wrapper - Writing example 20000
2021-04-24 00:08:20,027 - INFO - wrapper - Writing example 30000
2021-04-24 00:08:26,874 - INFO - wrapper - Writing example 40000
2021-04-24 00:08:33,716 - INFO - wrapper - Writing example 50000
2021-04-24 00:08:40,533 - INFO - wrapper - Writing example 60000
2021-04-24 00:08:47,381 - INFO - wrapper - Writing example 70000
2021-04-24 00:08:54,229 - INFO - wrapper - Writing example 80000
2021-04-24 00:09:01,067 - INFO - wrapper - Writing example 90000
2021-04-24 00:09:11,449 - INFO - wrapper - Writing example 100000
2021-04-24 00:09:18,410 - INFO - wrapper - Writing example 110000
2021-04-24 00:09:25,346 - INFO - wrapper - Writing example 120000
2021-04-24 00:09:32,242 - INFO - wrapper - Writing example 130000
2021-04-24 00:09:39,143 - INFO - wrapper - Writing example 140000
2021-04-24 00:22:10,245 - INFO - wrapper - Saving trained model at output/full/adaptation/g2/snli...
2021-04-24 00:22:10,245 - INFO - wrapper - best_dev_acc: 0.8999 | best_global_step: 25000
2021-04-24 00:22:10,245 - INFO - wrapper - Saving models.
2021-04-24 01:05:36,766 - INFO - wrapper - Writing example 0
2021-04-24 01:05:43,839 - INFO - wrapper - Writing example 10000
2021-04-24 01:05:50,713 - INFO - wrapper - Writing example 20000
2021-04-24 01:05:59,741 - INFO - wrapper - Writing example 30000
2021-04-24 01:06:06,662 - INFO - wrapper - Writing example 40000
2021-04-24 01:06:13,590 - INFO - wrapper - Writing example 50000
2021-04-24 01:06:20,455 - INFO - wrapper - Writing example 60000
2021-04-24 01:06:27,345 - INFO - wrapper - Writing example 70000
2021-04-24 01:06:34,239 - INFO - wrapper - Writing example 80000
2021-04-24 01:06:41,148 - INFO - wrapper - Writing example 90000
2021-04-24 01:06:48,073 - INFO - wrapper - Writing example 100000
2021-04-24 01:06:58,821 - INFO - wrapper - Writing example 110000
2021-04-24 01:07:05,783 - INFO - wrapper - Writing example 120000
2021-04-24 01:07:12,756 - INFO - wrapper - Writing example 130000
2021-04-24 01:07:19,734 - INFO - wrapper - Writing example 140000
2021-04-24 01:19:51,058 - INFO - wrapper - {'acc': 0.8995590976105038}
2021-04-24 01:19:51,058 - INFO - wrapper - 1
2021-04-24 01:28:50,273 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-24 01:28:50,273 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-42 (num_examples=-1, set_type=test)
2021-04-24 01:28:50,320 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-24 01:28:50,333 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-24 01:28:50,334 - INFO - wrapper - Writing example 0
2021-04-24 01:29:47,140 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-24 01:29:47,140 - INFO - modeling - eval_results: {'acc': 0.8799024588498273}
2021-04-25 13:30:32,560 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=21000, pet_max_meta_steps=36000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-25 13:30:32,589 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=train)
2021-04-25 13:30:42,569 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-25 13:30:42,569 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=dev)
2021-04-25 13:30:45,173 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-25 13:30:45,173 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-25 13:30:45,173 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-25 13:30:45,173 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-25 13:30:45,173 - INFO - run_task_adaptation - task=MNLI
2021-04-25 13:30:45,173 - INFO - run_task_adaptation - label=contradiction
2021-04-25 13:30:45,173 - INFO - run_task_adaptation - **********************************
2021-04-25 13:30:48,885 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 13:31:15,068 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-25 13:31:15,068 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 13:31:24,465 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 13:31:32,627 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 13:31:40,576 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 13:31:48,433 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 13:31:56,232 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 13:32:04,008 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 13:32:14,660 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 13:32:22,385 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 13:32:30,077 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 13:32:37,739 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 13:32:45,357 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 13:32:52,932 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 13:33:00,067 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 13:33:07,148 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 13:33:18,913 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 13:33:25,931 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 13:33:32,963 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 13:33:39,977 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 13:33:46,991 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 13:33:53,990 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 13:34:00,981 - INFO - transprompt_wrapper - Writing example 210000
2021-04-25 13:34:07,973 - INFO - transprompt_wrapper - Writing example 220000
2021-04-25 13:34:14,970 - INFO - transprompt_wrapper - Writing example 230000
2021-04-25 13:34:21,946 - INFO - transprompt_wrapper - Writing example 240000
2021-04-25 13:34:35,701 - INFO - transprompt_wrapper - Writing example 250000
2021-04-25 13:34:43,204 - INFO - transprompt_wrapper - Writing example 260000
2021-04-25 13:34:50,680 - INFO - transprompt_wrapper - Writing example 270000
2021-04-25 13:34:58,170 - INFO - transprompt_wrapper - Writing example 280000
2021-04-25 13:35:05,687 - INFO - transprompt_wrapper - Writing example 290000
2021-04-25 13:35:13,149 - INFO - transprompt_wrapper - Writing example 300000
2021-04-25 13:35:20,629 - INFO - transprompt_wrapper - Writing example 310000
2021-04-25 13:35:28,112 - INFO - transprompt_wrapper - Writing example 320000
2021-04-25 13:35:35,600 - INFO - transprompt_wrapper - Writing example 330000
2021-04-25 13:35:43,134 - INFO - transprompt_wrapper - Writing example 340000
2021-04-25 13:35:50,599 - INFO - transprompt_wrapper - Writing example 350000
2021-04-25 13:35:57,952 - INFO - transprompt_wrapper - Writing example 360000
2021-04-25 13:36:04,864 - INFO - transprompt_wrapper - Writing example 370000
2021-04-25 13:36:20,888 - INFO - transprompt_wrapper - Writing example 380000
2021-04-25 13:36:27,836 - INFO - transprompt_wrapper - Writing example 390000
2021-04-25 13:36:34,775 - INFO - transprompt_wrapper - Writing example 400000
2021-04-25 13:36:41,714 - INFO - transprompt_wrapper - Writing example 410000
2021-04-25 13:36:48,645 - INFO - transprompt_wrapper - Writing example 420000
2021-04-25 13:36:55,597 - INFO - transprompt_wrapper - Writing example 430000
2021-04-25 13:37:02,531 - INFO - transprompt_wrapper - Writing example 440000
2021-04-25 13:37:09,457 - INFO - transprompt_wrapper - Writing example 450000
2021-04-25 13:37:16,389 - INFO - transprompt_wrapper - Writing example 460000
2021-04-25 13:37:23,314 - INFO - transprompt_wrapper - Writing example 470000
2021-04-25 13:37:30,258 - INFO - transprompt_wrapper - Writing example 480000
2021-04-25 13:37:37,196 - INFO - transprompt_wrapper - Writing example 490000
2021-04-25 13:37:44,537 - INFO - transprompt_wrapper - Writing example 500000
2021-04-25 13:37:52,065 - INFO - transprompt_wrapper - Writing example 510000
2021-04-25 13:37:59,574 - INFO - transprompt_wrapper - Writing example 520000
2021-04-25 13:38:19,449 - INFO - transprompt_wrapper - Writing example 530000
2021-04-25 13:38:26,972 - INFO - transprompt_wrapper - Writing example 540000
2021-04-25 13:38:34,500 - INFO - transprompt_wrapper - Writing example 550000
2021-04-25 13:38:42,253 - INFO - transprompt_wrapper - Writing example 560000
2021-04-25 13:38:49,792 - INFO - transprompt_wrapper - Writing example 570000
2021-04-25 13:38:57,298 - INFO - transprompt_wrapper - Writing example 580000
2021-04-25 13:39:04,808 - INFO - transprompt_wrapper - Writing example 590000
2021-04-25 13:39:12,327 - INFO - transprompt_wrapper - Writing example 600000
2021-04-25 13:39:19,557 - INFO - transprompt_wrapper - Writing example 610000
2021-04-25 13:39:26,562 - INFO - transprompt_wrapper - Writing example 620000
2021-04-25 13:39:33,578 - INFO - transprompt_wrapper - Writing example 630000
2021-04-25 13:39:40,588 - INFO - transprompt_wrapper - Writing example 640000
2021-04-25 13:39:47,593 - INFO - transprompt_wrapper - Writing example 650000
2021-04-25 13:39:54,598 - INFO - transprompt_wrapper - Writing example 660000
2021-04-25 13:40:01,599 - INFO - transprompt_wrapper - Writing example 670000
2021-04-25 13:40:08,618 - INFO - transprompt_wrapper - Writing example 680000
2021-04-25 13:40:15,616 - INFO - transprompt_wrapper - Writing example 690000
2021-04-25 13:40:22,620 - INFO - transprompt_wrapper - Writing example 700000
2021-04-25 13:40:29,630 - INFO - transprompt_wrapper - Writing example 710000
2021-04-25 13:40:36,655 - INFO - transprompt_wrapper - Writing example 720000
2021-04-25 13:41:00,432 - INFO - transprompt_wrapper - Writing example 730000
2021-04-25 13:43:09,898 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=21000, pet_max_meta_steps=36000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-25 13:43:09,898 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=train)
2021-04-25 13:43:19,606 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-25 13:43:19,606 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=dev)
2021-04-25 13:43:22,159 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-25 13:43:22,160 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-25 13:43:22,160 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-25 13:43:22,160 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-25 13:43:22,160 - INFO - run_task_adaptation - task=MNLI
2021-04-25 13:43:22,160 - INFO - run_task_adaptation - label=contradiction
2021-04-25 13:43:22,160 - INFO - run_task_adaptation - **********************************
2021-04-25 13:43:24,973 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 13:43:41,775 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-25 13:43:41,775 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 13:43:51,169 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 13:43:59,633 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 13:44:07,499 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 13:44:15,237 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 13:44:22,933 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 13:44:30,586 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 13:44:40,804 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 13:44:48,419 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 13:44:56,021 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 13:45:03,609 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 13:45:11,175 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 13:45:18,246 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 13:45:25,221 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 13:45:32,176 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 13:45:42,612 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 13:45:49,534 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 13:45:56,457 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 13:46:03,376 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 13:46:10,324 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 13:46:17,231 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 13:46:24,125 - INFO - transprompt_wrapper - Writing example 210000
2021-04-25 13:46:31,024 - INFO - transprompt_wrapper - Writing example 220000
2021-04-25 13:46:37,924 - INFO - transprompt_wrapper - Writing example 230000
2021-04-25 13:46:44,822 - INFO - transprompt_wrapper - Writing example 240000
2021-04-25 13:46:56,914 - INFO - transprompt_wrapper - Writing example 250000
2021-04-25 13:47:04,325 - INFO - transprompt_wrapper - Writing example 260000
2021-04-25 13:47:11,716 - INFO - transprompt_wrapper - Writing example 270000
2021-04-25 13:47:19,125 - INFO - transprompt_wrapper - Writing example 280000
2021-04-25 13:47:26,546 - INFO - transprompt_wrapper - Writing example 290000
2021-04-25 13:47:33,909 - INFO - transprompt_wrapper - Writing example 300000
2021-04-25 13:47:41,293 - INFO - transprompt_wrapper - Writing example 310000
2021-04-25 13:47:48,687 - INFO - transprompt_wrapper - Writing example 320000
2021-04-25 13:47:56,083 - INFO - transprompt_wrapper - Writing example 330000
2021-04-25 13:48:03,478 - INFO - transprompt_wrapper - Writing example 340000
2021-04-25 13:48:10,861 - INFO - transprompt_wrapper - Writing example 350000
2021-04-25 13:48:18,139 - INFO - transprompt_wrapper - Writing example 360000
2021-04-25 13:48:24,970 - INFO - transprompt_wrapper - Writing example 370000
2021-04-25 13:48:38,525 - INFO - transprompt_wrapper - Writing example 380000
2021-04-25 13:48:45,379 - INFO - transprompt_wrapper - Writing example 390000
2021-04-25 13:48:52,219 - INFO - transprompt_wrapper - Writing example 400000
2021-04-25 13:48:59,054 - INFO - transprompt_wrapper - Writing example 410000
2021-04-25 13:49:05,899 - INFO - transprompt_wrapper - Writing example 420000
2021-04-25 13:49:12,749 - INFO - transprompt_wrapper - Writing example 430000
2021-04-25 13:49:19,595 - INFO - transprompt_wrapper - Writing example 440000
2021-04-25 13:49:26,428 - INFO - transprompt_wrapper - Writing example 450000
2021-04-25 13:49:33,271 - INFO - transprompt_wrapper - Writing example 460000
2021-04-25 13:49:40,111 - INFO - transprompt_wrapper - Writing example 470000
2021-04-25 13:49:46,957 - INFO - transprompt_wrapper - Writing example 480000
2021-04-25 13:49:54,332 - INFO - transprompt_wrapper - Writing example 490000
2021-04-25 13:50:01,688 - INFO - transprompt_wrapper - Writing example 500000
2021-04-25 13:50:09,201 - INFO - transprompt_wrapper - Writing example 510000
2021-04-25 13:50:16,669 - INFO - transprompt_wrapper - Writing example 520000
2021-04-25 13:50:33,414 - INFO - transprompt_wrapper - Writing example 530000
2021-04-25 13:50:40,882 - INFO - transprompt_wrapper - Writing example 540000
2021-04-25 13:50:48,338 - INFO - transprompt_wrapper - Writing example 550000
2021-04-25 13:50:55,792 - INFO - transprompt_wrapper - Writing example 560000
2021-04-25 13:51:03,232 - INFO - transprompt_wrapper - Writing example 570000
2021-04-25 13:51:10,706 - INFO - transprompt_wrapper - Writing example 580000
2021-04-25 13:51:18,532 - INFO - transprompt_wrapper - Writing example 590000
2021-04-25 13:51:26,588 - INFO - transprompt_wrapper - Writing example 600000
2021-04-25 13:51:33,953 - INFO - transprompt_wrapper - Writing example 610000
2021-04-25 13:51:40,949 - INFO - transprompt_wrapper - Writing example 620000
2021-04-25 13:51:47,924 - INFO - transprompt_wrapper - Writing example 630000
2021-04-25 13:51:54,889 - INFO - transprompt_wrapper - Writing example 640000
2021-04-25 13:52:01,830 - INFO - transprompt_wrapper - Writing example 650000
2021-04-25 13:52:08,766 - INFO - transprompt_wrapper - Writing example 660000
2021-04-25 13:52:16,171 - INFO - transprompt_wrapper - Writing example 670000
2021-04-25 13:52:23,183 - INFO - transprompt_wrapper - Writing example 680000
2021-04-25 13:52:30,158 - INFO - transprompt_wrapper - Writing example 690000
2021-04-25 13:52:37,116 - INFO - transprompt_wrapper - Writing example 700000
2021-04-25 13:52:44,071 - INFO - transprompt_wrapper - Writing example 710000
2021-04-25 13:52:51,004 - INFO - transprompt_wrapper - Writing example 720000
2021-04-25 13:53:10,088 - INFO - transprompt_wrapper - Writing example 730000
2021-04-25 14:30:13,459 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 14:30:21,177 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 14:30:28,528 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 14:30:35,635 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 14:30:42,542 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 14:30:49,402 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 14:30:56,272 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 14:31:03,314 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 14:31:10,812 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 14:31:18,207 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 14:31:25,162 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 14:31:32,110 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 14:31:39,004 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 14:31:45,945 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 14:31:53,133 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 14:32:00,719 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 14:32:07,950 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 14:32:14,922 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 14:32:21,925 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 14:32:28,906 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 14:32:35,834 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 14:46:27,395 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 14:46:27,395 - INFO - transprompt_wrapper - best_dev_acc: 0.8551 | best_global_step: 2500
2021-04-25 14:46:27,396 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:06:01,637 - INFO - run_task_generalization - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-12', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=192, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=12, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-25 15:06:01,637 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-12 (num_examples=-1, set_type=train)
2021-04-25 15:06:01,728 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-25 15:06:01,728 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-12 (num_examples=-1, set_type=dev)
2021-04-25 15:06:01,746 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-25 15:06:01,746 - INFO - run_task_generalization - ************Training Example:**************
2021-04-25 15:06:01,747 - INFO - run_task_generalization - text_a=unfortunately , we 'd prefer a simple misfire .
2021-04-25 15:06:01,747 - INFO - run_task_generalization - text_b=None
2021-04-25 15:06:01,747 - INFO - run_task_generalization - task=SST-2
2021-04-25 15:06:01,747 - INFO - run_task_generalization - label=0
2021-04-25 15:06:01,747 - INFO - run_task_generalization - **********************************
2021-04-25 15:06:01,747 - INFO - run_task_generalization - ======== Meta-learning on task cr,mr, Task generalization on unseen tasks: sst-2 ========
2021-04-25 15:06:04,697 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:06:50,350 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-25 15:06:50,351 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:07:57,573 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:08:00,165 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:08:00,165 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-25 15:08:00,165 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:09:25,477 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:09:28,112 - INFO - transprompt_wrapper - {'acc': 0.984375}
2021-04-25 15:09:28,112 - INFO - transprompt_wrapper - 1
2021-04-25 15:10:34,695 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:10:37,397 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:10:37,397 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-25 15:10:37,397 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:12:02,832 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:12:05,607 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:12:05,608 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-25 15:12:05,608 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:13:30,736 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:13:33,209 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:13:33,209 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-25 15:13:33,209 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:14:58,749 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:15:01,681 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:15:01,682 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 600
2021-04-25 15:15:01,682 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:16:29,360 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:16:31,996 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:16:31,996 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 700
2021-04-25 15:16:31,996 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:17:57,555 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:18:00,109 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:18:00,109 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 800
2021-04-25 15:18:00,109 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:19:26,291 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:19:28,735 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:19:28,736 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 900
2021-04-25 15:19:28,736 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:20:53,595 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:20:56,339 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:20:56,340 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 1000
2021-04-25 15:20:56,340 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:21:15,977 - INFO - modeling - Saving complete
2021-04-25 15:21:15,977 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-25 15:21:15,977 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-25 15:21:16,073 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:21:59,746 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task sst-2 =========
2021-04-25 15:21:59,746 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:22:34,252 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:22:35,520 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-25 15:22:35,520 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-25 15:22:35,521 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:23:17,717 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:23:19,208 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-25 15:23:19,208 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-25 15:23:19,208 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:24:11,766 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:24:12,867 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-25 15:24:12,867 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-25 15:24:12,867 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:24:31,837 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:25:18,300 - INFO - modeling - ========= Stage2: Evaluating test set on Task sst-2
2021-04-25 15:25:18,300 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-12 (num_examples=-1, set_type=test)
2021-04-25 15:25:18,366 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-25 15:25:18,366 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-25 15:25:18,367 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:25:55,162 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-25 15:25:55,163 - INFO - modeling - eval_results: {'acc': 0.9334862385321101}
2021-04-25 15:25:55,224 - INFO - run_task_generalization - ======== Meta-learning on task cr,SST-2, Task generalization on unseen tasks: mr ========
2021-04-25 15:25:57,986 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:26:23,746 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-25 15:26:23,746 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:26:59,299 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:27:02,197 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:27:02,197 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-25 15:27:02,197 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:27:56,822 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:27:59,346 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:27:59,346 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-25 15:27:59,346 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:28:52,769 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:28:55,547 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:28:55,547 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-25 15:28:55,547 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:29:14,283 - INFO - modeling - Saving complete
2021-04-25 15:29:14,283 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-25 15:29:14,283 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-25 15:29:14,393 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:30:01,753 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task mr =========
2021-04-25 15:30:01,753 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:30:36,397 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:30:37,893 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-25 15:30:37,893 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-25 15:30:37,893 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:31:19,556 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:31:21,025 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-25 15:31:21,025 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-25 15:31:21,025 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:32:14,815 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:32:16,211 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-25 15:32:16,211 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-25 15:32:16,211 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:32:35,050 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:32:35,571 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:32:43,119 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 15:32:52,291 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 15:32:59,278 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 15:33:06,173 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 15:33:13,358 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 15:33:20,299 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 15:33:22,416 - INFO - modeling - ========= Stage2: Evaluating test set on Task mr
2021-04-25 15:33:22,417 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-12 (num_examples=-1, set_type=test)
2021-04-25 15:33:22,715 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-25 15:33:22,716 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-25 15:33:22,716 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:33:27,433 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 15:33:34,931 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 15:33:44,932 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 15:33:52,024 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 15:33:59,013 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 15:34:01,083 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-25 15:34:01,083 - INFO - modeling - eval_results: {'acc': 0.8905}
2021-04-25 15:34:01,260 - INFO - run_task_generalization - ======== Meta-learning on task SST-2,mr, Task generalization on unseen tasks: cr ========
2021-04-25 15:34:04,030 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:34:06,150 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 15:34:13,169 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 15:34:20,423 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 15:34:28,297 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 15:34:29,587 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-25 15:34:29,587 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:34:35,836 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 15:34:42,883 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 15:34:50,441 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:34:51,692 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:34:51,692 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-25 15:34:51,692 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:34:54,022 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 15:35:01,015 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 15:35:08,013 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 15:35:37,743 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:35:40,096 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:35:40,096 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-25 15:35:40,096 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:36:28,863 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:36:31,201 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-25 15:36:31,201 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-25 15:36:31,201 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:36:50,251 - INFO - modeling - Saving complete
2021-04-25 15:36:50,251 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-25 15:36:50,251 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-25 15:36:50,350 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:37:41,799 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task cr =========
2021-04-25 15:37:41,799 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:38:12,695 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:38:13,797 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-25 15:38:13,797 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-25 15:38:13,797 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:38:50,554 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:38:51,733 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-25 15:38:51,733 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-25 15:38:51,734 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:39:41,956 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:39:43,135 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-25 15:39:43,136 - INFO - transprompt_wrapper - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-25 15:39:43,136 - INFO - transprompt_wrapper - Saving models.
2021-04-25 15:40:01,623 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-25 15:40:50,334 - INFO - modeling - ========= Stage2: Evaluating test set on Task cr
2021-04-25 15:40:50,335 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-12 (num_examples=-1, set_type=test)
2021-04-25 15:40:50,619 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-25 15:40:50,619 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-25 15:40:50,619 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 15:41:56,690 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-25 15:41:56,690 - INFO - modeling - eval_results: {'acc': 0.905}
2021-04-25 15:51:17,062 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 15:51:17,063 - INFO - transprompt_wrapper - best_dev_acc: 0.8709 | best_global_step: 5000
2021-04-25 15:51:17,063 - INFO - transprompt_wrapper - Saving models.
2021-04-25 16:28:30,053 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 16:28:37,567 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 16:28:44,714 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 16:28:51,400 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 16:28:58,086 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 16:29:04,784 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 16:29:11,477 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 16:29:18,293 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 16:29:28,465 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 16:29:35,549 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 16:29:42,229 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 16:29:48,960 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 16:29:55,663 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 16:30:02,351 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 16:30:09,296 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 16:30:16,597 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 16:30:27,230 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 16:30:34,000 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 16:30:40,779 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 16:30:47,592 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 16:30:54,383 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 16:44:39,889 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 16:44:39,889 - INFO - transprompt_wrapper - best_dev_acc: 0.8762 | best_global_step: 7500
2021-04-25 16:44:39,889 - INFO - transprompt_wrapper - Saving models.
2021-04-25 17:21:36,473 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 17:21:43,906 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 17:21:51,103 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 17:21:57,871 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 17:22:04,615 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 17:22:11,364 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 17:22:20,302 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 17:22:27,175 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 17:22:34,420 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 17:22:41,518 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 17:22:48,230 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 17:22:54,959 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 17:23:01,681 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 17:23:11,549 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 17:23:18,534 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 17:23:25,812 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 17:23:32,834 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 17:23:39,603 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 17:23:46,403 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 17:23:53,188 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 17:23:59,963 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 17:37:45,268 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 17:37:45,268 - INFO - transprompt_wrapper - best_dev_acc: 0.8799 | best_global_step: 10000
2021-04-25 17:37:45,268 - INFO - transprompt_wrapper - Saving models.
2021-04-25 18:14:59,216 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 18:15:06,627 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 18:15:15,566 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 18:15:22,346 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 18:15:29,127 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 18:15:35,901 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 18:15:42,680 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 18:15:49,565 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 18:15:56,802 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 18:16:06,632 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 18:16:13,391 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 18:16:20,141 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 18:16:26,891 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 18:16:33,665 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 18:16:40,681 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 18:16:47,989 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 18:16:55,070 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 18:17:01,904 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 18:17:12,485 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 18:17:19,306 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 18:17:26,146 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 18:31:11,854 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 18:31:11,855 - INFO - transprompt_wrapper - best_dev_acc: 0.8829 | best_global_step: 12500
2021-04-25 18:31:11,855 - INFO - transprompt_wrapper - Saving models.
2021-04-25 19:08:44,381 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 19:08:51,794 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 19:08:58,972 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 19:09:05,706 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 19:09:12,442 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 19:09:19,195 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 19:09:25,927 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 19:09:32,771 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 19:09:42,500 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 19:09:49,603 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 19:09:56,306 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 19:10:02,997 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 19:10:09,719 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 19:10:16,427 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 19:10:23,393 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 19:10:30,649 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 19:10:41,315 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 19:10:48,082 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 19:10:54,861 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 19:11:01,651 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 19:11:08,433 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 19:24:53,558 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 19:24:53,559 - INFO - transprompt_wrapper - best_dev_acc: 0.8845 | best_global_step: 15000
2021-04-25 19:24:53,559 - INFO - transprompt_wrapper - Saving models.
2021-04-25 20:02:51,029 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 20:02:58,469 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 20:03:05,684 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 20:03:12,457 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 20:03:19,206 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 20:03:25,957 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 20:03:34,930 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 20:03:41,829 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 20:03:49,092 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 20:03:56,210 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 20:04:02,922 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 20:04:09,674 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 20:04:16,404 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 20:04:26,300 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 20:04:33,303 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 20:04:40,608 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 20:04:47,646 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 20:04:54,439 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 20:05:01,247 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 20:05:08,055 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 20:05:14,857 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 20:19:00,732 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 20:19:00,732 - INFO - transprompt_wrapper - best_dev_acc: 0.8857 | best_global_step: 17500
2021-04-25 20:19:00,732 - INFO - transprompt_wrapper - Saving models.
2021-04-25 20:57:10,896 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 20:57:18,261 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 20:57:27,133 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 20:57:33,858 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 20:57:40,575 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 20:57:47,293 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 20:57:54,010 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 20:58:00,841 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 20:58:08,044 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 20:58:17,788 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 20:58:24,480 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 20:58:31,160 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 20:58:37,871 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 20:58:44,571 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 20:58:51,525 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 20:58:58,763 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 20:59:05,792 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 20:59:12,557 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 20:59:23,024 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 20:59:29,801 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 20:59:36,572 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 21:13:22,249 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 21:13:22,250 - INFO - transprompt_wrapper - best_dev_acc: 0.8875 | best_global_step: 20000
2021-04-25 21:13:22,250 - INFO - transprompt_wrapper - Saving models.
2021-04-25 21:50:51,515 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 21:50:58,899 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 21:51:06,056 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 21:51:12,773 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 21:51:19,492 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 21:51:26,218 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 21:51:32,940 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 21:51:42,197 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 21:51:49,397 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 21:51:56,462 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 21:52:03,123 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 21:52:09,770 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 21:52:16,454 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 21:52:23,128 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 21:52:30,046 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 21:52:37,257 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 21:52:47,750 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 21:52:54,501 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 21:53:01,238 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 21:53:07,995 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 21:53:14,740 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 22:07:00,548 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 22:07:00,549 - INFO - transprompt_wrapper - best_dev_acc: 0.8877 | best_global_step: 22500
2021-04-25 22:07:00,549 - INFO - transprompt_wrapper - Saving models.
2021-04-25 22:44:03,518 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 22:44:10,963 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 22:44:18,173 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 22:44:24,941 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 22:44:31,708 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 22:44:40,642 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 22:44:47,435 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 22:44:54,335 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 22:45:01,639 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 22:45:08,809 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 22:45:15,569 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 22:45:22,322 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 22:45:29,108 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 22:45:39,057 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 22:45:46,066 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 22:45:53,367 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 22:46:00,434 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 22:46:07,245 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 22:46:14,054 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 22:46:20,882 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 22:46:27,707 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 23:00:13,126 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-25 23:00:13,126 - INFO - transprompt_wrapper - best_dev_acc: 0.8897 | best_global_step: 25000
2021-04-25 23:00:13,126 - INFO - transprompt_wrapper - Saving models.
2021-04-25 23:37:30,053 - INFO - transprompt_wrapper - Writing example 0
2021-04-25 23:37:39,075 - INFO - transprompt_wrapper - Writing example 10000
2021-04-25 23:37:46,236 - INFO - transprompt_wrapper - Writing example 20000
2021-04-25 23:37:52,937 - INFO - transprompt_wrapper - Writing example 30000
2021-04-25 23:37:59,647 - INFO - transprompt_wrapper - Writing example 40000
2021-04-25 23:38:06,360 - INFO - transprompt_wrapper - Writing example 50000
2021-04-25 23:38:13,076 - INFO - transprompt_wrapper - Writing example 60000
2021-04-25 23:38:19,909 - INFO - transprompt_wrapper - Writing example 70000
2021-04-25 23:38:29,623 - INFO - transprompt_wrapper - Writing example 80000
2021-04-25 23:38:36,706 - INFO - transprompt_wrapper - Writing example 90000
2021-04-25 23:38:43,417 - INFO - transprompt_wrapper - Writing example 100000
2021-04-25 23:38:50,120 - INFO - transprompt_wrapper - Writing example 110000
2021-04-25 23:38:56,812 - INFO - transprompt_wrapper - Writing example 120000
2021-04-25 23:39:03,491 - INFO - transprompt_wrapper - Writing example 130000
2021-04-25 23:39:10,475 - INFO - transprompt_wrapper - Writing example 140000
2021-04-25 23:39:17,733 - INFO - transprompt_wrapper - Writing example 150000
2021-04-25 23:39:24,731 - INFO - transprompt_wrapper - Writing example 160000
2021-04-25 23:39:35,092 - INFO - transprompt_wrapper - Writing example 170000
2021-04-25 23:39:41,862 - INFO - transprompt_wrapper - Writing example 180000
2021-04-25 23:39:48,612 - INFO - transprompt_wrapper - Writing example 190000
2021-04-25 23:39:55,352 - INFO - transprompt_wrapper - Writing example 200000
2021-04-25 23:53:41,681 - INFO - transprompt_wrapper - {'acc': 0.889384416532644}
2021-04-25 23:53:41,681 - INFO - transprompt_wrapper - 1
2021-04-26 00:30:10,177 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 00:30:17,608 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 00:30:24,799 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 00:30:31,546 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 00:30:38,296 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 00:30:45,052 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 00:30:51,799 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 00:31:01,056 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 00:31:08,314 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 00:31:15,450 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 00:31:22,188 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 00:31:28,920 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 00:31:35,673 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 00:31:42,407 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 00:31:49,396 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 00:32:00,098 - INFO - transprompt_wrapper - Writing example 150000
2021-04-26 00:32:07,133 - INFO - transprompt_wrapper - Writing example 160000
2021-04-26 00:32:13,913 - INFO - transprompt_wrapper - Writing example 170000
2021-04-26 00:32:20,700 - INFO - transprompt_wrapper - Writing example 180000
2021-04-26 00:32:27,496 - INFO - transprompt_wrapper - Writing example 190000
2021-04-26 00:32:34,283 - INFO - transprompt_wrapper - Writing example 200000
2021-04-26 00:46:24,461 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-26 00:46:24,461 - INFO - transprompt_wrapper - best_dev_acc: 0.8901 | best_global_step: 30000
2021-04-26 00:46:24,461 - INFO - transprompt_wrapper - Saving models.
2021-04-26 01:22:52,117 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 01:22:59,556 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 01:23:06,781 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 01:23:13,509 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 01:23:22,327 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 01:23:29,102 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 01:23:36,354 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 01:23:43,358 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 01:23:50,711 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 01:23:57,838 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 01:24:04,614 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 01:24:11,348 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 01:24:21,080 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 01:24:27,842 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 01:24:34,849 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 01:24:42,195 - INFO - transprompt_wrapper - Writing example 150000
2021-04-26 01:24:49,271 - INFO - transprompt_wrapper - Writing example 160000
2021-04-26 01:24:56,105 - INFO - transprompt_wrapper - Writing example 170000
2021-04-26 01:25:02,925 - INFO - transprompt_wrapper - Writing example 180000
2021-04-26 01:25:09,777 - INFO - transprompt_wrapper - Writing example 190000
2021-04-26 01:25:16,605 - INFO - transprompt_wrapper - Writing example 200000
2021-04-26 01:39:05,766 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-26 01:39:05,766 - INFO - transprompt_wrapper - best_dev_acc: 0.8903 | best_global_step: 32500
2021-04-26 01:39:05,766 - INFO - transprompt_wrapper - Saving models.
2021-04-26 02:15:42,962 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 02:15:50,531 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 02:15:57,894 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 02:16:04,733 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 02:16:12,017 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 02:16:19,059 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 02:16:26,066 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 02:16:35,523 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 02:16:42,940 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 02:16:50,232 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 02:16:57,470 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 02:17:04,273 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 02:17:11,063 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 02:17:17,829 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 02:17:24,883 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 02:17:35,630 - INFO - transprompt_wrapper - Writing example 150000
2021-04-26 02:17:42,692 - INFO - transprompt_wrapper - Writing example 160000
2021-04-26 02:17:49,505 - INFO - transprompt_wrapper - Writing example 170000
2021-04-26 02:17:56,294 - INFO - transprompt_wrapper - Writing example 180000
2021-04-26 02:18:03,129 - INFO - transprompt_wrapper - Writing example 190000
2021-04-26 02:18:09,976 - INFO - transprompt_wrapper - Writing example 200000
2021-04-26 02:32:13,167 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-26 02:32:13,167 - INFO - transprompt_wrapper - best_dev_acc: 0.8911 | best_global_step: 35000
2021-04-26 02:32:13,167 - INFO - transprompt_wrapper - Saving models.
2021-04-26 02:46:48,015 - INFO - modeling - Saving complete
2021-04-26 02:46:48,016 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-26 02:46:48,016 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-26 02:46:48,187 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-26 02:47:15,801 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-26 02:47:16,221 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-26 02:47:16,332 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-26 02:47:16,332 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 02:47:24,783 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 02:47:32,610 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 02:47:40,266 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 02:47:50,003 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 02:47:57,714 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 02:48:05,342 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 02:48:12,949 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 02:48:20,484 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 02:48:28,045 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 02:48:35,545 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 02:48:43,025 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 02:48:53,403 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 02:49:00,766 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 02:49:08,162 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 02:49:15,520 - INFO - transprompt_wrapper - Writing example 150000
2021-04-26 02:49:22,861 - INFO - transprompt_wrapper - Writing example 160000
2021-04-26 02:49:30,236 - INFO - transprompt_wrapper - Writing example 170000
2021-04-26 02:49:37,613 - INFO - transprompt_wrapper - Writing example 180000
2021-04-26 02:49:44,995 - INFO - transprompt_wrapper - Writing example 190000
2021-04-26 02:49:52,400 - INFO - transprompt_wrapper - Writing example 200000
2021-04-26 02:50:03,950 - INFO - transprompt_wrapper - Writing example 210000
2021-04-26 02:50:11,311 - INFO - transprompt_wrapper - Writing example 220000
2021-04-26 02:50:18,702 - INFO - transprompt_wrapper - Writing example 230000
2021-04-26 02:50:26,116 - INFO - transprompt_wrapper - Writing example 240000
2021-04-26 02:50:33,512 - INFO - transprompt_wrapper - Writing example 250000
2021-04-26 02:50:40,908 - INFO - transprompt_wrapper - Writing example 260000
2021-04-26 02:50:48,352 - INFO - transprompt_wrapper - Writing example 270000
2021-04-26 02:50:55,978 - INFO - transprompt_wrapper - Writing example 280000
2021-04-26 02:51:03,411 - INFO - transprompt_wrapper - Writing example 290000
2021-04-26 02:51:10,815 - INFO - transprompt_wrapper - Writing example 300000
2021-04-26 02:51:18,188 - INFO - transprompt_wrapper - Writing example 310000
2021-04-26 02:51:25,560 - INFO - transprompt_wrapper - Writing example 320000
2021-04-26 02:51:38,929 - INFO - transprompt_wrapper - Writing example 330000
2021-04-26 03:26:26,692 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 03:26:34,318 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 03:26:41,613 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 03:26:48,936 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 03:26:56,271 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 03:27:03,640 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 03:31:10,248 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-26 03:31:10,248 - INFO - transprompt_wrapper - best_dev_acc: 0.8708 | best_global_step: 2500
2021-04-26 03:31:10,248 - INFO - transprompt_wrapper - Saving models.
2021-04-26 04:07:21,893 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 04:07:29,652 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 04:07:36,789 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 04:07:43,993 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 04:07:51,405 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 04:07:58,675 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 04:12:06,476 - INFO - transprompt_wrapper - {'acc': 0.8701999796285608}
2021-04-26 04:12:06,478 - INFO - transprompt_wrapper - 1
2021-04-26 04:48:56,344 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 04:49:05,994 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 04:49:13,152 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 04:49:20,329 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 04:49:27,773 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 04:49:35,018 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 04:53:41,291 - INFO - transprompt_wrapper - {'acc': 0.8706074084134044}
2021-04-26 04:53:41,292 - INFO - transprompt_wrapper - 2
2021-04-26 05:30:10,843 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 05:30:18,208 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 05:30:26,998 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 05:30:34,201 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 05:30:41,422 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 05:30:48,683 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 05:34:54,092 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-26 05:34:54,092 - INFO - transprompt_wrapper - best_dev_acc: 0.8714 | best_global_step: 10000
2021-04-26 05:34:54,092 - INFO - transprompt_wrapper - Saving models.
2021-04-26 05:58:02,285 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-26 05:58:02,285 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-26 05:58:02,383 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-26 05:58:02,383 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-26 05:58:02,394 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-26 05:58:02,394 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-26 05:58:02,394 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-26 05:58:02,394 - INFO - run_task_adaptation - text_b=None
2021-04-26 05:58:02,394 - INFO - run_task_adaptation - task=SST-2
2021-04-26 05:58:02,394 - INFO - run_task_adaptation - label=0
2021-04-26 05:58:02,395 - INFO - run_task_adaptation - **********************************
2021-04-26 05:58:05,437 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 05:58:56,931 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-26 05:58:56,931 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 05:59:54,170 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 05:59:57,444 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 05:59:57,444 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-26 05:59:57,444 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:01:16,270 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:01:19,528 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:01:19,529 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8958 | best_global_step: 200
2021-04-26 06:01:19,529 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:02:37,376 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:02:40,472 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:02:40,472 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8958 | best_global_step: 300
2021-04-26 06:02:40,473 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:03:59,524 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:04:02,776 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:04:02,776 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8958 | best_global_step: 400
2021-04-26 06:04:02,776 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:05:21,347 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:05:24,572 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:05:24,572 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8958 | best_global_step: 500
2021-04-26 06:05:24,572 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:06:43,233 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:06:46,394 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:06:46,394 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 600
2021-04-26 06:06:46,394 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:08:03,952 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:08:07,066 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-04-26 06:08:07,067 - INFO - transprompt_wrapper2 - 1
2021-04-26 06:09:02,437 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:09:05,510 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-04-26 06:09:05,510 - INFO - transprompt_wrapper2 - 2
2021-04-26 06:10:00,838 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:10:03,975 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-04-26 06:10:03,975 - INFO - transprompt_wrapper2 - 3
2021-04-26 06:11:00,179 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:11:03,496 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-04-26 06:11:03,496 - INFO - transprompt_wrapper2 - 4
2021-04-26 06:11:03,877 - INFO - modeling - Saving complete
2021-04-26 06:11:03,877 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-26 06:11:03,877 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-26 06:11:03,973 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:11:47,187 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-26 06:11:47,188 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-26 06:11:47,188 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-26 06:11:47,188 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:12:18,755 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:12:19,672 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-26 06:12:19,673 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-26 06:12:19,673 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:13:10,490 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:13:11,572 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-04-26 06:13:11,572 - INFO - transprompt_wrapper2 - 1
2021-04-26 06:13:42,351 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:13:43,199 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-04-26 06:13:43,199 - INFO - transprompt_wrapper2 - 2
2021-04-26 06:13:43,674 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:14:31,462 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-26 06:14:31,463 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-26 06:14:31,509 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-26 06:14:31,510 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-26 06:14:31,510 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:14:59,983 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-26 06:14:59,983 - INFO - modeling - eval_results: {'acc': 0.9392201834862385}
2021-04-26 06:14:59,986 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-26 06:14:59,986 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:15:30,257 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:15:31,065 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-26 06:15:31,065 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-26 06:15:31,066 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:16:23,220 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:16:24,325 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-26 06:16:24,325 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-26 06:16:24,325 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:17:16,677 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:17:17,960 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-26 06:17:17,960 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-26 06:17:17,960 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:17:38,337 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:18:26,785 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-26 06:18:26,785 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-26 06:18:26,825 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-26 06:18:26,826 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-26 06:18:26,826 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:19:08,076 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 06:19:15,316 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 06:19:18,822 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-26 06:19:18,823 - INFO - modeling - eval_results: {'acc': 0.891}
2021-04-26 06:19:18,825 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-26 06:19:18,825 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:19:24,147 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 06:19:31,421 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 06:19:38,698 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 06:19:39,676 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:19:40,195 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-26 06:19:40,195 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-26 06:19:40,196 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:19:46,068 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 06:20:29,827 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:20:30,746 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-26 06:20:30,746 - INFO - transprompt_wrapper2 - 1
2021-04-26 06:20:59,721 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:21:00,712 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-26 06:21:00,712 - INFO - transprompt_wrapper2 - 2
2021-04-26 06:21:01,020 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:21:45,967 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-26 06:21:45,967 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-26 06:21:46,025 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-26 06:21:46,028 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-26 06:21:46,028 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:22:40,488 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-26 06:22:40,489 - INFO - modeling - eval_results: {'acc': 0.896}
2021-04-26 06:25:01,212 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-26 06:25:01,212 - INFO - transprompt_wrapper - best_dev_acc: 0.8716 | best_global_step: 12500
2021-04-26 06:25:01,212 - INFO - transprompt_wrapper - Saving models.
2021-04-26 06:26:56,071 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-26 06:26:56,071 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-26 06:26:56,074 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-26 06:26:56,074 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-26 06:26:56,076 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-26 06:26:56,076 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-26 06:26:56,076 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-26 06:26:56,076 - INFO - run_task_adaptation - text_b=None
2021-04-26 06:26:56,076 - INFO - run_task_adaptation - task=SST-2
2021-04-26 06:26:56,076 - INFO - run_task_adaptation - label=0
2021-04-26 06:26:56,076 - INFO - run_task_adaptation - **********************************
2021-04-26 06:26:58,859 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:27:34,173 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-26 06:27:34,174 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:28:46,507 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:28:50,666 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:28:50,667 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 100
2021-04-26 06:28:50,667 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:30:23,804 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:30:28,062 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-04-26 06:30:28,063 - INFO - transprompt_wrapper2 - 1
2021-04-26 06:31:38,104 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:31:42,516 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:31:42,516 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 300
2021-04-26 06:31:42,516 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:33:14,939 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:33:19,360 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:33:19,360 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 400
2021-04-26 06:33:19,361 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:34:52,501 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:34:56,784 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:34:56,785 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-04-26 06:34:56,785 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:36:29,068 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:36:33,545 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 06:36:33,546 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 600
2021-04-26 06:36:33,546 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:38:06,507 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:38:10,758 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-04-26 06:38:10,758 - INFO - transprompt_wrapper2 - 2
2021-04-26 06:39:20,868 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:39:25,160 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-04-26 06:39:25,161 - INFO - transprompt_wrapper2 - 3
2021-04-26 06:40:35,421 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:40:39,760 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-04-26 06:40:39,761 - INFO - transprompt_wrapper2 - 4
2021-04-26 06:41:49,869 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:41:53,952 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-04-26 06:41:53,952 - INFO - transprompt_wrapper2 - 5
2021-04-26 06:41:54,831 - INFO - modeling - Saving complete
2021-04-26 06:41:54,831 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-26 06:41:54,831 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-26 06:41:54,923 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:42:37,901 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-26 06:42:37,901 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-26 06:42:37,901 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-26 06:42:37,901 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:43:14,856 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:43:16,376 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-26 06:43:16,376 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-26 06:43:16,376 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:44:12,800 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:44:14,070 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-26 06:44:14,070 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-26 06:44:14,070 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:45:09,967 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:45:11,370 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-26 06:45:11,370 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-26 06:45:11,370 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:45:31,208 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:46:20,057 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-26 06:46:20,057 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-26 06:46:20,065 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-26 06:46:20,065 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-26 06:46:20,065 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:46:59,551 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-26 06:46:59,551 - INFO - modeling - eval_results: {'acc': 0.9392201834862385}
2021-04-26 06:46:59,553 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-26 06:46:59,554 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:47:37,520 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:47:39,075 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-26 06:47:39,075 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-26 06:47:39,075 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:48:38,061 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:48:39,585 - INFO - transprompt_wrapper2 - {'acc': 0.78125}
2021-04-26 06:48:39,585 - INFO - transprompt_wrapper2 - 1
2021-04-26 06:49:17,240 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:49:18,693 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-26 06:49:18,693 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-26 06:49:18,693 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:49:38,684 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:50:25,746 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-26 06:50:25,747 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-26 06:50:25,760 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-26 06:50:25,761 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-26 06:50:25,761 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:51:54,121 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-26 06:51:54,121 - INFO - modeling - eval_results: {'acc': 0.8735}
2021-04-26 06:51:54,123 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-26 06:51:54,123 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:52:33,454 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:52:34,989 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-26 06:52:34,989 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-26 06:52:34,989 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:53:33,785 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:53:35,131 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-26 06:53:35,131 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-26 06:53:35,131 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:54:33,904 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:54:35,384 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-26 06:54:35,384 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-26 06:54:35,384 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 06:54:55,684 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 06:55:41,660 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-26 06:55:41,660 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-26 06:55:41,672 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-26 06:55:41,674 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-26 06:55:41,674 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 06:57:08,802 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-26 06:57:08,803 - INFO - modeling - eval_results: {'acc': 0.908}
2021-04-26 07:13:28,426 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 07:13:35,725 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 07:13:44,577 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 07:13:51,795 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 07:13:59,030 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 07:14:06,770 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 07:18:14,217 - INFO - transprompt_wrapper - {'acc': 0.8715241231793026}
2021-04-26 07:18:14,217 - INFO - transprompt_wrapper - 1
2021-04-26 07:53:06,404 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=96, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-26 07:53:06,404 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-26 07:53:06,407 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-26 07:53:06,407 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-26 07:53:06,409 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-26 07:53:06,409 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-26 07:53:06,409 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-26 07:53:06,409 - INFO - run_task_adaptation - text_b=None
2021-04-26 07:53:06,409 - INFO - run_task_adaptation - task=SST-2
2021-04-26 07:53:06,409 - INFO - run_task_adaptation - label=0
2021-04-26 07:53:06,409 - INFO - run_task_adaptation - **********************************
2021-04-26 07:53:09,181 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 07:53:42,134 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-26 07:53:42,135 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 07:54:32,643 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 07:54:35,550 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 07:54:35,550 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-26 07:54:35,550 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 07:54:47,915 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 07:54:55,269 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 07:55:02,418 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 07:55:11,403 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 07:55:18,623 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 07:55:25,192 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 07:55:25,895 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 07:55:26,508 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-26 07:55:26,509 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 200
2021-04-26 07:55:26,509 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 07:56:30,056 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 07:56:32,633 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-04-26 07:56:32,633 - INFO - transprompt_wrapper2 - 1
2021-04-26 07:57:13,731 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 07:57:16,196 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-04-26 07:57:16,196 - INFO - transprompt_wrapper2 - 2
2021-04-26 07:57:57,230 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 07:57:59,524 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-04-26 07:57:59,524 - INFO - transprompt_wrapper2 - 3
2021-04-26 07:58:40,547 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 07:58:43,091 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-04-26 07:58:43,091 - INFO - transprompt_wrapper2 - 4
2021-04-26 07:59:24,851 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 07:59:27,426 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-04-26 07:59:27,426 - INFO - transprompt_wrapper2 - 5
2021-04-26 08:00:08,358 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:00:10,980 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-04-26 08:00:10,980 - INFO - transprompt_wrapper2 - 6
2021-04-26 08:00:52,576 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:00:55,162 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-04-26 08:00:55,162 - INFO - transprompt_wrapper2 - 7
2021-04-26 08:01:36,435 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:01:38,935 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-04-26 08:01:38,935 - INFO - transprompt_wrapper2 - 8
2021-04-26 08:01:39,386 - INFO - modeling - Saving complete
2021-04-26 08:01:39,386 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-26 08:01:39,386 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-26 08:01:39,493 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 08:02:24,259 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-26 08:02:24,259 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-26 08:02:24,260 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-26 08:02:24,260 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:02:51,002 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:02:51,855 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-26 08:02:51,856 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-26 08:02:51,856 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:03:38,969 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:03:39,724 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-26 08:03:39,724 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-26 08:03:39,724 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:03:59,542 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-26 08:03:59,543 - INFO - transprompt_wrapper - best_dev_acc: 0.8717 | best_global_step: 17500
2021-04-26 08:03:59,543 - INFO - transprompt_wrapper - Saving models.
2021-04-26 08:04:44,857 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:04:45,919 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-26 08:04:45,919 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-26 08:04:45,919 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:05:19,661 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 08:06:12,585 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-26 08:06:12,586 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-26 08:06:12,594 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-26 08:06:12,594 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-26 08:06:12,594 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:06:40,941 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-26 08:06:40,941 - INFO - modeling - eval_results: {'acc': 0.9254587155963303}
2021-04-26 08:06:40,943 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-26 08:06:40,944 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:07:12,579 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:07:13,721 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-26 08:07:13,722 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-26 08:07:13,722 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:08:06,193 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:08:07,089 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-26 08:08:07,089 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 200
2021-04-26 08:08:07,089 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:08:59,499 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:09:00,546 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-26 08:09:00,546 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-26 08:09:00,546 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:09:21,249 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 08:10:12,122 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-26 08:10:12,123 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-26 08:10:12,252 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-26 08:10:12,253 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-26 08:10:12,253 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:11:16,145 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-26 08:11:16,145 - INFO - modeling - eval_results: {'acc': 0.872}
2021-04-26 08:11:16,148 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-26 08:11:16,148 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:11:46,883 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:11:47,668 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-26 08:11:47,668 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-26 08:11:47,668 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:12:39,612 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:12:40,511 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-26 08:12:40,511 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-26 08:12:40,511 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:13:33,141 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:13:34,406 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-26 08:13:34,407 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-26 08:13:34,407 - INFO - transprompt_wrapper2 - Saving models.
2021-04-26 08:13:56,490 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-26 08:14:46,928 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-26 08:14:46,929 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-26 08:14:46,945 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-26 08:14:46,946 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-26 08:14:46,946 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-26 08:15:50,109 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-26 08:15:50,110 - INFO - modeling - eval_results: {'acc': 0.9125}
2021-04-26 08:43:12,932 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 08:43:20,268 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 08:43:27,543 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 08:43:35,157 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 08:43:45,644 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 08:43:53,092 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 08:48:04,349 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-26 08:48:04,350 - INFO - transprompt_wrapper - best_dev_acc: 0.8728 | best_global_step: 20000
2021-04-26 08:48:04,350 - INFO - transprompt_wrapper - Saving models.
2021-04-26 09:02:44,520 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-26 09:03:05,220 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-26 09:03:05,220 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-04-26 09:03:05,410 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-26 09:03:05,410 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-26 09:03:05,410 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 09:03:13,754 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 09:04:40,340 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-26 09:04:40,340 - INFO - modeling - eval_results: {'acc': 0.8727032116862625}
2021-04-26 09:04:40,341 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-26 09:04:40,341 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 09:04:47,112 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 09:04:55,700 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 09:05:02,482 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 09:05:09,246 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 09:05:16,027 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 09:05:22,981 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 09:05:29,851 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 09:05:36,606 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 09:05:45,876 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 09:05:52,633 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 09:05:59,554 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 09:06:06,360 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 09:06:13,117 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 09:06:19,847 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 09:06:26,562 - INFO - transprompt_wrapper - Writing example 150000
2021-04-26 09:06:33,829 - INFO - transprompt_wrapper - Writing example 160000
2021-04-26 09:06:44,126 - INFO - transprompt_wrapper - Writing example 170000
2021-04-26 09:06:50,830 - INFO - transprompt_wrapper - Writing example 180000
2021-04-26 09:06:57,547 - INFO - transprompt_wrapper - Writing example 190000
2021-04-26 09:07:04,377 - INFO - transprompt_wrapper - Writing example 200000
2021-04-26 09:07:11,255 - INFO - transprompt_wrapper - Writing example 210000
2021-04-26 09:07:17,971 - INFO - transprompt_wrapper - Writing example 220000
2021-04-26 09:07:24,682 - INFO - transprompt_wrapper - Writing example 230000
2021-04-26 09:07:31,391 - INFO - transprompt_wrapper - Writing example 240000
2021-04-26 09:07:38,211 - INFO - transprompt_wrapper - Writing example 250000
2021-04-26 09:07:44,991 - INFO - transprompt_wrapper - Writing example 260000
2021-04-26 09:07:51,747 - INFO - transprompt_wrapper - Writing example 270000
2021-04-26 09:08:06,088 - INFO - transprompt_wrapper - Writing example 280000
2021-04-26 09:08:13,424 - INFO - transprompt_wrapper - Writing example 290000
2021-04-26 09:08:20,285 - INFO - transprompt_wrapper - Writing example 300000
2021-04-26 09:08:27,087 - INFO - transprompt_wrapper - Writing example 310000
2021-04-26 09:08:33,887 - INFO - transprompt_wrapper - Writing example 320000
2021-04-26 09:08:40,675 - INFO - transprompt_wrapper - Writing example 330000
2021-04-26 09:08:47,505 - INFO - transprompt_wrapper - Writing example 340000
2021-04-26 09:08:54,332 - INFO - transprompt_wrapper - Writing example 350000
2021-04-26 09:09:01,122 - INFO - transprompt_wrapper - Writing example 360000
2021-04-26 09:09:07,903 - INFO - transprompt_wrapper - Writing example 370000
2021-04-26 09:09:14,698 - INFO - transprompt_wrapper - Writing example 380000
2021-04-26 09:09:21,502 - INFO - transprompt_wrapper - Writing example 390000
2021-04-26 09:09:28,288 - INFO - transprompt_wrapper - Writing example 400000
2021-04-26 09:46:01,214 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 09:46:10,056 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 09:46:16,968 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 09:46:23,873 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 09:46:30,684 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 09:46:37,505 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 09:46:44,624 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 09:46:51,372 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 09:47:00,751 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 09:47:07,524 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 09:47:14,329 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 09:47:21,189 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 09:47:28,042 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 09:47:34,845 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 09:47:41,633 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 09:57:33,652 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-26 09:57:33,652 - INFO - transprompt_wrapper - best_dev_acc: 0.8953 | best_global_step: 2500
2021-04-26 09:57:33,652 - INFO - transprompt_wrapper - Saving models.
2021-04-26 10:34:10,328 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 10:34:17,178 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 10:34:25,527 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 10:34:32,248 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 10:34:38,973 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 10:34:45,941 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 10:34:52,679 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 10:34:59,370 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 10:35:06,073 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 10:35:15,568 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 10:35:22,349 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 10:35:29,146 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 10:35:35,936 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 10:35:42,768 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 10:35:49,886 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 10:45:38,431 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-26 10:45:38,431 - INFO - transprompt_wrapper - best_dev_acc: 0.8963 | best_global_step: 5000
2021-04-26 10:45:38,431 - INFO - transprompt_wrapper - Saving models.
2021-04-26 11:21:54,086 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 11:22:01,130 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 11:22:09,837 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 11:22:16,613 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 11:22:23,376 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 11:22:30,524 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 11:22:37,429 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 11:22:44,161 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 11:22:50,897 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 11:23:00,473 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 11:23:07,249 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 11:23:14,057 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 11:23:20,867 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 11:23:27,779 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 11:23:34,742 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 11:33:21,248 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-26 11:33:21,248 - INFO - transprompt_wrapper - best_dev_acc: 0.8983 | best_global_step: 7500
2021-04-26 11:33:21,248 - INFO - transprompt_wrapper - Saving models.
2021-04-26 12:09:50,331 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 12:09:57,454 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 12:10:04,173 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 12:10:12,773 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 12:10:19,708 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 12:10:26,429 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 12:10:33,132 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 12:10:39,790 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 12:10:46,509 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 12:10:53,391 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 12:11:00,098 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 12:11:09,603 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 12:11:16,399 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 12:11:23,344 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 12:11:30,108 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 12:21:22,037 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-26 12:21:22,038 - INFO - transprompt_wrapper - best_dev_acc: 0.8996 | best_global_step: 10000
2021-04-26 12:21:22,038 - INFO - transprompt_wrapper - Saving models.
2021-04-26 12:57:30,765 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 12:57:37,768 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 12:57:44,535 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 12:57:51,332 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 12:57:58,105 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 12:58:07,187 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 12:58:13,995 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 12:58:20,756 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 12:58:27,543 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 12:58:34,310 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 12:58:41,232 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 12:58:48,156 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 12:58:57,984 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 12:59:04,818 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 12:59:11,671 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 13:09:10,817 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-26 13:09:10,817 - INFO - transprompt_wrapper - best_dev_acc: 0.9003 | best_global_step: 12500
2021-04-26 13:09:10,818 - INFO - transprompt_wrapper - Saving models.
2021-04-26 13:45:22,134 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 13:45:29,269 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 13:45:36,052 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 13:45:42,820 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 13:45:49,569 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 13:45:56,397 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 13:46:03,210 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 13:46:12,465 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 13:46:19,240 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 13:46:26,045 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 13:46:32,841 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 13:46:39,740 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 13:46:46,816 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 13:46:53,673 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 13:47:00,545 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 13:56:53,234 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-26 13:56:53,235 - INFO - transprompt_wrapper - best_dev_acc: 0.9006 | best_global_step: 15000
2021-04-26 13:56:53,235 - INFO - transprompt_wrapper - Saving models.
2021-04-26 14:33:12,508 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 14:33:19,478 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 14:33:26,166 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 14:33:32,849 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 14:33:39,541 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 14:33:46,455 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 14:33:53,161 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 14:34:02,600 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 14:34:09,295 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 14:34:16,171 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 14:34:22,920 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 14:34:29,670 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 14:34:36,428 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 14:34:43,173 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 14:34:50,066 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 14:44:36,760 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-26 14:44:36,760 - INFO - transprompt_wrapper - best_dev_acc: 0.9010 | best_global_step: 17500
2021-04-26 14:44:36,760 - INFO - transprompt_wrapper - Saving models.
2021-04-26 15:20:57,513 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 15:21:04,447 - INFO - transprompt_wrapper - Writing example 10000
2021-04-26 15:21:11,177 - INFO - transprompt_wrapper - Writing example 20000
2021-04-26 15:21:17,994 - INFO - transprompt_wrapper - Writing example 30000
2021-04-26 15:21:24,839 - INFO - transprompt_wrapper - Writing example 40000
2021-04-26 15:21:31,607 - INFO - transprompt_wrapper - Writing example 50000
2021-04-26 15:21:38,287 - INFO - transprompt_wrapper - Writing example 60000
2021-04-26 15:21:47,275 - INFO - transprompt_wrapper - Writing example 70000
2021-04-26 15:21:54,017 - INFO - transprompt_wrapper - Writing example 80000
2021-04-26 15:22:00,748 - INFO - transprompt_wrapper - Writing example 90000
2021-04-26 15:22:07,518 - INFO - transprompt_wrapper - Writing example 100000
2021-04-26 15:22:14,327 - INFO - transprompt_wrapper - Writing example 110000
2021-04-26 15:22:21,136 - INFO - transprompt_wrapper - Writing example 120000
2021-04-26 15:22:27,963 - INFO - transprompt_wrapper - Writing example 130000
2021-04-26 15:22:34,778 - INFO - transprompt_wrapper - Writing example 140000
2021-04-26 15:32:23,882 - INFO - transprompt_wrapper - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-26 15:32:23,883 - INFO - transprompt_wrapper - best_dev_acc: 0.9013 | best_global_step: 20000
2021-04-26 15:32:23,883 - INFO - transprompt_wrapper - Saving models.
2021-04-26 15:46:57,114 - INFO - transprompt_wrapper - ========= This is 'Multi-Task Prompt Encoder' =========
2021-04-26 15:47:16,183 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-26 15:47:16,183 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-04-26 15:47:16,286 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-04-26 15:47:16,297 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-26 15:47:16,297 - INFO - transprompt_wrapper - Writing example 0
2021-04-26 15:48:03,038 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-26 15:48:03,039 - INFO - modeling - eval_results: {'acc': 0.9163787847998375}
2021-04-27 02:23:24,665 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 02:23:24,665 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 02:23:24,668 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:23:24,668 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 02:23:24,670 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:23:24,670 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 02:23:24,670 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 02:23:24,670 - INFO - run_task_adaptation - text_b=None
2021-04-27 02:23:24,670 - INFO - run_task_adaptation - task=SST-2
2021-04-27 02:23:24,670 - INFO - run_task_adaptation - label=0
2021-04-27 02:23:24,670 - INFO - run_task_adaptation - **********************************
2021-04-27 02:23:27,267 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 02:24:00,945 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 02:24:00,945 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:24:01,088 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:28:57,075 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 02:28:57,075 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 02:28:57,079 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:28:57,079 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 02:28:57,081 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:28:57,081 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 02:28:57,081 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 02:28:57,082 - INFO - run_task_adaptation - text_b=None
2021-04-27 02:28:57,082 - INFO - run_task_adaptation - task=SST-2
2021-04-27 02:28:57,082 - INFO - run_task_adaptation - label=0
2021-04-27 02:28:57,082 - INFO - run_task_adaptation - **********************************
2021-04-27 02:28:59,575 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 02:29:31,796 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 02:29:31,797 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:32:50,390 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 02:32:50,390 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 02:32:50,395 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:32:50,395 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 02:32:50,397 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:32:50,397 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 02:32:50,397 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 02:32:50,398 - INFO - run_task_adaptation - text_b=None
2021-04-27 02:32:50,398 - INFO - run_task_adaptation - task=SST-2
2021-04-27 02:32:50,398 - INFO - run_task_adaptation - label=0
2021-04-27 02:32:50,398 - INFO - run_task_adaptation - **********************************
2021-04-27 02:32:53,923 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 02:33:27,150 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 02:33:27,151 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:34:10,620 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 02:34:10,620 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 02:34:10,623 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:34:10,623 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 02:34:10,625 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:34:10,625 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 02:34:10,625 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 02:34:10,625 - INFO - run_task_adaptation - text_b=None
2021-04-27 02:34:10,625 - INFO - run_task_adaptation - task=SST-2
2021-04-27 02:34:10,625 - INFO - run_task_adaptation - label=0
2021-04-27 02:34:10,625 - INFO - run_task_adaptation - **********************************
2021-04-27 02:34:13,262 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 02:34:45,353 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 02:34:45,354 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:35:37,811 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 02:35:37,812 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 02:35:37,816 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:35:37,817 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 02:35:37,818 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:35:37,819 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 02:35:37,819 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 02:35:37,819 - INFO - run_task_adaptation - text_b=None
2021-04-27 02:35:37,819 - INFO - run_task_adaptation - task=SST-2
2021-04-27 02:35:37,819 - INFO - run_task_adaptation - label=0
2021-04-27 02:35:37,819 - INFO - run_task_adaptation - **********************************
2021-04-27 02:35:40,387 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 02:36:11,214 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 02:36:11,214 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:47:50,353 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 02:47:50,353 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 02:47:50,356 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:47:50,356 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 02:47:50,358 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:47:50,358 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 02:47:50,358 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 02:47:50,358 - INFO - run_task_adaptation - text_b=None
2021-04-27 02:47:50,358 - INFO - run_task_adaptation - task=SST-2
2021-04-27 02:47:50,358 - INFO - run_task_adaptation - label=0
2021-04-27 02:47:50,358 - INFO - run_task_adaptation - **********************************
2021-04-27 02:47:52,958 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 02:48:31,092 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 02:48:31,092 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:49:22,775 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 02:49:22,776 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 02:49:22,778 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:49:22,779 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 02:49:22,780 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:49:22,780 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 02:49:22,780 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 02:49:22,780 - INFO - run_task_adaptation - text_b=None
2021-04-27 02:49:22,780 - INFO - run_task_adaptation - task=SST-2
2021-04-27 02:49:22,780 - INFO - run_task_adaptation - label=0
2021-04-27 02:49:22,780 - INFO - run_task_adaptation - **********************************
2021-04-27 02:49:25,998 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 02:49:56,090 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 02:49:56,090 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:50:36,284 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 02:50:37,724 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 02:50:37,724 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8542 | best_global_step: 100
2021-04-27 02:50:37,724 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 02:51:50,961 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 02:51:50,961 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 02:51:50,964 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:51:50,964 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 02:51:50,966 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 02:51:50,966 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 02:51:50,966 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 02:51:50,966 - INFO - run_task_adaptation - text_b=None
2021-04-27 02:51:50,966 - INFO - run_task_adaptation - task=SST-2
2021-04-27 02:51:50,966 - INFO - run_task_adaptation - label=0
2021-04-27 02:51:50,966 - INFO - run_task_adaptation - **********************************
2021-04-27 02:51:53,561 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 02:52:23,462 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 02:52:23,462 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:19:07,701 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:19:07,701 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:19:07,704 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:19:07,704 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:19:07,705 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:19:07,705 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:19:07,706 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:19:07,706 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:19:07,706 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:19:07,706 - INFO - run_task_adaptation - label=0
2021-04-27 03:19:07,706 - INFO - run_task_adaptation - **********************************
2021-04-27 03:19:10,350 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:19:58,281 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:19:58,281 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:19:58,285 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:19:58,285 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:19:58,286 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:19:58,286 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:19:58,287 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:19:58,287 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:19:58,287 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:19:58,287 - INFO - run_task_adaptation - label=0
2021-04-27 03:19:58,287 - INFO - run_task_adaptation - **********************************
2021-04-27 03:20:00,879 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:20:31,471 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:20:31,471 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:23:36,997 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:23:36,998 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:23:37,001 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:23:37,001 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:23:37,002 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:23:37,002 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:23:37,002 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:23:37,003 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:23:37,003 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:23:37,003 - INFO - run_task_adaptation - label=0
2021-04-27 03:23:37,003 - INFO - run_task_adaptation - **********************************
2021-04-27 03:23:39,585 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:24:07,732 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:24:07,732 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:27:01,508 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:27:01,509 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:27:01,512 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:27:01,512 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:27:01,513 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:27:01,513 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:27:01,513 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:27:01,514 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:27:01,514 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:27:01,514 - INFO - run_task_adaptation - label=0
2021-04-27 03:27:01,514 - INFO - run_task_adaptation - **********************************
2021-04-27 03:27:03,860 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:27:35,621 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:27:35,622 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:28:05,217 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:28:05,217 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:28:05,221 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:28:05,221 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:28:05,223 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:28:05,223 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:28:05,223 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:28:05,223 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:28:05,223 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:28:05,223 - INFO - run_task_adaptation - label=0
2021-04-27 03:28:05,223 - INFO - run_task_adaptation - **********************************
2021-04-27 03:28:07,754 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:28:39,444 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:28:39,444 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:44:35,548 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:44:35,548 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:44:35,551 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:44:35,552 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:44:35,553 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:44:35,553 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:44:35,553 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:44:35,553 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:44:35,554 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:44:35,554 - INFO - run_task_adaptation - label=0
2021-04-27 03:44:35,554 - INFO - run_task_adaptation - **********************************
2021-04-27 03:44:37,878 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:45:09,459 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:45:09,459 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:46:09,343 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:46:09,344 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:46:09,347 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:46:09,347 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:46:09,349 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:46:09,349 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:46:09,349 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:46:09,349 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:46:09,349 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:46:09,349 - INFO - run_task_adaptation - label=0
2021-04-27 03:46:09,349 - INFO - run_task_adaptation - **********************************
2021-04-27 03:46:11,746 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:46:43,630 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:46:43,631 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:47:46,090 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:47:46,090 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:47:46,094 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:47:46,094 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:47:46,096 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:47:46,096 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:47:46,096 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:47:46,096 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:47:46,096 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:47:46,096 - INFO - run_task_adaptation - label=0
2021-04-27 03:47:46,096 - INFO - run_task_adaptation - **********************************
2021-04-27 03:47:48,697 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:48:20,343 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:48:20,344 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:49:39,764 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:49:39,764 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:49:39,767 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:49:39,767 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:49:39,769 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:49:39,769 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:49:39,769 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:49:39,769 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:49:39,769 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:49:39,769 - INFO - run_task_adaptation - label=0
2021-04-27 03:49:39,769 - INFO - run_task_adaptation - **********************************
2021-04-27 03:49:42,074 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:50:13,062 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:50:13,062 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:52:38,396 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:52:38,396 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:52:38,399 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:52:38,399 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:52:38,401 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:52:38,401 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:52:38,401 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:52:38,401 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:52:38,401 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:52:38,401 - INFO - run_task_adaptation - label=0
2021-04-27 03:52:38,401 - INFO - run_task_adaptation - **********************************
2021-04-27 03:52:40,670 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:53:15,440 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:53:15,441 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:54:31,739 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:54:31,739 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:54:31,742 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:54:31,742 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:54:31,744 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:54:31,744 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:54:31,744 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:54:31,744 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:54:31,744 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:54:31,744 - INFO - run_task_adaptation - label=0
2021-04-27 03:54:31,744 - INFO - run_task_adaptation - **********************************
2021-04-27 03:54:34,026 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:55:04,838 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:55:04,839 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:56:41,870 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 03:56:41,870 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 03:56:41,874 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:56:41,874 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 03:56:41,876 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 03:56:41,877 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 03:56:41,877 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 03:56:41,877 - INFO - run_task_adaptation - text_b=None
2021-04-27 03:56:41,877 - INFO - run_task_adaptation - task=SST-2
2021-04-27 03:56:41,877 - INFO - run_task_adaptation - label=0
2021-04-27 03:56:41,877 - INFO - run_task_adaptation - **********************************
2021-04-27 03:56:44,191 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 03:57:20,333 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 03:57:20,334 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:58:01,459 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:58:02,842 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 03:58:02,842 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8229 | best_global_step: 100
2021-04-27 03:58:02,842 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 03:59:04,897 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 03:59:06,285 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 03:59:06,285 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8958 | best_global_step: 200
2021-04-27 03:59:06,285 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:02:50,609 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 04:02:50,609 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 04:02:50,613 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 04:02:50,613 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 04:02:50,614 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 04:02:50,614 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 04:02:50,615 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 04:02:50,615 - INFO - run_task_adaptation - text_b=None
2021-04-27 04:02:50,615 - INFO - run_task_adaptation - task=SST-2
2021-04-27 04:02:50,615 - INFO - run_task_adaptation - label=0
2021-04-27 04:02:50,615 - INFO - run_task_adaptation - **********************************
2021-04-27 04:02:53,014 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:03:25,157 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 04:03:25,158 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:04:05,762 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:04:07,321 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 04:04:07,321 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8229 | best_global_step: 100
2021-04-27 04:04:07,321 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:05:10,384 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:05:11,817 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 04:05:11,817 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8958 | best_global_step: 200
2021-04-27 04:05:11,817 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:06:12,748 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:06:14,110 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-04-27 04:06:14,110 - INFO - transprompt_wrapper2 - 1
2021-04-27 04:06:52,891 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:06:54,252 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 04:06:54,252 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 400
2021-04-27 04:06:54,252 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:07:57,162 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:07:58,569 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-04-27 04:07:58,569 - INFO - transprompt_wrapper2 - 1
2021-04-27 04:08:37,877 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:08:39,241 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 04:08:39,241 - INFO - transprompt_wrapper2 - 2
2021-04-27 04:09:18,259 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:09:19,686 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 04:09:19,686 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 700
2021-04-27 04:09:19,686 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:10:21,590 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:10:22,995 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 04:10:22,995 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 800
2021-04-27 04:10:22,996 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:11:26,399 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:11:27,797 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 04:11:27,797 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 900
2021-04-27 04:11:27,797 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:12:28,764 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:12:30,207 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 04:12:30,208 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 1000
2021-04-27 04:12:30,208 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:12:53,221 - INFO - modeling - Saving complete
2021-04-27 04:12:53,221 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 04:12:53,221 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 04:12:53,300 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:13:36,042 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 04:13:36,042 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 04:13:36,043 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-27 04:13:36,043 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:13:58,412 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:13:58,911 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-27 04:13:58,911 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-27 04:13:58,911 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:14:40,913 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:14:41,360 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-27 04:14:41,360 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-04-27 04:14:41,360 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:15:22,617 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:15:23,097 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-27 04:15:23,097 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-27 04:15:23,097 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:15:43,097 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:16:30,460 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-27 04:16:30,460 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-27 04:16:30,468 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-27 04:16:30,468 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-27 04:16:30,468 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:16:43,071 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-27 04:16:43,071 - INFO - modeling - eval_results: {'acc': 0.9277522935779816}
2021-04-27 04:16:43,074 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-27 04:16:43,075 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:17:05,984 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:17:06,498 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-27 04:17:06,499 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-27 04:17:06,499 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:17:50,956 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:17:51,473 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-27 04:17:51,473 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-27 04:17:51,473 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:18:33,132 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:18:33,658 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-27 04:18:33,659 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 300
2021-04-27 04:18:33,659 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:18:54,390 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:19:40,497 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-27 04:19:40,497 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-27 04:19:40,596 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-27 04:19:40,597 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-27 04:19:40,597 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:20:09,139 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-27 04:20:09,139 - INFO - modeling - eval_results: {'acc': 0.878}
2021-04-27 04:20:09,182 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-27 04:20:09,183 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:20:31,424 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:20:31,929 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 04:20:31,929 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-27 04:20:31,929 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:21:15,797 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:21:16,309 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 04:21:16,309 - INFO - transprompt_wrapper2 - 1
2021-04-27 04:21:38,539 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:21:39,042 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 04:21:39,042 - INFO - transprompt_wrapper2 - 2
2021-04-27 04:21:39,423 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:22:24,521 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-27 04:22:24,521 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-27 04:22:24,537 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-27 04:22:24,539 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-27 04:22:24,539 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:22:52,726 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-27 04:22:52,726 - INFO - modeling - eval_results: {'acc': 0.906}
2021-04-27 04:35:32,496 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 04:35:32,497 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-04-27 04:35:32,532 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 04:35:32,532 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-04-27 04:35:32,537 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 04:35:32,537 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 04:35:32,537 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-27 04:35:32,537 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-27 04:35:32,537 - INFO - run_task_adaptation - task=MNLI
2021-04-27 04:35:32,537 - INFO - run_task_adaptation - label=contradiction
2021-04-27 04:35:32,537 - INFO - run_task_adaptation - **********************************
2021-04-27 04:35:34,949 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:36:05,656 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 04:36:05,656 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:36:46,372 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:36:47,803 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 04:36:47,804 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5833 | best_global_step: 100
2021-04-27 04:36:47,804 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:37:46,778 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:37:48,214 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 04:37:48,214 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6667 | best_global_step: 200
2021-04-27 04:37:48,214 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:38:48,266 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:38:49,865 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 04:38:49,866 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6771 | best_global_step: 300
2021-04-27 04:38:49,866 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:39:49,532 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:39:50,929 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 04:39:50,930 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 400
2021-04-27 04:39:50,930 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:40:51,350 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:40:52,790 - INFO - transprompt_wrapper2 - {'acc': 0.71875}
2021-04-27 04:40:52,791 - INFO - transprompt_wrapper2 - 1
2021-04-27 04:41:31,262 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:41:32,665 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 04:41:32,666 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 600
2021-04-27 04:41:32,666 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:42:31,871 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:42:33,359 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 04:42:33,359 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 700
2021-04-27 04:42:33,359 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:43:32,515 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:43:33,961 - INFO - transprompt_wrapper2 - {'acc': 0.71875}
2021-04-27 04:43:33,961 - INFO - transprompt_wrapper2 - 4
2021-04-27 04:44:13,912 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:44:15,327 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 04:44:15,327 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 900
2021-04-27 04:44:15,327 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:45:14,703 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:45:16,148 - INFO - transprompt_wrapper2 - {'acc': 0.71875}
2021-04-27 04:45:16,148 - INFO - transprompt_wrapper2 - 6
2021-04-27 04:45:16,447 - INFO - modeling - Saving complete
2021-04-27 04:45:16,447 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 04:45:16,447 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 04:45:16,532 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:45:59,251 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 04:45:59,251 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 04:45:59,251 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-27 04:45:59,251 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:46:22,111 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:46:22,881 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-27 04:46:22,882 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 100
2021-04-27 04:46:22,882 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:47:01,853 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:47:02,557 - INFO - transprompt_wrapper2 - {'acc': 0.5208333333333334}
2021-04-27 04:47:02,557 - INFO - transprompt_wrapper2 - 1
2021-04-27 04:47:24,009 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:47:24,751 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-27 04:47:24,751 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 300
2021-04-27 04:47:24,751 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:47:42,388 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:48:29,214 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-27 04:48:29,214 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-04-27 04:48:29,556 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-27 04:48:29,556 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-27 04:48:29,556 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:48:38,026 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 04:53:13,774 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-27 04:53:13,774 - INFO - modeling - eval_results: {'acc': 0.6420318623708454}
2021-04-27 04:53:13,776 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-27 04:53:13,777 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:53:36,693 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:53:37,459 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-27 04:53:37,459 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 100
2021-04-27 04:53:37,459 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 04:54:17,213 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:54:17,982 - INFO - transprompt_wrapper2 - {'acc': 0.7083333333333334}
2021-04-27 04:54:17,982 - INFO - transprompt_wrapper2 - 1
2021-04-27 04:54:40,206 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:54:40,959 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-04-27 04:54:40,959 - INFO - transprompt_wrapper2 - 2
2021-04-27 04:54:41,299 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 04:55:28,024 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-27 04:55:28,024 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-04-27 04:55:28,069 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-04-27 04:55:28,083 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-27 04:55:28,084 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 04:57:47,976 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-27 04:57:47,977 - INFO - modeling - eval_results: {'acc': 0.7128632391790286}
2021-04-27 05:37:06,914 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 05:37:06,914 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-04-27 05:37:06,917 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 05:37:06,918 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-04-27 05:37:06,919 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 05:37:06,919 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 05:37:06,919 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-27 05:37:06,919 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-27 05:37:06,919 - INFO - run_task_adaptation - task=MNLI
2021-04-27 05:37:06,919 - INFO - run_task_adaptation - label=contradiction
2021-04-27 05:37:06,919 - INFO - run_task_adaptation - **********************************
2021-04-27 05:37:09,695 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 05:37:40,027 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 05:37:40,027 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:38:21,121 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:38:22,619 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 05:38:22,619 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5833 | best_global_step: 100
2021-04-27 05:38:22,619 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:39:24,135 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:39:25,602 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 05:39:25,603 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6667 | best_global_step: 200
2021-04-27 05:39:25,603 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:40:27,032 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:40:28,454 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 05:40:28,454 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6771 | best_global_step: 300
2021-04-27 05:40:28,454 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:41:28,433 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:41:29,804 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 05:41:29,804 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 400
2021-04-27 05:41:29,804 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:42:31,725 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:42:33,171 - INFO - transprompt_wrapper2 - {'acc': 0.71875}
2021-04-27 05:42:33,171 - INFO - transprompt_wrapper2 - 1
2021-04-27 05:43:12,973 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:43:14,447 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 05:43:14,447 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 600
2021-04-27 05:43:14,447 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:44:13,684 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:44:15,166 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 05:44:15,166 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 700
2021-04-27 05:44:15,166 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:45:15,857 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:45:17,297 - INFO - transprompt_wrapper2 - {'acc': 0.71875}
2021-04-27 05:45:17,297 - INFO - transprompt_wrapper2 - 4
2021-04-27 05:45:57,678 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:45:59,160 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 05:45:59,160 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 900
2021-04-27 05:45:59,160 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:47:00,261 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:47:01,698 - INFO - transprompt_wrapper2 - {'acc': 0.71875}
2021-04-27 05:47:01,698 - INFO - transprompt_wrapper2 - 6
2021-04-27 05:47:02,013 - INFO - modeling - Saving complete
2021-04-27 05:47:02,013 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 05:47:02,013 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 05:47:02,101 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 05:47:47,437 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 05:47:47,438 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 05:47:47,438 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-27 05:47:47,438 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:48:12,464 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:48:13,242 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-27 05:48:13,242 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 100
2021-04-27 05:48:13,242 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:48:55,426 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:48:56,210 - INFO - transprompt_wrapper2 - {'acc': 0.5208333333333334}
2021-04-27 05:48:56,210 - INFO - transprompt_wrapper2 - 1
2021-04-27 05:49:18,555 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:49:19,258 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-27 05:49:19,259 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 300
2021-04-27 05:49:19,259 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:49:38,656 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 05:50:27,165 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-27 05:50:27,165 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-04-27 05:50:27,550 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-27 05:50:27,550 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-27 05:50:27,550 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:50:35,996 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 05:55:09,751 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-27 05:55:09,752 - INFO - modeling - eval_results: {'acc': 0.6420318623708454}
2021-04-27 05:55:09,754 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-27 05:55:09,754 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:55:33,611 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:55:34,340 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-27 05:55:34,341 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 100
2021-04-27 05:55:34,341 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 05:56:16,365 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:56:17,123 - INFO - transprompt_wrapper2 - {'acc': 0.7083333333333334}
2021-04-27 05:56:17,123 - INFO - transprompt_wrapper2 - 1
2021-04-27 05:56:39,869 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:56:40,562 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-04-27 05:56:40,562 - INFO - transprompt_wrapper2 - 2
2021-04-27 05:56:40,839 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 05:57:27,942 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-27 05:57:27,943 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-04-27 05:57:27,997 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-04-27 05:57:28,012 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-27 05:57:28,012 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 05:59:53,197 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-27 05:59:53,197 - INFO - modeling - eval_results: {'acc': 0.7128632391790286}
2021-04-27 06:06:46,211 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 06:06:46,211 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-04-27 06:06:46,256 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 06:06:46,256 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-04-27 06:06:46,261 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 06:06:46,261 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 06:06:46,261 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-27 06:06:46,261 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-27 06:06:46,261 - INFO - run_task_adaptation - task=MNLI
2021-04-27 06:06:46,261 - INFO - run_task_adaptation - label=contradiction
2021-04-27 06:06:46,261 - INFO - run_task_adaptation - **********************************
2021-04-27 06:06:49,236 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:07:17,783 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 06:07:17,783 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:07:58,948 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:08:00,399 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:08:00,400 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 100
2021-04-27 06:08:00,400 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:08:28,795 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 06:08:28,795 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-04-27 06:08:28,798 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 06:08:28,799 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-04-27 06:08:28,800 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 06:08:28,800 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 06:08:28,800 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-04-27 06:08:28,800 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-04-27 06:08:28,800 - INFO - run_task_adaptation - task=MNLI
2021-04-27 06:08:28,801 - INFO - run_task_adaptation - label=contradiction
2021-04-27 06:08:28,801 - INFO - run_task_adaptation - **********************************
2021-04-27 06:08:31,659 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:09:00,525 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 06:09:00,526 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:09:40,829 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:09:42,269 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:09:42,269 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 100
2021-04-27 06:09:42,269 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:10:42,547 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:10:43,957 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-04-27 06:10:43,957 - INFO - transprompt_wrapper2 - 1
2021-04-27 06:11:22,743 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:11:24,200 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:11:24,201 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 300
2021-04-27 06:11:24,201 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:12:23,543 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:12:24,970 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:12:24,970 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6771 | best_global_step: 400
2021-04-27 06:12:24,970 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:13:25,025 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:13:26,379 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-04-27 06:13:26,379 - INFO - transprompt_wrapper2 - 1
2021-04-27 06:14:04,687 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:14:06,113 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-04-27 06:14:06,113 - INFO - transprompt_wrapper2 - 2
2021-04-27 06:14:44,827 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:14:46,250 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-04-27 06:14:46,251 - INFO - transprompt_wrapper2 - 3
2021-04-27 06:15:24,646 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:15:26,096 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:15:26,096 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6771 | best_global_step: 800
2021-04-27 06:15:26,096 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:16:26,976 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:16:28,338 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:16:28,338 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6771 | best_global_step: 900
2021-04-27 06:16:28,338 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:17:28,334 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:17:29,700 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:17:29,700 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6771 | best_global_step: 1000
2021-04-27 06:17:29,700 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:17:53,396 - INFO - modeling - Saving complete
2021-04-27 06:17:53,396 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 06:17:53,396 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 06:17:53,475 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:18:37,191 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 06:18:37,192 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 06:18:37,192 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-27 06:18:37,192 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:18:58,979 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:18:59,773 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-27 06:18:59,773 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 100
2021-04-27 06:18:59,773 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:19:41,177 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:19:41,884 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-04-27 06:19:41,884 - INFO - transprompt_wrapper2 - 1
2021-04-27 06:20:02,282 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:20:03,019 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-27 06:20:03,019 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 300
2021-04-27 06:20:03,019 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:20:20,936 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:21:08,172 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-27 06:21:08,173 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-42 (num_examples=-1, set_type=test)
2021-04-27 06:21:08,655 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('contradiction', 6453), ('neutral', 6252)]
2021-04-27 06:21:08,655 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-27 06:21:08,655 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:21:17,377 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 06:25:51,253 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-27 06:25:51,253 - INFO - modeling - eval_results: {'acc': 0.6630019850358834}
2021-04-27 06:25:51,256 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-27 06:25:51,256 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:26:13,964 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:26:14,742 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-27 06:26:14,742 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 100
2021-04-27 06:26:14,742 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:26:55,176 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:26:55,881 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-27 06:26:55,881 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7708 | best_global_step: 200
2021-04-27 06:26:55,881 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:27:37,115 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:27:37,873 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-27 06:27:37,874 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8125 | best_global_step: 300
2021-04-27 06:27:37,874 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:27:56,188 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:28:46,183 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-27 06:28:46,183 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-42 (num_examples=-1, set_type=test)
2021-04-27 06:28:46,731 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-04-27 06:28:46,748 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-27 06:28:46,748 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:31:07,667 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-27 06:31:07,668 - INFO - modeling - eval_results: {'acc': 0.7641739483844747}
2021-04-27 06:36:03,973 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-12', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=12, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 06:36:03,973 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-12 (num_examples=-1, set_type=train)
2021-04-27 06:36:04,010 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 06:36:04,010 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-12 (num_examples=-1, set_type=dev)
2021-04-27 06:36:04,012 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-04-27 06:36:04,012 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 06:36:04,012 - INFO - run_task_adaptation - text_a=The monastery's museum traces the kingdom of Naples' long history in costumes, sculpture, paintings, and prints.
2021-04-27 06:36:04,013 - INFO - run_task_adaptation - text_b=The museum of the monastery does not show the long history of Naples and instead completely focuses on the history of other surrounding countries. 
2021-04-27 06:36:04,013 - INFO - run_task_adaptation - task=MNLI
2021-04-27 06:36:04,013 - INFO - run_task_adaptation - label=contradiction
2021-04-27 06:36:04,013 - INFO - run_task_adaptation - **********************************
2021-04-27 06:36:06,794 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:36:36,913 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 06:36:36,914 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:37:03,049 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 06:37:03,049 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=train)
2021-04-27 06:37:03,066 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-04-27 06:37:03,066 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=dev)
2021-04-27 06:37:03,069 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-04-27 06:37:03,069 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 06:37:03,069 - INFO - run_task_adaptation - text_a=Egypt , Mongolia , the Seychelles , Tunisia and at least three other governments have signed unpublicized agreements .
2021-04-27 06:37:03,069 - INFO - run_task_adaptation - text_b=At least seven other governments have signed agreements , but have asked not to have them publicized .
2021-04-27 06:37:03,069 - INFO - run_task_adaptation - task=MRPC
2021-04-27 06:37:03,069 - INFO - run_task_adaptation - label=0
2021-04-27 06:37:03,069 - INFO - run_task_adaptation - **********************************
2021-04-27 06:37:05,787 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:37:15,686 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:37:17,121 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:37:17,121 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 100
2021-04-27 06:37:17,121 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:37:36,384 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 06:37:36,385 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:38:53,019 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:38:55,507 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-27 06:38:55,507 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5938 | best_global_step: 100
2021-04-27 06:38:55,507 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:38:55,650 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:38:57,026 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-04-27 06:38:57,026 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7083 | best_global_step: 200
2021-04-27 06:38:57,026 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:40:45,812 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:40:47,069 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:40:47,959 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-27 06:40:47,959 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7031 | best_global_step: 200
2021-04-27 06:40:47,959 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:40:48,879 - INFO - transprompt_wrapper2 - {'acc': 0.6979166666666666}
2021-04-27 06:40:48,880 - INFO - transprompt_wrapper2 - 1
2021-04-27 06:41:44,100 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:41:47,713 - INFO - transprompt_wrapper2 - {'acc': 0.6770833333333334}
2021-04-27 06:41:47,713 - INFO - transprompt_wrapper2 - 2
2021-04-27 06:42:25,480 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:42:27,741 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-04-27 06:42:27,741 - INFO - transprompt_wrapper2 - 1
2021-04-27 06:43:06,518 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:43:09,994 - INFO - transprompt_wrapper2 - {'acc': 0.6354166666666666}
2021-04-27 06:43:09,994 - INFO - transprompt_wrapper2 - 3
2021-04-27 06:43:43,313 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:43:45,683 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-04-27 06:43:45,684 - INFO - transprompt_wrapper2 - 2
2021-04-27 06:44:25,497 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:44:29,065 - INFO - transprompt_wrapper2 - {'acc': 0.6354166666666666}
2021-04-27 06:44:29,065 - INFO - transprompt_wrapper2 - 4
2021-04-27 06:45:01,571 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:45:03,966 - INFO - transprompt_wrapper2 - {'acc': 0.609375}
2021-04-27 06:45:03,966 - INFO - transprompt_wrapper2 - 3
2021-04-27 06:45:45,054 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:45:48,776 - INFO - transprompt_wrapper2 - {'acc': 0.6354166666666666}
2021-04-27 06:45:48,776 - INFO - transprompt_wrapper2 - 5
2021-04-27 06:46:19,028 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:46:21,428 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-27 06:46:21,428 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7031 | best_global_step: 600
2021-04-27 06:46:21,428 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:46:42,509 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:46:44,971 - INFO - transprompt_wrapper2 - {'acc': 0.6354166666666666}
2021-04-27 06:46:44,971 - INFO - transprompt_wrapper2 - 6
2021-04-27 06:47:58,624 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:48:00,922 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-04-27 06:48:00,922 - INFO - transprompt_wrapper2 - 5
2021-04-27 06:48:04,028 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:48:07,514 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-04-27 06:48:07,514 - INFO - transprompt_wrapper2 - 7
2021-04-27 06:49:16,175 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:49:18,424 - INFO - transprompt_wrapper2 - {'acc': 0.671875}
2021-04-27 06:49:18,424 - INFO - transprompt_wrapper2 - 6
2021-04-27 06:49:23,954 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:49:27,600 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-04-27 06:49:27,601 - INFO - transprompt_wrapper2 - 8
2021-04-27 06:49:28,162 - INFO - modeling - Saving complete
2021-04-27 06:49:28,162 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 06:49:28,162 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 06:49:28,250 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:50:00,169 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:50:01,102 - INFO - transprompt_wrapper2 - {'acc': 0.671875}
2021-04-27 06:50:01,102 - INFO - transprompt_wrapper2 - 7
2021-04-27 06:50:14,130 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 06:50:14,131 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 06:50:14,131 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-27 06:50:14,131 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:50:54,084 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:50:55,742 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-04-27 06:50:55,742 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7083 | best_global_step: 100
2021-04-27 06:50:55,742 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:50:58,946 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:50:59,914 - INFO - transprompt_wrapper2 - {'acc': 0.671875}
2021-04-27 06:50:59,914 - INFO - transprompt_wrapper2 - 8
2021-04-27 06:51:00,155 - INFO - modeling - Saving complete
2021-04-27 06:51:00,155 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 06:51:00,155 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 06:51:00,252 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:51:33,457 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:51:34,165 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-04-27 06:51:34,165 - INFO - transprompt_wrapper2 - 1
2021-04-27 06:51:48,136 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 06:51:48,136 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 06:51:48,136 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-04-27 06:51:48,136 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:51:54,509 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:51:55,201 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-04-27 06:51:55,201 - INFO - transprompt_wrapper2 - 2
2021-04-27 06:51:55,469 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 06:52:43,660 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-27 06:52:43,660 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-12 (num_examples=-1, set_type=test)
2021-04-27 06:52:44,105 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-27 06:52:44,105 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-27 06:52:44,105 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:52:52,664 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 06:57:25,562 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-27 06:57:25,562 - INFO - modeling - eval_results: {'acc': 0.6638163587316129}
2021-04-27 06:57:25,595 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-27 06:57:25,595 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:57:45,417 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:57:46,130 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-27 06:57:46,130 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 100
2021-04-27 06:57:46,130 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:58:23,877 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:58:24,565 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-27 06:58:24,565 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6875 | best_global_step: 200
2021-04-27 06:58:24,565 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:59:02,077 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 06:59:02,747 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-04-27 06:59:02,747 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7083 | best_global_step: 300
2021-04-27 06:59:02,748 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 06:59:22,489 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 07:00:09,212 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-27 07:00:09,213 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-12 (num_examples=-1, set_type=test)
2021-04-27 07:00:09,276 - INFO - task_processors - Returning 9842 test examples with label dist.: [('entailment', 3329), ('contradiction', 3278), ('neutral', 3235)]
2021-04-27 07:00:09,289 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-27 07:00:09,290 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:02:29,612 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-27 07:02:29,612 - INFO - modeling - eval_results: {'acc': 0.7404998983946353}
2021-04-27 07:09:40,125 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 07:09:40,125 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=train)
2021-04-27 07:09:40,128 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-04-27 07:09:40,128 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=dev)
2021-04-27 07:09:40,130 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-04-27 07:09:40,130 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 07:09:40,130 - INFO - run_task_adaptation - text_a=Egypt , Mongolia , the Seychelles , Tunisia and at least three other governments have signed unpublicized agreements .
2021-04-27 07:09:40,130 - INFO - run_task_adaptation - text_b=At least seven other governments have signed agreements , but have asked not to have them publicized .
2021-04-27 07:09:40,130 - INFO - run_task_adaptation - task=MRPC
2021-04-27 07:09:40,130 - INFO - run_task_adaptation - label=0
2021-04-27 07:09:40,130 - INFO - run_task_adaptation - **********************************
2021-04-27 07:09:42,673 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 07:10:12,727 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 07:10:12,727 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:10:51,284 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:10:52,242 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-27 07:10:52,243 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5938 | best_global_step: 100
2021-04-27 07:10:52,243 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:11:50,904 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:11:51,840 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-27 07:11:51,840 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7031 | best_global_step: 200
2021-04-27 07:11:51,840 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:12:50,428 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:12:51,361 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-04-27 07:12:51,361 - INFO - transprompt_wrapper2 - 1
2021-04-27 07:13:28,648 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:13:29,602 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-04-27 07:13:29,602 - INFO - transprompt_wrapper2 - 2
2021-04-27 07:14:06,834 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:14:07,770 - INFO - transprompt_wrapper2 - {'acc': 0.609375}
2021-04-27 07:14:07,770 - INFO - transprompt_wrapper2 - 3
2021-04-27 07:14:46,121 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:14:47,084 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-04-27 07:14:47,084 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7031 | best_global_step: 600
2021-04-27 07:14:47,084 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:15:46,543 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:15:47,508 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-04-27 07:15:47,508 - INFO - transprompt_wrapper2 - 5
2021-04-27 07:16:24,978 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:16:25,905 - INFO - transprompt_wrapper2 - {'acc': 0.671875}
2021-04-27 07:16:25,905 - INFO - transprompt_wrapper2 - 6
2021-04-27 07:17:03,163 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:17:04,076 - INFO - transprompt_wrapper2 - {'acc': 0.671875}
2021-04-27 07:17:04,077 - INFO - transprompt_wrapper2 - 7
2021-04-27 07:17:41,002 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:17:41,960 - INFO - transprompt_wrapper2 - {'acc': 0.671875}
2021-04-27 07:17:41,960 - INFO - transprompt_wrapper2 - 8
2021-04-27 07:17:42,231 - INFO - modeling - Saving complete
2021-04-27 07:17:42,231 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 07:17:42,231 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 07:17:42,351 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 07:18:29,045 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 07:18:29,045 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 07:18:29,045 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-04-27 07:18:29,046 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:19:48,695 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:19:49,105 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-04-27 07:19:49,105 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5938 | best_global_step: 100
2021-04-27 07:19:49,105 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:21:27,072 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:21:27,462 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-04-27 07:21:27,462 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5938 | best_global_step: 200
2021-04-27 07:21:27,462 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:23:06,302 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:23:06,705 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-04-27 07:23:06,705 - INFO - transprompt_wrapper2 - 2
2021-04-27 07:24:25,088 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:24:25,486 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-04-27 07:24:25,486 - INFO - transprompt_wrapper2 - 3
2021-04-27 07:25:43,826 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:25:44,215 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-04-27 07:25:44,215 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5938 | best_global_step: 500
2021-04-27 07:25:44,215 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:27:22,677 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:27:23,064 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-04-27 07:27:23,064 - INFO - transprompt_wrapper2 - 5
2021-04-27 07:28:41,903 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:28:42,293 - INFO - transprompt_wrapper2 - {'acc': 0.53125}
2021-04-27 07:28:42,293 - INFO - transprompt_wrapper2 - 6
2021-04-27 07:30:01,196 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:30:01,622 - INFO - transprompt_wrapper2 - {'acc': 0.53125}
2021-04-27 07:30:01,623 - INFO - transprompt_wrapper2 - 7
2021-04-27 07:30:44,958 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 07:30:44,958 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-27 07:30:44,991 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 07:30:44,992 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-27 07:30:44,997 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 07:30:44,997 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 07:30:44,997 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-27 07:30:44,997 - INFO - run_task_adaptation - text_b=None
2021-04-27 07:30:44,998 - INFO - run_task_adaptation - task=SST-2
2021-04-27 07:30:44,998 - INFO - run_task_adaptation - label=0
2021-04-27 07:30:44,998 - INFO - run_task_adaptation - **********************************
2021-04-27 07:30:51,008 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 07:31:20,250 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:31:20,685 - INFO - transprompt_wrapper2 - {'acc': 0.53125}
2021-04-27 07:31:20,685 - INFO - transprompt_wrapper2 - 8
2021-04-27 07:31:26,012 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 07:31:26,015 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:32:40,953 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:32:41,363 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-04-27 07:32:41,363 - INFO - transprompt_wrapper2 - 9
2021-04-27 07:33:59,380 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:33:59,768 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-04-27 07:33:59,768 - INFO - transprompt_wrapper2 - 10
2021-04-27 07:33:59,887 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 07:34:50,886 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mrpc
2021-04-27 07:34:50,886 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MRPC/16-21 (num_examples=-1, set_type=test)
2021-04-27 07:34:50,909 - INFO - task_processors - Returning 408 test examples with label dist.: [(1, 279), (0, 129)]
2021-04-27 07:34:50,909 - INFO - modeling - Group g3: Task mrpc 's Test examples number: 408
2021-04-27 07:34:50,909 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:34:55,949 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=mrpc) ---
2021-04-27 07:34:55,949 - INFO - modeling - eval_results: {'acc': 0.7671568627450981}
2021-04-27 07:34:55,951 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task qqp =========
2021-04-27 07:34:55,951 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:35:41,596 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:35:41,990 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-27 07:35:41,990 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 100
2021-04-27 07:35:41,990 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:36:46,798 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:36:47,181 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-27 07:36:47,181 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 200
2021-04-27 07:36:47,181 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:37:52,130 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:37:52,511 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-04-27 07:37:52,512 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 300
2021-04-27 07:37:52,512 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 07:38:12,646 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 07:39:02,270 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task qqp
2021-04-27 07:39:02,270 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/QQP/16-21 (num_examples=-1, set_type=test)
2021-04-27 07:39:02,988 - INFO - task_processors - Returning 40429 test examples with label dist.: [(0, 25544), (1, 14885)]
2021-04-27 07:39:02,989 - INFO - modeling - Group g3: Task qqp 's Test examples number: 40429
2021-04-27 07:39:02,989 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 07:39:09,518 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 07:39:15,774 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-27 07:39:21,304 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-27 07:39:27,204 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-27 07:47:10,553 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=qqp) ---
2021-04-27 07:47:10,553 - INFO - modeling - eval_results: {'acc': 0.7349180044027802}
2021-04-27 08:07:29,044 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 08:07:29,044 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 08:07:29,047 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 08:07:29,047 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 08:07:29,049 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 08:07:29,049 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 08:07:29,049 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 08:07:29,049 - INFO - run_task_adaptation - text_b=None
2021-04-27 08:07:29,049 - INFO - run_task_adaptation - task=SST-2
2021-04-27 08:07:29,049 - INFO - run_task_adaptation - label=0
2021-04-27 08:07:29,049 - INFO - run_task_adaptation - **********************************
2021-04-27 08:07:31,936 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:08:05,133 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 08:08:05,133 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 08:08:05,137 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 08:08:05,137 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 08:08:05,138 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 08:08:05,138 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 08:08:05,138 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 08:08:05,138 - INFO - run_task_adaptation - text_b=None
2021-04-27 08:08:05,138 - INFO - run_task_adaptation - task=SST-2
2021-04-27 08:08:05,138 - INFO - run_task_adaptation - label=0
2021-04-27 08:08:05,138 - INFO - run_task_adaptation - **********************************
2021-04-27 08:08:07,863 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:08:38,123 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 08:08:38,123 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:09:17,036 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:09:18,426 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 08:09:18,426 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8542 | best_global_step: 100
2021-04-27 08:09:18,426 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:10:18,651 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:10:19,999 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 08:10:19,999 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8646 | best_global_step: 200
2021-04-27 08:10:19,999 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:11:20,128 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:11:21,482 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 08:11:21,482 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 300
2021-04-27 08:11:21,482 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:12:22,075 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:12:23,489 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 08:12:23,489 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 400
2021-04-27 08:12:23,489 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:13:25,068 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:13:26,422 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 08:13:26,422 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-04-27 08:13:26,422 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:14:26,312 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:14:27,660 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-04-27 08:14:27,660 - INFO - transprompt_wrapper2 - 1
2021-04-27 08:15:05,069 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:15:06,417 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 08:15:06,417 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 700
2021-04-27 08:15:06,417 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:16:07,288 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:16:08,661 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-04-27 08:16:08,661 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 800
2021-04-27 08:16:08,661 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:17:10,563 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:17:11,955 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-04-27 08:17:11,955 - INFO - transprompt_wrapper2 - 4
2021-04-27 08:17:49,504 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:17:50,876 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-04-27 08:17:50,877 - INFO - transprompt_wrapper2 - 5
2021-04-27 08:17:51,177 - INFO - modeling - Saving complete
2021-04-27 08:17:51,177 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 08:17:51,177 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 08:17:51,270 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:18:36,801 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 08:18:36,801 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 08:18:36,801 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-27 08:18:36,801 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:18:56,307 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:18:56,781 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-27 08:18:56,781 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9688 | best_global_step: 100
2021-04-27 08:18:56,781 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:19:35,533 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:19:35,994 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-27 08:19:35,994 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9688 | best_global_step: 200
2021-04-27 08:19:35,994 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:20:14,873 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:20:15,324 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-27 08:20:15,324 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9688 | best_global_step: 300
2021-04-27 08:20:15,324 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:20:35,307 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:21:24,379 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-27 08:21:24,379 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-27 08:21:24,386 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-27 08:21:24,386 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-27 08:21:24,386 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:21:37,354 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-27 08:21:37,354 - INFO - modeling - eval_results: {'acc': 0.9403669724770642}
2021-04-27 08:21:37,356 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-27 08:21:37,356 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:21:58,187 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:21:58,711 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-27 08:21:58,711 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 100
2021-04-27 08:21:58,711 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:22:39,102 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:22:39,569 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-27 08:22:39,569 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 200
2021-04-27 08:22:39,569 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:23:19,843 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:23:20,311 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-27 08:23:20,311 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 300
2021-04-27 08:23:20,311 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:23:41,362 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:24:31,015 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-27 08:24:31,015 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-27 08:24:31,028 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-27 08:24:31,029 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-27 08:24:31,029 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:25:00,675 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-27 08:25:00,675 - INFO - modeling - eval_results: {'acc': 0.891}
2021-04-27 08:25:00,677 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-27 08:25:00,678 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:25:21,359 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:25:21,834 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:25:21,834 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-27 08:25:21,834 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:26:02,901 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:26:03,370 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:26:03,370 - INFO - transprompt_wrapper2 - 1
2021-04-27 08:26:24,038 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:26:24,544 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:26:24,544 - INFO - transprompt_wrapper2 - 2
2021-04-27 08:26:24,841 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:27:14,237 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-27 08:27:14,237 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-27 08:27:14,253 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-27 08:27:14,254 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-27 08:27:14,254 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:27:43,725 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-27 08:27:43,725 - INFO - modeling - eval_results: {'acc': 0.8985}
2021-04-27 08:32:15,318 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 08:32:15,319 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-27 08:32:15,322 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 08:32:15,322 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-27 08:32:15,323 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 08:32:15,324 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 08:32:15,324 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-27 08:32:15,324 - INFO - run_task_adaptation - text_b=None
2021-04-27 08:32:15,324 - INFO - run_task_adaptation - task=SST-2
2021-04-27 08:32:15,324 - INFO - run_task_adaptation - label=0
2021-04-27 08:32:15,324 - INFO - run_task_adaptation - **********************************
2021-04-27 08:32:17,934 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:32:48,808 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-27 08:32:48,918 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:33:38,610 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-27 08:33:38,611 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-27 08:33:38,611 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-27 08:33:38,611 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:33:58,328 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:33:58,853 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-27 08:33:58,854 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-27 08:33:58,854 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:34:38,823 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:34:39,293 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-04-27 08:34:39,293 - INFO - transprompt_wrapper2 - 1
2021-04-27 08:34:58,442 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:34:58,909 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:34:58,909 - INFO - transprompt_wrapper2 - 2
2021-04-27 08:35:17,820 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:35:18,284 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:35:18,284 - INFO - transprompt_wrapper2 - 3
2021-04-27 08:35:37,814 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:35:38,281 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:35:38,281 - INFO - transprompt_wrapper2 - 4
2021-04-27 08:35:57,548 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:35:58,010 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:35:58,010 - INFO - transprompt_wrapper2 - 5
2021-04-27 08:36:16,862 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:36:17,325 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:36:17,326 - INFO - transprompt_wrapper2 - 6
2021-04-27 08:36:36,191 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:36:36,656 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:36:36,656 - INFO - transprompt_wrapper2 - 7
2021-04-27 08:36:56,217 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:36:56,680 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:36:56,680 - INFO - transprompt_wrapper2 - 8
2021-04-27 08:37:15,687 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:37:16,161 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:37:16,161 - INFO - transprompt_wrapper2 - 9
2021-04-27 08:37:35,256 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:37:35,719 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:37:35,719 - INFO - transprompt_wrapper2 - 10
2021-04-27 08:37:35,819 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:38:27,344 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-04-27 08:38:27,344 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-42 (num_examples=-1, set_type=test)
2021-04-27 08:38:27,394 - INFO - task_processors - Returning 872 test examples with label dist.: [(1, 444), (0, 428)]
2021-04-27 08:38:27,394 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-27 08:38:27,394 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:38:40,248 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-27 08:38:40,248 - INFO - modeling - eval_results: {'acc': 0.9323394495412844}
2021-04-27 08:38:40,250 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-04-27 08:38:40,251 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:39:00,405 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:39:00,881 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-04-27 08:39:00,881 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-27 08:39:00,881 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:39:41,121 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:39:41,587 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:39:41,587 - INFO - transprompt_wrapper2 - 1
2021-04-27 08:40:01,050 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:40:01,515 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:40:01,515 - INFO - transprompt_wrapper2 - 2
2021-04-27 08:40:21,125 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:40:21,599 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:40:21,599 - INFO - transprompt_wrapper2 - 3
2021-04-27 08:40:41,607 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:40:42,095 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-04-27 08:40:42,095 - INFO - transprompt_wrapper2 - 4
2021-04-27 08:41:02,308 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:41:02,808 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:41:02,808 - INFO - transprompt_wrapper2 - 5
2021-04-27 08:41:22,092 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:41:22,557 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:41:22,558 - INFO - transprompt_wrapper2 - 6
2021-04-27 08:41:41,698 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:41:42,150 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:41:42,150 - INFO - transprompt_wrapper2 - 7
2021-04-27 08:42:01,821 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:42:02,288 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:42:02,289 - INFO - transprompt_wrapper2 - 8
2021-04-27 08:42:21,683 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:42:22,134 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:42:22,134 - INFO - transprompt_wrapper2 - 9
2021-04-27 08:42:41,223 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:42:41,694 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-04-27 08:42:41,694 - INFO - transprompt_wrapper2 - 10
2021-04-27 08:42:41,804 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:43:30,532 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-04-27 08:43:30,532 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-42 (num_examples=-1, set_type=test)
2021-04-27 08:43:30,655 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-27 08:43:30,655 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-27 08:43:30,655 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:44:00,233 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-27 08:44:00,233 - INFO - modeling - eval_results: {'acc': 0.861}
2021-04-27 08:44:00,234 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-04-27 08:44:00,235 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:44:20,930 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:44:21,387 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:44:21,387 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 100
2021-04-27 08:44:21,387 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:45:01,062 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:45:01,517 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:45:01,517 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 200
2021-04-27 08:45:01,517 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:45:41,684 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:45:42,138 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:45:42,138 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 300
2021-04-27 08:45:42,138 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:46:23,024 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:46:23,476 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:46:23,476 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 400
2021-04-27 08:46:23,476 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:47:03,698 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:47:04,157 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:47:04,157 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 500
2021-04-27 08:47:04,158 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:47:47,197 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:47:47,653 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:47:47,654 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 600
2021-04-27 08:47:47,654 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:48:28,940 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:48:29,398 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:48:29,399 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 700
2021-04-27 08:48:29,399 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:49:10,591 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:49:11,068 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:49:11,069 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8125 | best_global_step: 800
2021-04-27 08:49:11,069 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:49:53,847 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:49:54,307 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-04-27 08:49:54,307 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8125 | best_global_step: 900
2021-04-27 08:49:54,307 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 08:50:34,674 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:50:35,124 - INFO - transprompt_wrapper2 - {'acc': 0.78125}
2021-04-27 08:50:35,124 - INFO - transprompt_wrapper2 - 2
2021-04-27 08:50:54,618 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:50:55,069 - INFO - transprompt_wrapper2 - {'acc': 0.78125}
2021-04-27 08:50:55,069 - INFO - transprompt_wrapper2 - 3
2021-04-27 08:51:14,662 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:51:15,113 - INFO - transprompt_wrapper2 - {'acc': 0.78125}
2021-04-27 08:51:15,113 - INFO - transprompt_wrapper2 - 4
2021-04-27 08:51:15,805 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 08:52:05,461 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-04-27 08:52:05,461 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-42 (num_examples=-1, set_type=test)
2021-04-27 08:52:05,505 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-27 08:52:05,507 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-27 08:52:05,508 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 08:52:34,253 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-27 08:52:34,253 - INFO - modeling - eval_results: {'acc': 0.894}
2021-04-27 09:16:19,864 - INFO - run_task_generalization - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-12', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=192, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=12, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 09:16:19,865 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-12 (num_examples=-1, set_type=train)
2021-04-27 09:16:19,906 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 09:16:19,906 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-12 (num_examples=-1, set_type=dev)
2021-04-27 09:16:19,908 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 09:16:19,908 - INFO - run_task_generalization - ************Training Example:**************
2021-04-27 09:16:19,908 - INFO - run_task_generalization - text_a=unfortunately , we 'd prefer a simple misfire .
2021-04-27 09:16:19,909 - INFO - run_task_generalization - text_b=None
2021-04-27 09:16:19,909 - INFO - run_task_generalization - task=SST-2
2021-04-27 09:16:19,909 - INFO - run_task_generalization - label=0
2021-04-27 09:16:19,909 - INFO - run_task_generalization - **********************************
2021-04-27 09:16:19,909 - INFO - run_task_generalization - ======== Meta-learning on task mr,cr, Task generalization on unseen tasks: sst-2 ========
2021-04-27 09:16:22,508 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:16:51,925 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 09:16:51,925 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:17:40,149 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:17:41,390 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:17:41,390 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 09:17:41,390 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:18:50,742 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:18:51,967 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:18:51,967 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 09:18:51,967 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:20:01,527 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:20:02,759 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:20:02,759 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 09:20:02,759 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:21:12,452 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:21:13,676 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:21:13,676 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-27 09:21:13,676 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:22:24,615 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:22:25,848 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:22:25,848 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-27 09:22:25,848 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:23:35,751 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:23:37,010 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:23:37,010 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 600
2021-04-27 09:23:37,010 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:24:49,270 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:24:50,510 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:24:50,510 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 700
2021-04-27 09:24:50,510 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:26:02,583 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:26:03,815 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:26:03,815 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 800
2021-04-27 09:26:03,815 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:27:23,482 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:27:24,774 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:27:24,774 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 900
2021-04-27 09:27:24,774 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:28:37,256 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:28:38,483 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:28:38,483 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 1000
2021-04-27 09:28:38,483 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:29:01,531 - INFO - modeling - Saving complete
2021-04-27 09:29:01,531 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 09:29:01,531 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-27 09:29:01,613 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:29:46,940 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task sst-2 =========
2021-04-27 09:29:46,940 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:30:10,097 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:30:10,703 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-27 09:30:10,703 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 09:30:10,703 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:30:52,842 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:30:53,462 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-27 09:30:53,462 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 09:30:53,462 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:31:35,940 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:31:36,559 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-27 09:31:36,559 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 09:31:36,559 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:31:57,629 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:32:47,312 - INFO - modeling - ========= Stage2: Evaluating test set on Task sst-2
2021-04-27 09:32:47,312 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-12 (num_examples=-1, set_type=test)
2021-04-27 09:32:47,355 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-27 09:32:47,355 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-27 09:32:47,355 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:33:04,217 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-27 09:33:04,218 - INFO - modeling - eval_results: {'acc': 0.926605504587156}
2021-04-27 09:33:04,327 - INFO - run_task_generalization - ======== Meta-learning on task SST-2,cr, Task generalization on unseen tasks: mr ========
2021-04-27 09:33:06,934 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:33:36,337 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 09:33:36,338 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:34:01,313 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:34:02,601 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:34:02,601 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 09:34:02,601 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:34:46,622 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:34:47,839 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:34:47,839 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 09:34:47,839 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:35:31,500 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:35:32,717 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:35:32,717 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 09:35:32,717 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:35:52,922 - INFO - modeling - Saving complete
2021-04-27 09:35:52,922 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 09:35:52,922 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-27 09:35:53,011 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:36:42,885 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task mr =========
2021-04-27 09:36:42,885 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:37:06,302 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:37:06,922 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-27 09:37:06,922 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 09:37:06,922 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:37:48,761 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:37:49,389 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-27 09:37:49,389 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 09:37:49,389 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:38:32,619 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:38:33,232 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-27 09:38:33,232 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 09:38:33,232 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:38:53,076 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:39:41,559 - INFO - modeling - ========= Stage2: Evaluating test set on Task mr
2021-04-27 09:39:41,559 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-12 (num_examples=-1, set_type=test)
2021-04-27 09:39:41,613 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-27 09:39:41,613 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-27 09:39:41,613 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:40:20,053 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-27 09:40:20,053 - INFO - modeling - eval_results: {'acc': 0.863}
2021-04-27 09:40:20,114 - INFO - run_task_generalization - ======== Meta-learning on task SST-2,mr, Task generalization on unseen tasks: cr ========
2021-04-27 09:40:22,579 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:40:48,443 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 09:40:48,443 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:41:13,501 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:41:14,750 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:41:14,750 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 09:41:14,750 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:41:58,821 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:42:00,050 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:42:00,050 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 09:42:00,050 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:42:44,063 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:42:45,299 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 09:42:45,299 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 09:42:45,299 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:43:05,503 - INFO - modeling - Saving complete
2021-04-27 09:43:05,503 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 09:43:05,503 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-27 09:43:05,607 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:43:55,715 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task cr =========
2021-04-27 09:43:55,715 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:44:19,341 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:44:19,948 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-27 09:44:19,948 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 09:44:19,948 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:45:03,295 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:45:03,912 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-27 09:45:03,912 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 09:45:03,912 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:45:46,508 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:45:47,116 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-27 09:45:47,116 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 09:45:47,116 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 09:46:08,421 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 09:47:00,940 - INFO - modeling - ========= Stage2: Evaluating test set on Task cr
2021-04-27 09:47:00,940 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-12 (num_examples=-1, set_type=test)
2021-04-27 09:47:01,036 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-27 09:47:01,036 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-27 09:47:01,036 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 09:47:39,167 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-27 09:47:39,168 - INFO - modeling - eval_results: {'acc': 0.907}
2021-04-27 12:27:50,697 - INFO - run_task_generalization - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=192, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-27 12:27:50,698 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-04-27 12:27:50,702 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 12:27:50,703 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-04-27 12:27:50,705 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-27 12:27:50,705 - INFO - run_task_generalization - ************Training Example:**************
2021-04-27 12:27:50,705 - INFO - run_task_generalization - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-04-27 12:27:50,705 - INFO - run_task_generalization - text_b=None
2021-04-27 12:27:50,705 - INFO - run_task_generalization - task=SST-2
2021-04-27 12:27:50,705 - INFO - run_task_generalization - label=0
2021-04-27 12:27:50,705 - INFO - run_task_generalization - **********************************
2021-04-27 12:27:50,705 - INFO - run_task_generalization - ======== Meta-learning on task mr,cr, Task generalization on unseen tasks: sst-2 ========
2021-04-27 12:27:53,196 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:28:22,233 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 12:28:22,233 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:29:10,452 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:29:11,672 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:29:11,672 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 12:29:11,672 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:30:22,724 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:30:23,959 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:30:23,960 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 12:30:23,960 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:31:33,990 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:31:35,221 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:31:35,221 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 12:31:35,221 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:32:45,137 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:32:46,375 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:32:46,375 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 400
2021-04-27 12:32:46,375 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:33:56,563 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:33:57,803 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:33:57,804 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 500
2021-04-27 12:33:57,804 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:35:08,014 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:35:09,252 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:35:09,252 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 600
2021-04-27 12:35:09,252 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:36:19,060 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:36:20,293 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:36:20,293 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 700
2021-04-27 12:36:20,293 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:37:30,670 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:37:31,932 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:37:31,932 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 800
2021-04-27 12:37:31,932 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:38:42,225 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:38:43,469 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:38:43,470 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 900
2021-04-27 12:38:43,470 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:39:53,836 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:39:55,086 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:39:55,086 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 1000
2021-04-27 12:39:55,086 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:40:19,024 - INFO - modeling - Saving complete
2021-04-27 12:40:19,024 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 12:40:19,024 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-27 12:40:19,108 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:41:05,356 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task sst-2 =========
2021-04-27 12:41:05,356 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:41:28,817 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:41:29,463 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-27 12:41:29,463 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 12:41:29,463 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:42:12,555 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:42:13,195 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-27 12:42:13,195 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 12:42:13,195 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:42:56,640 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:42:57,257 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/sst-2...
2021-04-27 12:42:57,257 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 12:42:57,258 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:43:18,284 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:44:08,711 - INFO - modeling - ========= Stage2: Evaluating test set on Task sst-2
2021-04-27 12:44:08,712 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-04-27 12:44:08,720 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-04-27 12:44:08,720 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-04-27 12:44:08,720 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:44:25,708 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-04-27 12:44:25,708 - INFO - modeling - eval_results: {'acc': 0.9346330275229358}
2021-04-27 12:44:25,784 - INFO - run_task_generalization - ======== Meta-learning on task SST-2,cr, Task generalization on unseen tasks: mr ========
2021-04-27 12:44:28,449 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:44:55,138 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 12:44:55,138 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:45:20,037 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:45:21,266 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:45:21,266 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-04-27 12:45:21,266 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:46:04,468 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:46:05,693 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:46:05,693 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 12:46:05,693 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:46:48,267 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:46:49,520 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:46:49,521 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 12:46:49,521 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:47:09,524 - INFO - modeling - Saving complete
2021-04-27 12:47:09,524 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 12:47:09,524 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-27 12:47:09,614 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:47:59,992 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task mr =========
2021-04-27 12:47:59,992 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:48:23,297 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:48:23,920 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-27 12:48:23,920 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 12:48:23,920 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:49:07,293 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:49:07,904 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-27 12:49:07,904 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 12:49:07,904 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:49:50,828 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:49:51,454 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/mr...
2021-04-27 12:49:51,454 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 12:49:51,454 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:50:11,907 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:51:01,281 - INFO - modeling - ========= Stage2: Evaluating test set on Task mr
2021-04-27 12:51:01,281 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-04-27 12:51:01,295 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-04-27 12:51:01,295 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-04-27 12:51:01,295 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:51:39,935 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=mr) ---
2021-04-27 12:51:39,935 - INFO - modeling - eval_results: {'acc': 0.8675}
2021-04-27 12:51:40,052 - INFO - run_task_generalization - ======== Meta-learning on task mr,SST-2, Task generalization on unseen tasks: cr ========
2021-04-27 12:51:42,615 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:52:11,059 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 12:52:11,059 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:52:35,993 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:52:37,215 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:52:37,215 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9844 | best_global_step: 100
2021-04-27 12:52:37,215 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:53:22,250 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:53:23,480 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:53:23,480 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 12:53:23,480 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:54:06,781 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:54:08,016 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1...
2021-04-27 12:54:08,016 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 12:54:08,016 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:54:28,215 - INFO - modeling - Saving complete
2021-04-27 12:54:28,215 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-27 12:54:28,215 - INFO - modeling - ========= Stage2: Starting Task Generalization (Unseen Task-Specific Fine-tuning) ... =========
2021-04-27 12:54:28,368 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:55:21,014 - INFO - modeling - ========= Stage2: Specific fine-tuning on Unseen Task cr =========
2021-04-27 12:55:21,014 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:55:44,492 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:55:45,106 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-27 12:55:45,106 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 100
2021-04-27 12:55:45,106 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:56:28,773 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:56:29,415 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-27 12:56:29,415 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 200
2021-04-27 12:56:29,415 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:57:13,509 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:57:14,144 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/generalization/g1/cr...
2021-04-27 12:57:14,144 - INFO - transprompt_wrapper2 - best_dev_acc: 1.0000 | best_global_step: 300
2021-04-27 12:57:14,145 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 12:57:35,013 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 12:58:25,485 - INFO - modeling - ========= Stage2: Evaluating test set on Task cr
2021-04-27 12:58:25,485 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-04-27 12:58:25,507 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-04-27 12:58:25,507 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-04-27 12:58:25,507 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 12:59:03,911 - INFO - modeling - --- Unseen Task Generalization Result (pattern_id=1, Group=g1, Task=cr) ---
2021-04-27 12:59:03,912 - INFO - modeling - eval_results: {'acc': 0.907}
2021-04-27 13:58:38,529 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=21000, pet_max_meta_steps=36000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-27 13:58:38,549 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=train)
2021-04-27 13:59:01,467 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=21000, pet_max_meta_steps=36000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-27 13:59:01,467 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=train)
2021-04-27 13:59:13,944 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-27 13:59:13,944 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=dev)
2021-04-27 13:59:18,012 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-27 13:59:18,013 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-27 13:59:18,013 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-27 13:59:18,013 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-27 13:59:18,013 - INFO - run_task_adaptation - task=MNLI
2021-04-27 13:59:18,013 - INFO - run_task_adaptation - label=contradiction
2021-04-27 13:59:18,013 - INFO - run_task_adaptation - **********************************
2021-04-27 13:59:20,653 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-27 13:59:43,258 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-27 13:59:43,259 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 13:59:52,551 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 14:00:00,992 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-27 14:00:09,270 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-27 14:00:17,623 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-27 14:00:25,689 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-27 14:00:37,056 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-27 14:00:45,005 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-27 14:00:53,044 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-27 14:01:00,984 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-27 14:01:08,931 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-27 14:01:16,862 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-27 14:01:24,111 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-27 14:01:31,639 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-27 14:01:43,411 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-27 14:01:50,566 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-27 14:01:57,755 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-27 14:02:04,996 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-27 14:02:12,218 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-27 14:02:19,471 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-27 14:02:26,625 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-27 14:02:33,863 - INFO - transprompt_wrapper2 - Writing example 210000
2021-04-27 14:02:41,100 - INFO - transprompt_wrapper2 - Writing example 220000
2021-04-27 14:02:48,252 - INFO - transprompt_wrapper2 - Writing example 230000
2021-04-27 14:02:55,414 - INFO - transprompt_wrapper2 - Writing example 240000
2021-04-27 14:03:09,074 - INFO - transprompt_wrapper2 - Writing example 250000
2021-04-27 14:03:16,609 - INFO - transprompt_wrapper2 - Writing example 260000
2021-04-27 14:03:24,122 - INFO - transprompt_wrapper2 - Writing example 270000
2021-04-27 14:03:31,737 - INFO - transprompt_wrapper2 - Writing example 280000
2021-04-27 14:03:39,347 - INFO - transprompt_wrapper2 - Writing example 290000
2021-04-27 14:03:46,967 - INFO - transprompt_wrapper2 - Writing example 300000
2021-04-27 14:03:54,571 - INFO - transprompt_wrapper2 - Writing example 310000
2021-04-27 14:04:02,077 - INFO - transprompt_wrapper2 - Writing example 320000
2021-04-27 14:04:09,567 - INFO - transprompt_wrapper2 - Writing example 330000
2021-04-27 14:04:17,095 - INFO - transprompt_wrapper2 - Writing example 340000
2021-04-27 14:04:24,696 - INFO - transprompt_wrapper2 - Writing example 350000
2021-04-27 14:04:32,042 - INFO - transprompt_wrapper2 - Writing example 360000
2021-04-27 14:04:46,653 - INFO - transprompt_wrapper2 - Writing example 370000
2021-04-27 14:04:53,677 - INFO - transprompt_wrapper2 - Writing example 380000
2021-04-27 14:05:00,637 - INFO - transprompt_wrapper2 - Writing example 390000
2021-04-27 14:05:07,553 - INFO - transprompt_wrapper2 - Writing example 400000
2021-04-27 14:05:14,595 - INFO - transprompt_wrapper2 - Writing example 410000
2021-04-27 14:05:21,467 - INFO - transprompt_wrapper2 - Writing example 420000
2021-04-27 14:05:28,333 - INFO - transprompt_wrapper2 - Writing example 430000
2021-04-27 14:05:35,192 - INFO - transprompt_wrapper2 - Writing example 440000
2021-04-27 14:05:42,203 - INFO - transprompt_wrapper2 - Writing example 450000
2021-04-27 14:05:49,100 - INFO - transprompt_wrapper2 - Writing example 460000
2021-04-27 14:05:56,084 - INFO - transprompt_wrapper2 - Writing example 470000
2021-04-27 14:06:03,120 - INFO - transprompt_wrapper2 - Writing example 480000
2021-04-27 14:06:10,053 - INFO - transprompt_wrapper2 - Writing example 490000
2021-04-27 14:06:17,494 - INFO - transprompt_wrapper2 - Writing example 500000
2021-04-27 14:06:24,987 - INFO - transprompt_wrapper2 - Writing example 510000
2021-04-27 14:06:32,472 - INFO - transprompt_wrapper2 - Writing example 520000
2021-04-27 14:06:49,308 - INFO - transprompt_wrapper2 - Writing example 530000
2021-04-27 14:06:56,854 - INFO - transprompt_wrapper2 - Writing example 540000
2021-04-27 14:07:04,397 - INFO - transprompt_wrapper2 - Writing example 550000
2021-04-27 14:07:11,986 - INFO - transprompt_wrapper2 - Writing example 560000
2021-04-27 14:07:19,539 - INFO - transprompt_wrapper2 - Writing example 570000
2021-04-27 14:07:27,091 - INFO - transprompt_wrapper2 - Writing example 580000
2021-04-27 14:07:34,666 - INFO - transprompt_wrapper2 - Writing example 590000
2021-04-27 14:07:42,192 - INFO - transprompt_wrapper2 - Writing example 600000
2021-04-27 14:07:49,430 - INFO - transprompt_wrapper2 - Writing example 610000
2021-04-27 14:07:56,506 - INFO - transprompt_wrapper2 - Writing example 620000
2021-04-27 14:08:03,505 - INFO - transprompt_wrapper2 - Writing example 630000
2021-04-27 14:08:10,488 - INFO - transprompt_wrapper2 - Writing example 640000
2021-04-27 14:08:17,653 - INFO - transprompt_wrapper2 - Writing example 650000
2021-04-27 14:08:24,980 - INFO - transprompt_wrapper2 - Writing example 660000
2021-04-27 14:08:32,130 - INFO - transprompt_wrapper2 - Writing example 670000
2021-04-27 14:08:39,340 - INFO - transprompt_wrapper2 - Writing example 680000
2021-04-27 14:08:46,500 - INFO - transprompt_wrapper2 - Writing example 690000
2021-04-27 14:08:53,640 - INFO - transprompt_wrapper2 - Writing example 700000
2021-04-27 14:09:00,815 - INFO - transprompt_wrapper2 - Writing example 710000
2021-04-27 14:09:20,850 - INFO - transprompt_wrapper2 - Writing example 720000
2021-04-27 14:09:27,855 - INFO - transprompt_wrapper2 - Writing example 730000
2021-04-27 16:45:09,008 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 16:45:16,862 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 16:45:24,604 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-27 16:45:31,733 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-27 16:45:38,903 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-27 16:45:46,159 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-27 16:45:53,531 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-27 16:46:00,932 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-27 16:46:08,662 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-27 16:46:16,083 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-27 16:46:23,039 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-27 16:46:29,950 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-27 16:46:36,923 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-27 16:46:43,862 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-27 16:46:51,064 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-27 16:46:58,667 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-27 16:47:05,914 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-27 16:47:12,880 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-27 16:47:19,914 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-27 16:47:26,936 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-27 16:47:33,901 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-27 17:18:12,252 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-27 17:18:12,252 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3324 | best_global_step: 2500
2021-04-27 17:18:12,252 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 18:39:25,892 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 18:39:36,255 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 18:39:44,037 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-27 18:39:51,179 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-27 18:39:58,341 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-27 18:40:05,417 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-27 18:40:12,933 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-27 18:40:20,098 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-27 18:40:30,477 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-27 18:40:37,830 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-27 18:40:44,770 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-27 18:40:51,888 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-27 18:40:58,817 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-27 18:41:05,771 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-27 18:41:13,009 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-27 18:41:20,560 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-27 18:41:27,941 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-27 18:41:38,927 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-27 18:41:45,900 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-27 18:41:52,922 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-27 18:41:59,952 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-27 19:11:21,230 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-27 19:11:21,230 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3324 | best_global_step: 5000
2021-04-27 19:11:21,230 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 20:28:24,411 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 20:28:32,019 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 20:28:39,652 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-27 20:28:46,923 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-27 20:28:53,866 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-27 20:29:00,847 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-27 20:29:10,308 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-27 20:29:17,392 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-27 20:29:24,973 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-27 20:29:32,348 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-27 20:29:39,269 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-27 20:29:46,207 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-27 20:29:53,173 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-27 20:30:00,116 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-27 20:30:07,355 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-27 20:30:18,693 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-27 20:30:25,978 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-27 20:30:32,975 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-27 20:30:39,982 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-27 20:30:47,029 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-27 20:30:54,248 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-27 21:00:15,725 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-27 21:00:15,725 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3324 | best_global_step: 7500
2021-04-27 21:00:15,725 - INFO - transprompt_wrapper2 - Saving models.
2021-04-27 22:17:29,375 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-27 22:17:36,888 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-27 22:17:44,506 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-27 22:17:51,590 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-27 22:18:00,941 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-27 22:18:07,884 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-27 22:18:14,860 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-27 22:18:21,961 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-27 22:18:29,464 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-27 22:18:36,817 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-27 22:18:43,818 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-27 22:18:53,830 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-27 22:19:00,745 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-27 22:19:07,644 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-27 22:19:14,889 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-27 22:19:22,521 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-27 22:19:29,915 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-27 22:19:36,888 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-27 22:19:43,945 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-27 22:19:50,975 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-27 22:20:02,642 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-27 22:49:31,276 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-27 22:49:31,277 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3324 | best_global_step: 10000
2021-04-27 22:49:31,277 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 01:50:43,071 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 01:50:51,027 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 01:50:58,615 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 01:51:05,933 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 01:51:13,004 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 01:51:20,048 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 01:51:27,063 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 01:51:34,274 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 01:51:42,108 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 01:51:49,468 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 01:51:56,432 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 01:52:06,852 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 01:52:13,888 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 01:52:20,855 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 01:52:28,117 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 01:52:35,729 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 01:52:43,927 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 01:52:51,473 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 01:52:59,259 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 01:53:07,350 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 01:53:19,295 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 02:10:08,224 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 02:10:08,224 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3335 | best_global_step: 12500
2021-04-28 02:10:08,224 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 03:14:31,418 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 03:14:39,464 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 03:14:47,161 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 03:14:54,278 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 03:15:01,408 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 03:15:08,706 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 03:15:15,929 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 03:15:23,174 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 03:15:30,867 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 03:15:38,388 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 03:15:48,540 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 03:15:55,661 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 03:16:02,778 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 03:16:09,892 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 03:16:17,375 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 03:16:25,131 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 03:16:32,604 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 03:16:39,792 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 03:16:47,119 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 03:16:58,612 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 03:17:05,790 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 03:44:41,128 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 03:44:41,128 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3335 | best_global_step: 15000
2021-04-28 03:44:41,128 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 04:58:23,864 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 04:58:31,725 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 04:58:39,248 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 04:58:46,222 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 04:58:53,139 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 04:59:00,071 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 04:59:07,204 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 04:59:14,251 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 04:59:21,700 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 04:59:31,787 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 04:59:38,886 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 04:59:45,780 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 04:59:52,699 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 04:59:59,565 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 05:00:06,734 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 05:00:14,330 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 05:00:21,589 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 05:00:28,551 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 05:00:39,567 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 05:00:46,506 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 05:00:53,474 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 05:28:56,195 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 05:28:56,195 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3335 | best_global_step: 17500
2021-04-28 05:28:56,195 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 06:46:23,593 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 06:46:31,147 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 06:46:38,463 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 06:46:45,319 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 06:46:52,437 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 06:46:59,330 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 06:47:06,184 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 06:47:15,615 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 06:47:23,272 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 06:47:30,683 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 06:47:37,538 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 06:47:44,439 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 06:47:51,297 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 06:47:58,208 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 06:48:05,342 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 06:48:12,883 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 06:48:23,891 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 06:48:30,807 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 06:48:37,718 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 06:48:44,638 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 06:48:51,543 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 07:17:40,511 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 07:17:40,511 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3335 | best_global_step: 20000
2021-04-28 07:17:40,511 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 08:27:56,589 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 08:28:04,152 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 08:28:11,534 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 08:28:18,630 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 08:28:25,505 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 08:28:34,594 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 08:28:41,454 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 08:28:48,485 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 08:28:55,969 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 08:29:03,191 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 08:29:10,002 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 08:29:16,811 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 08:29:23,750 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 08:29:33,847 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 08:29:40,930 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 08:29:48,335 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 08:29:55,606 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 08:30:02,711 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 08:30:09,591 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 08:30:16,476 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 08:30:23,376 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 08:55:19,931 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 08:55:19,932 - INFO - transprompt_wrapper2 - best_dev_acc: 0.3335 | best_global_step: 22500
2021-04-28 08:55:19,932 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 11:46:13,384 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 11:46:22,651 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 11:46:30,313 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 11:46:37,220 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 11:46:44,094 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 11:46:51,162 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 11:46:58,039 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 11:47:05,442 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 11:47:15,493 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 11:47:22,855 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 11:47:29,857 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 11:47:36,729 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 11:47:43,917 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 11:47:50,775 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 11:47:57,931 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 11:48:05,443 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 11:48:16,468 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 11:48:23,500 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 11:48:30,463 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 11:48:37,398 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 11:48:44,316 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 12:17:38,932 - INFO - transprompt_wrapper2 - {'acc': 0.0862448323154187}
2021-04-28 12:17:38,962 - INFO - transprompt_wrapper2 - 5
2021-04-28 13:32:38,434 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 13:32:46,132 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 13:32:53,820 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 13:33:00,887 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 13:33:08,005 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 13:33:15,040 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 13:33:24,501 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 13:33:31,643 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 13:33:39,173 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 13:33:46,585 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 13:33:53,534 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 13:34:00,519 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 13:34:07,459 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 13:34:14,571 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 13:34:21,903 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 13:34:33,134 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 13:34:40,452 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 13:34:47,702 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 13:34:54,710 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 13:35:01,720 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 13:35:08,704 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 13:59:48,764 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=2500, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=21000, pet_max_meta_steps=36000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=64, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=500, weight_decay=0.1)
2021-04-28 13:59:48,764 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=train)
2021-04-28 14:00:00,403 - INFO - task_processors - Returning 739367 train examples with label dist.: [('contradiction', 246488), ('entailment', 246588), ('neutral', 246291)]
2021-04-28 14:00:00,403 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/full-21 (num_examples=-1, set_type=dev)
2021-04-28 14:00:03,166 - INFO - task_processors - Returning 202702 dev examples with label dist.: [('contradiction', 67602), ('entailment', 67727), ('neutral', 67373)]
2021-04-28 14:00:03,166 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-28 14:00:03,166 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-04-28 14:00:03,166 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-04-28 14:00:03,166 - INFO - run_task_adaptation - task=MNLI
2021-04-28 14:00:03,166 - INFO - run_task_adaptation - label=contradiction
2021-04-28 14:00:03,166 - INFO - run_task_adaptation - **********************************
2021-04-28 14:00:06,330 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-28 14:00:31,780 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-04-28 14:00:31,780 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 14:00:41,021 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 14:00:49,661 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 14:00:58,085 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 14:01:06,151 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 14:01:15,094 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 14:01:27,334 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 14:01:35,430 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 14:01:43,441 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 14:01:51,797 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 14:01:59,975 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 14:02:07,978 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 14:02:15,382 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 14:02:22,892 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 14:02:36,405 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 14:02:44,453 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 14:02:51,757 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 14:02:59,215 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 14:03:06,795 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 14:03:14,823 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 14:03:22,194 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 14:03:29,848 - INFO - transprompt_wrapper2 - Writing example 210000
2021-04-28 14:03:37,111 - INFO - transprompt_wrapper2 - Writing example 220000
2021-04-28 14:03:44,485 - INFO - transprompt_wrapper2 - Writing example 230000
2021-04-28 14:03:52,020 - INFO - transprompt_wrapper2 - Writing example 240000
2021-04-28 14:04:05,549 - INFO - transprompt_wrapper2 - Writing example 250000
2021-04-28 14:04:14,010 - INFO - transprompt_wrapper2 - Writing example 260000
2021-04-28 14:04:22,323 - INFO - transprompt_wrapper2 - Writing example 270000
2021-04-28 14:04:30,727 - INFO - transprompt_wrapper2 - Writing example 280000
2021-04-28 14:04:39,007 - INFO - transprompt_wrapper2 - Writing example 290000
2021-04-28 14:04:47,141 - INFO - transprompt_wrapper2 - Writing example 300000
2021-04-28 14:04:54,850 - INFO - transprompt_wrapper2 - Writing example 310000
2021-04-28 14:05:02,525 - INFO - transprompt_wrapper2 - Writing example 320000
2021-04-28 14:05:10,173 - INFO - transprompt_wrapper2 - Writing example 330000
2021-04-28 14:05:18,368 - INFO - transprompt_wrapper2 - Writing example 340000
2021-04-28 14:05:26,310 - INFO - transprompt_wrapper2 - Writing example 350000
2021-04-28 14:05:33,837 - INFO - transprompt_wrapper2 - Writing example 360000
2021-04-28 14:05:52,051 - INFO - transprompt_wrapper2 - Writing example 370000
2021-04-28 14:05:59,711 - INFO - transprompt_wrapper2 - Writing example 380000
2021-04-28 14:06:06,949 - INFO - transprompt_wrapper2 - Writing example 390000
2021-04-28 14:06:14,526 - INFO - transprompt_wrapper2 - Writing example 400000
2021-04-28 14:06:21,606 - INFO - transprompt_wrapper2 - Writing example 410000
2021-04-28 14:06:29,224 - INFO - transprompt_wrapper2 - Writing example 420000
2021-04-28 14:06:36,468 - INFO - transprompt_wrapper2 - Writing example 430000
2021-04-28 14:06:44,571 - INFO - transprompt_wrapper2 - Writing example 440000
2021-04-28 14:06:51,841 - INFO - transprompt_wrapper2 - Writing example 450000
2021-04-28 14:06:58,989 - INFO - transprompt_wrapper2 - Writing example 460000
2021-04-28 14:07:06,172 - INFO - transprompt_wrapper2 - Writing example 470000
2021-04-28 14:07:13,205 - INFO - transprompt_wrapper2 - Writing example 480000
2021-04-28 14:07:20,647 - INFO - transprompt_wrapper2 - Writing example 490000
2021-04-28 14:07:28,421 - INFO - transprompt_wrapper2 - Writing example 500000
2021-04-28 14:07:36,675 - INFO - transprompt_wrapper2 - Writing example 510000
2021-04-28 14:07:44,685 - INFO - transprompt_wrapper2 - Writing example 520000
2021-04-28 14:08:04,912 - INFO - transprompt_wrapper2 - Writing example 530000
2021-04-28 14:08:13,009 - INFO - transprompt_wrapper2 - Writing example 540000
2021-04-28 14:08:20,717 - INFO - transprompt_wrapper2 - Writing example 550000
2021-04-28 14:08:28,381 - INFO - transprompt_wrapper2 - Writing example 560000
2021-04-28 14:08:36,102 - INFO - transprompt_wrapper2 - Writing example 570000
2021-04-28 14:08:43,925 - INFO - transprompt_wrapper2 - Writing example 580000
2021-04-28 14:08:52,059 - INFO - transprompt_wrapper2 - Writing example 590000
2021-04-28 14:08:59,680 - INFO - transprompt_wrapper2 - Writing example 600000
2021-04-28 14:09:07,052 - INFO - transprompt_wrapper2 - Writing example 610000
2021-04-28 14:09:14,550 - INFO - transprompt_wrapper2 - Writing example 620000
2021-04-28 14:09:22,052 - INFO - transprompt_wrapper2 - Writing example 630000
2021-04-28 14:09:30,014 - INFO - transprompt_wrapper2 - Writing example 640000
2021-04-28 14:09:37,798 - INFO - transprompt_wrapper2 - Writing example 650000
2021-04-28 14:09:45,141 - INFO - transprompt_wrapper2 - Writing example 660000
2021-04-28 14:09:52,474 - INFO - transprompt_wrapper2 - Writing example 670000
2021-04-28 14:09:59,931 - INFO - transprompt_wrapper2 - Writing example 680000
2021-04-28 14:10:07,276 - INFO - transprompt_wrapper2 - Writing example 690000
2021-04-28 14:10:14,723 - INFO - transprompt_wrapper2 - Writing example 700000
2021-04-28 14:10:22,242 - INFO - transprompt_wrapper2 - Writing example 710000
2021-04-28 14:10:46,002 - INFO - transprompt_wrapper2 - Writing example 720000
2021-04-28 14:10:53,292 - INFO - transprompt_wrapper2 - Writing example 730000
2021-04-28 15:35:46,405 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-28 15:35:46,405 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-28 15:35:46,479 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-28 15:35:46,479 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-28 15:35:46,482 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-28 15:35:46,482 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-28 15:35:46,482 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-28 15:35:46,482 - INFO - run_task_adaptation - text_b=None
2021-04-28 15:35:46,483 - INFO - run_task_adaptation - task=SST-2
2021-04-28 15:35:46,483 - INFO - run_task_adaptation - label=0
2021-04-28 15:35:46,483 - INFO - run_task_adaptation - **********************************
2021-04-28 15:35:49,094 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-28 15:36:35,969 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-28 15:36:36,152 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-28 15:37:36,638 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-28 15:37:36,639 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-28 15:37:36,639 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-28 15:37:36,639 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 15:38:21,278 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 15:38:22,513 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-28 15:38:22,513 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-28 15:38:22,514 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 15:40:50,872 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-28 15:40:50,872 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-28 15:40:50,875 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-28 15:40:50,875 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-28 15:40:50,877 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-28 15:40:50,877 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-28 15:40:50,877 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-28 15:40:50,877 - INFO - run_task_adaptation - text_b=None
2021-04-28 15:40:50,877 - INFO - run_task_adaptation - task=SST-2
2021-04-28 15:40:50,877 - INFO - run_task_adaptation - label=0
2021-04-28 15:40:50,878 - INFO - run_task_adaptation - **********************************
2021-04-28 15:40:53,440 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-28 15:41:33,417 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-28 15:41:33,518 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-28 15:42:23,939 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-28 15:42:23,939 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-28 15:42:23,940 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-28 15:42:23,940 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 15:43:09,240 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 15:43:10,626 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-28 15:43:10,627 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-04-28 15:43:10,627 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 15:44:17,873 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 15:44:19,035 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-04-28 15:44:19,036 - INFO - transprompt_wrapper2 - 1
2021-04-28 15:45:02,325 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 15:45:03,564 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-28 15:45:03,564 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-04-28 15:45:03,564 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 15:46:06,049 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 15:46:07,780 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-04-28 15:46:07,781 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 400
2021-04-28 15:46:07,781 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 15:48:22,220 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-42', dev32_examples=-1, do_eval=True, do_train=False, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-04-28 15:48:22,220 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=train)
2021-04-28 15:48:22,224 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-04-28 15:48:22,224 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-42 (num_examples=-1, set_type=dev)
2021-04-28 15:48:22,226 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-04-28 15:48:22,226 - INFO - run_task_adaptation - ************Training Example:**************
2021-04-28 15:48:22,226 - INFO - run_task_adaptation - text_a=unfortunately , carvey 's rubber-face routine is no match for the insipid script he has crafted with harris goldberg .
2021-04-28 15:48:22,226 - INFO - run_task_adaptation - text_b=None
2021-04-28 15:48:22,227 - INFO - run_task_adaptation - task=SST-2
2021-04-28 15:48:22,227 - INFO - run_task_adaptation - label=0
2021-04-28 15:48:22,227 - INFO - run_task_adaptation - **********************************
2021-04-28 15:48:24,863 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-28 15:49:03,464 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-28 15:49:03,607 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-28 15:49:50,510 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-28 15:49:50,511 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-28 15:49:50,511 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-04-28 15:49:50,511 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 16:47:57,629 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 16:48:05,984 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 16:48:14,066 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 16:48:21,713 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 16:48:28,974 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 16:48:36,979 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 16:48:44,406 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 16:48:52,461 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 16:49:00,249 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 16:49:08,526 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 16:49:15,548 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 16:49:23,051 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 16:49:30,490 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 16:49:37,661 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 16:49:44,962 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 16:49:53,591 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 16:50:01,159 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 16:50:08,799 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 16:50:15,960 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 16:50:23,467 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 16:50:30,679 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 17:05:58,632 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 17:05:58,632 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8379 | best_global_step: 2500
2021-04-28 17:05:58,632 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 17:49:48,902 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 17:49:58,849 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 17:50:06,568 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 17:50:13,531 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 17:50:21,283 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 17:50:28,412 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 17:50:35,669 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 17:50:43,507 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 17:50:55,009 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 17:51:02,883 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 17:51:09,990 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 17:51:17,055 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 17:51:24,444 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 17:51:31,779 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 17:51:39,837 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 17:51:47,953 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 17:51:55,703 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 17:52:07,327 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 17:52:14,494 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 17:52:21,638 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 17:52:29,071 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 18:07:56,894 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 18:07:56,894 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8499 | best_global_step: 5000
2021-04-28 18:07:56,894 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 18:52:14,222 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 18:52:21,960 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 18:52:30,377 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 18:52:37,432 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 18:52:44,580 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 18:52:51,566 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 18:53:01,201 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 18:53:08,319 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 18:53:15,882 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 18:53:23,384 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 18:53:30,409 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 18:53:37,501 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 18:53:44,460 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 18:53:51,473 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 18:54:03,435 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 18:54:11,210 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 18:54:18,582 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 18:54:25,987 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 18:54:33,311 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 18:54:40,571 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 18:54:47,656 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 19:10:16,400 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 19:10:16,400 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8620 | best_global_step: 7500
2021-04-28 19:10:16,400 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 19:56:27,245 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 19:56:35,242 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 19:56:43,246 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 19:56:52,587 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 19:57:00,129 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 19:57:07,337 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 19:57:14,421 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 19:57:21,699 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 19:57:29,241 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 19:57:37,088 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 19:57:44,117 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 19:57:54,283 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 19:58:01,165 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 19:58:08,285 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 19:58:16,211 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 19:58:23,767 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 19:58:30,999 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 19:58:37,969 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 19:58:44,915 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 19:58:51,884 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 19:59:03,252 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 20:14:18,501 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 20:14:18,501 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8686 | best_global_step: 10000
2021-04-28 20:14:18,501 - INFO - transprompt_wrapper2 - Saving models.
2021-04-28 21:59:10,305 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 21:59:17,885 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 21:59:25,225 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 21:59:32,139 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 21:59:39,000 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 21:59:45,876 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 21:59:52,760 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 21:59:59,739 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 22:00:07,108 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 22:00:14,351 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 22:00:24,131 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 22:00:30,980 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 22:00:37,871 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 22:00:44,719 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 22:00:51,846 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 22:00:59,280 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 22:01:06,480 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 22:01:13,417 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 22:01:20,340 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 22:01:31,451 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 22:01:38,407 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 22:16:56,308 - INFO - transprompt_wrapper2 - {'acc': 0.8672435397776046}
2021-04-28 22:16:56,308 - INFO - transprompt_wrapper2 - 1
2021-04-28 23:03:42,653 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-28 23:03:50,256 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-28 23:03:57,620 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-28 23:04:04,526 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-28 23:04:11,379 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-28 23:04:18,257 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-28 23:04:25,104 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-28 23:04:32,087 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-28 23:04:39,464 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-28 23:04:46,697 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-28 23:04:56,447 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-28 23:05:03,347 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-28 23:05:10,218 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-28 23:05:17,098 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-28 23:05:24,251 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-28 23:05:31,707 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-28 23:05:38,940 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-28 23:05:45,895 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-28 23:05:52,850 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-28 23:06:03,980 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-28 23:06:10,953 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-28 23:21:26,085 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-28 23:21:26,086 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8695 | best_global_step: 15000
2021-04-28 23:21:26,086 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 00:08:38,057 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 00:08:45,634 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 00:08:52,960 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 00:08:59,847 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 00:09:06,730 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 00:09:13,586 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 00:09:20,462 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 00:09:27,441 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 00:09:34,789 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 00:09:44,751 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 00:09:51,612 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 00:09:58,460 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 00:10:05,305 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 00:10:12,164 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 00:10:19,296 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 00:10:26,719 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 00:10:33,886 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 00:10:44,745 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 00:10:51,658 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 00:10:58,559 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 00:11:05,464 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 00:26:20,897 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-29 00:26:20,897 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8713 | best_global_step: 17500
2021-04-29 00:26:20,897 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 01:13:35,022 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 01:13:42,570 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 01:13:49,959 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 01:13:57,193 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 01:14:04,126 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 01:14:11,034 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 01:14:17,967 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 01:14:27,511 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 01:14:34,991 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 01:14:42,330 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 01:14:49,275 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 01:14:56,242 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 01:15:03,644 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 01:15:10,769 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 01:15:18,386 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 01:15:29,601 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 01:15:36,860 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 01:15:43,884 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 01:15:50,886 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 01:15:57,860 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 01:16:04,887 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 01:31:19,378 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-29 01:31:19,378 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8730 | best_global_step: 20000
2021-04-29 01:31:19,378 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 02:15:27,078 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 02:15:35,190 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 02:15:43,476 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 02:15:50,676 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 02:15:58,872 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 02:16:09,534 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 02:16:16,566 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 02:16:24,266 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 02:16:33,133 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 02:16:41,549 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 02:16:49,604 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 02:16:56,642 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 02:17:07,517 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 02:17:15,160 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 02:17:22,853 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 02:17:31,810 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 02:17:39,918 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 02:17:47,776 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 02:17:55,912 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 02:18:04,126 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 02:18:11,532 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 02:33:41,802 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-29 02:33:41,803 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8755 | best_global_step: 22500
2021-04-29 02:33:41,803 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 04:16:43,840 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 04:16:53,109 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 04:17:00,572 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 04:17:07,995 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 04:17:15,570 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 04:17:22,682 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 04:17:29,642 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 04:17:39,253 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 04:17:46,724 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 04:17:54,345 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 04:18:01,792 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 04:18:09,912 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 04:18:17,263 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 04:18:25,404 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 04:18:33,652 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 04:18:45,487 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 04:18:54,187 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 04:19:02,498 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 04:19:11,180 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 04:19:18,625 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 04:19:25,710 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 04:34:55,949 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-29 04:34:55,949 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8761 | best_global_step: 25000
2021-04-29 04:34:55,949 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 05:18:58,633 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 05:19:07,310 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 05:19:14,902 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 05:19:22,184 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 05:19:29,515 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 05:19:39,827 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 05:19:47,016 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 05:19:55,424 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 05:20:04,302 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 05:20:12,725 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 05:20:20,188 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 05:20:27,204 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 05:20:38,265 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 05:20:46,283 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 05:20:54,404 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 05:21:02,915 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 05:21:10,573 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 05:21:17,863 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 05:21:25,079 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 05:21:32,926 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 05:21:40,567 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 05:37:15,348 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-29 05:37:15,348 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8765 | best_global_step: 27500
2021-04-29 05:37:15,348 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 06:21:14,449 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 06:21:25,051 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 06:21:33,712 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 06:21:41,284 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 06:21:48,931 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 06:21:56,554 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 06:22:04,621 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 06:22:11,895 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 06:22:23,671 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 06:22:32,142 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 06:22:39,668 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 06:22:46,857 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 06:22:54,429 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 06:23:02,095 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 06:23:10,551 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 06:23:18,249 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 06:23:31,087 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 06:23:38,991 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 06:23:46,383 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 06:23:54,098 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 06:24:01,704 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 06:39:33,311 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-29 06:39:33,312 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8774 | best_global_step: 30000
2021-04-29 06:39:33,312 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 07:23:40,829 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 07:23:49,902 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 07:23:58,854 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 07:24:06,286 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 07:24:14,957 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 07:24:25,671 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 07:24:34,106 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 07:24:41,909 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 07:24:50,245 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 07:24:58,792 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 07:25:06,468 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 07:25:14,037 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 07:25:21,734 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 07:25:32,446 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 07:25:40,407 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 07:25:48,464 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 07:25:56,505 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 07:26:03,809 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 07:26:10,738 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 07:26:17,942 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 07:26:25,298 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 07:41:53,879 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-29 07:41:53,879 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8775 | best_global_step: 32500
2021-04-29 07:41:53,879 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 09:24:26,147 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 09:24:33,943 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 09:24:43,187 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 09:24:50,249 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 09:24:57,300 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 09:25:04,545 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 09:25:11,594 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 09:25:18,812 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 09:25:26,330 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 09:25:36,544 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 09:25:43,509 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 09:25:50,446 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 09:25:57,394 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 09:26:04,397 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 09:26:11,680 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 09:26:19,275 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 09:26:26,573 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 09:26:37,665 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 09:26:44,715 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 09:26:51,736 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 09:26:58,731 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 09:42:14,634 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2...
2021-04-29 09:42:14,635 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8781 | best_global_step: 35000
2021-04-29 09:42:14,635 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 10:00:12,397 - INFO - modeling - Saving complete
2021-04-29 10:00:12,398 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-04-29 10:00:12,398 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-04-29 10:00:12,524 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-29 10:00:33,061 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-04-29 10:00:33,477 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-04-29 10:00:33,588 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-04-29 10:00:33,588 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 10:00:42,409 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 10:00:50,535 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 10:00:58,447 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 10:01:06,568 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 10:01:14,404 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 10:01:22,325 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 10:01:32,896 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 10:01:41,019 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 10:01:48,931 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 10:01:56,916 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 10:02:04,917 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 10:02:12,506 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 10:02:20,132 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 10:02:27,790 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 10:02:39,308 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 10:02:46,858 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 10:02:54,458 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 10:03:02,108 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 10:03:09,789 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 10:03:17,439 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 10:03:25,094 - INFO - transprompt_wrapper2 - Writing example 210000
2021-04-29 10:03:32,744 - INFO - transprompt_wrapper2 - Writing example 220000
2021-04-29 10:03:40,508 - INFO - transprompt_wrapper2 - Writing example 230000
2021-04-29 10:03:48,202 - INFO - transprompt_wrapper2 - Writing example 240000
2021-04-29 10:03:55,806 - INFO - transprompt_wrapper2 - Writing example 250000
2021-04-29 10:04:08,798 - INFO - transprompt_wrapper2 - Writing example 260000
2021-04-29 10:04:16,663 - INFO - transprompt_wrapper2 - Writing example 270000
2021-04-29 10:04:24,301 - INFO - transprompt_wrapper2 - Writing example 280000
2021-04-29 10:04:31,968 - INFO - transprompt_wrapper2 - Writing example 290000
2021-04-29 10:04:39,615 - INFO - transprompt_wrapper2 - Writing example 300000
2021-04-29 10:04:47,287 - INFO - transprompt_wrapper2 - Writing example 310000
2021-04-29 10:04:54,935 - INFO - transprompt_wrapper2 - Writing example 320000
2021-04-29 10:05:02,556 - INFO - transprompt_wrapper2 - Writing example 330000
2021-04-29 11:16:16,424 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 11:16:24,152 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 11:16:31,833 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 11:16:39,369 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 11:16:46,883 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 11:16:56,688 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 11:21:27,278 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-29 11:21:27,278 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8567 | best_global_step: 2500
2021-04-29 11:21:27,278 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 12:07:39,264 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 12:07:46,863 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 12:07:54,317 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 12:08:01,836 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 12:08:09,255 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 12:08:16,681 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 12:12:49,769 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-29 12:12:49,770 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8572 | best_global_step: 5000
2021-04-29 12:12:49,770 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 13:24:37,527 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 13:24:44,934 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 13:24:52,344 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 13:24:59,742 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 13:25:07,165 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 13:25:14,591 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 13:29:45,437 - INFO - transprompt_wrapper2 - {'acc': 0.8516619699181747}
2021-04-29 13:29:45,438 - INFO - transprompt_wrapper2 - 1
2021-04-29 14:15:23,423 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 14:15:32,507 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 14:15:39,900 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 14:15:47,360 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 14:15:54,844 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 14:16:02,324 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 14:20:32,591 - INFO - transprompt_wrapper2 - {'acc': 0.8537500424404985}
2021-04-29 14:20:32,591 - INFO - transprompt_wrapper2 - 2
2021-04-29 15:32:38,294 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 15:32:46,256 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 15:32:55,461 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 15:33:02,855 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 15:33:10,282 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 15:33:18,037 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 15:37:48,699 - INFO - transprompt_wrapper2 - {'acc': 0.8554306861779785}
2021-04-29 15:37:48,699 - INFO - transprompt_wrapper2 - 3
2021-04-29 16:23:49,015 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 16:23:56,609 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 16:24:04,037 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 16:24:13,473 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 16:24:20,954 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 16:24:28,375 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 16:28:59,580 - INFO - transprompt_wrapper2 - {'acc': 0.8560757817539809}
2021-04-29 16:28:59,581 - INFO - transprompt_wrapper2 - 4
2021-04-29 17:40:44,118 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 17:40:51,710 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 17:40:59,083 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 17:41:06,500 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 17:41:15,991 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 17:41:23,469 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 17:45:54,907 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-29 17:45:54,907 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8615 | best_global_step: 17500
2021-04-29 17:45:54,907 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 18:31:58,789 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 18:32:06,405 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 18:32:13,766 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 18:32:21,116 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 18:32:28,523 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 18:32:38,255 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 18:37:08,607 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/mnli...
2021-04-29 18:37:08,607 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8617 | best_global_step: 20000
2021-04-29 18:37:08,607 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 19:21:48,716 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-29 19:22:09,147 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-04-29 19:22:09,147 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-04-29 19:22:09,355 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-04-29 19:22:09,356 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-04-29 19:22:09,356 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 19:22:18,009 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 19:23:53,209 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-04-29 19:23:53,209 - INFO - modeling - eval_results: {'acc': 0.8612001832340815}
2021-04-29 19:23:53,210 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-04-29 19:23:53,211 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 19:24:00,184 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 19:24:07,134 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 19:24:16,085 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 19:24:23,052 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 19:24:30,004 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 19:24:36,981 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 19:24:43,923 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 19:24:50,909 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 19:24:57,876 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 19:25:07,768 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 19:25:14,717 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 19:25:21,721 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 19:25:28,679 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 19:25:35,592 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 19:25:42,433 - INFO - transprompt_wrapper2 - Writing example 150000
2021-04-29 19:25:49,278 - INFO - transprompt_wrapper2 - Writing example 160000
2021-04-29 19:25:56,182 - INFO - transprompt_wrapper2 - Writing example 170000
2021-04-29 19:26:03,055 - INFO - transprompt_wrapper2 - Writing example 180000
2021-04-29 19:26:14,195 - INFO - transprompt_wrapper2 - Writing example 190000
2021-04-29 19:26:21,050 - INFO - transprompt_wrapper2 - Writing example 200000
2021-04-29 19:26:27,925 - INFO - transprompt_wrapper2 - Writing example 210000
2021-04-29 19:26:34,825 - INFO - transprompt_wrapper2 - Writing example 220000
2021-04-29 19:26:41,663 - INFO - transprompt_wrapper2 - Writing example 230000
2021-04-29 19:26:48,498 - INFO - transprompt_wrapper2 - Writing example 240000
2021-04-29 19:26:55,379 - INFO - transprompt_wrapper2 - Writing example 250000
2021-04-29 19:27:02,302 - INFO - transprompt_wrapper2 - Writing example 260000
2021-04-29 19:27:09,156 - INFO - transprompt_wrapper2 - Writing example 270000
2021-04-29 19:27:16,092 - INFO - transprompt_wrapper2 - Writing example 280000
2021-04-29 19:27:23,015 - INFO - transprompt_wrapper2 - Writing example 290000
2021-04-29 19:27:30,001 - INFO - transprompt_wrapper2 - Writing example 300000
2021-04-29 19:27:42,903 - INFO - transprompt_wrapper2 - Writing example 310000
2021-04-29 19:27:49,829 - INFO - transprompt_wrapper2 - Writing example 320000
2021-04-29 19:27:56,760 - INFO - transprompt_wrapper2 - Writing example 330000
2021-04-29 19:28:03,747 - INFO - transprompt_wrapper2 - Writing example 340000
2021-04-29 19:28:10,754 - INFO - transprompt_wrapper2 - Writing example 350000
2021-04-29 19:28:17,757 - INFO - transprompt_wrapper2 - Writing example 360000
2021-04-29 19:28:24,701 - INFO - transprompt_wrapper2 - Writing example 370000
2021-04-29 19:28:31,643 - INFO - transprompt_wrapper2 - Writing example 380000
2021-04-29 19:28:38,632 - INFO - transprompt_wrapper2 - Writing example 390000
2021-04-29 19:28:45,560 - INFO - transprompt_wrapper2 - Writing example 400000
2021-04-29 20:46:30,386 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 20:46:37,629 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 20:46:44,737 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 20:46:51,709 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 20:47:00,815 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 20:47:07,794 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 20:47:14,785 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 20:47:21,756 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 20:47:28,696 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 20:47:35,693 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 20:47:42,791 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 20:47:49,903 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 20:48:00,260 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 20:48:07,326 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 20:48:14,448 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 20:59:05,352 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-29 20:59:05,353 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8857 | best_global_step: 2500
2021-04-29 20:59:05,353 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 21:44:17,671 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 21:44:24,745 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 21:44:31,865 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 21:44:38,834 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 21:44:45,777 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 21:44:52,651 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 21:45:01,953 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 21:45:08,988 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 21:45:15,850 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 21:45:22,718 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 21:45:29,616 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 21:45:36,877 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 21:45:43,981 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 21:45:50,997 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 21:45:57,938 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 21:56:51,911 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-29 21:56:51,912 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8865 | best_global_step: 5000
2021-04-29 21:56:51,912 - INFO - transprompt_wrapper2 - Saving models.
2021-04-29 23:13:57,930 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-29 23:14:04,985 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-29 23:14:11,846 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-29 23:14:18,735 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-29 23:14:25,749 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-29 23:14:32,680 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-29 23:14:39,525 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-29 23:14:46,369 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-29 23:14:53,237 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-29 23:15:00,217 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-29 23:15:10,078 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-29 23:15:17,054 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-29 23:15:24,021 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-29 23:15:31,342 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-29 23:15:38,378 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-29 23:26:24,708 - INFO - transprompt_wrapper2 - {'acc': 0.877792149990264}
2021-04-29 23:26:24,709 - INFO - transprompt_wrapper2 - 1
2021-04-30 00:12:04,070 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-30 00:12:11,016 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-30 00:12:17,892 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-30 00:12:24,750 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-30 00:12:33,730 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-30 00:12:40,681 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-30 00:12:47,567 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-30 00:12:54,424 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-30 00:13:01,281 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-30 00:13:08,173 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-30 00:13:15,068 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-30 00:13:22,005 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-30 00:13:32,090 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-30 00:13:39,080 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-30 00:13:46,145 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-30 00:24:32,969 - INFO - transprompt_wrapper2 - {'acc': 0.8799479818631951}
2021-04-30 00:24:32,970 - INFO - transprompt_wrapper2 - 2
2021-04-30 01:09:33,108 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-30 01:09:40,441 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-30 01:09:47,339 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-30 01:09:54,240 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-30 01:10:01,335 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-30 01:10:09,063 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-30 01:10:19,033 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-30 01:10:25,951 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-30 01:10:32,961 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-30 01:10:40,001 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-30 01:10:46,975 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-30 01:10:53,934 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-30 01:11:01,211 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-30 01:11:08,209 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-30 01:11:15,385 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-30 01:22:18,567 - INFO - transprompt_wrapper2 - {'acc': 0.8822568082561406}
2021-04-30 01:22:18,568 - INFO - transprompt_wrapper2 - 3
2021-04-30 02:38:21,234 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-30 02:38:28,334 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-30 02:38:35,532 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-30 02:38:42,503 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-30 02:38:49,537 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-30 02:38:56,848 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-30 02:39:04,863 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-30 02:39:11,878 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-30 02:39:18,836 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-30 02:39:25,740 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-30 02:39:35,751 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-30 02:39:42,752 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-30 02:39:49,697 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-30 02:39:56,624 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-30 02:40:03,542 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-30 02:51:03,033 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-30 02:51:03,033 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8870 | best_global_step: 15000
2021-04-30 02:51:03,033 - INFO - transprompt_wrapper2 - Saving models.
2021-04-30 03:35:10,743 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-30 03:35:18,813 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-30 03:35:27,528 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-30 03:35:35,759 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-30 03:35:46,002 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-30 03:35:54,024 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-30 03:36:02,332 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-30 03:36:10,632 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-30 03:36:19,443 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-30 03:36:27,515 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-30 03:36:36,153 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-30 03:36:43,519 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-30 03:36:54,715 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-30 03:37:02,334 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-30 03:37:09,836 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-30 03:48:09,514 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-30 03:48:09,514 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8870 | best_global_step: 17500
2021-04-30 03:48:09,514 - INFO - transprompt_wrapper2 - Saving models.
2021-04-30 05:04:30,104 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-30 05:04:37,194 - INFO - transprompt_wrapper2 - Writing example 10000
2021-04-30 05:04:44,256 - INFO - transprompt_wrapper2 - Writing example 20000
2021-04-30 05:04:51,267 - INFO - transprompt_wrapper2 - Writing example 30000
2021-04-30 05:04:58,218 - INFO - transprompt_wrapper2 - Writing example 40000
2021-04-30 05:05:05,507 - INFO - transprompt_wrapper2 - Writing example 50000
2021-04-30 05:05:14,978 - INFO - transprompt_wrapper2 - Writing example 60000
2021-04-30 05:05:22,016 - INFO - transprompt_wrapper2 - Writing example 70000
2021-04-30 05:05:29,713 - INFO - transprompt_wrapper2 - Writing example 80000
2021-04-30 05:05:38,140 - INFO - transprompt_wrapper2 - Writing example 90000
2021-04-30 05:05:46,756 - INFO - transprompt_wrapper2 - Writing example 100000
2021-04-30 05:05:54,614 - INFO - transprompt_wrapper2 - Writing example 110000
2021-04-30 05:06:02,498 - INFO - transprompt_wrapper2 - Writing example 120000
2021-04-30 05:06:10,220 - INFO - transprompt_wrapper2 - Writing example 130000
2021-04-30 05:06:18,440 - INFO - transprompt_wrapper2 - Writing example 140000
2021-04-30 05:17:21,722 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g2/snli...
2021-04-30 05:17:21,723 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8887 | best_global_step: 20000
2021-04-30 05:17:21,723 - INFO - transprompt_wrapper2 - Saving models.
2021-04-30 05:35:11,440 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-04-30 05:35:35,693 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-04-30 05:35:35,694 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-04-30 05:35:35,793 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-04-30 05:35:35,809 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-04-30 05:35:35,809 - INFO - transprompt_wrapper2 - Writing example 0
2021-04-30 05:36:27,059 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-04-30 05:36:27,060 - INFO - modeling - eval_results: {'acc': 0.9057102214996952}
2021-05-01 02:39:09,364 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=1200, pet_max_seq_length=196, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-01 02:39:09,365 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-05-01 02:39:09,409 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-01 02:39:09,410 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-05-01 02:39:09,416 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-01 02:39:09,416 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 02:39:09,416 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-05-01 02:39:09,416 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-05-01 02:39:09,416 - INFO - run_task_adaptation - task=MNLI
2021-05-01 02:39:09,416 - INFO - run_task_adaptation - label=contradiction
2021-05-01 02:39:09,416 - INFO - run_task_adaptation - **********************************
2021-05-01 02:39:11,770 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 02:39:43,238 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 02:39:43,239 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:39:43,398 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:39:51,683 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:39:59,975 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:40:08,330 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:40:16,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:40:24,924 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:40:33,327 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:40:36,611 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:40:38,669 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-01 02:40:38,669 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6354 | best_global_step: 100
2021-05-01 02:40:38,669 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 02:41:05,931 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:41:14,176 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:41:22,510 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:41:30,798 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:41:39,144 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:41:47,898 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:41:52,813 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:41:54,850 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-01 02:41:54,850 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7188 | best_global_step: 200
2021-05-01 02:41:54,850 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 02:42:18,949 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:42:27,033 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:42:35,237 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:42:43,317 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:42:51,584 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:42:59,802 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:43:06,312 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:43:08,323 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 02:43:08,323 - INFO - transprompt_wrapper2 - 1
2021-05-01 02:43:09,905 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:43:18,141 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:43:26,343 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:43:34,542 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:43:42,808 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:43:51,631 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:44:00,251 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:44:02,261 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-01 02:44:02,261 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7188 | best_global_step: 400
2021-05-01 02:44:02,261 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 02:44:22,949 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:44:31,147 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:44:39,407 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:44:47,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:44:55,960 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:45:04,217 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:45:12,468 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:45:15,755 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:45:17,811 - INFO - transprompt_wrapper2 - {'acc': 0.6979166666666666}
2021-05-01 02:45:17,812 - INFO - transprompt_wrapper2 - 3
2021-05-01 02:45:22,873 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:45:31,225 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:45:39,548 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:45:47,702 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:45:55,894 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:46:03,842 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:46:08,794 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:46:10,818 - INFO - transprompt_wrapper2 - {'acc': 0.6979166666666666}
2021-05-01 02:46:10,818 - INFO - transprompt_wrapper2 - 4
2021-05-01 02:46:14,098 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:46:22,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:46:30,470 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:46:38,751 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:46:47,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:46:55,850 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:47:02,837 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:47:04,911 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 02:47:04,911 - INFO - transprompt_wrapper2 - 5
2021-05-01 02:47:06,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:47:14,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:47:22,800 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:47:31,072 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:47:39,321 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:47:47,555 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:47:55,799 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:47:57,810 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 02:47:57,810 - INFO - transprompt_wrapper2 - 6
2021-05-01 02:47:57,810 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:48:06,027 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:48:14,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:48:22,533 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:48:30,806 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:48:39,040 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:48:47,229 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:48:50,484 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:48:52,500 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-01 02:48:52,500 - INFO - transprompt_wrapper2 - 7
2021-05-01 02:48:57,493 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:49:05,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:49:13,999 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:49:22,237 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:49:30,423 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:49:38,624 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:49:43,566 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:49:45,603 - INFO - transprompt_wrapper2 - {'acc': 0.6979166666666666}
2021-05-01 02:49:45,603 - INFO - transprompt_wrapper2 - 8
2021-05-01 02:49:48,892 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:49:57,122 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:50:05,340 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:50:13,569 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:50:22,247 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:50:30,381 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:50:36,836 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:50:38,860 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-05-01 02:50:38,860 - INFO - transprompt_wrapper2 - 9
2021-05-01 02:50:40,519 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:50:48,739 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:50:57,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:51:05,333 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:51:13,633 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:51:21,899 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:51:30,141 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:51:32,167 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-05-01 02:51:32,167 - INFO - transprompt_wrapper2 - 10
2021-05-01 02:51:32,171 - INFO - modeling - Saving complete
2021-05-01 02:51:32,171 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-01 02:51:32,171 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-01 02:51:32,257 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 02:52:17,020 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-01 02:52:17,020 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-01 02:52:17,020 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-05-01 02:52:17,021 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:52:17,090 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:52:23,107 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:52:29,387 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:52:35,529 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:52:41,964 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:52:43,793 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:52:44,847 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 02:52:44,847 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5625 | best_global_step: 100
2021-05-01 02:52:44,848 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 02:53:08,377 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:53:14,649 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:53:20,924 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:53:27,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:53:29,810 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:53:30,846 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 02:53:30,847 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5833 | best_global_step: 200
2021-05-01 02:53:30,847 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 02:53:53,025 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:53:59,283 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:54:05,496 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:54:11,733 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:54:15,385 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:54:16,424 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-01 02:54:16,424 - INFO - transprompt_wrapper2 - 1
2021-05-01 02:54:19,049 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:54:25,272 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:54:31,511 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:54:37,764 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:54:42,250 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:54:43,290 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 02:54:43,290 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5833 | best_global_step: 400
2021-05-01 02:54:43,290 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 02:55:03,155 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:55:09,375 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:55:16,031 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:55:23,059 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:55:28,376 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:55:29,387 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 02:55:29,387 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5833 | best_global_step: 500
2021-05-01 02:55:29,387 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 02:55:49,025 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:55:55,218 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:01,484 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:07,472 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:13,616 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:56:14,644 - INFO - transprompt_wrapper2 - {'acc': 0.5416666666666666}
2021-05-01 02:56:14,644 - INFO - transprompt_wrapper2 - 4
2021-05-01 02:56:14,645 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:20,711 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:26,925 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:33,276 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:39,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:41,562 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:56:42,597 - INFO - transprompt_wrapper2 - {'acc': 0.5416666666666666}
2021-05-01 02:56:42,598 - INFO - transprompt_wrapper2 - 5
2021-05-01 02:56:47,479 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:56:54,393 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:00,511 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:06,801 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:09,547 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:57:10,567 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-01 02:57:10,567 - INFO - transprompt_wrapper2 - 6
2021-05-01 02:57:14,088 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:20,351 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:26,587 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:32,764 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:36,366 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:57:37,390 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-01 02:57:37,390 - INFO - transprompt_wrapper2 - 7
2021-05-01 02:57:40,021 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:46,277 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:52,521 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:57:58,682 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:03,169 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:58:04,199 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-01 02:58:04,199 - INFO - transprompt_wrapper2 - 8
2021-05-01 02:58:05,901 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:12,135 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:18,386 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:24,697 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:30,065 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:58:31,091 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-01 02:58:31,091 - INFO - transprompt_wrapper2 - 9
2021-05-01 02:58:31,965 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:38,075 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:43,805 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:49,979 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 02:58:56,278 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:58:57,303 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-01 02:58:57,303 - INFO - transprompt_wrapper2 - 10
2021-05-01 02:58:57,395 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 02:59:44,911 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-05-01 02:59:44,912 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-05-01 02:59:45,256 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-05-01 02:59:45,256 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-05-01 02:59:45,256 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 02:59:53,621 - INFO - transprompt_wrapper2 - Writing example 10000
2021-05-01 03:06:32,132 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-05-01 03:06:32,132 - INFO - modeling - eval_results: {'acc': 0.63078332569858}
2021-05-01 03:06:32,136 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-05-01 03:06:32,136 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:06:32,232 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:06:38,595 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:06:44,768 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:06:51,062 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:06:57,351 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:06:59,219 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:07:00,260 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-01 03:07:00,260 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7292 | best_global_step: 100
2021-05-01 03:07:00,260 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 03:07:22,592 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:07:28,882 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:07:35,225 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:07:41,242 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:07:43,922 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:07:44,942 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-05-01 03:07:44,943 - INFO - transprompt_wrapper2 - 1
2021-05-01 03:07:48,479 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:07:55,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:08:02,110 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:08:08,346 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:08:11,946 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:08:12,977 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-01 03:08:12,977 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 300
2021-05-01 03:08:12,977 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 03:08:33,826 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:08:40,049 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:08:46,298 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:08:52,896 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:08:57,581 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:08:58,613 - INFO - transprompt_wrapper2 - {'acc': 0.5416666666666666}
2021-05-01 03:08:58,613 - INFO - transprompt_wrapper2 - 1
2021-05-01 03:09:00,438 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:06,980 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:13,466 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:19,822 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:25,237 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:09:26,258 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 03:09:26,259 - INFO - transprompt_wrapper2 - 2
2021-05-01 03:09:27,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:33,363 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:39,658 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:45,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:52,222 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:09:53,238 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 03:09:53,238 - INFO - transprompt_wrapper2 - 3
2021-05-01 03:09:53,238 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:09:59,524 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:05,876 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:12,345 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:18,839 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:20,742 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:10:21,766 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-05-01 03:10:21,766 - INFO - transprompt_wrapper2 - 4
2021-05-01 03:10:26,139 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:32,307 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:38,496 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:44,734 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:47,479 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:10:48,500 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 03:10:48,500 - INFO - transprompt_wrapper2 - 5
2021-05-01 03:10:52,046 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:10:58,309 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:04,594 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:10,640 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:14,191 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:11:15,220 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 03:11:15,220 - INFO - transprompt_wrapper2 - 6
2021-05-01 03:11:17,805 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:23,869 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:30,075 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:36,290 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:40,676 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:11:41,700 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 03:11:41,701 - INFO - transprompt_wrapper2 - 7
2021-05-01 03:11:43,420 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:49,277 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:11:55,216 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:12:01,471 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:12:06,823 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:12:07,851 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 03:12:07,852 - INFO - transprompt_wrapper2 - 8
2021-05-01 03:12:08,725 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:12:14,982 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:12:21,210 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:12:27,355 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:12:33,528 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:12:34,542 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 03:12:34,542 - INFO - transprompt_wrapper2 - 9
2021-05-01 03:12:34,542 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:12:35,794 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 03:13:20,883 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-05-01 03:13:20,883 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-05-01 03:13:21,198 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-05-01 03:13:21,207 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-05-01 03:13:21,207 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:16:44,493 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-05-01 03:16:44,493 - INFO - modeling - eval_results: {'acc': 0.7226173541963016}
2021-05-01 03:50:45,191 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-01 03:50:45,192 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-01 03:50:45,241 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 03:50:45,242 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-01 03:50:45,256 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 03:50:45,256 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 03:50:45,256 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-01 03:50:45,256 - INFO - run_task_adaptation - text_b=None
2021-05-01 03:50:45,257 - INFO - run_task_adaptation - task=SST-2
2021-05-01 03:50:45,257 - INFO - run_task_adaptation - label=0
2021-05-01 03:50:45,257 - INFO - run_task_adaptation - **********************************
2021-05-01 03:50:47,690 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 03:51:24,395 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 03:51:24,395 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:51:24,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:51:36,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:51:48,048 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:51:50,183 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:51:51,611 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-01 03:51:51,611 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-01 03:51:51,611 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 03:52:24,038 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:52:35,768 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:52:38,808 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:52:40,232 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 03:52:40,233 - INFO - transprompt_wrapper2 - 1
2021-05-01 03:52:48,375 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:52:59,560 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:53:03,489 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:53:04,948 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 03:53:04,948 - INFO - transprompt_wrapper2 - 2
2021-05-01 03:53:12,804 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:53:24,087 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:53:28,474 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:53:29,822 - INFO - transprompt_wrapper2 - {'acc': 0.8645833333333334}
2021-05-01 03:53:29,822 - INFO - transprompt_wrapper2 - 3
2021-05-01 03:53:36,017 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:53:46,653 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:53:51,995 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:53:53,435 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 03:53:53,435 - INFO - transprompt_wrapper2 - 4
2021-05-01 03:53:59,484 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:54:11,114 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:54:17,597 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:54:19,020 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 03:54:19,020 - INFO - transprompt_wrapper2 - 5
2021-05-01 03:54:24,108 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:54:35,778 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:54:43,164 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:54:44,633 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 03:54:44,633 - INFO - transprompt_wrapper2 - 6
2021-05-01 03:54:48,951 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:55:00,270 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:55:08,397 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:55:09,816 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 03:55:09,816 - INFO - transprompt_wrapper2 - 7
2021-05-01 03:55:13,229 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:55:26,100 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:55:35,726 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:55:37,194 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 03:55:37,194 - INFO - transprompt_wrapper2 - 8
2021-05-01 03:55:39,742 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:55:51,297 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:56:01,340 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:56:02,764 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 03:56:02,764 - INFO - transprompt_wrapper2 - 9
2021-05-01 03:56:02,967 - INFO - modeling - Saving complete
2021-05-01 03:56:02,967 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-01 03:56:02,967 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-01 03:56:03,095 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 03:56:51,115 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-01 03:56:51,115 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-01 03:56:51,116 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-01 03:56:51,116 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:56:51,161 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:56:54,836 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:56:58,384 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:02,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:06,148 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:09,976 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:13,397 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:14,712 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:57:15,246 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-01 03:57:15,246 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-01 03:57:15,246 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 03:57:38,673 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:42,447 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:45,900 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:49,297 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:53,436 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:57,536 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:57:59,743 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:58:00,219 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-01 03:58:00,219 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-01 03:58:00,219 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 03:58:24,902 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:58:28,570 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:58:32,455 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:58:36,106 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:58:40,195 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:58:44,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 03:58:47,063 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 03:58:47,630 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-01 03:58:47,630 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-01 03:58:47,631 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 03:59:10,169 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:00:08,545 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-01 04:00:08,545 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-01 04:00:08,600 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-01 04:00:08,601 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-01 04:00:08,601 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:00:21,248 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-01 04:00:21,248 - INFO - modeling - eval_results: {'acc': 0.9243119266055045}
2021-05-01 04:00:21,250 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-01 04:00:21,251 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:00:21,308 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:00:24,875 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:00:28,617 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:00:32,532 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:00:36,435 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:00:40,338 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:00:44,086 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:00:45,451 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:00:45,988 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-01 04:00:45,988 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8125 | best_global_step: 100
2021-05-01 04:00:45,988 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:01:09,826 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:01:14,226 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:01:18,362 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:01:22,412 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:01:26,178 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:01:29,787 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:01:31,809 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:01:32,330 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-01 04:01:32,330 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8438 | best_global_step: 200
2021-05-01 04:01:32,330 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:01:56,682 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:02:00,366 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:02:04,114 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:02:07,898 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:02:11,736 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:02:15,706 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:02:18,753 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:02:19,263 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-01 04:02:19,263 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8438 | best_global_step: 300
2021-05-01 04:02:19,271 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:02:42,544 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:03:40,490 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-01 04:03:40,490 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-01 04:03:40,538 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-01 04:03:40,540 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-01 04:03:40,540 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:04:11,548 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-01 04:04:11,549 - INFO - modeling - eval_results: {'acc': 0.8525}
2021-05-01 04:04:11,554 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-01 04:04:11,554 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:04:11,634 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:04:15,621 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:04:19,731 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:04:23,702 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:04:28,342 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:04:32,573 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:04:36,620 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:04:37,960 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:04:38,465 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-01 04:04:38,466 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 100
2021-05-01 04:04:38,466 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:05:03,331 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:05:07,125 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:05:11,130 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:05:15,087 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:05:18,938 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:05:23,000 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:05:25,240 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:05:25,761 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-01 04:05:25,761 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 200
2021-05-01 04:05:25,761 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:05:50,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:05:53,893 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:05:57,690 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:06:01,771 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:06:05,814 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:06:09,577 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:06:12,816 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:06:13,395 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-01 04:06:13,395 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9688 | best_global_step: 300
2021-05-01 04:06:13,395 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:06:36,072 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:07:32,320 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-01 04:07:32,321 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-01 04:07:32,370 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-01 04:07:32,373 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-01 04:07:32,373 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:08:02,007 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-01 04:08:02,007 - INFO - modeling - eval_results: {'acc': 0.9035}
2021-05-01 04:09:50,997 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=1200, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-01 04:09:50,997 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-05-01 04:09:51,032 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-01 04:09:51,032 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-05-01 04:09:51,034 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-01 04:09:51,034 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 04:09:51,034 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-05-01 04:09:51,034 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-05-01 04:09:51,034 - INFO - run_task_adaptation - task=MNLI
2021-05-01 04:09:51,034 - INFO - run_task_adaptation - label=contradiction
2021-05-01 04:09:51,034 - INFO - run_task_adaptation - **********************************
2021-05-01 04:09:53,449 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:10:26,306 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 04:10:26,307 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:10:26,465 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:10:33,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:10:39,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:10:45,931 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:10:52,270 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:10:58,786 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:11:05,087 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:11:07,531 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:11:08,961 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-01 04:11:08,961 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5938 | best_global_step: 100
2021-05-01 04:11:08,961 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:11:34,973 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:11:41,312 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:11:47,720 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:11:54,121 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:12:00,410 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:12:06,664 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:12:10,379 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:12:11,829 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-01 04:12:11,829 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6354 | best_global_step: 200
2021-05-01 04:12:11,830 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:12:32,974 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=4, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-01 04:12:32,974 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-01 04:12:32,977 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 04:12:32,977 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-01 04:12:32,979 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 04:12:32,979 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 04:12:32,979 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-01 04:12:32,979 - INFO - run_task_adaptation - text_b=None
2021-05-01 04:12:32,979 - INFO - run_task_adaptation - task=SST-2
2021-05-01 04:12:32,979 - INFO - run_task_adaptation - label=0
2021-05-01 04:12:32,979 - INFO - run_task_adaptation - **********************************
2021-05-01 04:12:35,310 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:12:35,950 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:12:42,193 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:12:48,345 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:12:54,641 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:13:00,960 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:13:07,571 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:13:12,735 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:13:13,745 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 04:13:13,746 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:13:13,881 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:13:14,590 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-01 04:13:14,590 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6771 | best_global_step: 300
2021-05-01 04:13:14,590 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:13:37,445 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:13:43,616 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:13:49,800 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:13:55,958 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:02,093 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:03,636 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-01 04:14:03,636 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-01 04:14:03,640 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 04:14:03,640 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-01 04:14:03,641 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 04:14:03,642 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 04:14:03,642 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-01 04:14:03,642 - INFO - run_task_adaptation - text_b=None
2021-05-01 04:14:03,642 - INFO - run_task_adaptation - task=SST-2
2021-05-01 04:14:03,642 - INFO - run_task_adaptation - label=0
2021-05-01 04:14:03,642 - INFO - run_task_adaptation - **********************************
2021-05-01 04:14:05,956 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:14:08,277 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:14,371 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:14:15,858 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-05-01 04:14:15,858 - INFO - transprompt_wrapper2 - 1
2021-05-01 04:14:15,859 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:22,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:28,251 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:34,537 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:40,860 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:44,762 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 04:14:44,763 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:14:44,917 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:48,669 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:55,788 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:14:58,312 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:14:59,847 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-05-01 04:14:59,848 - INFO - transprompt_wrapper2 - 2
2021-05-01 04:15:03,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:15:10,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:15:16,369 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:15:22,650 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:15:28,984 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:15:35,404 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:15:39,309 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:15:40,773 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-05-01 04:15:40,773 - INFO - transprompt_wrapper2 - 3
2021-05-01 04:15:43,226 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:15:49,320 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:15:55,631 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:01,895 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:08,324 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:14,545 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:19,559 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:16:21,026 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-01 04:16:21,026 - INFO - transprompt_wrapper2 - 4
2021-05-01 04:16:22,340 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:28,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:34,903 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:41,242 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:47,588 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:16:53,875 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:00,214 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:17:01,704 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-01 04:17:01,704 - INFO - transprompt_wrapper2 - 5
2021-05-01 04:17:01,704 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:07,989 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:14,316 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:20,560 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:26,613 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:32,689 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:38,409 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-01 04:17:38,409 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-01 04:17:38,414 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 04:17:38,414 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-01 04:17:38,416 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 04:17:38,416 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 04:17:38,416 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-01 04:17:38,416 - INFO - run_task_adaptation - text_b=None
2021-05-01 04:17:38,416 - INFO - run_task_adaptation - task=SST-2
2021-05-01 04:17:38,417 - INFO - run_task_adaptation - label=0
2021-05-01 04:17:38,417 - INFO - run_task_adaptation - **********************************
2021-05-01 04:17:38,817 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:40,800 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:17:41,232 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:17:42,632 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-01 04:17:42,632 - INFO - transprompt_wrapper2 - 6
2021-05-01 04:17:46,348 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:52,698 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:17:58,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:18:05,293 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:18:11,903 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:18:15,917 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 04:18:15,917 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:18:16,023 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:18:19,661 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:18:27,084 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:18:30,704 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-01 04:18:30,704 - INFO - transprompt_wrapper2 - 7
2021-05-01 04:18:35,720 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:18:35,798 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:18:47,740 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:18:57,037 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:03,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:09,326 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:15,523 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:20,580 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:19:22,035 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-01 04:19:22,035 - INFO - transprompt_wrapper2 - 8
2021-05-01 04:19:23,274 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:29,561 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:35,905 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:42,160 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:48,316 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:52,226 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-01 04:19:52,226 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-01 04:19:52,229 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 04:19:52,229 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-01 04:19:52,231 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 04:19:52,231 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 04:19:52,231 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-01 04:19:52,232 - INFO - run_task_adaptation - text_b=None
2021-05-01 04:19:52,232 - INFO - run_task_adaptation - task=SST-2
2021-05-01 04:19:52,232 - INFO - run_task_adaptation - label=0
2021-05-01 04:19:52,232 - INFO - run_task_adaptation - **********************************
2021-05-01 04:19:54,544 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:19:54,596 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:20:00,814 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:20:02,265 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-01 04:20:02,265 - INFO - transprompt_wrapper2 - 9
2021-05-01 04:20:02,265 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:20:03,730 - INFO - modeling - Saving complete
2021-05-01 04:20:03,730 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-01 04:20:03,730 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-01 04:20:03,831 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:20:26,653 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 04:20:26,654 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:20:26,781 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:20:39,119 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:20:47,360 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-01 04:20:47,360 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-01 04:20:47,360 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-05-01 04:20:47,360 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:20:47,426 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:20:52,477 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:20:56,244 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:20:57,073 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:21:00,429 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-01 04:21:00,429 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 100
2021-05-01 04:21:00,429 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:21:03,137 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:21:08,579 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:21:13,668 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:21:16,921 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:21:17,721 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 04:21:17,722 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 100
2021-05-01 04:21:17,722 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:21:41,049 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:21:45,858 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:21:55,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:21:59,988 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:04,284 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:05,883 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:22:09,270 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 04:22:09,270 - INFO - transprompt_wrapper2 - 1
2021-05-01 04:22:13,227 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:17,444 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:22:19,249 - INFO - transprompt_wrapper2 - {'acc': 0.5208333333333334}
2021-05-01 04:22:19,250 - INFO - transprompt_wrapper2 - 1
2021-05-01 04:22:22,494 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:24,399 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:33,670 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:41,927 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:42,728 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:49,013 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:22:51,453 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:22:52,284 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 04:22:52,284 - INFO - transprompt_wrapper2 - 2
2021-05-01 04:22:56,914 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:22:58,684 - INFO - transprompt_wrapper2 - {'acc': 0.6041666666666666}
2021-05-01 04:22:58,684 - INFO - transprompt_wrapper2 - 2
2021-05-01 04:23:02,696 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:23:03,895 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:23:11,740 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:23:21,368 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:23:22,793 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:23:30,501 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:23:31,194 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:23:34,516 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 04:23:34,517 - INFO - transprompt_wrapper2 - 3
2021-05-01 04:23:36,640 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:23:38,418 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 04:23:38,418 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 400
2021-05-01 04:23:38,418 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:23:42,377 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:23:53,503 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:00,023 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:24:00,184 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:03,171 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 04:24:03,171 - INFO - transprompt_wrapper2 - 4
2021-05-01 04:24:09,019 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:12,423 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:18,039 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:27,635 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:31,479 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:35,564 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:24:37,360 - INFO - transprompt_wrapper2 - {'acc': 0.5833333333333334}
2021-05-01 04:24:37,360 - INFO - transprompt_wrapper2 - 4
2021-05-01 04:24:38,671 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:42,137 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:24:45,556 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 04:24:45,556 - INFO - transprompt_wrapper2 - 5
2021-05-01 04:24:47,577 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:53,692 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:24:56,331 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:25:05,210 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:25:13,847 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:25:14,380 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:25:15,811 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 04:25:15,812 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6250 | best_global_step: 600
2021-05-01 04:25:15,812 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:25:21,767 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:25:23,144 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 04:25:23,144 - INFO - transprompt_wrapper2 - 6
2021-05-01 04:25:26,593 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:25:33,831 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:25:39,398 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:25:42,688 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:25:52,296 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:25:53,179 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:25:56,511 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 04:25:56,511 - INFO - transprompt_wrapper2 - 7
2021-05-01 04:26:00,980 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:26:01,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:26:10,025 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:26:12,898 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:26:14,661 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 04:26:14,661 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 700
2021-05-01 04:26:14,661 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:26:18,362 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:26:26,769 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:26:28,165 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 04:26:28,165 - INFO - transprompt_wrapper2 - 8
2021-05-01 04:26:30,327 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:26:39,892 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:26:46,928 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:26:49,080 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:26:58,446 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:27:03,300 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:27:06,883 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 04:27:06,883 - INFO - transprompt_wrapper2 - 9
2021-05-01 04:27:06,998 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:27:07,170 - INFO - modeling - Saving complete
2021-05-01 04:27:07,170 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-01 04:27:07,170 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-01 04:27:07,270 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:27:09,151 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:27:09,859 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-01 04:27:09,859 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 800
2021-05-01 04:27:09,859 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:27:32,138 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:27:37,103 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:27:42,422 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:27:48,103 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:27:51,041 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-01 04:27:51,041 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-01 04:27:51,042 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-01 04:27:51,042 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:27:51,081 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:27:51,195 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:27:52,410 - INFO - transprompt_wrapper2 - {'acc': 0.5833333333333334}
2021-05-01 04:27:52,410 - INFO - transprompt_wrapper2 - 2
2021-05-01 04:27:54,823 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:00,382 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:05,734 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:10,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:14,733 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:28:15,439 - INFO - transprompt_wrapper2 - {'acc': 0.5833333333333334}
2021-05-01 04:28:15,439 - INFO - transprompt_wrapper2 - 3
2021-05-01 04:28:16,975 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:22,697 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:28,328 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:33,899 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:38,654 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:28:39,431 - INFO - transprompt_wrapper2 - {'acc': 0.5833333333333334}
2021-05-01 04:28:39,431 - INFO - transprompt_wrapper2 - 4
2021-05-01 04:28:40,229 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:45,627 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:51,208 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:28:56,782 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:29:02,476 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:29:03,271 - INFO - transprompt_wrapper2 - {'acc': 0.5833333333333334}
2021-05-01 04:29:03,271 - INFO - transprompt_wrapper2 - 5
2021-05-01 04:29:03,272 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:29:04,219 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:29:49,250 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-05-01 04:29:49,250 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-42 (num_examples=-1, set_type=test)
2021-05-01 04:29:49,712 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('contradiction', 6453), ('neutral', 6252)]
2021-05-01 04:29:49,712 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-05-01 04:29:49,712 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:29:58,285 - INFO - transprompt_wrapper2 - Writing example 10000
2021-05-01 04:34:32,085 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-05-01 04:34:32,085 - INFO - modeling - eval_results: {'acc': 0.6200946709421286}
2021-05-01 04:34:32,087 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-05-01 04:34:32,088 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:34:32,159 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:34:37,846 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:34:43,483 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:34:48,955 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:34:54,320 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:34:55,804 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:34:56,559 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-01 04:34:56,560 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8125 | best_global_step: 100
2021-05-01 04:34:56,560 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 04:35:18,972 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:35:24,600 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:35:30,157 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:35:35,879 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:35:38,196 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:35:38,949 - INFO - transprompt_wrapper2 - {'acc': 0.7916666666666666}
2021-05-01 04:35:38,949 - INFO - transprompt_wrapper2 - 1
2021-05-01 04:35:42,233 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:35:47,707 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:35:53,389 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:35:58,789 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:01,485 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:36:02,182 - INFO - transprompt_wrapper2 - {'acc': 0.75}
2021-05-01 04:36:02,182 - INFO - transprompt_wrapper2 - 2
2021-05-01 04:36:04,481 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:10,112 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:15,650 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:21,307 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:24,712 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:36:25,462 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 04:36:25,462 - INFO - transprompt_wrapper2 - 3
2021-05-01 04:36:26,961 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:32,289 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:37,215 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:42,467 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:46,821 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:36:47,541 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-01 04:36:47,542 - INFO - transprompt_wrapper2 - 4
2021-05-01 04:36:48,288 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:53,997 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:36:59,677 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:05,244 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:10,566 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:37:11,304 - INFO - transprompt_wrapper2 - {'acc': 0.7083333333333334}
2021-05-01 04:37:11,304 - INFO - transprompt_wrapper2 - 5
2021-05-01 04:37:11,305 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:16,735 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:22,393 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:28,096 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:33,818 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:35,301 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:37:36,037 - INFO - transprompt_wrapper2 - {'acc': 0.7083333333333334}
2021-05-01 04:37:36,037 - INFO - transprompt_wrapper2 - 6
2021-05-01 04:37:40,060 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:45,543 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:51,226 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:56,771 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:37:59,076 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:37:59,827 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-01 04:37:59,827 - INFO - transprompt_wrapper2 - 7
2021-05-01 04:38:03,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:08,678 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:14,139 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:19,312 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:22,275 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:38:22,996 - INFO - transprompt_wrapper2 - {'acc': 0.7083333333333334}
2021-05-01 04:38:22,996 - INFO - transprompt_wrapper2 - 8
2021-05-01 04:38:25,396 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:30,947 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:36,652 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:41,730 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:45,188 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:38:45,925 - INFO - transprompt_wrapper2 - {'acc': 0.7291666666666666}
2021-05-01 04:38:45,925 - INFO - transprompt_wrapper2 - 9
2021-05-01 04:38:47,465 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:52,959 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:38:58,698 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:39:04,431 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 04:39:09,305 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:39:10,055 - INFO - transprompt_wrapper2 - {'acc': 0.7083333333333334}
2021-05-01 04:39:10,055 - INFO - transprompt_wrapper2 - 10
2021-05-01 04:39:10,183 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 04:39:55,251 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-05-01 04:39:55,252 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-42 (num_examples=-1, set_type=test)
2021-05-01 04:39:55,320 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-05-01 04:39:55,334 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-05-01 04:39:55,334 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 04:42:15,721 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-05-01 04:42:15,722 - INFO - modeling - eval_results: {'acc': 0.7386710018288966}
2021-05-01 05:23:47,388 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=2, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-01 05:23:47,388 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-01 05:23:47,391 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 05:23:47,391 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-01 05:23:47,393 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-01 05:23:47,393 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 05:23:47,393 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-01 05:23:47,393 - INFO - run_task_adaptation - text_b=None
2021-05-01 05:23:47,393 - INFO - run_task_adaptation - task=SST-2
2021-05-01 05:23:47,393 - INFO - run_task_adaptation - label=0
2021-05-01 05:23:47,393 - INFO - run_task_adaptation - **********************************
2021-05-01 05:23:49,744 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 05:24:23,817 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 05:24:23,817 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:24:23,964 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:24:36,277 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:24:47,790 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:24:49,864 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:24:51,303 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-01 05:24:51,303 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9167 | best_global_step: 100
2021-05-01 05:24:51,303 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 05:25:25,181 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:25:36,947 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:25:39,728 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:25:41,187 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 05:25:41,187 - INFO - transprompt_wrapper2 - 1
2021-05-01 05:25:49,501 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:26:01,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:26:04,750 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:26:06,220 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 05:26:06,221 - INFO - transprompt_wrapper2 - 2
2021-05-01 05:26:13,835 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:26:25,502 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:26:30,320 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:26:31,835 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 05:26:31,835 - INFO - transprompt_wrapper2 - 3
2021-05-01 05:26:38,797 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:26:50,238 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:26:55,502 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:26:56,902 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 05:26:56,902 - INFO - transprompt_wrapper2 - 4
2021-05-01 05:27:02,675 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:27:14,285 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:27:20,730 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:27:22,169 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 05:27:22,170 - INFO - transprompt_wrapper2 - 5
2021-05-01 05:27:27,261 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:27:38,435 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:27:45,715 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:27:47,149 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 05:27:47,150 - INFO - transprompt_wrapper2 - 6
2021-05-01 05:27:51,427 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:28:02,780 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:28:10,786 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:28:12,199 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 05:28:12,199 - INFO - transprompt_wrapper2 - 7
2021-05-01 05:28:15,314 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:28:26,488 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:28:35,041 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:28:36,515 - INFO - transprompt_wrapper2 - {'acc': 0.8958333333333334}
2021-05-01 05:28:36,515 - INFO - transprompt_wrapper2 - 8
2021-05-01 05:28:38,921 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:28:50,256 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:28:59,991 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:29:01,403 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-05-01 05:29:01,403 - INFO - transprompt_wrapper2 - 9
2021-05-01 05:29:01,585 - INFO - modeling - Saving complete
2021-05-01 05:29:01,585 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-01 05:29:01,585 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-01 05:29:01,677 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 05:29:46,164 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-01 05:29:46,164 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-01 05:29:46,164 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-01 05:29:46,164 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:29:46,208 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:29:50,308 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:29:54,648 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:29:58,665 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:03,018 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:06,890 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:11,224 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:12,702 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:30:13,297 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-01 05:30:13,297 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-01 05:30:13,297 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 05:30:36,702 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:40,523 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:44,284 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:48,048 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:51,875 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:55,612 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:30:57,720 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:30:58,208 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-01 05:30:58,208 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 200
2021-05-01 05:30:58,208 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 05:31:19,023 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:31:23,331 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:31:27,675 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:31:31,904 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:31:36,364 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:31:40,869 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:31:44,337 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:31:44,924 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-01 05:31:44,925 - INFO - transprompt_wrapper2 - 2
2021-05-01 05:31:45,289 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 05:32:33,871 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-01 05:32:33,871 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-01 05:32:33,997 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-01 05:32:33,997 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-01 05:32:33,997 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:32:46,441 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-01 05:32:46,441 - INFO - modeling - eval_results: {'acc': 0.9013761467889908}
2021-05-01 05:32:46,443 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-01 05:32:46,443 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:32:46,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:32:50,200 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:32:54,119 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:32:57,940 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:01,884 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:05,727 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:09,526 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:10,847 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:33:11,374 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-01 05:33:11,374 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7812 | best_global_step: 100
2021-05-01 05:33:11,374 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 05:33:34,208 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:38,123 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:41,926 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:45,762 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:49,666 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:53,505 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:33:55,634 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:33:56,124 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-01 05:33:56,125 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8438 | best_global_step: 200
2021-05-01 05:33:56,125 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 05:34:17,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:34:21,747 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:34:25,439 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:34:29,230 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:34:32,795 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:34:36,563 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:34:39,471 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:34:39,953 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-01 05:34:39,953 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8438 | best_global_step: 300
2021-05-01 05:34:39,953 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 05:35:00,727 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 05:35:52,224 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-01 05:35:52,224 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-01 05:35:52,239 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-01 05:35:52,240 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-01 05:35:52,240 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:36:21,572 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-01 05:36:21,572 - INFO - modeling - eval_results: {'acc': 0.865}
2021-05-01 05:36:21,617 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-01 05:36:21,617 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:36:21,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:36:25,136 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:36:29,008 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:36:32,951 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:36:36,899 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:36:40,814 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:36:44,625 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:36:45,950 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:36:46,577 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-01 05:36:46,578 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-01 05:36:46,578 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 05:37:09,564 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:37:12,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:37:16,694 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:37:20,318 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:37:24,392 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:37:28,056 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:37:30,107 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:37:30,577 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-01 05:37:30,577 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-01 05:37:30,577 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 05:37:52,809 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:37:56,583 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:37:59,795 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:38:03,453 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:38:07,261 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:38:11,148 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:38:14,236 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:38:14,751 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-01 05:38:14,751 - INFO - transprompt_wrapper2 - 1
2021-05-01 05:38:15,081 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 05:39:05,136 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-01 05:39:05,136 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-01 05:39:05,152 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-01 05:39:05,154 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-01 05:39:05,154 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:39:33,854 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-01 05:39:33,855 - INFO - modeling - eval_results: {'acc': 0.8895}
2021-05-01 05:51:49,605 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-05-01 05:51:49,606 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=train)
2021-05-01 05:51:49,720 - INFO - task_processors - Returning 11965 train examples with label dist.: [(0, 5268), (1, 6697)]
2021-05-01 05:51:49,720 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=dev)
2021-05-01 05:51:49,890 - INFO - task_processors - Returning 5392 dev examples with label dist.: [(0, 2741), (1, 2651)]
2021-05-01 05:51:49,890 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-01 05:51:49,890 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-01 05:51:49,891 - INFO - run_task_adaptation - text_b=None
2021-05-01 05:51:49,891 - INFO - run_task_adaptation - task=SST-2
2021-05-01 05:51:49,891 - INFO - run_task_adaptation - label=0
2021-05-01 05:51:49,891 - INFO - run_task_adaptation - **********************************
2021-05-01 05:51:52,334 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 05:52:10,501 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-01 05:52:10,501 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 05:52:18,224 - INFO - transprompt_wrapper2 - Writing example 10000
2021-05-01 05:52:19,811 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 05:56:46,245 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:01:13,476 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:05:36,188 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:07:15,215 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 06:07:43,218 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-05-01 06:07:43,219 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9121 | best_global_step: 600
2021-05-01 06:07:43,219 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 06:10:37,463 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:15:04,176 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:19:40,798 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:22:04,934 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 06:22:32,949 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-05-01 06:22:32,949 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9208 | best_global_step: 1200
2021-05-01 06:22:32,949 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 06:24:45,095 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:29:45,771 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:34:22,218 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:37:25,857 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 06:37:53,531 - INFO - transprompt_wrapper2 - {'acc': 0.9204376854599406}
2021-05-01 06:37:53,531 - INFO - transprompt_wrapper2 - 1
2021-05-01 06:39:07,689 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:43:32,287 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:47:52,253 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:51:32,462 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 06:52:00,387 - INFO - transprompt_wrapper2 - {'acc': 0.9187685459940653}
2021-05-01 06:52:00,387 - INFO - transprompt_wrapper2 - 2
2021-05-01 06:52:35,175 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 06:56:47,732 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:01:21,413 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:05:34,059 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:06:41,918 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 07:07:10,428 - INFO - transprompt_wrapper2 - {'acc': 0.9193249258160238}
2021-05-01 07:07:10,428 - INFO - transprompt_wrapper2 - 3
2021-05-01 07:10:30,632 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:14:54,648 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:19:24,956 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:21:24,504 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 07:21:55,579 - INFO - transprompt_wrapper2 - {'acc': 0.9206231454005934}
2021-05-01 07:21:55,580 - INFO - transprompt_wrapper2 - 4
2021-05-01 07:24:47,091 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:29:13,679 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:33:42,973 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:36:14,187 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 07:36:42,174 - INFO - transprompt_wrapper2 - {'acc': 0.9167284866468842}
2021-05-01 07:36:42,174 - INFO - transprompt_wrapper2 - 5
2021-05-01 07:38:33,437 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:43:31,864 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:48:15,793 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:51:30,552 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 07:51:58,589 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-05-01 07:51:58,589 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9217 | best_global_step: 4800
2021-05-01 07:51:58,589 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 07:53:17,855 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 07:57:46,345 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:02:45,073 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:06:41,537 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 08:07:09,850 - INFO - transprompt_wrapper2 - {'acc': 0.9198813056379822}
2021-05-01 08:07:09,850 - INFO - transprompt_wrapper2 - 1
2021-05-01 08:07:35,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:11:59,113 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:16:49,623 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:21:16,810 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:22:30,697 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 08:22:58,882 - INFO - transprompt_wrapper2 - {'acc': 0.9204376854599406}
2021-05-01 08:22:58,882 - INFO - transprompt_wrapper2 - 2
2021-05-01 08:26:09,759 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:30:55,956 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:35:34,986 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:37:32,361 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 08:38:00,588 - INFO - transprompt_wrapper2 - {'acc': 0.9209940652818991}
2021-05-01 08:38:00,588 - INFO - transprompt_wrapper2 - 3
2021-05-01 08:40:27,503 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:44:52,558 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:47:19,382 - INFO - modeling - Saving complete
2021-05-01 08:47:19,383 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-01 08:47:19,383 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-01 08:47:19,498 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 08:47:43,610 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-01 08:47:43,617 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-01 08:47:43,620 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-01 08:47:43,620 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 08:47:48,019 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:49:51,752 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:51:51,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:53:54,393 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:55:27,229 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 08:55:36,558 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/sst-2...
2021-05-01 08:55:36,558 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9299 | best_global_step: 600
2021-05-01 08:55:36,558 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 08:56:15,027 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 08:58:16,104 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:00:19,321 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:02:18,875 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:03:20,909 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:03:29,872 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/sst-2...
2021-05-01 09:03:29,872 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9322 | best_global_step: 1200
2021-05-01 09:03:29,872 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 09:04:35,231 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:06:37,591 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:08:38,962 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:10:38,592 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:11:12,767 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:11:21,775 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/sst-2...
2021-05-01 09:11:21,775 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9327 | best_global_step: 1800
2021-05-01 09:11:21,775 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 09:11:31,583 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 09:11:53,856 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-01 09:11:53,857 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-01 09:11:54,086 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-01 09:11:54,086 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-01 09:11:54,086 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:11:58,963 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-01 09:11:58,963 - INFO - modeling - eval_results: {'acc': 0.9518348623853211}
2021-05-01 09:11:58,965 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-01 09:11:58,966 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:12:03,190 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:14:10,771 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:16:17,712 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:18:23,353 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:19:49,180 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:20:07,050 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/mr...
2021-05-01 09:20:07,051 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9065 | best_global_step: 600
2021-05-01 09:20:07,051 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 09:20:54,157 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:22:58,438 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:25:01,580 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:27:06,623 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:27:54,259 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:28:12,255 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/mr...
2021-05-01 09:28:12,255 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9092 | best_global_step: 1200
2021-05-01 09:28:12,255 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 09:29:37,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:31:43,388 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:33:49,034 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:35:38,412 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:35:56,787 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/mr...
2021-05-01 09:35:56,787 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9131 | best_global_step: 1800
2021-05-01 09:35:56,787 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 09:36:05,807 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 09:36:28,671 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-01 09:36:28,672 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-01 09:36:28,728 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-01 09:36:28,729 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-01 09:36:28,729 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:36:39,846 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-01 09:36:39,846 - INFO - modeling - eval_results: {'acc': 0.8975}
2021-05-01 09:36:39,848 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-01 09:36:39,848 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:36:41,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:37:18,274 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:37:54,787 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:38:32,419 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:39:10,077 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:39:47,014 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:40:22,164 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:40:58,482 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:41:34,297 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:42:10,278 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:42:46,156 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:43:21,396 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:43:56,971 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:44:18,472 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:44:19,963 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/cr...
2021-05-01 09:44:19,963 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9552 | best_global_step: 600
2021-05-01 09:44:19,963 - INFO - transprompt_wrapper2 - Saving models.
2021-05-01 09:44:42,807 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:45:18,548 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:45:54,921 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:46:31,038 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:47:07,370 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:47:43,453 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:48:19,328 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:48:55,026 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:49:32,024 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:50:07,093 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:50:43,357 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:51:18,332 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:51:53,876 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:51:55,407 - INFO - transprompt_wrapper2 - {'acc': 0.9440298507462687}
2021-05-01 09:51:55,408 - INFO - transprompt_wrapper2 - 1
2021-05-01 09:51:55,408 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:52:32,985 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:53:10,975 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:53:47,101 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:54:23,912 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:54:59,130 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:55:33,975 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:56:09,899 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:56:45,208 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:57:20,907 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:57:56,857 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:58:32,402 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:59:08,466 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-01 09:59:30,114 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 09:59:31,606 - INFO - transprompt_wrapper2 - {'acc': 0.9477611940298507}
2021-05-01 09:59:31,606 - INFO - transprompt_wrapper2 - 2
2021-05-01 09:59:32,299 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-01 09:59:54,670 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-01 09:59:54,671 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-01 09:59:54,686 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-01 09:59:54,687 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-01 09:59:54,687 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-01 10:00:05,305 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-01 10:00:05,306 - INFO - modeling - eval_results: {'acc': 0.913}
2021-05-11 07:16:39,736 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=4000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-11 07:16:39,754 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-11 07:16:39,839 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-11 07:16:39,839 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-11 07:16:39,842 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-11 07:16:39,842 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-11 07:16:39,842 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-11 07:16:39,842 - INFO - run_task_adaptation - text_b=None
2021-05-11 07:16:39,842 - INFO - run_task_adaptation - task=SST-2
2021-05-11 07:16:39,843 - INFO - run_task_adaptation - label=0
2021-05-11 07:16:39,843 - INFO - run_task_adaptation - **********************************
2021-05-11 07:16:42,818 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-11 07:17:14,209 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-11 07:17:14,210 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-11 07:17:14,346 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-11 07:18:24,431 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=4000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-11 07:18:24,431 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-11 07:18:24,434 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-11 07:18:24,434 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-11 07:18:24,436 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-11 07:18:24,436 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-11 07:18:24,436 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-11 07:18:24,436 - INFO - run_task_adaptation - text_b=None
2021-05-11 07:18:24,436 - INFO - run_task_adaptation - task=SST-2
2021-05-11 07:18:24,436 - INFO - run_task_adaptation - label=0
2021-05-11 07:18:24,436 - INFO - run_task_adaptation - **********************************
2021-05-11 07:18:28,278 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-11 07:18:56,995 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-11 07:18:56,996 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-11 07:18:57,138 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-11 07:19:26,983 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=4000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-11 07:19:26,983 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-11 07:19:26,986 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-11 07:19:26,986 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-11 07:19:26,987 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-11 07:19:26,987 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-11 07:19:26,988 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-11 07:19:26,988 - INFO - run_task_adaptation - text_b=None
2021-05-11 07:19:26,988 - INFO - run_task_adaptation - task=SST-2
2021-05-11 07:19:26,988 - INFO - run_task_adaptation - label=0
2021-05-11 07:19:26,988 - INFO - run_task_adaptation - **********************************
2021-05-11 07:19:29,507 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-11 07:19:57,781 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-11 07:19:57,781 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-11 07:19:57,892 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 10:37:38,042 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-12 10:37:38,043 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=train)
2021-05-12 10:37:38,090 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-05-12 10:37:38,090 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=dev)
2021-05-12 10:37:38,095 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-05-12 10:37:38,095 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-12 10:37:38,095 - INFO - run_task_adaptation - text_a=Egypt , Mongolia , the Seychelles , Tunisia and at least three other governments have signed unpublicized agreements .
2021-05-12 10:37:38,095 - INFO - run_task_adaptation - text_b=At least seven other governments have signed agreements , but have asked not to have them publicized .
2021-05-12 10:37:38,095 - INFO - run_task_adaptation - task=MRPC
2021-05-12 10:37:38,095 - INFO - run_task_adaptation - label=0
2021-05-12 10:37:38,095 - INFO - run_task_adaptation - **********************************
2021-05-12 10:37:40,457 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 10:38:12,834 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-12 10:38:12,835 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:39:09,485 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:39:11,344 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:39:11,344 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6406 | best_global_step: 100
2021-05-12 10:39:11,344 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:40:27,607 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:40:29,669 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:40:29,669 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 200
2021-05-12 10:40:29,669 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:41:48,229 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:41:50,047 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:41:50,047 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 300
2021-05-12 10:41:50,047 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:43:09,786 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:43:11,617 - INFO - transprompt_wrapper2 - {'acc': 0.640625}
2021-05-12 10:43:11,617 - INFO - transprompt_wrapper2 - 2
2021-05-12 10:43:44,580 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=1200, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-12 10:43:44,580 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-05-12 10:43:44,614 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-12 10:43:44,614 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-05-12 10:43:44,616 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-12 10:43:44,616 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-12 10:43:44,616 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-05-12 10:43:44,616 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-05-12 10:43:44,616 - INFO - run_task_adaptation - task=MNLI
2021-05-12 10:43:44,617 - INFO - run_task_adaptation - label=contradiction
2021-05-12 10:43:44,617 - INFO - run_task_adaptation - **********************************
2021-05-12 10:43:47,047 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 10:44:06,622 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:44:08,616 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:44:08,616 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 500
2021-05-12 10:44:08,616 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:44:38,934 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g2/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=1200, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-12 10:44:38,934 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=train)
2021-05-12 10:44:38,937 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-12 10:44:38,937 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-21 (num_examples=-1, set_type=dev)
2021-05-12 10:44:38,939 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-12 10:44:38,939 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-12 10:44:38,939 - INFO - run_task_adaptation - text_a=Madeira was then granted autonomy, in addition to the right to determine its own taxes and send a deputation to the Portuguese government.
2021-05-12 10:44:38,939 - INFO - run_task_adaptation - text_b=Portugal tightened its grip on Madeira as it sought to impose its rule there.
2021-05-12 10:44:38,939 - INFO - run_task_adaptation - task=MNLI
2021-05-12 10:44:38,939 - INFO - run_task_adaptation - label=contradiction
2021-05-12 10:44:38,939 - INFO - run_task_adaptation - **********************************
2021-05-12 10:44:41,332 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 10:45:20,891 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-12 10:45:20,891 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:45:34,347 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:45:38,760 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:45:38,760 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 600
2021-05-12 10:45:38,760 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:46:42,609 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:46:49,750 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-12 10:46:49,750 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6354 | best_global_step: 100
2021-05-12 10:46:49,750 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:47:21,090 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:47:25,793 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:47:25,793 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 700
2021-05-12 10:47:25,793 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:48:29,705 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:48:36,591 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-12 10:48:36,592 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 200
2021-05-12 10:48:36,592 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:49:04,420 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:49:08,930 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:49:08,931 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 800
2021-05-12 10:49:08,931 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:50:16,586 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:50:23,488 - INFO - transprompt_wrapper2 - {'acc': 0.6145833333333334}
2021-05-12 10:50:23,488 - INFO - transprompt_wrapper2 - 1
2021-05-12 10:51:07,791 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:51:12,208 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:51:12,208 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 900
2021-05-12 10:51:12,208 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:51:42,480 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:51:49,331 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-12 10:51:49,331 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 400
2021-05-12 10:51:49,331 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:52:50,695 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:52:55,353 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 10:52:55,353 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 1000
2021-05-12 10:52:55,353 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:53:18,988 - INFO - modeling - Saving complete
2021-05-12 10:53:18,988 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-12 10:53:18,988 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-12 10:53:19,082 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 10:53:28,233 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:53:30,959 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 10:53:30,959 - INFO - transprompt_wrapper2 - 3
2021-05-12 10:54:08,116 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-12 10:54:08,117 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-12 10:54:08,117 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-05-12 10:54:08,117 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:54:41,549 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:54:48,754 - INFO - transprompt_wrapper2 - {'acc': 0.6354166666666666}
2021-05-12 10:54:48,755 - INFO - transprompt_wrapper2 - 4
2021-05-12 10:56:25,082 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:56:32,036 - INFO - transprompt_wrapper2 - {'acc': 0.6354166666666666}
2021-05-12 10:56:32,036 - INFO - transprompt_wrapper2 - 5
2021-05-12 10:57:29,147 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:57:30,818 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 10:57:30,818 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 100
2021-05-12 10:57:30,818 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 10:57:55,524 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:58:02,067 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 10:58:02,067 - INFO - transprompt_wrapper2 - 6
2021-05-12 10:59:38,644 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 10:59:45,870 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 10:59:45,871 - INFO - transprompt_wrapper2 - 7
2021-05-12 11:01:13,907 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:01:15,614 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 11:01:15,615 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 200
2021-05-12 11:01:15,615 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:01:19,724 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:01:22,363 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 11:01:22,363 - INFO - transprompt_wrapper2 - 8
2021-05-12 11:02:49,909 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:02:56,781 - INFO - transprompt_wrapper2 - {'acc': 0.6354166666666666}
2021-05-12 11:02:56,781 - INFO - transprompt_wrapper2 - 9
2021-05-12 11:04:33,977 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:04:40,698 - INFO - transprompt_wrapper2 - {'acc': 0.6354166666666666}
2021-05-12 11:04:40,699 - INFO - transprompt_wrapper2 - 10
2021-05-12 11:04:40,703 - INFO - modeling - Saving complete
2021-05-12 11:04:40,703 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-12 11:04:40,703 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-12 11:04:40,812 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 11:04:49,320 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:04:50,028 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 11:04:50,028 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 300
2021-05-12 11:04:50,028 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:05:34,810 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-12 11:05:34,810 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-12 11:05:34,810 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-05-12 11:05:34,810 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:06:27,270 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:06:30,540 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:06:30,540 - INFO - transprompt_wrapper2 - best_dev_acc: 0.5833 | best_global_step: 100
2021-05-12 11:06:30,541 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:07:43,634 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:07:47,065 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:07:47,065 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 200
2021-05-12 11:07:47,065 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:07:50,196 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:07:50,961 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 11:07:50,961 - INFO - transprompt_wrapper2 - 3
2021-05-12 11:09:00,458 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:09:03,975 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 11:09:03,975 - INFO - transprompt_wrapper2 - 1
2021-05-12 11:09:56,526 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:09:59,748 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-12 11:09:59,749 - INFO - transprompt_wrapper2 - 2
2021-05-12 11:10:51,212 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:10:54,662 - INFO - transprompt_wrapper2 - {'acc': 0.5833333333333334}
2021-05-12 11:10:54,663 - INFO - transprompt_wrapper2 - 3
2021-05-12 11:11:02,065 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:11:03,480 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-12 11:11:03,480 - INFO - transprompt_wrapper2 - 4
2021-05-12 11:11:46,930 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:11:50,186 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:11:50,186 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 600
2021-05-12 11:11:50,186 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:13:02,934 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:13:06,491 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:13:06,491 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 700
2021-05-12 11:13:06,491 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:13:52,811 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:13:54,468 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-12 11:13:54,469 - INFO - transprompt_wrapper2 - 5
2021-05-12 11:14:20,056 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:14:23,631 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:14:23,631 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 800
2021-05-12 11:14:23,632 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:15:36,156 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:15:39,758 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:15:39,759 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 900
2021-05-12 11:15:39,759 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:16:53,356 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:16:55,098 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:16:56,376 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 11:16:56,376 - INFO - transprompt_wrapper2 - 6
2021-05-12 11:16:56,439 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:16:56,439 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 1000
2021-05-12 11:16:56,439 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:18:09,178 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:18:12,905 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:18:12,905 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 1100
2021-05-12 11:18:12,905 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:19:20,112 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:19:22,730 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 11:19:22,730 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6458 | best_global_step: 1200
2021-05-12 11:19:22,730 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:19:29,458 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:19:30,037 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 11:19:30,037 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 800
2021-05-12 11:19:30,037 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:19:45,461 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 11:20:42,523 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-05-12 11:20:42,523 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-21 (num_examples=-1, set_type=test)
2021-05-12 11:20:43,183 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('neutral', 6252), ('contradiction', 6453)]
2021-05-12 11:20:43,184 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-05-12 11:20:43,184 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:20:52,120 - INFO - transprompt_wrapper2 - Writing example 10000
2021-05-12 11:22:09,165 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:22:10,427 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 11:22:10,427 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 900
2021-05-12 11:22:10,427 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:24:59,794 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:25:00,735 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 11:25:00,735 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 1000
2021-05-12 11:25:00,735 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:27:56,730 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:27:58,011 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 11:27:58,011 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 1100
2021-05-12 11:27:58,011 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:28:18,057 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 11:29:16,003 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mrpc
2021-05-12 11:29:16,003 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MRPC/16-21 (num_examples=-1, set_type=test)
2021-05-12 11:29:16,072 - INFO - task_processors - Returning 408 test examples with label dist.: [(1, 279), (0, 129)]
2021-05-12 11:29:16,072 - INFO - modeling - Group g3: Task mrpc 's Test examples number: 408
2021-05-12 11:29:16,072 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:29:31,532 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=mrpc) ---
2021-05-12 11:29:31,532 - INFO - modeling - eval_results: {'acc': 0.7696078431372549}
2021-05-12 11:29:31,535 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task qqp =========
2021-05-12 11:29:31,535 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:31:07,690 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:31:08,672 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-05-12 11:31:08,672 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 100
2021-05-12 11:31:08,672 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:32:58,782 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:33:00,030 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-05-12 11:33:00,030 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 200
2021-05-12 11:33:00,030 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:34:56,783 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:34:58,034 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 11:34:58,034 - INFO - transprompt_wrapper2 - 1
2021-05-12 11:34:59,092 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 11:35:52,877 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task qqp
2021-05-12 11:35:52,877 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/QQP/16-21 (num_examples=-1, set_type=test)
2021-05-12 11:35:53,618 - INFO - task_processors - Returning 40429 test examples with label dist.: [(0, 25544), (1, 14885)]
2021-05-12 11:35:53,619 - INFO - modeling - Group g3: Task qqp 's Test examples number: 40429
2021-05-12 11:35:53,619 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:36:00,141 - INFO - transprompt_wrapper2 - Writing example 10000
2021-05-12 11:36:06,580 - INFO - transprompt_wrapper2 - Writing example 20000
2021-05-12 11:36:12,854 - INFO - transprompt_wrapper2 - Writing example 30000
2021-05-12 11:36:19,352 - INFO - transprompt_wrapper2 - Writing example 40000
2021-05-12 11:36:30,825 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-05-12 11:36:30,826 - INFO - modeling - eval_results: {'acc': 0.655367231638418}
2021-05-12 11:36:30,829 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-05-12 11:36:30,829 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:37:14,297 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:37:16,882 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 11:37:16,882 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 100
2021-05-12 11:37:16,882 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:38:21,014 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:38:23,877 - INFO - transprompt_wrapper2 - {'acc': 0.5833333333333334}
2021-05-12 11:38:23,877 - INFO - transprompt_wrapper2 - 1
2021-05-12 11:39:10,487 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:39:13,275 - INFO - transprompt_wrapper2 - {'acc': 0.6041666666666666}
2021-05-12 11:39:13,276 - INFO - transprompt_wrapper2 - 2
2021-05-12 11:39:59,645 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:40:02,369 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 11:40:02,369 - INFO - transprompt_wrapper2 - 3
2021-05-12 11:40:48,157 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:40:50,896 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 11:40:50,896 - INFO - transprompt_wrapper2 - 4
2021-05-12 11:41:37,486 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:41:40,116 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 11:41:40,116 - INFO - transprompt_wrapper2 - 5
2021-05-12 11:42:26,191 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:42:28,997 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 11:42:28,998 - INFO - transprompt_wrapper2 - 6
2021-05-12 11:43:15,234 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:43:18,082 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 11:43:18,082 - INFO - transprompt_wrapper2 - 7
2021-05-12 11:44:04,098 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:44:06,978 - INFO - transprompt_wrapper2 - {'acc': 0.7083333333333334}
2021-05-12 11:44:06,978 - INFO - transprompt_wrapper2 - 8
2021-05-12 11:44:47,469 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:44:49,893 - INFO - transprompt_wrapper2 - {'acc': 0.7083333333333334}
2021-05-12 11:44:49,894 - INFO - transprompt_wrapper2 - 9
2021-05-12 11:45:30,161 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:45:32,317 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 11:45:32,317 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 1100
2021-05-12 11:45:32,317 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 11:45:50,827 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 11:46:41,376 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-05-12 11:46:41,377 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-21 (num_examples=-1, set_type=test)
2021-05-12 11:46:41,811 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('contradiction', 3278), ('entailment', 3329)]
2021-05-12 11:46:41,824 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-05-12 11:46:41,824 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 11:55:59,559 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-05-12 11:55:59,559 - INFO - modeling - eval_results: {'acc': 0.6848201585043691}
2021-05-12 11:59:47,261 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=qqp) ---
2021-05-12 11:59:47,261 - INFO - modeling - eval_results: {'acc': 0.7700165722624849}
2021-05-12 14:00:41,067 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g2/16-42', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1200, pet_max_meta_steps=2000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=42, split_examples_evenly=False, task_name='g2', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-12 14:00:41,067 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=train)
2021-05-12 14:00:41,091 - INFO - task_processors - Returning 96 train examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-12 14:00:41,091 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g2/16-42 (num_examples=-1, set_type=dev)
2021-05-12 14:00:41,097 - INFO - task_processors - Returning 96 dev examples with label dist.: [('contradiction', 32), ('entailment', 32), ('neutral', 32)]
2021-05-12 14:00:41,098 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-12 14:00:41,098 - INFO - run_task_adaptation - text_a=You will also find that many well-known brand names of popular items may be less expensive here than at home.
2021-05-12 14:00:41,098 - INFO - run_task_adaptation - text_b=Popular brand names cost more here than at home.
2021-05-12 14:00:41,098 - INFO - run_task_adaptation - task=MNLI
2021-05-12 14:00:41,098 - INFO - run_task_adaptation - label=contradiction
2021-05-12 14:00:41,098 - INFO - run_task_adaptation - **********************************
2021-05-12 14:00:43,903 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 14:01:15,794 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-12 14:01:15,795 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:02:01,995 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:02:04,306 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-12 14:02:04,306 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6354 | best_global_step: 100
2021-05-12 14:02:04,306 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:03:12,325 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:03:14,469 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-12 14:03:14,469 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6875 | best_global_step: 200
2021-05-12 14:03:14,469 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:04:21,634 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:04:23,953 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 14:04:23,953 - INFO - transprompt_wrapper2 - 1
2021-05-12 14:05:10,429 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:05:12,872 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-05-12 14:05:12,873 - INFO - transprompt_wrapper2 - 2
2021-05-12 14:06:06,490 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:06:08,656 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-05-12 14:06:08,656 - INFO - transprompt_wrapper2 - 3
2021-05-12 14:06:54,015 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:06:56,101 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 14:06:56,101 - INFO - transprompt_wrapper2 - 4
2021-05-12 14:07:41,354 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:07:44,031 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 14:07:44,032 - INFO - transprompt_wrapper2 - 5
2021-05-12 14:08:30,142 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:08:32,343 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-05-12 14:08:32,343 - INFO - transprompt_wrapper2 - 6
2021-05-12 14:09:27,308 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:09:30,461 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-05-12 14:09:30,461 - INFO - transprompt_wrapper2 - 7
2021-05-12 14:10:20,351 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:10:22,624 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-05-12 14:10:22,624 - INFO - transprompt_wrapper2 - 8
2021-05-12 14:11:10,920 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-12 14:11:10,920 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=train)
2021-05-12 14:11:10,950 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-05-12 14:11:10,950 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=dev)
2021-05-12 14:11:10,953 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-05-12 14:11:10,954 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-12 14:11:10,954 - INFO - run_task_adaptation - text_a=Egypt , Mongolia , the Seychelles , Tunisia and at least three other governments have signed unpublicized agreements .
2021-05-12 14:11:10,954 - INFO - run_task_adaptation - text_b=At least seven other governments have signed agreements , but have asked not to have them publicized .
2021-05-12 14:11:10,954 - INFO - run_task_adaptation - task=MRPC
2021-05-12 14:11:10,954 - INFO - run_task_adaptation - label=0
2021-05-12 14:11:10,954 - INFO - run_task_adaptation - **********************************
2021-05-12 14:11:11,325 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:11:13,539 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 14:11:13,620 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-12 14:11:13,620 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6875 | best_global_step: 1100
2021-05-12 14:11:13,620 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:11:51,317 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-12 14:11:51,318 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:13:07,032 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:13:12,568 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2...
2021-05-12 14:13:12,569 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6979 | best_global_step: 1200
2021-05-12 14:13:12,569 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:13:20,130 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:13:21,575 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:13:21,575 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6406 | best_global_step: 100
2021-05-12 14:13:21,575 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:14:57,046 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:15:02,947 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-05-12 14:15:02,947 - INFO - transprompt_wrapper2 - 1
2021-05-12 14:15:10,177 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:15:14,017 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:15:14,017 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 200
2021-05-12 14:15:14,017 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:16:08,696 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:16:14,379 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-05-12 14:16:14,379 - INFO - transprompt_wrapper2 - 2
2021-05-12 14:16:59,423 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:17:04,320 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:17:04,320 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 300
2021-05-12 14:17:04,320 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:17:25,224 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:17:30,010 - INFO - transprompt_wrapper2 - {'acc': 0.6770833333333334}
2021-05-12 14:17:30,010 - INFO - transprompt_wrapper2 - 3
2021-05-12 14:18:50,148 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:18:53,771 - INFO - transprompt_wrapper2 - {'acc': 0.640625}
2021-05-12 14:18:53,771 - INFO - transprompt_wrapper2 - 2
2021-05-12 14:18:56,686 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:19:02,870 - INFO - transprompt_wrapper2 - {'acc': 0.6770833333333334}
2021-05-12 14:19:02,871 - INFO - transprompt_wrapper2 - 4
2021-05-12 14:20:20,913 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:20:25,681 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:20:25,681 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 500
2021-05-12 14:20:25,681 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:20:30,795 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:20:33,863 - INFO - transprompt_wrapper2 - {'acc': 0.6770833333333334}
2021-05-12 14:20:33,864 - INFO - transprompt_wrapper2 - 5
2021-05-12 14:21:58,179 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:22:03,546 - INFO - transprompt_wrapper2 - {'acc': 0.6770833333333334}
2021-05-12 14:22:03,546 - INFO - transprompt_wrapper2 - 6
2021-05-12 14:22:11,536 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:22:14,861 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:22:14,861 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 600
2021-05-12 14:22:14,861 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:23:07,703 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:23:13,085 - INFO - transprompt_wrapper2 - {'acc': 0.6770833333333334}
2021-05-12 14:23:13,086 - INFO - transprompt_wrapper2 - 7
2021-05-12 14:23:54,951 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:23:58,838 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:23:58,838 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 700
2021-05-12 14:23:58,838 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:24:19,345 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:24:23,567 - INFO - transprompt_wrapper2 - {'acc': 0.6770833333333334}
2021-05-12 14:24:23,567 - INFO - transprompt_wrapper2 - 8
2021-05-12 14:24:24,327 - INFO - modeling - Saving complete
2021-05-12 14:24:24,327 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-12 14:24:24,327 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-12 14:24:24,415 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 14:25:06,008 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:25:07,672 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:25:07,672 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 800
2021-05-12 14:25:07,672 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:25:15,768 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-12 14:25:15,768 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-12 14:25:15,768 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mnli =========
2021-05-12 14:25:15,768 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:25:53,059 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:25:55,665 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 14:25:55,665 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7083 | best_global_step: 100
2021-05-12 14:25:55,665 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:26:34,338 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:26:37,575 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:26:37,575 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 900
2021-05-12 14:26:37,575 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:26:50,957 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:26:52,120 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/mnli...
2021-05-12 14:26:52,120 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 200
2021-05-12 14:26:52,120 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:27:59,439 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:28:02,178 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-12 14:28:02,178 - INFO - transprompt_wrapper2 - 1
2021-05-12 14:28:06,363 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:28:09,523 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:28:09,523 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 1000
2021-05-12 14:28:09,523 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:28:31,039 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:28:31,407 - INFO - modeling - Saving complete
2021-05-12 14:28:31,407 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-12 14:28:31,407 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-12 14:28:31,489 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 14:28:32,433 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-05-12 14:28:32,434 - INFO - transprompt_wrapper2 - 2
2021-05-12 14:28:59,613 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:29:01,226 - INFO - transprompt_wrapper2 - {'acc': 0.6875}
2021-05-12 14:29:01,226 - INFO - transprompt_wrapper2 - 3
2021-05-12 14:29:16,285 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-12 14:29:16,285 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-12 14:29:16,285 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-05-12 14:29:16,285 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:29:41,399 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:29:44,466 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 14:29:44,466 - INFO - transprompt_wrapper2 - 4
2021-05-12 14:30:30,824 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:30:33,822 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-05-12 14:30:33,822 - INFO - transprompt_wrapper2 - 5
2021-05-12 14:31:09,267 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:31:10,298 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-05-12 14:31:10,298 - INFO - transprompt_wrapper2 - 6
2021-05-12 14:31:37,933 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:31:38,603 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g3/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g3', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-12 14:31:38,603 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=train)
2021-05-12 14:31:38,606 - INFO - task_processors - Returning 64 train examples with label dist.: [(0, 32), (1, 32)]
2021-05-12 14:31:38,606 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g3/16-21 (num_examples=-1, set_type=dev)
2021-05-12 14:31:38,608 - INFO - task_processors - Returning 64 dev examples with label dist.: [(0, 32), (1, 32)]
2021-05-12 14:31:38,608 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-12 14:31:38,608 - INFO - run_task_adaptation - text_a=Egypt , Mongolia , the Seychelles , Tunisia and at least three other governments have signed unpublicized agreements .
2021-05-12 14:31:38,608 - INFO - run_task_adaptation - text_b=At least seven other governments have signed agreements , but have asked not to have them publicized .
2021-05-12 14:31:38,608 - INFO - run_task_adaptation - task=MRPC
2021-05-12 14:31:38,608 - INFO - run_task_adaptation - label=0
2021-05-12 14:31:38,608 - INFO - run_task_adaptation - **********************************
2021-05-12 14:31:39,396 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-05-12 14:31:39,396 - INFO - transprompt_wrapper2 - 7
2021-05-12 14:31:41,356 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 14:32:05,143 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:32:06,267 - INFO - transprompt_wrapper2 - {'acc': 0.6458333333333334}
2021-05-12 14:32:06,268 - INFO - transprompt_wrapper2 - 8
2021-05-12 14:32:17,339 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-12 14:32:17,339 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:32:17,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:32:29,395 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:32:42,532 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:32:44,998 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:32:47,670 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 14:32:47,670 - INFO - transprompt_wrapper2 - 9
2021-05-12 14:32:54,056 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:33:05,776 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:33:20,469 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:33:33,300 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:33:34,777 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:33:37,336 - INFO - transprompt_wrapper2 - {'acc': 0.6666666666666666}
2021-05-12 14:33:37,336 - INFO - transprompt_wrapper2 - 10
2021-05-12 14:33:37,434 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 14:33:41,419 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:33:47,685 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:33:53,823 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:33:55,500 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:33:56,988 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:33:56,989 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6719 | best_global_step: 100
2021-05-12 14:33:56,989 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:34:23,139 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:34:29,341 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mnli
2021-05-12 14:34:29,341 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MNLI/16-42 (num_examples=-1, set_type=test)
2021-05-12 14:34:29,428 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:34:29,752 - INFO - task_processors - Returning 19647 test examples with label dist.: [('entailment', 6942), ('contradiction', 6453), ('neutral', 6252)]
2021-05-12 14:34:29,752 - INFO - modeling - Group g2: Task mnli 's Test examples number: 19647
2021-05-12 14:34:29,752 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:34:35,557 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:34:38,928 - INFO - transprompt_wrapper2 - Writing example 10000
2021-05-12 14:34:41,448 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:34:47,449 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:34:56,424 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:35:05,373 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:35:14,288 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:35:23,178 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:35:26,307 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:35:28,983 - INFO - transprompt_wrapper2 - {'acc': 0.609375}
2021-05-12 14:35:28,983 - INFO - transprompt_wrapper2 - 1
2021-05-12 14:35:34,943 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:35:44,582 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:35:53,701 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:36:02,865 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:36:12,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:36:24,567 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:36:34,263 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:36:43,303 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:36:52,778 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:36:56,645 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:36:59,224 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3...
2021-05-12 14:36:59,224 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6875 | best_global_step: 300
2021-05-12 14:36:59,224 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:37:26,176 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:37:35,708 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:37:44,792 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:37:53,614 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:38:03,512 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:38:15,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:38:26,693 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:38:36,535 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:38:45,613 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:38:50,178 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:38:53,277 - INFO - transprompt_wrapper2 - {'acc': 0.609375}
2021-05-12 14:38:53,277 - INFO - transprompt_wrapper2 - 1
2021-05-12 14:38:58,075 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:39:07,545 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:39:16,648 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:39:26,485 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:39:36,351 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:39:47,820 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:39:58,952 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:40:07,934 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:40:16,881 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:40:23,504 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:40:27,177 - INFO - transprompt_wrapper2 - {'acc': 0.578125}
2021-05-12 14:40:27,177 - INFO - transprompt_wrapper2 - 2
2021-05-12 14:40:32,048 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:40:43,076 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:40:52,387 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:41:01,437 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:41:10,263 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:41:19,933 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:41:29,631 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:41:38,750 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:41:47,691 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:41:53,694 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:41:56,239 - INFO - transprompt_wrapper2 - {'acc': 0.65625}
2021-05-12 14:41:56,240 - INFO - transprompt_wrapper2 - 3
2021-05-12 14:41:59,224 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:42:08,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:42:17,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:42:26,032 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:42:35,743 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:42:46,646 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:42:56,521 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:43:05,215 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:43:14,351 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:43:21,607 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:43:24,272 - INFO - transprompt_wrapper2 - {'acc': 0.671875}
2021-05-12 14:43:24,272 - INFO - transprompt_wrapper2 - 4
2021-05-12 14:43:27,267 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:43:38,863 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:43:48,974 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:43:57,639 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:44:06,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:44:16,043 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:44:26,210 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:44:37,484 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:44:47,274 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:44:54,530 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:44:57,012 - INFO - transprompt_wrapper2 - {'acc': 0.640625}
2021-05-12 14:44:57,012 - INFO - transprompt_wrapper2 - 5
2021-05-12 14:44:58,800 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:45:07,769 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:45:16,550 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:45:25,366 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:45:34,105 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:45:43,243 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:45:51,914 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:46:01,303 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:46:10,469 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:46:18,476 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:46:21,008 - INFO - transprompt_wrapper2 - {'acc': 0.640625}
2021-05-12 14:46:21,008 - INFO - transprompt_wrapper2 - 6
2021-05-12 14:46:22,132 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:46:33,201 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:46:44,673 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:46:55,466 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:47:05,180 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:47:14,603 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:47:23,473 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:47:32,912 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:47:42,836 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:47:51,657 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:47:54,084 - INFO - transprompt_wrapper2 - {'acc': 0.640625}
2021-05-12 14:47:54,084 - INFO - transprompt_wrapper2 - 7
2021-05-12 14:47:54,616 - INFO - modeling - Saving complete
2021-05-12 14:47:54,616 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-12 14:47:54,616 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-12 14:47:54,702 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 14:48:41,536 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-12 14:48:41,537 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-12 14:48:41,538 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task mrpc =========
2021-05-12 14:48:41,538 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:48:41,641 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:48:45,570 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:48:49,438 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:48:53,418 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:48:57,005 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:00,775 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:05,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:09,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:12,570 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:16,037 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:19,454 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:23,104 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:26,902 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:30,878 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:34,369 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:37,843 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:41,298 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:45,114 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:48,712 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:52,151 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:55,651 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:49:59,126 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:02,954 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:07,568 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:12,221 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:16,866 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:21,126 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:25,002 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:28,448 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:31,879 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:35,218 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:38,606 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:42,392 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:45,871 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:49,425 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:52,793 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:50:56,372 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:00,011 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:04,052 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:07,621 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:11,213 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:14,609 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:18,061 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:21,712 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:25,258 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:28,915 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:33,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:36,903 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:37,531 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=mnli) ---
2021-05-12 14:51:37,532 - INFO - modeling - eval_results: {'acc': 0.6627474932559678}
2021-05-12 14:51:37,534 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task snli =========
2021-05-12 14:51:37,534 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:51:41,732 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:46,626 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:51:51,038 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:51:52,312 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 14:51:52,312 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 100
2021-05-12 14:51:52,312 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:52:10,085 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:52:11,199 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:11,276 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 14:52:11,276 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6042 | best_global_step: 100
2021-05-12 14:52:11,276 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:52:13,609 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:16,080 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:18,583 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:20,972 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:23,267 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:25,630 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:28,017 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:30,508 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:35,068 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:39,719 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:44,321 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:48,708 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:53,248 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:52:58,830 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:04,652 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:10,382 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:16,190 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:17,812 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:53:20,952 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:21,011 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-12 14:53:21,011 - INFO - transprompt_wrapper2 - 1
2021-05-12 14:53:26,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:30,441 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:35,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:39,633 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:44,008 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:48,270 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:53,125 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:53:58,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:04,710 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:07,907 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:54:10,039 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:11,175 - INFO - transprompt_wrapper2 - {'acc': 0.5625}
2021-05-12 14:54:11,175 - INFO - transprompt_wrapper2 - 2
2021-05-12 14:54:15,463 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:21,349 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:27,139 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:32,931 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:38,117 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:42,567 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:46,881 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:52,130 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:54:57,134 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:00,256 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:55:01,571 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:02,951 - INFO - transprompt_wrapper2 - {'acc': 0.5833333333333334}
2021-05-12 14:55:02,951 - INFO - transprompt_wrapper2 - 3
2021-05-12 14:55:05,986 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:10,437 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:15,250 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:20,125 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:25,265 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:29,828 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:34,507 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:39,289 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:44,342 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:48,948 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:49,182 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:55:51,795 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 14:55:51,795 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 500
2021-05-12 14:55:51,795 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:55:52,413 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:55:54,736 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:55:55,314 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 14:55:55,314 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 200
2021-05-12 14:55:55,314 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:56:23,418 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:56:27,896 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:56:32,638 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:56:37,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:56:41,664 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:56:45,954 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:56:50,281 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:56:54,581 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:56:58,721 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:56:59,028 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:01,204 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 14:57:01,204 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 600
2021-05-12 14:57:01,204 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:57:02,126 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:04,399 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:06,759 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:09,175 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:11,579 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:13,976 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:16,572 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:19,143 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:22,734 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:27,595 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:32,358 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:37,334 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:41,696 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:46,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:51,512 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:57:57,013 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:02,841 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:07,227 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:07,858 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:58:10,741 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 14:58:10,742 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 700
2021-05-12 14:58:10,742 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:58:11,112 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:13,611 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:16,093 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:18,505 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:20,840 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:23,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:25,381 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:27,795 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:30,829 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:35,625 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:40,284 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:45,069 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:50,803 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:58:56,603 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:02,424 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:07,605 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:12,182 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:16,583 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:17,531 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:59:20,189 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 14:59:20,189 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 800
2021-05-12 14:59:20,189 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:59:20,429 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:23,001 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:25,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:27,813 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:31,033 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:33,330 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 14:59:33,906 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 14:59:33,906 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 300
2021-05-12 14:59:33,906 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 14:59:53,474 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 14:59:58,478 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:03,274 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:07,938 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:12,505 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:16,877 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:00:17,440 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:20,268 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 15:00:20,269 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 900
2021-05-12 15:00:20,269 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:00:21,540 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:24,764 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:27,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:30,873 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:33,883 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:36,515 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:39,190 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:43,205 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:47,608 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:51,965 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:00:56,397 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:00,893 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:05,638 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:10,347 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:15,403 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:19,894 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:24,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:25,251 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:01:27,841 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 15:01:27,842 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 1000
2021-05-12 15:01:27,842 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:01:28,398 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:31,029 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:33,745 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:36,518 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:39,410 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:42,444 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:45,387 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:49,155 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:53,649 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:01:58,192 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:02,944 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:07,481 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:12,070 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:16,809 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:21,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:26,233 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:30,894 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:32,061 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:02:34,907 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:34,949 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 15:02:34,949 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 1100
2021-05-12 15:02:34,949 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:02:37,274 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:39,553 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:41,986 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:44,528 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:47,066 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:49,474 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:52,010 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:54,331 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:02:57,585 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:02,547 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:03:03,734 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 15:03:03,734 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 400
2021-05-12 15:03:03,734 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:03:22,377 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:26,417 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:03:26,818 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:28,939 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g2/snli...
2021-05-12 15:03:28,939 - INFO - transprompt_wrapper2 - best_dev_acc: 0.7500 | best_global_step: 1200
2021-05-12 15:03:28,939 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:03:29,887 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:32,183 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:34,531 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:37,150 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:39,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:41,897 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:44,231 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:46,542 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:48,508 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 15:03:49,006 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:51,377 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:53,662 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:55,989 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:03:58,761 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:02,032 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:04,914 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:07,173 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:09,535 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:11,829 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:14,904 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:17,790 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:20,435 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:22,860 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:25,222 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:27,845 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:30,940 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:34,107 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:37,154 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:38,614 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task snli
2021-05-12 15:04:38,614 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SNLI/16-42 (num_examples=-1, set_type=test)
2021-05-12 15:04:38,687 - INFO - task_processors - Returning 9842 test examples with label dist.: [('neutral', 3235), ('entailment', 3329), ('contradiction', 3278)]
2021-05-12 15:04:38,701 - INFO - modeling - Group g2: Task snli 's Test examples number: 9842
2021-05-12 15:04:38,701 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:04:40,569 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:43,914 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:46,968 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:50,731 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:54,852 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:04:59,413 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:04,076 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:08,692 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:13,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:17,969 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:22,573 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:26,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:29,895 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:33,766 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:37,305 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:41,162 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:44,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:48,285 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:51,663 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:55,125 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:05:58,582 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:02,082 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:06:03,027 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 15:06:03,027 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 500
2021-05-12 15:06:03,028 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:06:21,717 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:25,321 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:29,260 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:32,857 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:36,432 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:39,911 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:43,525 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:47,198 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:50,871 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:54,544 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:06:58,120 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:01,698 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:05,515 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:08,975 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:12,579 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:16,198 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:20,243 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:24,008 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:27,766 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:31,433 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:35,140 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:39,624 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:44,159 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:48,737 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:53,302 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:07:57,706 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:01,833 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:05,784 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:10,353 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:14,999 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:19,632 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:24,286 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:28,873 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:33,012 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:36,554 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:40,154 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:43,663 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:47,405 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:51,136 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:54,856 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:08:58,609 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:02,247 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:05,712 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:09,265 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:13,192 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:17,079 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:20,830 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:24,791 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:28,468 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:32,076 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:35,502 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:09:36,469 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 15:09:36,469 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 600
2021-05-12 15:09:36,469 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:09:55,036 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:09:58,628 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:02,044 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:05,460 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:09,260 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:12,775 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:16,471 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:20,328 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:24,032 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:27,962 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:31,365 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:35,021 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:38,540 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:41,966 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:45,858 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:49,642 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:53,112 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:10:56,606 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:00,072 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:03,501 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:07,056 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:10,530 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:14,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:17,721 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:21,521 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:25,082 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:28,635 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:32,199 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:35,720 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:39,405 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:42,984 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:46,485 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:50,775 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:54,236 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:11:57,900 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:01,782 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:05,242 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:08,656 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:12,682 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:17,108 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:21,688 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:26,356 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:31,073 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:35,768 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:40,354 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:45,010 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:49,681 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:54,356 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:12:58,957 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:03,620 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:08,261 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:13:09,550 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 15:13:09,550 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 700
2021-05-12 15:13:09,551 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:13:12,597 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g2, Task=snli) ---
2021-05-12 15:13:12,597 - INFO - modeling - eval_results: {'acc': 0.7676285307864256}
2021-05-12 15:13:27,662 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:30,859 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:33,490 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:35,964 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:38,249 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:40,538 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:42,809 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:45,092 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:47,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:49,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:52,685 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:55,093 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:57,407 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:13:59,738 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:02,141 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:04,469 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:06,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:09,212 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:11,610 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:14,003 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:16,349 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:18,686 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:20,980 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:23,264 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:25,563 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:27,924 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:30,267 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:32,550 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:34,852 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:37,152 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:39,449 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:41,808 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:44,152 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:46,460 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:48,899 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:51,620 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:54,097 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:56,933 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:14:59,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:02,032 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:04,288 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:06,883 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:10,003 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:13,300 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:16,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:19,685 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:22,813 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:26,188 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:29,166 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:31,963 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:35,123 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:15:35,967 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 15:15:35,968 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 800
2021-05-12 15:15:35,968 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:15:54,120 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:56,694 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:15:59,392 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:02,083 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:04,651 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:07,365 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:10,105 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:12,477 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:14,932 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:17,366 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:19,817 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:22,122 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:24,560 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:27,119 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:29,506 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:31,910 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:34,262 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:36,539 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:38,836 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:41,086 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:43,514 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:45,826 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:48,101 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:50,460 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:52,725 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:55,007 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:57,302 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:16:59,602 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:02,044 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:04,695 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:07,084 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:09,591 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:11,972 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:14,298 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:16,598 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:18,923 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:21,245 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:23,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:26,177 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:28,585 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:30,952 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:33,289 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:35,591 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:37,890 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:40,198 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:42,900 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:45,233 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:47,529 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:49,906 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:52,233 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:17:54,529 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:17:55,118 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 15:17:55,118 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 900
2021-05-12 15:17:55,118 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:18:13,255 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:15,539 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:17,898 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:20,223 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:22,661 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:24,943 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:27,247 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:29,551 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:32,098 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:34,408 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:36,747 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:39,146 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:41,630 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:43,982 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:46,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:48,644 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:50,923 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:53,185 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:55,541 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:18:57,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:00,488 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:02,953 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:05,346 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:07,667 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:09,968 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:12,393 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:14,673 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:16,930 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:19,132 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:21,528 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:24,074 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:26,691 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:29,211 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:31,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:34,211 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:36,592 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:38,929 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:41,225 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:43,766 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:46,104 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:48,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:50,812 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:53,169 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:55,742 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:19:58,796 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:01,587 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:03,997 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:06,253 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:08,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:10,895 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:13,141 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:20:13,754 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 15:20:13,754 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 1000
2021-05-12 15:20:13,754 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:20:31,783 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:34,462 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:37,144 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:39,812 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:42,451 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:44,760 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:47,139 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:49,432 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:51,718 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:54,008 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:56,294 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:20:58,661 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:01,014 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:03,514 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:06,379 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:08,957 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:11,369 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:14,314 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:17,373 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:19,904 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:22,310 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:24,678 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:27,240 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:29,570 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:31,884 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:34,162 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:36,448 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:38,725 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:41,063 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:43,675 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:46,123 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:49,120 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:51,526 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:53,785 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:56,007 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:21:58,274 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:00,853 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:03,206 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:05,481 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:07,824 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:10,250 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:12,510 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:14,849 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:17,149 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:19,464 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:21,813 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:24,135 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:26,404 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:28,667 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:30,965 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:22:33,275 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:22:33,853 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/mrpc...
2021-05-12 15:22:33,853 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 1100
2021-05-12 15:22:33,853 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:22:52,081 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 15:23:38,753 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task mrpc
2021-05-12 15:23:38,753 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/MRPC/16-21 (num_examples=-1, set_type=test)
2021-05-12 15:23:38,775 - INFO - task_processors - Returning 408 test examples with label dist.: [(1, 279), (0, 129)]
2021-05-12 15:23:38,775 - INFO - modeling - Group g3: Task mrpc 's Test examples number: 408
2021-05-12 15:23:38,775 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:23:49,409 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=mrpc) ---
2021-05-12 15:23:49,409 - INFO - modeling - eval_results: {'acc': 0.7598039215686274}
2021-05-12 15:23:49,411 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task qqp =========
2021-05-12 15:23:49,411 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:23:49,451 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:23:52,293 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:23:55,030 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:23:57,914 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:00,778 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:03,521 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:06,175 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:08,974 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:11,922 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:14,688 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:17,584 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:20,366 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:23,113 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:25,829 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:28,523 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:31,165 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:33,819 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:36,598 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:40,291 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:44,133 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:48,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:51,966 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:55,873 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:24:58,983 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:01,816 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:04,539 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:25:05,133 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-05-12 15:25:05,133 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 100
2021-05-12 15:25:05,133 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:25:24,126 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:26,810 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:29,577 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:32,251 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:34,950 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:37,727 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:40,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:43,295 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:46,088 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:48,818 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:51,572 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:54,706 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:25:58,637 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:02,542 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:06,484 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:10,451 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:14,400 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:18,340 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:22,316 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:26,266 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:30,209 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:34,179 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:38,028 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:40,789 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:43,523 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:46,487 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:26:47,054 - INFO - transprompt_wrapper2 - {'acc': 0.625}
2021-05-12 15:26:47,054 - INFO - transprompt_wrapper2 - 1
2021-05-12 15:26:47,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:49,734 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:52,387 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:55,034 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:26:57,650 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:00,352 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:03,048 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:05,921 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:08,761 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:11,465 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:14,092 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:16,778 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:19,442 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:22,211 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:25,308 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:28,060 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:30,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:33,424 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:36,118 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:38,804 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:41,708 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:44,669 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:47,453 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:50,413 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:53,155 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:27:55,823 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:27:56,394 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g3/qqp...
2021-05-12 15:27:56,394 - INFO - transprompt_wrapper2 - best_dev_acc: 0.6562 | best_global_step: 300
2021-05-12 15:27:56,394 - INFO - transprompt_wrapper2 - Saving models.
2021-05-12 15:28:14,696 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-12 15:28:15,924 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-12 15:29:04,076 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task qqp
2021-05-12 15:29:04,077 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/QQP/16-21 (num_examples=-1, set_type=test)
2021-05-12 15:29:04,812 - INFO - task_processors - Returning 40429 test examples with label dist.: [(0, 25544), (1, 14885)]
2021-05-12 15:29:04,813 - INFO - modeling - Group g3: Task qqp 's Test examples number: 40429
2021-05-12 15:29:04,813 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-12 15:29:11,086 - INFO - transprompt_wrapper2 - Writing example 10000
2021-05-12 15:29:17,115 - INFO - transprompt_wrapper2 - Writing example 20000
2021-05-12 15:29:22,976 - INFO - transprompt_wrapper2 - Writing example 30000
2021-05-12 15:29:28,076 - INFO - transprompt_wrapper2 - Writing example 40000
2021-05-12 15:41:31,930 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g3, Task=qqp) ---
2021-05-12 15:41:31,931 - INFO - modeling - eval_results: {'acc': 0.7043706250463776}
2021-05-13 11:31:37,850 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-13 11:31:37,850 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-13 11:31:37,853 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-13 11:31:37,853 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-13 11:31:37,855 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-13 11:31:37,855 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-13 11:31:37,855 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-13 11:31:37,855 - INFO - run_task_adaptation - text_b=None
2021-05-13 11:31:37,855 - INFO - run_task_adaptation - task=SST-2
2021-05-13 11:31:37,855 - INFO - run_task_adaptation - label=0
2021-05-13 11:31:37,855 - INFO - run_task_adaptation - **********************************
2021-05-13 11:31:40,664 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:32:05,369 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0005, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-13 11:32:05,369 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-13 11:32:05,373 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-13 11:32:05,374 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-13 11:32:05,376 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-13 11:32:05,376 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-13 11:32:05,376 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-13 11:32:05,376 - INFO - run_task_adaptation - text_b=None
2021-05-13 11:32:05,376 - INFO - run_task_adaptation - task=SST-2
2021-05-13 11:32:05,376 - INFO - run_task_adaptation - label=0
2021-05-13 11:32:05,376 - INFO - run_task_adaptation - **********************************
2021-05-13 11:32:08,397 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:32:12,556 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-13 11:32:12,557 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:32:12,690 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:32:19,088 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:32:25,415 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:32:31,625 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:32:38,224 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:32:41,802 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-13 11:32:41,802 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:32:41,906 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:32:46,879 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:32:54,708 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:32:59,497 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:33:04,722 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:33:06,891 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:33:08,183 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-13 11:33:08,183 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-13 11:33:08,183 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:33:13,779 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:33:24,758 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:33:31,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:33:38,236 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:33:43,658 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:33:48,993 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:33:50,282 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:33:52,443 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-13 11:33:52,443 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8229 | best_global_step: 100
2021-05-13 11:33:52,443 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:33:57,467 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:03,627 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:09,819 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:15,973 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:22,921 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:23,698 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:34:27,182 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-13 11:34:27,182 - INFO - transprompt_wrapper2 - 1
2021-05-13 11:34:32,118 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:34,724 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:44,621 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:47,433 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:34:57,286 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:00,013 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:09,901 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:12,786 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:22,265 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:25,367 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:33,244 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:35:34,439 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:36,770 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-13 11:35:36,770 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 200
2021-05-13 11:35:36,770 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:35:40,399 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:35:41,794 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-13 11:35:41,794 - INFO - transprompt_wrapper2 - 2
2021-05-13 11:35:43,032 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:49,244 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:35:57,401 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:04,937 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:06,948 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:17,552 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:19,496 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:30,080 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:32,028 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:42,578 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:44,772 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:36:48,539 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-13 11:36:48,540 - INFO - transprompt_wrapper2 - 3
2021-05-13 11:36:48,541 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:36:54,003 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:00,978 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:06,608 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:13,465 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:16,633 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:37:20,437 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-13 11:37:20,437 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 300
2021-05-13 11:37:20,437 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:37:22,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:29,127 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:35,309 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:41,366 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:43,727 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:37:45,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:47,286 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-13 11:37:47,286 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-13 11:37:47,287 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:37:52,571 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:37:58,781 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:05,004 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:11,194 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:18,523 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:23,723 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:30,743 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:36,366 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:38:40,154 - INFO - transprompt_wrapper2 - {'acc': 0.8645833333333334}
2021-05-13 11:38:40,154 - INFO - transprompt_wrapper2 - 2
2021-05-13 11:38:40,155 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:42,307 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:52,705 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:38:54,877 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:05,291 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:07,313 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:17,866 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:19,812 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:27,509 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:39:29,872 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:31,065 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-13 11:39:31,065 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-13 11:39:31,065 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:39:36,632 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:42,810 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:45,225 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:39:46,611 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-13 11:39:46,611 - INFO - transprompt_wrapper2 - 3
2021-05-13 11:39:50,558 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:59,063 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:39:59,432 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:11,572 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:11,825 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:24,040 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:24,276 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:36,502 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:36,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:48,964 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:49,195 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:40:56,383 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:41:00,095 - INFO - transprompt_wrapper2 - {'acc': 0.8229166666666666}
2021-05-13 11:41:00,095 - INFO - transprompt_wrapper2 - 4
2021-05-13 11:41:00,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:04,862 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:10,770 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:41:14,409 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-13 11:41:14,409 - INFO - transprompt_wrapper2 - 1
2021-05-13 11:41:16,919 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:16,983 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:29,245 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:29,497 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:41,734 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:42,011 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:54,230 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:41:54,493 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:06,733 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:06,989 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:16,950 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:42:18,733 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:20,557 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-13 11:42:20,558 - INFO - transprompt_wrapper2 - 5
2021-05-13 11:42:22,992 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:30,722 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:42:34,393 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-13 11:42:34,393 - INFO - transprompt_wrapper2 - 2
2021-05-13 11:42:34,394 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:34,911 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:46,895 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:47,507 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:42:59,529 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:00,097 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:12,222 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:12,760 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:24,897 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:25,114 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:37,343 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:37,556 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:43:40,967 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-13 11:43:40,967 - INFO - transprompt_wrapper2 - 6
2021-05-13 11:43:40,968 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:48,988 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:53,407 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:43:54,201 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:43:57,818 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-13 11:43:57,818 - INFO - transprompt_wrapper2 - 3
2021-05-13 11:44:05,131 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:05,431 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:17,633 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:17,902 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:30,204 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:30,474 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:42,690 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:42,983 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:55,223 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:44:55,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:45:00,115 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:45:03,696 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-13 11:45:03,697 - INFO - transprompt_wrapper2 - 7
2021-05-13 11:45:07,232 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:45:10,790 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:45:14,896 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:45:18,599 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-13 11:45:18,599 - INFO - transprompt_wrapper2 - 4
2021-05-13 11:45:19,209 - INFO - modeling - Saving complete
2021-05-13 11:45:19,209 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-13 11:45:19,209 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-13 11:45:19,290 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:45:21,023 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:45:27,205 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:45:33,330 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:45:39,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:45:45,642 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:45:49,189 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:45:50,525 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-13 11:45:50,525 - INFO - transprompt_wrapper2 - 8
2021-05-13 11:45:50,827 - INFO - modeling - Saving complete
2021-05-13 11:45:50,828 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-13 11:45:50,828 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-13 11:45:50,912 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:46:06,752 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-13 11:46:06,752 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-13 11:46:06,753 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-13 11:46:06,753 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:46:06,791 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:10,825 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:14,304 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:17,612 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:21,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:24,865 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:28,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:29,240 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:46:29,738 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-13 11:46:29,738 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-13 11:46:29,739 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:46:35,073 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-13 11:46:35,074 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-13 11:46:35,074 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-13 11:46:35,074 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:46:35,113 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:38,885 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:42,527 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:46,131 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:49,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:53,085 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:56,204 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:46:59,007 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:02,183 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:04,568 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:47:05,010 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:05,604 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-13 11:47:05,604 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-13 11:47:05,604 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:47:08,995 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:12,173 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:15,324 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:17,190 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:47:17,670 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-13 11:47:17,670 - INFO - transprompt_wrapper2 - 1
2021-05-13 11:47:19,277 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:22,945 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:26,617 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:31,207 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:31,895 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:37,540 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:37,878 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:43,868 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:43,965 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:48,706 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:47:49,701 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:49,840 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-13 11:47:49,840 - INFO - transprompt_wrapper2 - 2
2021-05-13 11:47:50,164 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:47:53,380 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:56,858 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:47:58,757 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:47:59,205 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-13 11:47:59,205 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9688 | best_global_step: 200
2021-05-13 11:47:59,205 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:48:22,425 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:48:25,548 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:48:28,962 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:48:32,498 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:48:36,121 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:48:39,545 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:48:41,202 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-13 11:48:41,202 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-13 11:48:41,483 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-13 11:48:41,483 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-13 11:48:41,483 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:48:42,057 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:48:42,820 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-13 11:48:42,821 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9688 | best_global_step: 300
2021-05-13 11:48:42,821 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:48:54,212 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-13 11:48:54,212 - INFO - modeling - eval_results: {'acc': 0.9231651376146789}
2021-05-13 11:48:54,215 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-13 11:48:54,216 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:48:54,265 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:48:58,235 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:02,535 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:03,845 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:49:07,000 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:11,325 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:15,441 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:19,107 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:20,421 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:49:20,928 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-13 11:49:20,928 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-13 11:49:20,929 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:49:43,426 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:47,724 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:52,071 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:56,090 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:49:56,844 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-13 11:49:56,845 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-13 11:49:56,854 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-13 11:49:56,855 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-13 11:49:56,855 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:50:00,551 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:05,883 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:08,946 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:50:09,917 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-13 11:50:09,917 - INFO - transprompt_wrapper2 - 1
2021-05-13 11:50:12,183 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:17,598 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:23,022 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:27,252 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-13 11:50:27,252 - INFO - modeling - eval_results: {'acc': 0.9243119266055045}
2021-05-13 11:50:27,254 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-13 11:50:27,255 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:50:27,300 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:28,375 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:33,575 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:34,672 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:39,887 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:40,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:45,880 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:50:46,111 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:46,880 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-13 11:50:46,880 - INFO - transprompt_wrapper2 - 2
2021-05-13 11:50:47,236 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:50:50,290 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:53,931 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:57,558 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:50:58,784 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:50:59,280 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-13 11:50:59,281 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8438 | best_global_step: 100
2021-05-13 11:50:59,281 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:51:22,553 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:51:25,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:51:29,530 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:51:33,215 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:51:36,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:51:38,994 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-13 11:51:38,995 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-13 11:51:39,008 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-13 11:51:39,009 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-13 11:51:39,009 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:51:39,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:51:42,534 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:51:43,475 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-13 11:51:43,475 - INFO - transprompt_wrapper2 - 1
2021-05-13 11:51:45,752 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:51:51,158 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:51:56,545 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:01,988 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:07,400 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:12,806 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:17,092 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:52:18,064 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-13 11:52:18,065 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8438 | best_global_step: 300
2021-05-13 11:52:18,065 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:52:29,878 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-13 11:52:29,878 - INFO - modeling - eval_results: {'acc': 0.849}
2021-05-13 11:52:29,882 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-13 11:52:29,882 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:52:29,928 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:33,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:37,147 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:38,911 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:52:40,728 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:44,097 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:47,491 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:51,038 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:52:52,287 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:52:52,779 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-13 11:52:52,779 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-13 11:52:52,779 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:53:15,432 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:53:19,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:53:23,705 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:53:27,913 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:53:31,078 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-13 11:53:31,079 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-13 11:53:31,203 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-13 11:53:31,204 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-13 11:53:31,204 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:53:31,874 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:53:36,638 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:53:39,821 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:53:40,764 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-13 11:53:40,764 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-13 11:53:40,764 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:54:02,619 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:08,082 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:11,171 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-13 11:54:11,171 - INFO - modeling - eval_results: {'acc': 0.8565}
2021-05-13 11:54:11,173 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-13 11:54:11,173 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:54:11,264 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:13,651 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:17,845 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:19,831 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:24,221 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:26,205 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:30,622 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:32,601 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:37,058 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:37,742 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:54:38,870 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-13 11:54:38,870 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-13 11:54:38,870 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:54:41,584 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:45,413 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:54:46,709 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:54:47,203 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-13 11:54:47,203 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-13 11:54:47,203 - INFO - transprompt_wrapper2 - Saving models.
2021-05-13 11:55:01,263 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:55:18,396 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:22,070 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:25,807 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:29,502 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:33,281 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:37,091 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:39,216 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:55:39,742 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-13 11:55:39,742 - INFO - transprompt_wrapper2 - 1
2021-05-13 11:55:41,295 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:45,067 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:48,760 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:51,280 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-13 11:55:51,281 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-13 11:55:51,302 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-13 11:55:51,304 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-13 11:55:51,304 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:55:52,546 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:55:57,542 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:56:03,032 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-13 11:56:07,379 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:56:08,315 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-13 11:56:08,315 - INFO - transprompt_wrapper2 - 2
2021-05-13 11:56:08,667 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-13 11:56:29,848 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-13 11:56:29,848 - INFO - modeling - eval_results: {'acc': 0.9025}
2021-05-13 11:56:56,703 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-13 11:56:56,704 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-13 11:56:56,717 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-13 11:56:56,719 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-13 11:56:56,719 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-13 11:57:24,885 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-13 11:57:24,886 - INFO - modeling - eval_results: {'acc': 0.9025}
2021-05-15 04:37:01,111 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 04:37:01,111 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 04:37:01,115 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 04:37:01,115 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 04:37:01,117 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 04:37:01,117 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 04:37:01,117 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 04:37:01,117 - INFO - run_task_adaptation - text_b=None
2021-05-15 04:37:01,117 - INFO - run_task_adaptation - task=SST-2
2021-05-15 04:37:01,117 - INFO - run_task_adaptation - label=0
2021-05-15 04:37:01,117 - INFO - run_task_adaptation - **********************************
2021-05-15 04:37:03,482 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 04:37:32,266 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 04:37:32,266 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:37:32,370 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:37:38,635 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:37:44,857 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:37:50,995 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:37:57,143 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:38:03,336 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:38:09,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:38:11,994 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:38:13,431 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 04:38:13,431 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 04:38:13,431 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:38:41,140 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:38:47,336 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:38:53,613 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:38:59,801 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:05,982 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:12,119 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:15,809 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:39:17,264 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 04:39:17,264 - INFO - transprompt_wrapper2 - 1
2021-05-15 04:39:19,793 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:26,063 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:32,296 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:38,503 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:44,777 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:51,040 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:39:55,974 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:39:57,381 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 04:39:57,381 - INFO - transprompt_wrapper2 - 2
2021-05-15 04:39:58,634 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:04,846 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:11,093 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:17,383 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:23,650 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:29,862 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:36,182 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:40:37,612 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 04:40:37,612 - INFO - transprompt_wrapper2 - 3
2021-05-15 04:40:37,612 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:43,894 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:50,198 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:40:56,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:41:02,745 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:41:08,980 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:41:15,179 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:41:17,560 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:41:18,911 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 04:41:18,911 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 04:41:18,912 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:41:45,454 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:41:51,635 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:41:57,827 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:42:04,074 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:42:10,352 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:42:16,626 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:42:20,350 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:42:21,792 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 04:42:21,792 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 04:42:21,792 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:42:48,066 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:42:54,280 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:00,299 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:06,281 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:12,444 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:18,686 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:23,558 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:43:25,011 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 04:43:25,011 - INFO - transprompt_wrapper2 - 1
2021-05-15 04:43:26,263 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:32,548 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:38,821 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:44,974 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:51,159 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:43:57,456 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:03,674 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:44:05,049 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 04:44:05,049 - INFO - transprompt_wrapper2 - 2
2021-05-15 04:44:05,049 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:11,125 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:17,396 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:23,577 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:29,597 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:35,712 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:41,745 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:44,145 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:44:45,544 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 04:44:45,544 - INFO - transprompt_wrapper2 - 3
2021-05-15 04:44:49,282 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:44:55,257 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:45:01,473 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:45:07,500 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:45:13,436 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:45:19,431 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:45:22,999 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:45:24,380 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 04:45:24,380 - INFO - transprompt_wrapper2 - 4
2021-05-15 04:45:24,678 - INFO - modeling - Saving complete
2021-05-15 04:45:24,678 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 04:45:24,678 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 04:45:24,765 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 04:46:14,263 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 04:46:14,264 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 04:46:14,264 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 04:46:14,264 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:46:14,304 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:46:17,992 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:46:21,674 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:46:25,351 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:46:29,024 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:46:32,616 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:46:35,954 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:46:37,167 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:46:37,682 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 04:46:37,682 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 04:46:37,682 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:47:00,523 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:03,918 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:07,634 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:11,371 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:15,095 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:18,820 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:20,884 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:47:21,372 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 04:47:21,372 - INFO - transprompt_wrapper2 - 1
2021-05-15 04:47:22,972 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:26,486 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:29,836 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:33,324 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:37,099 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:40,724 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:47:43,662 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:47:44,170 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 04:47:44,170 - INFO - transprompt_wrapper2 - 2
2021-05-15 04:47:44,508 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 04:48:38,177 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 04:48:38,178 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 04:48:38,453 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 04:48:38,453 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 04:48:38,453 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:48:51,015 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 04:48:51,015 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 04:48:51,017 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 04:48:51,017 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:48:51,061 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:48:54,644 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:48:58,431 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:02,158 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:05,900 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:09,462 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:13,097 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:14,380 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:49:14,886 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 04:49:14,886 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 04:49:14,886 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:49:38,062 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:41,643 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:45,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:48,798 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:52,333 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:55,810 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:49:57,754 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:49:58,237 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 04:49:58,237 - INFO - transprompt_wrapper2 - 1
2021-05-15 04:49:59,828 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:50:03,493 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:50:06,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:50:10,547 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:50:14,202 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:50:17,978 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:50:20,949 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:50:21,443 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 04:50:21,443 - INFO - transprompt_wrapper2 - 2
2021-05-15 04:50:21,790 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 04:51:12,051 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 04:51:12,051 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 04:51:12,066 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 04:51:12,067 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 04:51:12,067 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:51:41,164 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 04:51:41,164 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 04:51:41,167 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 04:51:41,167 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:51:41,209 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:51:44,937 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:51:48,657 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:51:52,341 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:51:55,977 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:51:59,536 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:52:03,210 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:52:04,498 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:52:05,029 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 04:52:05,029 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 04:52:05,029 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:52:28,481 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:52:31,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:52:35,460 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:52:38,931 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:52:42,422 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:52:46,155 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:52:48,163 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:52:48,614 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 04:52:48,614 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 04:52:48,614 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:53:10,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:53:14,176 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:53:17,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:53:21,502 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:53:25,307 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:53:29,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:53:32,082 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:53:32,570 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 04:53:32,571 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 04:53:32,571 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:53:53,518 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 04:54:47,434 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 04:54:47,435 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 04:54:47,450 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 04:54:47,452 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 04:54:47,452 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:55:16,525 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 04:55:16,525 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 04:55:21,176 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 04:55:21,176 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 04:55:21,179 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 04:55:21,179 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 04:55:21,181 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 04:55:21,181 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 04:55:21,181 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 04:55:21,181 - INFO - run_task_adaptation - text_b=None
2021-05-15 04:55:21,181 - INFO - run_task_adaptation - task=SST-2
2021-05-15 04:55:21,181 - INFO - run_task_adaptation - label=0
2021-05-15 04:55:21,181 - INFO - run_task_adaptation - **********************************
2021-05-15 04:55:23,518 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 04:55:53,940 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 04:55:53,941 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:55:54,072 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:56:00,559 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:56:06,933 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:56:13,294 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:56:19,655 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:56:25,897 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:56:32,190 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:56:34,623 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:56:36,087 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 04:56:36,087 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 04:56:36,087 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 04:57:03,633 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:57:09,871 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:57:16,082 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:57:22,260 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:57:28,497 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:57:34,749 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:57:38,448 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:57:39,883 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 04:57:39,883 - INFO - transprompt_wrapper2 - 1
2021-05-15 04:57:42,374 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:57:48,590 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:57:54,709 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:00,882 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:07,127 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:13,377 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:18,323 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:58:19,780 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 04:58:19,780 - INFO - transprompt_wrapper2 - 2
2021-05-15 04:58:21,056 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:27,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:33,627 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:39,814 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:45,939 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:52,197 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:58:58,484 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:58:59,913 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 04:58:59,914 - INFO - transprompt_wrapper2 - 3
2021-05-15 04:58:59,914 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:59:06,207 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:59:12,457 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:59:18,748 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:59:24,965 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:59:31,220 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:59:37,535 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 04:59:39,965 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 04:59:41,384 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 04:59:41,384 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 04:59:41,384 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:00:09,206 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:00:15,410 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:00:21,696 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:00:27,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:00:34,199 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:00:40,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:00:44,106 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:00:45,558 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 05:00:45,558 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 05:00:45,558 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:01:11,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:01:17,406 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:01:23,624 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:01:29,864 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:01:36,064 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:01:42,328 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:01:47,317 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:01:48,743 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:01:48,743 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:01:49,989 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:01:56,216 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:02,434 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:08,689 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:14,943 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:21,183 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:27,425 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:02:28,827 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 05:02:28,827 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:02:28,828 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:35,073 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:41,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:47,687 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:02:53,966 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:00,224 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:06,512 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:08,938 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:03:10,338 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 05:03:10,338 - INFO - transprompt_wrapper2 - 3
2021-05-15 05:03:14,120 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:20,364 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:26,638 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:32,923 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:39,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:45,320 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:03:48,994 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:03:50,425 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 05:03:50,425 - INFO - transprompt_wrapper2 - 4
2021-05-15 05:03:50,734 - INFO - modeling - Saving complete
2021-05-15 05:03:50,735 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 05:03:50,735 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 05:03:50,831 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:04:39,708 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 05:04:39,708 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 05:04:39,708 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 05:04:39,708 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:04:39,748 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:04:43,335 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:04:47,043 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:04:50,823 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:04:54,614 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:04:58,333 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:01,981 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:03,270 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:05:03,774 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 05:05:03,774 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 05:05:03,774 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:05:25,869 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:29,172 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:32,374 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:35,363 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:38,658 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:42,471 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:44,611 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:05:45,112 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 05:05:45,113 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:05:46,736 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:50,480 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:54,138 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:05:57,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:06:01,496 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:06:05,189 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:06:08,146 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:06:08,651 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 05:06:08,651 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:06:08,988 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:07:04,005 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 05:07:04,005 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 05:07:04,321 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 05:07:04,321 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 05:07:04,321 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:07:16,829 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 05:07:16,829 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 05:07:16,831 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 05:07:16,831 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:07:16,875 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:07:20,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:07:23,842 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:07:27,544 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:07:31,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:07:34,926 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:07:38,664 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:07:39,939 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:07:40,437 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 05:07:40,437 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 05:07:40,437 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:08:03,247 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:06,972 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:10,731 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:14,401 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:17,976 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:21,781 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:23,922 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:08:24,435 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:08:24,435 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:08:26,089 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:29,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:33,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:37,279 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:41,007 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:44,652 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:08:47,413 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:08:47,921 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:08:47,921 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:08:48,211 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:09:43,953 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 05:09:43,953 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 05:09:43,967 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 05:09:43,967 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 05:09:43,967 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:10:12,957 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 05:10:12,957 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 05:10:12,959 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 05:10:12,959 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:10:13,001 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:10:16,551 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:10:20,313 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:10:24,083 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:10:27,718 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:10:31,117 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:10:34,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:10:36,006 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:10:36,521 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:10:36,521 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 05:10:36,521 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:10:59,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:03,443 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:07,318 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:11,127 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:14,904 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:18,707 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:20,823 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:11:21,310 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:11:21,310 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 05:11:21,310 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:11:43,368 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:47,202 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:50,944 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:54,631 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:11:58,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:12:02,256 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:12:05,231 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:12:05,734 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:12:05,734 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 05:12:05,734 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:12:26,787 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:13:23,197 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 05:13:23,197 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 05:13:23,213 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 05:13:23,215 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 05:13:23,215 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:13:53,064 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 05:13:53,064 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 05:13:57,805 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 05:13:57,805 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 05:13:57,808 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 05:13:57,808 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 05:13:57,810 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 05:13:57,810 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 05:13:57,810 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 05:13:57,810 - INFO - run_task_adaptation - text_b=None
2021-05-15 05:13:57,810 - INFO - run_task_adaptation - task=SST-2
2021-05-15 05:13:57,810 - INFO - run_task_adaptation - label=0
2021-05-15 05:13:57,810 - INFO - run_task_adaptation - **********************************
2021-05-15 05:14:00,165 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:14:30,632 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 05:14:30,632 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:14:30,758 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:14:41,742 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:14:54,086 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:15:05,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:15:12,410 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:15:18,564 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:15:25,105 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:15:29,931 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:15:33,341 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 05:15:33,341 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 05:15:33,341 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:16:04,261 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:16:10,972 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:16:23,096 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:16:35,159 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:16:45,544 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:16:51,588 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:16:55,129 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:17:01,207 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 05:17:01,208 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:17:04,965 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:17:17,176 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:17:29,405 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:17:38,762 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:17:45,077 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:17:51,346 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:17:58,380 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:18:01,738 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 05:18:01,738 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:18:04,124 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:18:16,318 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:18:27,644 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:18:34,087 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:18:40,397 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:18:47,539 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:18:59,691 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:19:03,300 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 05:19:03,301 - INFO - transprompt_wrapper2 - 3
2021-05-15 05:19:03,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:19:15,430 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:19:23,162 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:19:29,413 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:19:35,676 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:19:46,474 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:19:58,707 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:20:03,577 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:20:06,895 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 05:20:06,895 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 05:20:06,895 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:20:47,994 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:21:00,150 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:21:09,173 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:21:15,443 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:21:25,146 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:21:37,629 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:21:45,427 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:21:48,726 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 05:21:48,726 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 05:21:48,726 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:22:26,490 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:22:32,760 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:22:38,957 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:22:45,235 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:22:51,522 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:22:57,721 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:23:03,010 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:23:05,499 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:23:05,500 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:23:06,720 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:23:13,012 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:23:19,334 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:23:25,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:23:31,790 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:23:37,866 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:23:43,944 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:23:45,344 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 05:23:45,344 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:23:45,344 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:23:51,486 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:24:01,595 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:24:12,264 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:24:22,579 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:24:32,012 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:24:42,508 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:24:46,706 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:24:49,736 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 05:24:49,736 - INFO - transprompt_wrapper2 - 3
2021-05-15 05:24:55,982 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:25:06,469 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:25:16,960 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:25:27,459 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:25:36,896 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:25:47,251 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:25:53,580 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:25:56,617 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 05:25:56,617 - INFO - transprompt_wrapper2 - 4
2021-05-15 05:25:57,095 - INFO - modeling - Saving complete
2021-05-15 05:25:57,095 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 05:25:57,096 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 05:25:57,192 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:26:51,676 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 05:26:51,676 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 05:26:51,676 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 05:26:51,676 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:26:51,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:26:57,014 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:27:03,172 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:27:09,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:27:15,754 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:27:21,812 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:27:26,935 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:27:28,212 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:27:28,746 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 05:27:28,746 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 05:27:28,746 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:28:04,237 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:10,419 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:16,743 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:23,274 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:29,005 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:35,278 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:38,817 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:28:39,906 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 05:28:39,906 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:28:42,355 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:48,690 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:54,715 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:28:59,698 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:29:03,324 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:29:07,075 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:29:09,947 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:29:10,442 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 05:29:10,442 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:29:10,744 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:30:02,184 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 05:30:02,184 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 05:30:02,520 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 05:30:02,520 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 05:30:02,520 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:30:24,391 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 05:30:24,391 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 05:30:24,394 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 05:30:24,394 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:30:24,437 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:30:28,051 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:30:31,826 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:30:35,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:30:40,997 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:30:47,103 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:30:53,223 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:30:55,531 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:30:56,634 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 05:30:56,635 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 05:30:56,635 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:31:23,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:31:27,567 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:31:32,717 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:31:39,001 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:31:45,113 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:31:51,224 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:31:54,811 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:31:55,891 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:31:55,891 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:31:58,448 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:32:04,264 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:32:10,805 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:32:17,125 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:32:23,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:32:29,701 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:32:34,102 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:32:35,198 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:32:35,199 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:32:35,628 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:33:25,811 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 05:33:25,811 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 05:33:25,824 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 05:33:25,825 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 05:33:25,825 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:33:55,605 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 05:33:55,605 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 05:33:55,608 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 05:33:55,608 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:33:55,650 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:33:59,447 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:03,310 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:07,159 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:10,724 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:15,476 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:19,365 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:20,682 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:34:21,189 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:34:21,189 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 05:34:21,189 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:34:46,081 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:49,662 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:53,289 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:34:57,050 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:35:00,904 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:35:04,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:35:06,631 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:35:07,140 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:35:07,141 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 05:35:07,141 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:35:30,744 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:35:36,219 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:35:41,616 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:35:47,085 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:35:52,482 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:35:57,886 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:36:02,145 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:36:03,138 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:36:03,138 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 05:36:03,138 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:36:24,464 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:37:16,135 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 05:37:16,136 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 05:37:16,150 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 05:37:16,152 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 05:37:16,152 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:38:03,461 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 05:38:03,461 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 05:38:12,521 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 05:38:12,521 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 05:38:12,525 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 05:38:12,525 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 05:38:12,526 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 05:38:12,526 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 05:38:12,527 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 05:38:12,527 - INFO - run_task_adaptation - text_b=None
2021-05-15 05:38:12,527 - INFO - run_task_adaptation - task=SST-2
2021-05-15 05:38:12,527 - INFO - run_task_adaptation - label=0
2021-05-15 05:38:12,527 - INFO - run_task_adaptation - **********************************
2021-05-15 05:38:15,135 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:38:44,871 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 05:38:44,871 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:38:44,978 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:38:57,264 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:39:09,019 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:39:21,297 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:39:33,577 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:39:41,749 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:39:47,987 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:39:50,372 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:39:51,843 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 05:39:51,843 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 05:39:51,843 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:40:22,251 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:40:34,482 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:40:46,652 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:40:58,147 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:41:10,403 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:41:22,539 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:41:29,208 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:41:32,749 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 05:41:32,749 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:41:37,590 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:41:49,894 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:42:01,615 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:42:13,786 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:42:25,963 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:42:37,415 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:42:47,149 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:42:50,387 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 05:42:50,388 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:42:52,769 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:04,728 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:12,094 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:18,323 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:24,551 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:30,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:37,030 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:43:38,562 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 05:43:38,562 - INFO - transprompt_wrapper2 - 3
2021-05-15 05:43:38,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:44,777 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:51,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:43:57,558 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:44:05,039 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:44:11,179 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:44:17,373 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:44:19,757 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:44:21,129 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 05:44:21,129 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 05:44:21,129 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:44:50,728 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:44:58,561 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:45:08,773 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:45:18,962 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:45:28,053 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:45:38,229 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:45:44,374 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:45:47,236 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 05:45:47,236 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 05:45:47,236 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:46:15,254 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:46:25,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:46:35,753 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:46:46,040 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:46:56,282 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:47:06,582 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:47:14,567 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:47:15,993 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:47:15,994 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:47:17,282 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:47:23,430 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:47:29,670 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:47:35,927 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:47:42,139 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:47:48,751 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:47:57,558 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:48:01,121 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 05:48:01,121 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:48:01,121 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:48:13,375 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:48:25,099 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:48:31,878 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:48:38,144 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:48:44,400 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:48:55,181 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:49:00,179 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:49:03,982 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 05:49:03,982 - INFO - transprompt_wrapper2 - 3
2021-05-15 05:49:11,316 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:49:20,782 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:49:26,949 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:49:33,156 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:49:42,314 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:49:54,391 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:50:01,721 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:50:05,028 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 05:50:05,028 - INFO - transprompt_wrapper2 - 4
2021-05-15 05:50:05,583 - INFO - modeling - Saving complete
2021-05-15 05:50:05,583 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 05:50:05,583 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 05:50:05,683 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:50:55,797 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 05:50:55,797 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 05:50:55,797 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 05:50:55,797 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:50:55,838 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:50:59,309 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:51:03,302 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:51:09,480 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:51:15,504 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:51:21,811 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:51:28,081 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:51:30,512 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:51:31,514 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 05:51:31,515 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 05:51:31,515 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:52:03,875 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:10,036 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:16,042 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:22,210 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:28,239 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:33,958 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:36,502 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:52:37,052 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 05:52:37,052 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:52:38,731 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:42,488 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:46,031 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:49,728 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:52:53,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:53:00,518 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:53:05,787 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:53:06,949 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 05:53:06,949 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:53:07,395 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:54:00,261 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 05:54:00,261 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 05:54:00,576 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 05:54:00,576 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 05:54:00,576 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:54:25,123 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 05:54:25,123 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 05:54:25,199 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 05:54:25,200 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:54:25,249 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:54:28,773 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:54:32,202 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:54:35,428 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:54:39,305 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:54:45,938 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:54:52,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:54:54,690 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:54:55,826 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 05:54:55,826 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 05:54:55,826 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:55:23,696 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:27,030 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:30,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:34,041 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:37,072 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:40,102 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:41,841 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:55:42,305 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:55:42,305 - INFO - transprompt_wrapper2 - 1
2021-05-15 05:55:43,624 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:46,689 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:49,714 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:52,821 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:55:56,552 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:56:00,298 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:56:03,275 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:56:03,778 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 05:56:03,778 - INFO - transprompt_wrapper2 - 2
2021-05-15 05:56:04,081 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 05:56:56,363 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 05:56:56,363 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 05:56:56,379 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 05:56:56,379 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 05:56:56,379 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:57:25,297 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 05:57:25,298 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 05:57:25,299 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 05:57:25,300 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:57:25,342 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:57:28,880 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:57:33,836 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:57:39,228 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:57:44,575 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:57:49,970 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:57:55,354 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:57:57,379 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:57:58,358 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:57:58,358 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 05:57:58,358 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:58:22,342 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:58:27,749 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:58:33,193 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:58:38,528 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:58:43,247 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:58:48,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:58:51,874 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:58:52,920 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:58:52,920 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 05:58:52,920 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:59:15,177 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:59:18,712 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:59:22,296 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:59:26,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:59:29,784 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:59:33,585 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 05:59:36,534 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 05:59:37,018 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 05:59:37,018 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 05:59:37,018 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 05:59:57,495 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:00:47,796 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 06:00:47,797 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 06:00:47,813 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 06:00:47,815 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 06:00:47,815 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:01:31,349 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 06:01:31,349 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 06:01:36,261 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 06:01:36,261 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 06:01:36,264 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 06:01:36,264 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 06:01:36,266 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 06:01:36,266 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 06:01:36,266 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 06:01:36,266 - INFO - run_task_adaptation - text_b=None
2021-05-15 06:01:36,266 - INFO - run_task_adaptation - task=SST-2
2021-05-15 06:01:36,266 - INFO - run_task_adaptation - label=0
2021-05-15 06:01:36,266 - INFO - run_task_adaptation - **********************************
2021-05-15 06:01:38,817 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:02:08,287 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 06:02:08,287 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:02:08,391 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:02:20,697 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:02:32,240 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:02:44,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:02:56,898 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:03:08,484 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:03:20,829 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:03:25,672 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:03:29,065 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 06:03:29,065 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 06:03:29,065 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:03:59,361 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:04:11,673 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:04:23,125 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:04:35,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:04:47,931 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:04:57,978 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:01,706 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:05:03,177 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 06:05:03,177 - INFO - transprompt_wrapper2 - 1
2021-05-15 06:05:05,694 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:11,950 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:18,206 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:24,363 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:30,632 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:36,874 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:41,841 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:05:44,177 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 06:05:44,177 - INFO - transprompt_wrapper2 - 2
2021-05-15 06:05:45,882 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:52,113 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:05:58,372 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:06:04,646 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:06:10,848 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:06:17,112 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:06:23,387 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:06:24,800 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 06:06:24,801 - INFO - transprompt_wrapper2 - 3
2021-05-15 06:06:24,801 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:06:31,100 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:06:37,292 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:06:46,618 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:06:56,925 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:07:07,251 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:07:16,424 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:07:20,546 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:07:23,311 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 06:07:23,311 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 06:07:23,311 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:07:53,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:08:03,441 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:08:13,823 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:08:24,028 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:08:34,388 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:08:44,642 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:08:50,882 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:08:53,865 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 06:08:53,865 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 06:08:53,865 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:09:20,403 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:09:26,672 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:09:33,342 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:09:45,126 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:09:57,299 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:10:08,504 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:10:13,440 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:10:14,889 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 06:10:14,889 - INFO - transprompt_wrapper2 - 1
2021-05-15 06:10:16,102 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:10:22,355 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:10:31,035 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:10:43,367 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:10:55,601 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:11:03,560 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:11:09,847 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:11:11,276 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 06:11:11,276 - INFO - transprompt_wrapper2 - 2
2021-05-15 06:11:11,277 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:11:17,534 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:11:29,470 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:11:41,865 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:11:52,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:11:58,596 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:12:04,830 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:12:07,268 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:12:08,675 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 06:12:08,675 - INFO - transprompt_wrapper2 - 3
2021-05-15 06:12:15,848 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:12:28,195 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:12:40,137 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:12:52,089 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:13:04,361 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:13:15,905 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:13:23,311 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:13:26,582 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 06:13:26,582 - INFO - transprompt_wrapper2 - 4
2021-05-15 06:13:27,125 - INFO - modeling - Saving complete
2021-05-15 06:13:27,125 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 06:13:27,125 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 06:13:27,213 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:15:12,732 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 06:15:12,733 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 06:15:12,733 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 06:15:12,733 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:15:12,779 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:15:16,724 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:15:20,460 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:15:24,132 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:15:27,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:15:31,426 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:15:35,152 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:15:36,416 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:15:36,930 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 06:15:36,930 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 06:15:36,930 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:15:59,630 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:03,273 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:07,378 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:10,785 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:13,896 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:17,026 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:19,114 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:16:19,676 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 06:16:19,677 - INFO - transprompt_wrapper2 - 1
2021-05-15 06:16:21,249 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:25,076 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:28,813 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:32,517 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:36,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:39,831 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:16:42,559 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:16:43,058 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 06:16:43,058 - INFO - transprompt_wrapper2 - 2
2021-05-15 06:16:43,374 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:18:40,563 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 06:18:40,563 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 06:18:40,888 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 06:18:40,888 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 06:18:40,888 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:18:59,013 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 06:18:59,013 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 06:18:59,016 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 06:18:59,016 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:18:59,061 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:19:04,403 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:19:09,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:19:15,174 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:19:19,749 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:19:24,985 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:19:30,358 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:19:32,341 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:19:33,323 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 06:19:33,323 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 06:19:33,323 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:19:58,518 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:03,833 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:09,209 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:14,672 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:19,974 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:25,319 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:28,409 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:20:29,427 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 06:20:29,428 - INFO - transprompt_wrapper2 - 1
2021-05-15 06:20:31,678 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:37,007 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:42,305 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:47,738 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:53,133 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:20:58,668 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:21:01,599 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:21:02,099 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 06:21:02,099 - INFO - transprompt_wrapper2 - 2
2021-05-15 06:21:02,463 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:22:53,769 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 06:22:53,769 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 06:22:53,783 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 06:22:53,783 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 06:22:53,784 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:23:22,807 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 06:23:22,808 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 06:23:22,809 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 06:23:22,810 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:23:22,850 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:23:26,605 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:23:30,668 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:23:37,021 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:23:43,479 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:23:50,146 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:23:56,363 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:23:58,854 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:23:59,985 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 06:23:59,985 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 06:23:59,985 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:24:36,603 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:24:42,900 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:24:49,079 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:24:55,356 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:24:59,912 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:25:03,812 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:25:05,883 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:25:06,362 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 06:25:06,362 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 06:25:06,362 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:25:33,800 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:25:39,966 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:25:46,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:25:52,271 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:25:57,174 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:26:01,001 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:26:03,919 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:26:09,082 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 06:26:09,083 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 06:26:09,083 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:26:31,077 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:28:24,513 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 06:28:24,514 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 06:28:24,528 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 06:28:24,530 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 06:28:24,530 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:29:29,749 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 06:29:29,749 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 06:29:34,391 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 06:29:34,392 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 06:29:34,396 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 06:29:34,396 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 06:29:34,398 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 06:29:34,398 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 06:29:34,398 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 06:29:34,398 - INFO - run_task_adaptation - text_b=None
2021-05-15 06:29:34,398 - INFO - run_task_adaptation - task=SST-2
2021-05-15 06:29:34,398 - INFO - run_task_adaptation - label=0
2021-05-15 06:29:34,398 - INFO - run_task_adaptation - **********************************
2021-05-15 06:30:30,611 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:31:55,255 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 06:31:55,256 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:31:55,372 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:32:01,910 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:32:08,218 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:32:14,500 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:32:20,734 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:32:26,959 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:32:33,211 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:32:35,640 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:32:37,131 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 06:32:37,131 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 06:32:37,132 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:33:07,512 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:33:18,395 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:33:28,050 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:33:38,926 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:33:49,808 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:34:00,441 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:34:06,788 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:34:09,717 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 06:34:09,717 - INFO - transprompt_wrapper2 - 1
2021-05-15 06:34:13,982 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:34:24,656 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:34:34,467 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:34:45,165 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:34:55,699 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:35:06,063 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:35:14,262 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:35:17,146 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 06:35:17,146 - INFO - transprompt_wrapper2 - 2
2021-05-15 06:35:19,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:35:29,408 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:35:39,712 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:35:45,977 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:35:52,209 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:35:58,440 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:36:04,717 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:36:06,158 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 06:36:06,159 - INFO - transprompt_wrapper2 - 3
2021-05-15 06:36:06,159 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:36:12,364 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:36:18,665 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:36:24,930 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:36:31,261 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:36:37,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:36:43,735 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:36:46,183 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:36:47,599 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 06:36:47,599 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 06:36:47,599 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:37:18,313 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:37:24,573 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:37:30,742 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:37:36,831 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:37:43,077 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:37:49,314 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:37:53,045 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:37:54,571 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 06:37:54,571 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 06:37:54,571 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:38:23,531 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:38:32,095 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:38:38,443 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:38:44,723 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:38:54,973 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:39:07,228 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:39:16,752 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:39:19,651 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 06:39:19,651 - INFO - transprompt_wrapper2 - 1
2021-05-15 06:39:21,842 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:39:34,084 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:39:46,361 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:39:57,942 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:40:10,131 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:40:22,375 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:40:34,002 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:40:37,301 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 06:40:37,301 - INFO - transprompt_wrapper2 - 2
2021-05-15 06:40:37,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:40:49,502 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:41:01,381 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:41:13,542 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:41:25,917 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:41:37,714 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:41:50,103 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:41:54,975 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:41:58,397 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 06:41:58,397 - INFO - transprompt_wrapper2 - 3
2021-05-15 06:42:05,710 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:42:17,352 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:42:29,720 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:42:41,527 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:42:53,721 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:43:05,974 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:43:13,298 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:43:16,111 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 06:43:16,111 - INFO - transprompt_wrapper2 - 4
2021-05-15 06:43:16,716 - INFO - modeling - Saving complete
2021-05-15 06:43:16,716 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 06:43:16,716 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 06:43:16,810 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:44:59,183 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 06:44:59,183 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 06:44:59,183 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 06:44:59,183 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:44:59,227 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:03,199 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:06,793 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:10,563 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:14,255 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:17,958 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:22,614 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:23,858 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:45:24,389 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 06:45:24,389 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 06:45:24,389 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:45:46,862 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:50,649 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:54,473 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:45:58,325 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:01,979 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:05,763 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:07,958 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:46:08,468 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 06:46:08,468 - INFO - transprompt_wrapper2 - 1
2021-05-15 06:46:10,059 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:13,613 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:17,474 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:21,300 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:25,027 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:28,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:46:31,690 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:46:32,199 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 06:46:32,199 - INFO - transprompt_wrapper2 - 2
2021-05-15 06:46:32,537 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:48:19,433 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 06:48:19,434 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 06:48:19,812 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 06:48:19,812 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 06:48:19,812 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:48:32,325 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 06:48:32,325 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 06:48:32,391 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 06:48:32,391 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:48:32,435 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:48:36,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:48:39,653 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:48:43,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:48:47,174 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:48:51,008 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:48:54,874 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:48:56,194 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:48:56,711 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 06:48:56,711 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 06:48:56,711 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:49:20,336 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:24,166 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:27,990 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:31,804 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:35,349 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:38,968 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:41,121 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:49:41,632 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 06:49:41,633 - INFO - transprompt_wrapper2 - 1
2021-05-15 06:49:43,297 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:47,131 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:50,841 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:54,619 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:49:58,336 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:50:01,902 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:50:04,822 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:50:05,333 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 06:50:05,333 - INFO - transprompt_wrapper2 - 2
2021-05-15 06:50:05,727 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:51:53,995 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 06:51:53,996 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 06:51:54,010 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 06:51:54,011 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 06:51:54,011 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:52:58,771 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 06:52:58,771 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 06:52:58,774 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 06:52:58,774 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:52:58,817 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:53:02,654 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:53:06,470 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:53:10,149 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:53:15,071 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:53:21,637 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:53:28,355 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:53:30,770 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:53:31,879 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 06:53:31,879 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 06:53:31,879 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:54:02,810 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:54:07,513 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:54:14,136 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:54:20,475 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:54:26,806 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:54:33,128 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:54:36,509 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:54:37,521 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 06:54:37,522 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 06:54:37,522 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:55:12,168 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:55:18,370 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:55:24,573 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:55:30,738 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:55:36,409 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:55:40,395 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 06:55:43,460 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:55:43,963 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 06:55:43,964 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 06:55:43,964 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 06:56:10,615 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 06:57:59,352 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 06:57:59,352 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 06:57:59,367 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 06:57:59,369 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 06:57:59,369 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 06:58:29,326 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 06:58:29,326 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 06:58:33,951 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 06:58:33,951 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 06:58:33,954 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 06:58:33,954 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 06:58:33,956 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 06:58:33,956 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 06:58:33,956 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 06:58:33,956 - INFO - run_task_adaptation - text_b=None
2021-05-15 06:58:33,956 - INFO - run_task_adaptation - task=SST-2
2021-05-15 06:58:33,957 - INFO - run_task_adaptation - label=0
2021-05-15 06:58:33,957 - INFO - run_task_adaptation - **********************************
2021-05-15 06:59:30,205 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:01:05,005 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 07:01:05,005 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:01:05,119 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:01:15,589 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:01:24,598 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:01:35,091 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:01:45,593 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:01:56,153 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:02:06,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:02:10,858 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:02:13,931 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 07:02:13,932 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 07:02:13,932 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:02:43,979 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:02:54,333 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:03,746 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:10,037 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:16,368 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:22,591 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:26,346 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:03:27,764 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 07:03:27,764 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:03:30,307 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:36,597 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:42,868 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:49,123 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:03:55,362 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:01,632 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:06,595 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:04:08,011 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 07:04:08,011 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:04:09,242 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:15,516 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:21,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:28,197 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:34,484 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:40,744 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:47,051 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:04:48,466 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 07:04:48,467 - INFO - transprompt_wrapper2 - 3
2021-05-15 07:04:48,467 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:04:54,769 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:05:01,097 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:05:07,391 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:05:13,600 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:05:19,819 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:05:26,522 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:05:29,092 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:05:31,396 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 07:05:31,397 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 07:05:31,397 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:05:58,261 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:06:04,496 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:06:13,364 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:06:25,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:06:38,393 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:06:45,866 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:06:49,585 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:06:50,986 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 07:06:50,986 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 07:06:50,986 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:07:19,747 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:07:32,205 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:07:44,531 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:07:56,303 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:08:08,642 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:08:20,869 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:08:28,764 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:08:30,243 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 07:08:30,243 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:08:31,506 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:08:37,742 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:08:45,027 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:08:57,372 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:09:09,572 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:09:19,922 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:09:26,285 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:09:27,691 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 07:09:27,691 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:09:27,691 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:09:33,872 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:09:44,401 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:09:56,595 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:10:08,610 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:10:20,765 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:10:33,161 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:10:38,143 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:10:41,002 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 07:10:41,003 - INFO - transprompt_wrapper2 - 3
2021-05-15 07:10:48,120 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:11:00,337 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:11:12,643 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:11:24,310 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:11:36,620 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:11:48,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:11:52,836 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:11:54,271 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 07:11:54,272 - INFO - transprompt_wrapper2 - 4
2021-05-15 07:11:54,586 - INFO - modeling - Saving complete
2021-05-15 07:11:54,586 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 07:11:54,586 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 07:11:54,672 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:13:47,358 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 07:13:47,359 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 07:13:47,359 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 07:13:47,359 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:13:47,401 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:13:51,454 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:13:55,302 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:13:59,079 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:02,954 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:06,739 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:10,621 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:11,919 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:14:12,449 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 07:14:12,449 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 07:14:12,449 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:14:36,088 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:39,917 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:43,703 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:47,528 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:51,347 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:54,750 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:14:56,842 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:14:57,390 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 07:14:57,390 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:14:59,029 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:15:02,820 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:15:06,529 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:15:10,299 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:15:14,082 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:15:17,793 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:15:20,579 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:15:21,097 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 07:15:21,097 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:15:21,432 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:17:07,988 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 07:17:07,988 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 07:17:08,263 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 07:17:08,263 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 07:17:08,264 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:17:20,839 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 07:17:20,839 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 07:17:20,841 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 07:17:20,841 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:17:20,947 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:17:24,745 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:17:28,536 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:17:32,372 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:17:36,249 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:17:40,108 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:17:43,952 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:17:45,214 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:17:45,729 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 07:17:45,729 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 07:17:45,729 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:18:10,519 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:14,197 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:17,959 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:21,802 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:25,624 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:29,413 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:31,537 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:18:32,023 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 07:18:32,023 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:18:33,756 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:37,587 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:41,279 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:45,128 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:48,838 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:52,614 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:18:55,436 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:18:55,928 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 07:18:55,928 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:18:56,280 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:20:44,593 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 07:20:44,594 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 07:20:44,610 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 07:20:44,610 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 07:20:44,611 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:21:30,835 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 07:21:30,835 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 07:21:30,838 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 07:21:30,838 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:21:30,886 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:21:34,559 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:21:39,693 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:21:46,493 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:21:53,282 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:21:59,678 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:22:05,858 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:22:07,945 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:22:08,614 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 07:22:08,614 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 07:22:08,614 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:22:45,239 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:22:51,951 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:22:58,766 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:23:04,851 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:23:08,935 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:23:12,865 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:23:15,006 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:23:15,496 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 07:23:15,496 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 07:23:15,496 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:23:41,582 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:23:47,908 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:23:53,064 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:23:56,754 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:24:00,535 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:24:04,358 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:24:07,348 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:24:07,850 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 07:24:07,851 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 07:24:07,851 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:24:29,619 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:26:19,727 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 07:26:19,727 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 07:26:19,741 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 07:26:19,743 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 07:26:19,743 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:26:49,213 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 07:26:49,213 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 07:26:54,124 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 07:26:54,124 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 07:26:54,127 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 07:26:54,128 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 07:26:54,129 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 07:26:54,129 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 07:26:54,129 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 07:26:54,129 - INFO - run_task_adaptation - text_b=None
2021-05-15 07:26:54,130 - INFO - run_task_adaptation - task=SST-2
2021-05-15 07:26:54,130 - INFO - run_task_adaptation - label=0
2021-05-15 07:26:54,130 - INFO - run_task_adaptation - **********************************
2021-05-15 07:27:50,381 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:29:24,163 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 07:29:24,164 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:29:24,277 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:29:34,994 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:29:45,348 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:29:55,974 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:30:06,510 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:30:16,940 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:30:27,164 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:30:30,869 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:30:33,203 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 07:30:33,203 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 07:30:33,203 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:31:02,409 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:08,815 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:14,938 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:20,952 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:26,938 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:32,879 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:36,468 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:31:37,848 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 07:31:37,849 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:31:40,320 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:46,628 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:52,983 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:31:59,316 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:05,652 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:11,962 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:16,900 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:32:18,355 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 07:32:18,355 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:32:19,613 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:25,918 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:32,201 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:38,471 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:44,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:50,914 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:32:57,254 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:32:58,705 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 07:32:58,705 - INFO - transprompt_wrapper2 - 3
2021-05-15 07:32:58,705 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:33:05,008 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:33:11,299 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:33:17,639 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:33:24,034 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:33:31,120 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:33:43,698 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:33:48,647 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:33:51,908 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 07:33:51,908 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 07:33:51,908 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:34:30,085 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:34:42,300 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:34:53,728 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:35:05,927 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:35:18,132 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:35:29,606 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:35:36,901 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:35:40,142 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 07:35:40,142 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 07:35:40,142 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:36:09,600 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:36:15,854 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:36:28,044 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:36:40,176 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:36:50,794 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:36:57,068 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:37:02,105 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:37:06,459 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 07:37:06,459 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:37:07,715 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:37:19,547 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:37:31,765 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:37:42,706 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:37:48,988 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:37:55,233 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:38:03,207 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:38:06,482 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 07:38:06,483 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:38:06,483 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:38:18,577 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:38:30,688 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:38:37,907 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:38:44,175 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:38:50,422 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:39:02,666 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:39:07,518 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:39:10,806 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 07:39:10,806 - INFO - transprompt_wrapper2 - 3
2021-05-15 07:39:18,175 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:39:29,680 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:39:41,752 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:39:54,172 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:40:05,950 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:40:18,310 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:40:25,643 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:40:28,645 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 07:40:28,645 - INFO - transprompt_wrapper2 - 4
2021-05-15 07:40:29,123 - INFO - modeling - Saving complete
2021-05-15 07:40:29,123 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 07:40:29,123 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 07:40:29,209 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:42:20,439 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 07:42:20,440 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 07:42:20,440 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 07:42:20,440 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:42:20,483 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:42:24,809 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:42:28,522 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:42:32,294 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:42:35,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:42:39,395 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:42:42,824 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:42:44,139 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:42:44,679 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 07:42:44,679 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 07:42:44,679 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:43:08,584 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:12,352 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:16,182 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:19,850 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:23,659 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:27,493 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:29,620 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:43:30,127 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 07:43:30,127 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:43:31,744 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:35,323 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:38,523 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:42,077 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:45,763 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:49,197 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:43:52,139 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:43:52,635 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 07:43:52,635 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:43:52,966 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:45:44,441 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 07:45:44,441 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 07:45:44,758 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 07:45:44,758 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 07:45:44,758 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:45:57,408 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 07:45:57,408 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 07:45:57,410 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 07:45:57,411 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:45:57,456 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:00,664 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:04,429 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:08,081 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:11,818 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:15,420 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:19,073 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:20,365 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:46:20,884 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 07:46:20,884 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 07:46:20,884 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:46:44,021 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:47,737 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:51,403 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:55,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:46:58,805 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:47:02,515 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:47:04,558 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:47:05,062 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 07:47:05,063 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:47:06,727 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:47:10,426 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:47:14,225 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:47:17,875 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:47:21,731 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:47:25,622 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:47:28,814 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:47:29,445 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 07:47:29,445 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:47:29,915 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:48:51,244 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 07:48:51,244 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 07:48:51,260 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 07:48:51,261 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 07:48:51,261 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:49:32,856 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 07:49:32,856 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 07:49:32,859 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 07:49:32,859 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:49:32,933 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:49:39,525 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:49:45,573 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:49:50,208 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:49:54,616 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:50:05,461 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:50:11,603 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:50:14,053 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:50:15,153 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 07:50:15,153 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 07:50:15,154 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:50:40,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:50:44,418 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:50:48,100 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:50:53,620 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:51:00,008 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:51:06,505 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:51:10,406 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:51:11,526 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 07:51:11,526 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 07:51:11,526 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:51:42,205 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:51:47,550 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:51:54,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:52:00,521 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:52:06,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:52:13,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:52:17,343 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:52:17,872 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 07:52:17,872 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 07:52:17,872 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:52:49,512 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:53:45,898 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 07:53:45,898 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 07:53:45,913 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 07:53:45,914 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 07:53:45,915 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:54:32,302 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 07:54:32,302 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 07:54:37,271 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 07:54:37,271 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 07:54:37,274 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 07:54:37,274 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 07:54:37,276 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 07:54:37,276 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 07:54:37,276 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 07:54:37,276 - INFO - run_task_adaptation - text_b=None
2021-05-15 07:54:37,276 - INFO - run_task_adaptation - task=SST-2
2021-05-15 07:54:37,276 - INFO - run_task_adaptation - label=0
2021-05-15 07:54:37,276 - INFO - run_task_adaptation - **********************************
2021-05-15 07:54:39,597 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 07:55:09,935 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 07:55:09,936 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:55:10,041 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:55:16,378 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:55:22,518 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:55:28,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:55:35,224 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:55:41,433 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:55:47,589 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:55:50,020 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:55:51,432 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 07:55:51,432 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 07:55:51,432 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 07:56:21,640 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:56:27,903 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:56:34,147 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:56:40,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:56:46,366 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:56:52,449 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:56:56,078 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:56:57,448 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 07:56:57,448 - INFO - transprompt_wrapper2 - 1
2021-05-15 07:56:59,891 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:57:06,172 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:57:15,091 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:57:25,378 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:57:35,691 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:57:45,004 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:57:53,359 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:57:56,333 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 07:57:56,333 - INFO - transprompt_wrapper2 - 2
2021-05-15 07:57:58,410 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:58:08,814 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:58:19,260 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:58:29,780 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:58:40,208 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:58:50,406 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:58:59,966 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 07:59:02,810 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 07:59:02,810 - INFO - transprompt_wrapper2 - 3
2021-05-15 07:59:02,811 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:59:13,124 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:59:23,874 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:59:34,255 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:59:44,686 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 07:59:55,088 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:00:03,433 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:00:05,905 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:00:07,333 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 08:00:07,333 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 08:00:07,333 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:00:34,881 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:00:41,307 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:00:52,476 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:01:04,798 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:01:16,371 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:01:22,931 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:01:26,665 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:01:28,074 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 08:01:28,074 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 08:01:28,074 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:01:57,066 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:02:03,878 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:02:10,161 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:02:16,365 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:02:27,666 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:02:40,085 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:02:49,445 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:02:51,441 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 08:02:51,441 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:02:52,670 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:02:58,951 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:03:06,567 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:03:16,421 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:03:28,584 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:03:40,684 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:03:52,624 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:03:56,136 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 08:03:56,137 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:03:56,137 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:04:08,451 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:04:20,177 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:04:32,647 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:04:45,377 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:04:57,083 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:05:09,628 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:05:14,492 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:05:17,754 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 08:05:17,754 - INFO - transprompt_wrapper2 - 3
2021-05-15 08:05:23,290 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:05:29,583 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:05:35,835 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:05:44,574 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:05:56,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:06:09,166 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:06:16,048 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:06:19,377 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 08:06:19,378 - INFO - transprompt_wrapper2 - 4
2021-05-15 08:06:19,950 - INFO - modeling - Saving complete
2021-05-15 08:06:19,950 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 08:06:19,950 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 08:06:20,035 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:07:09,786 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 08:07:09,787 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 08:07:09,787 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 08:07:09,787 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:07:09,831 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:07:13,486 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:07:17,241 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:07:21,037 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:07:24,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:07:28,360 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:07:31,972 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:07:33,283 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:07:33,797 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 08:07:33,797 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 08:07:33,797 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:07:58,606 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:02,331 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:05,769 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:09,536 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:13,167 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:16,858 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:19,000 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:08:19,511 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 08:08:19,511 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:08:21,168 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:24,709 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:28,401 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:31,846 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:35,522 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:39,213 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:08:42,021 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:08:42,524 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 08:08:42,524 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:08:42,874 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:09:42,716 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 08:09:42,716 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 08:09:43,009 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 08:09:43,009 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 08:09:43,009 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:10:09,387 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 08:10:09,387 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 08:10:09,389 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 08:10:09,390 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:10:09,435 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:10:14,844 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:10:20,305 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:10:25,828 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:10:29,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:10:33,486 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:10:37,235 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:10:38,583 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:10:39,172 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 08:10:39,172 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 08:10:39,172 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:11:06,423 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:12,784 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:19,223 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:25,665 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:31,627 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:35,987 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:38,177 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:11:38,681 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 08:11:38,681 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:11:40,333 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:43,680 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:47,368 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:51,479 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:11:58,375 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:12:05,247 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:12:10,681 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:12:12,001 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 08:12:12,001 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:12:12,427 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:13:04,435 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 08:13:04,435 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 08:13:04,454 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 08:13:04,455 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 08:13:04,455 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:14:11,722 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 08:14:11,722 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 08:14:11,724 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 08:14:11,724 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:14:11,766 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:14:17,517 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:14:21,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:14:25,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:14:29,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:14:32,750 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:14:36,485 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:14:38,818 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:14:39,967 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 08:14:39,967 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 08:14:39,967 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:15:04,280 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:15:07,824 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:15:11,547 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:15:15,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:15:21,435 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:15:28,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:15:31,808 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:15:32,909 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 08:15:32,909 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 08:15:32,910 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:15:59,987 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:16:03,586 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:16:08,715 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:16:15,431 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:16:22,052 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:16:28,659 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:16:33,845 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:16:34,866 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 08:16:34,866 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 08:16:34,866 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:17:05,827 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:17:55,677 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 08:17:55,677 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 08:17:55,693 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 08:17:55,694 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 08:17:55,695 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:18:24,791 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 08:18:24,791 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 08:18:29,509 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 08:18:29,509 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 08:18:29,512 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 08:18:29,512 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 08:18:29,514 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 08:18:29,514 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 08:18:29,514 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 08:18:29,514 - INFO - run_task_adaptation - text_b=None
2021-05-15 08:18:29,514 - INFO - run_task_adaptation - task=SST-2
2021-05-15 08:18:29,514 - INFO - run_task_adaptation - label=0
2021-05-15 08:18:29,514 - INFO - run_task_adaptation - **********************************
2021-05-15 08:18:31,877 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:19:01,147 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 08:19:01,148 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:19:01,253 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:19:07,491 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:19:13,768 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:19:20,118 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:19:26,359 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:19:32,654 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:19:41,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:19:45,208 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:19:47,955 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 08:19:47,955 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 08:19:47,955 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:20:17,821 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:20:28,092 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:20:38,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:20:48,257 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:20:58,676 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:21:09,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:21:15,469 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:21:18,369 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 08:21:18,369 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:21:22,519 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:21:33,081 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:21:43,636 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:21:52,375 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:21:58,400 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:22:04,453 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:22:09,292 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:22:10,673 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 08:22:10,674 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:22:11,892 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:22:17,929 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:22:24,554 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:22:33,907 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:22:46,323 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:22:58,695 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:23:06,383 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:23:07,831 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 08:23:07,831 - INFO - transprompt_wrapper2 - 3
2021-05-15 08:23:07,831 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:23:14,112 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:23:21,091 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:23:33,894 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:23:46,736 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:23:55,488 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:24:01,771 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:24:04,214 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:24:05,616 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 08:24:05,616 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 08:24:05,616 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:24:35,262 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:24:41,533 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:24:47,688 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:24:59,823 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:25:12,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:25:23,804 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:25:31,185 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:25:34,545 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 08:25:34,545 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 08:25:34,545 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:26:06,028 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:26:14,557 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:26:26,824 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:26:38,987 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:26:50,765 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:27:03,338 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:27:13,135 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:27:16,435 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 08:27:16,435 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:27:18,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:27:31,027 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:27:43,407 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:27:55,261 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:28:07,586 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:28:19,702 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:28:31,578 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:28:35,040 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 08:28:35,040 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:28:35,040 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:28:47,380 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:28:57,289 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:03,624 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:09,746 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:15,883 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:22,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:24,583 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:29:26,019 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 08:29:26,019 - INFO - transprompt_wrapper2 - 3
2021-05-15 08:29:29,807 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:36,005 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:42,322 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:49,955 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:29:56,138 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:30:02,439 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:30:06,137 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:30:07,560 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 08:30:07,560 - INFO - transprompt_wrapper2 - 4
2021-05-15 08:30:07,878 - INFO - modeling - Saving complete
2021-05-15 08:30:07,878 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 08:30:07,878 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 08:30:07,990 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:31:07,995 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 08:31:07,996 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 08:31:07,996 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 08:31:07,996 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:31:08,042 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:31:14,011 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:31:19,732 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:31:24,831 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:31:30,203 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:31:35,605 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:31:40,973 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:31:42,962 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:31:44,135 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 08:31:44,135 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 08:31:44,135 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:32:10,902 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:14,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:18,424 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:22,431 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:26,650 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:30,295 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:32,316 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:32:32,877 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 08:32:32,877 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:32:34,520 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:38,919 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:45,114 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:51,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:32:57,936 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:33:04,146 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:33:08,637 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:33:09,667 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 08:33:09,667 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:33:09,980 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:34:03,679 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 08:34:03,680 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 08:34:03,995 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 08:34:03,995 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 08:34:03,995 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:34:31,669 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 08:34:31,669 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 08:34:31,750 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 08:34:31,750 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:34:31,797 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:34:37,004 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:34:40,772 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:34:44,555 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:34:48,399 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:34:52,191 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:34:57,236 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:34:59,531 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:35:00,647 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 08:35:00,647 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 08:35:00,647 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:35:26,451 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:35:33,104 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:35:39,598 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:35:45,416 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:35:51,594 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:35:57,829 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:36:01,550 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:36:02,744 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 08:36:02,744 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:36:05,263 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:36:11,503 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:36:17,525 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:36:24,031 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:36:30,478 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:36:36,709 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:36:41,620 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:36:42,736 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 08:36:42,736 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:36:43,147 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:37:38,835 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 08:37:38,835 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 08:37:38,851 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 08:37:38,852 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 08:37:38,852 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:38:11,066 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 08:38:11,066 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 08:38:11,069 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 08:38:11,070 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:38:11,165 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:38:14,877 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:38:18,734 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:38:22,557 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:38:26,325 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:38:30,021 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:38:33,747 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:38:35,063 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:38:35,562 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 08:38:35,562 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 08:38:35,562 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:38:59,463 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:03,259 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:07,111 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:10,945 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:14,649 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:18,530 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:20,629 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:39:21,121 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 08:39:21,121 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 08:39:21,121 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:39:43,481 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:47,417 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:52,802 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:39:58,222 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:40:03,603 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:40:09,012 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:40:13,276 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:40:14,310 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 08:40:14,310 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 08:40:14,310 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:40:36,401 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:41:27,488 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 08:41:27,489 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 08:41:27,506 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 08:41:27,507 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 08:41:27,508 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:42:03,355 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 08:42:03,355 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 08:42:08,250 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 08:42:08,250 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 08:42:08,253 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 08:42:08,254 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 08:42:08,255 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 08:42:08,255 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 08:42:08,255 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 08:42:08,255 - INFO - run_task_adaptation - text_b=None
2021-05-15 08:42:08,256 - INFO - run_task_adaptation - task=SST-2
2021-05-15 08:42:08,256 - INFO - run_task_adaptation - label=0
2021-05-15 08:42:08,256 - INFO - run_task_adaptation - **********************************
2021-05-15 08:42:10,622 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:42:41,258 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 08:42:41,259 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:42:41,364 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:42:53,695 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:43:05,197 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:43:17,595 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:43:29,843 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:43:41,180 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:43:53,483 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:43:58,474 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:44:01,874 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 08:44:01,874 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 08:44:01,874 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:44:32,122 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:44:44,264 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:44:56,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:45:07,893 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:45:20,353 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:45:32,526 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:45:39,240 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:45:42,564 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 08:45:42,564 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:45:47,330 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:45:59,650 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:46:11,051 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:46:23,501 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:46:35,755 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:46:47,362 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:46:57,249 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:47:00,517 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 08:47:00,517 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:47:02,868 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:47:14,759 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:47:22,182 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:47:28,446 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:47:34,678 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:47:40,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:47:47,125 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:47:48,532 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 08:47:48,532 - INFO - transprompt_wrapper2 - 3
2021-05-15 08:47:48,533 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:47:54,668 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:48:00,911 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:48:07,153 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:48:13,442 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:48:21,023 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:48:27,206 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:48:29,567 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:48:30,973 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 08:48:30,973 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 08:48:30,973 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:48:59,340 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:49:05,357 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:49:11,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:49:17,438 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:49:27,635 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:49:37,810 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:49:43,931 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:49:46,702 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 08:49:46,702 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 08:49:46,702 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:50:14,699 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:50:24,450 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:50:33,983 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:50:44,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:50:54,670 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:51:04,986 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:51:13,228 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:51:16,003 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 08:51:16,003 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:51:18,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:51:28,341 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:51:37,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:51:43,789 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:51:50,032 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:51:56,216 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:52:02,431 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:52:03,842 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 08:52:03,843 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:52:03,843 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:52:10,433 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:52:19,752 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:52:32,160 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:52:44,259 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:52:52,122 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:52:58,332 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:53:00,772 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:53:02,179 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 08:53:02,179 - INFO - transprompt_wrapper2 - 3
2021-05-15 08:53:06,136 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:53:18,395 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:53:30,659 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:53:42,255 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:53:54,859 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:54:07,202 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:54:13,960 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:54:17,301 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 08:54:17,301 - INFO - transprompt_wrapper2 - 4
2021-05-15 08:54:17,885 - INFO - modeling - Saving complete
2021-05-15 08:54:17,885 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 08:54:17,886 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 08:54:17,973 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:55:08,133 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 08:55:08,133 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 08:55:08,133 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 08:55:08,133 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:55:08,173 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:55:13,211 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:55:19,328 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:55:25,743 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:55:31,744 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:55:37,717 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:55:43,046 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:55:44,450 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:55:44,971 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 08:55:44,971 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 08:55:44,971 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:56:20,278 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:56:26,276 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:56:31,871 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:56:38,097 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:56:44,086 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:56:50,643 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:56:54,170 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:56:55,257 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 08:56:55,257 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:56:57,681 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:57:03,351 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:57:09,337 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:57:15,447 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:57:21,443 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:57:27,430 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:57:32,320 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:57:33,231 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 08:57:33,231 - INFO - transprompt_wrapper2 - 2
2021-05-15 08:57:33,613 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 08:58:30,329 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 08:58:30,329 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 08:58:30,649 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 08:58:30,649 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 08:58:30,649 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:58:43,270 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 08:58:43,270 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 08:58:43,273 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 08:58:43,273 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:58:43,366 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:58:46,587 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:58:49,958 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:58:54,613 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:58:58,346 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:01,840 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:05,506 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:06,693 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:59:07,193 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 08:59:07,193 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 08:59:07,193 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 08:59:30,451 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:34,186 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:37,888 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:41,506 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:44,984 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:48,706 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:50,781 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 08:59:51,269 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 08:59:51,269 - INFO - transprompt_wrapper2 - 1
2021-05-15 08:59:52,913 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 08:59:56,223 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:00:00,738 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:00:06,150 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:00:11,567 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:00:16,914 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:00:21,218 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:00:22,272 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:00:22,272 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:00:22,638 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:01:15,073 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 09:01:15,073 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:01:15,090 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 09:01:15,091 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 09:01:15,091 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:01:49,364 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 09:01:49,364 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 09:01:49,366 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 09:01:49,366 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:01:49,412 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:01:53,152 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:01:56,694 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:02:00,578 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:02:04,612 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:02:11,421 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:02:18,210 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:02:20,788 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:02:21,909 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:02:21,909 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 09:02:21,909 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:02:51,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:02:55,022 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:03:00,851 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:03:07,152 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:03:13,577 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:03:19,998 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:03:23,698 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:03:24,847 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:03:24,847 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 09:03:24,847 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:04:00,489 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:04:06,819 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:04:13,155 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:04:19,450 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:04:25,735 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:04:29,581 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:04:32,718 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:04:38,397 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:04:38,397 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 09:04:38,397 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:05:00,415 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:05:54,661 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 09:05:54,661 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:05:54,686 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 09:05:54,688 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 09:05:54,688 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:07:02,798 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 09:07:02,798 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 09:07:07,419 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 09:07:07,419 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 09:07:07,422 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 09:07:07,422 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 09:07:07,424 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 09:07:07,424 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 09:07:07,424 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 09:07:07,424 - INFO - run_task_adaptation - text_b=None
2021-05-15 09:07:07,424 - INFO - run_task_adaptation - task=SST-2
2021-05-15 09:07:07,424 - INFO - run_task_adaptation - label=0
2021-05-15 09:07:07,424 - INFO - run_task_adaptation - **********************************
2021-05-15 09:07:09,737 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:07:39,062 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 09:07:39,062 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:07:39,167 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:07:47,056 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:07:53,409 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:07:59,685 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:08:06,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:08:12,324 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:08:18,576 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:08:20,974 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:08:22,384 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:08:22,384 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 09:08:22,384 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:08:50,817 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:08:57,018 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:09:03,256 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:09:09,495 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:09:15,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:09:22,059 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:09:25,874 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:09:28,721 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 09:09:28,722 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:09:32,806 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:09:43,056 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:09:53,361 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:10:02,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:10:12,695 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:10:22,992 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:10:31,258 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:10:34,404 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 09:10:34,404 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:10:36,498 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:10:46,739 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:10:57,035 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:11:07,191 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:11:16,569 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:11:26,740 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:11:37,040 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:11:40,129 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 09:11:40,129 - INFO - transprompt_wrapper2 - 3
2021-05-15 09:11:40,130 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:11:50,388 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:12:00,707 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:12:11,000 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:12:20,215 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:12:26,480 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:12:32,714 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:12:35,123 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:12:36,598 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:12:36,598 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 09:12:36,598 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:13:02,936 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:13:09,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:13:15,243 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:13:21,470 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:13:27,690 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:13:33,897 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:13:37,582 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:13:39,096 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:13:39,096 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 09:13:39,096 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:14:04,612 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:14:10,792 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:14:16,948 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:14:23,166 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:14:29,365 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:14:35,541 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:14:40,539 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:14:41,956 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:14:41,957 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:14:43,209 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:14:49,455 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:14:55,655 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:01,886 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:08,157 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:14,408 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:20,564 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:15:21,961 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 09:15:21,961 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:15:21,961 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:28,108 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:34,360 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:40,590 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:46,815 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:53,076 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:15:59,299 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:16:01,708 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:16:03,111 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 09:16:03,111 - INFO - transprompt_wrapper2 - 3
2021-05-15 09:16:06,889 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:16:13,105 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:16:19,317 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:16:25,516 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:16:31,741 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:16:37,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:16:41,650 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:16:43,055 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 09:16:43,055 - INFO - transprompt_wrapper2 - 4
2021-05-15 09:16:43,362 - INFO - modeling - Saving complete
2021-05-15 09:16:43,362 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 09:16:43,362 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 09:16:43,449 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:17:33,856 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 09:17:33,856 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 09:17:33,856 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 09:17:33,856 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:17:33,897 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:17:37,630 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:17:41,162 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:17:44,686 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:17:48,361 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:17:51,987 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:17:55,656 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:17:56,919 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:17:57,418 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 09:17:57,418 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 09:17:57,418 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:18:21,462 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:25,228 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:28,937 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:32,526 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:36,063 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:39,810 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:41,784 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:18:42,269 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 09:18:42,270 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:18:43,654 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:46,994 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:50,668 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:54,132 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:18:57,835 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:19:01,487 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:19:04,411 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:19:04,904 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 09:19:04,904 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:19:05,231 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:20:01,913 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 09:20:01,913 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:20:02,203 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 09:20:02,203 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 09:20:02,204 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:20:14,654 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 09:20:14,654 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 09:20:14,655 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 09:20:14,656 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:20:14,699 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:20:18,294 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:20:22,016 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:20:25,771 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:20:29,581 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:20:33,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:20:36,943 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:20:38,177 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:20:38,680 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 09:20:38,680 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 09:20:38,680 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:21:01,620 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:05,341 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:09,082 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:12,615 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:16,254 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:19,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:21,914 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:21:22,408 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:21:22,408 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:21:24,029 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:27,780 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:31,500 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:35,215 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:38,911 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:42,460 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:21:45,252 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:21:45,740 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:21:45,740 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:21:46,058 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:22:38,143 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 09:22:38,143 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:22:38,156 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 09:22:38,157 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 09:22:38,157 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:23:07,246 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 09:23:07,246 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 09:23:07,248 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 09:23:07,248 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:23:07,288 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:23:10,952 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:23:14,542 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:23:18,116 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:23:21,686 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:23:25,507 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:23:29,319 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:23:30,606 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:23:31,105 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:23:31,105 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 09:23:31,105 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:23:54,900 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:23:58,705 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:02,346 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:06,110 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:09,881 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:13,482 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:15,490 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:24:15,984 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:24:15,984 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 09:24:15,984 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:24:38,960 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:42,792 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:46,520 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:50,340 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:54,140 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:24:57,959 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:25:00,884 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:25:01,368 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:25:01,368 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 09:25:01,368 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:25:23,056 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:26:16,589 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 09:26:16,589 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:26:16,607 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 09:26:16,609 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 09:26:16,609 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:26:45,206 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 09:26:45,206 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 09:26:49,676 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 09:26:49,676 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 09:26:49,679 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 09:26:49,679 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 09:26:49,681 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 09:26:49,681 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 09:26:49,681 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 09:26:49,681 - INFO - run_task_adaptation - text_b=None
2021-05-15 09:26:49,681 - INFO - run_task_adaptation - task=SST-2
2021-05-15 09:26:49,681 - INFO - run_task_adaptation - label=0
2021-05-15 09:26:49,681 - INFO - run_task_adaptation - **********************************
2021-05-15 09:26:51,989 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:27:19,487 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 09:27:19,488 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:27:19,594 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:27:25,620 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:27:31,581 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:27:37,542 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:27:43,525 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:27:49,700 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:27:55,949 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:27:58,355 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:27:59,791 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:27:59,792 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 09:27:59,792 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:28:26,598 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:28:32,783 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:28:38,935 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:28:45,104 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:28:51,264 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:28:57,451 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:01,083 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:29:02,504 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 09:29:02,504 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:29:05,042 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:11,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:17,521 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:23,696 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:29,857 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:36,062 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:40,994 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:29:42,402 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 09:29:42,402 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:29:43,606 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:49,792 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:29:56,038 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:02,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:08,447 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:14,625 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:20,900 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:30:22,356 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 09:30:22,356 - INFO - transprompt_wrapper2 - 3
2021-05-15 09:30:22,356 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:28,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:34,842 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:40,994 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:47,200 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:53,472 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:30:59,737 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:31:02,155 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:31:03,606 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:31:03,606 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 09:31:03,606 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:31:30,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:31:36,637 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:31:42,835 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:31:49,040 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:31:55,283 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:32:01,526 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:32:05,189 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:32:06,594 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:32:06,594 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 09:32:06,594 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:32:32,334 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:32:38,595 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:32:44,749 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:32:51,002 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:32:57,209 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:03,428 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:08,361 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:33:09,778 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:33:09,778 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:33:11,032 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:17,269 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:23,540 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:29,759 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:36,039 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:42,292 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:48,557 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:33:49,981 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 09:33:49,981 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:33:49,982 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:33:56,201 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:02,434 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:08,633 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:14,890 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:21,138 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:27,381 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:29,797 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:34:31,197 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 09:34:31,197 - INFO - transprompt_wrapper2 - 3
2021-05-15 09:34:34,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:41,223 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:47,458 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:53,690 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:34:59,940 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:35:06,236 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:35:09,940 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:35:11,340 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 09:35:11,340 - INFO - transprompt_wrapper2 - 4
2021-05-15 09:35:11,641 - INFO - modeling - Saving complete
2021-05-15 09:35:11,642 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 09:35:11,642 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 09:35:11,725 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:36:01,696 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 09:36:01,696 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 09:36:01,697 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 09:36:01,697 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:36:01,737 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:05,825 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:09,418 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:12,827 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:16,618 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:20,367 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:24,111 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:25,398 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:36:25,913 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 09:36:25,913 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 09:36:25,913 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:36:48,111 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:51,849 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:55,546 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:36:59,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:03,017 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:06,649 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:08,656 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:37:09,141 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 09:37:09,141 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:37:10,717 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:14,396 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:18,152 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:21,904 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:25,642 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:29,368 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:37:32,316 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:37:32,814 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 09:37:32,815 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:37:33,119 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:38:28,749 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 09:38:28,749 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:38:29,057 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 09:38:29,057 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 09:38:29,058 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:38:41,485 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 09:38:41,485 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 09:38:41,487 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 09:38:41,487 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:38:41,532 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:38:45,112 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:38:48,637 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:38:51,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:38:55,907 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:38:59,661 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:03,444 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:04,736 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:39:05,244 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 09:39:05,244 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 09:39:05,244 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:39:29,173 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:32,973 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:36,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:40,528 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:44,224 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:47,905 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:49,922 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:39:50,464 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:39:50,464 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:39:51,965 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:55,627 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:39:59,395 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:40:03,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:40:06,840 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:40:10,534 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:40:13,325 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:40:13,849 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:40:13,849 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:40:14,230 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:41:06,671 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 09:41:06,671 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:41:06,684 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 09:41:06,685 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 09:41:06,685 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:41:35,188 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 09:41:35,188 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 09:41:35,218 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 09:41:35,218 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:41:35,259 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:41:38,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:41:42,753 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:41:46,533 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:41:50,323 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:41:53,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:41:56,772 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:41:57,909 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:41:58,408 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:41:58,409 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 09:41:58,409 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:42:21,826 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:42:25,646 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:42:29,464 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:42:33,250 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:42:37,072 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:42:40,798 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:42:42,934 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:42:43,432 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:42:43,432 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 09:42:43,432 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:43:05,713 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:43:09,487 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:43:13,237 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:43:16,896 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:43:20,696 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:43:24,526 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:43:27,544 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:43:28,038 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 09:43:28,038 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 09:43:28,038 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:43:49,048 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:44:41,872 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 09:44:41,872 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:44:41,888 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 09:44:41,889 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 09:44:41,889 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:45:10,559 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 09:45:10,560 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 09:45:15,305 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 09:45:15,305 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 09:45:15,309 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 09:45:15,309 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 09:45:15,310 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 09:45:15,311 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 09:45:15,311 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 09:45:15,311 - INFO - run_task_adaptation - text_b=None
2021-05-15 09:45:15,311 - INFO - run_task_adaptation - task=SST-2
2021-05-15 09:45:15,311 - INFO - run_task_adaptation - label=0
2021-05-15 09:45:15,311 - INFO - run_task_adaptation - **********************************
2021-05-15 09:45:17,636 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:45:45,756 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 09:45:45,757 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:45:45,871 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:45:52,073 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:45:58,371 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:46:04,671 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:46:10,923 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:46:17,121 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:46:23,334 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:46:25,758 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:46:27,206 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:46:27,206 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 09:46:27,206 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:46:54,189 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:00,443 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:06,521 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:12,589 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:18,699 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:24,870 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:28,555 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:47:29,971 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 09:47:29,971 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:47:32,474 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:38,666 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:44,928 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:51,250 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:47:57,487 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:03,719 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:08,617 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:48:10,069 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 09:48:10,069 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:48:11,287 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:17,484 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:23,620 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:29,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:35,937 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:42,189 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:48,450 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:48:49,862 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 09:48:49,863 - INFO - transprompt_wrapper2 - 3
2021-05-15 09:48:49,863 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:48:56,089 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:49:02,303 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:49:08,560 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:49:14,814 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:49:21,061 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:49:27,295 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:49:29,722 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:49:31,159 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:49:31,160 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 09:49:31,160 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:49:58,061 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:50:04,281 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:50:10,492 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:50:16,762 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:50:22,956 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:50:29,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:50:32,971 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:50:34,369 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 09:50:34,369 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 09:50:34,369 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:51:00,407 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:06,573 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:12,788 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:19,009 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:25,080 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:31,026 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:35,736 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:51:37,089 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:51:37,089 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:51:38,317 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:44,552 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:50,772 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:51:57,035 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:03,291 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:09,566 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:15,798 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:52:17,203 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 09:52:17,204 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:52:17,204 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:23,416 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:29,667 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:35,956 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:42,220 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:48,438 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:54,645 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:52:57,023 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:52:58,425 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 09:52:58,426 - INFO - transprompt_wrapper2 - 3
2021-05-15 09:53:02,205 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:53:08,492 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:53:14,728 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:53:20,905 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:53:27,177 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:53:33,467 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:53:37,172 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:53:38,571 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 09:53:38,571 - INFO - transprompt_wrapper2 - 4
2021-05-15 09:53:38,880 - INFO - modeling - Saving complete
2021-05-15 09:53:38,880 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 09:53:38,880 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 09:53:38,965 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:54:28,066 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 09:54:28,066 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 09:54:28,066 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 09:54:28,066 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:54:28,105 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:54:31,994 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:54:35,308 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:54:39,033 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:54:42,509 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:54:46,195 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:54:49,727 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:54:50,984 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:54:51,484 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 09:54:51,484 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 09:54:51,484 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:55:15,497 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:18,979 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:22,747 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:26,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:30,199 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:33,921 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:36,009 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:55:36,504 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 09:55:36,505 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:55:38,149 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:41,798 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:45,522 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:49,286 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:53,029 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:56,783 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:55:59,662 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:56:00,155 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 09:56:00,155 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:56:00,454 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:56:57,448 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 09:56:57,448 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:56:57,715 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 09:56:57,715 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 09:56:57,715 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:57:10,299 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 09:57:10,299 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 09:57:10,301 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 09:57:10,301 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:57:10,342 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:57:14,000 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:57:17,794 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:57:21,318 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:57:25,110 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:57:28,872 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:57:32,652 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:57:33,910 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:57:34,412 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 09:57:34,412 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 09:57:34,412 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 09:57:56,895 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:00,667 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:04,404 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:08,195 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:11,954 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:15,681 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:17,715 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:58:18,247 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:58:18,247 - INFO - transprompt_wrapper2 - 1
2021-05-15 09:58:19,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:23,634 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:27,404 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:31,189 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:34,957 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:38,739 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 09:58:41,665 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 09:58:42,156 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 09:58:42,156 - INFO - transprompt_wrapper2 - 2
2021-05-15 09:58:42,477 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 09:59:32,960 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 09:59:32,960 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 09:59:32,973 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 09:59:32,974 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 09:59:32,974 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:00:01,730 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 10:00:01,730 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 10:00:01,732 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 10:00:01,732 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:00:01,774 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:05,526 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:09,347 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:13,187 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:17,022 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:20,807 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:24,548 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:25,832 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:00:26,328 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:00:26,328 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 10:00:26,328 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:00:50,668 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:54,437 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:00:58,158 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:02,022 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:05,881 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:09,679 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:11,803 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:01:12,303 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:01:12,303 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 10:01:12,303 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:01:36,360 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:40,213 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:44,027 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:47,817 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:51,350 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:55,129 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:01:58,115 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:01:58,611 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:01:58,611 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 10:01:58,612 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:02:21,414 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:03:15,421 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 10:03:15,421 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:03:15,437 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 10:03:15,439 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 10:03:15,439 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:03:44,385 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 10:03:44,386 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 10:03:48,796 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 10:03:48,796 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 10:03:48,800 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 10:03:48,800 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 10:03:48,801 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 10:03:48,802 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 10:03:48,802 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 10:03:48,802 - INFO - run_task_adaptation - text_b=None
2021-05-15 10:03:48,802 - INFO - run_task_adaptation - task=SST-2
2021-05-15 10:03:48,802 - INFO - run_task_adaptation - label=0
2021-05-15 10:03:48,802 - INFO - run_task_adaptation - **********************************
2021-05-15 10:03:51,191 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:04:19,380 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 10:04:19,381 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:04:19,482 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:04:25,770 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:04:32,028 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:04:38,261 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:04:44,541 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:04:50,545 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:04:56,514 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:04:58,873 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:05:00,287 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:05:00,287 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 10:05:00,287 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:05:27,196 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:05:33,471 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:05:39,691 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:05:45,891 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:05:52,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:05:58,259 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:01,940 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:06:03,355 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 10:06:03,356 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:06:05,855 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:12,052 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:18,231 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:24,432 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:30,689 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:36,953 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:41,911 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:06:43,329 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 10:06:43,329 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:06:44,596 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:50,800 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:06:56,994 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:03,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:09,522 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:15,773 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:21,977 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:07:23,456 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 10:07:23,456 - INFO - transprompt_wrapper2 - 3
2021-05-15 10:07:23,456 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:29,664 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:35,921 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:42,148 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:48,313 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:07:54,577 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:08:00,840 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:08:03,254 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:08:04,660 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:08:04,660 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 10:08:04,660 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:08:31,281 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:08:37,306 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:08:43,290 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:08:49,309 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:08:55,274 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:09:01,324 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:09:04,906 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:09:06,295 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:09:06,295 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 10:09:06,295 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:09:32,683 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:09:38,870 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:09:45,036 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:09:51,145 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:09:57,313 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:03,423 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:08,336 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:10:09,728 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:10:09,728 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:10:10,960 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:17,153 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:23,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:29,473 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:35,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:41,969 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:48,245 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:10:49,644 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 10:10:49,644 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:10:49,645 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:10:55,793 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:01,970 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:08,226 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:14,249 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:20,376 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:26,585 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:28,998 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:11:30,388 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 10:11:30,388 - INFO - transprompt_wrapper2 - 3
2021-05-15 10:11:34,185 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:40,439 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:46,645 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:52,859 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:11:59,148 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:12:05,377 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:12:09,066 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:12:10,460 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 10:12:10,461 - INFO - transprompt_wrapper2 - 4
2021-05-15 10:12:10,770 - INFO - modeling - Saving complete
2021-05-15 10:12:10,770 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 10:12:10,770 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 10:12:10,858 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:12:56,688 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 10:12:56,688 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 10:12:56,688 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 10:12:56,688 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:12:56,728 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:00,283 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:03,963 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:07,638 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:11,155 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:14,629 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:18,083 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:19,310 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:13:19,810 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 10:13:19,810 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 10:13:19,810 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:13:43,287 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:47,030 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:50,776 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:54,486 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:13:58,175 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:14:01,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:14:03,860 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:14:04,393 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 10:14:04,393 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:14:05,837 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:14:09,575 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:14:13,331 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:14:17,063 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:14:20,746 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:14:24,460 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:14:27,358 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:14:27,856 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 10:14:27,857 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:14:28,172 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:15:21,752 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 10:15:21,752 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:15:22,024 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 10:15:22,024 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 10:15:22,024 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:15:34,546 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 10:15:34,546 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 10:15:34,548 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 10:15:34,548 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:15:34,634 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:15:38,323 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:15:42,015 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:15:45,722 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:15:49,220 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:15:52,941 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:15:56,694 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:15:57,980 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:15:58,483 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 10:15:58,483 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 10:15:58,483 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:16:20,995 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:24,764 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:28,543 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:32,281 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:36,038 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:39,783 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:41,900 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:16:42,411 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:16:42,411 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:16:43,981 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:47,689 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:51,399 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:55,164 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:16:58,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:17:02,529 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:17:05,378 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:17:05,878 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:17:05,878 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:17:06,218 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:17:55,505 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 10:17:55,505 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:17:55,518 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 10:17:55,519 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 10:17:55,519 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:18:24,065 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 10:18:24,065 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 10:18:24,067 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 10:18:24,068 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:18:24,109 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:18:27,603 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:18:31,455 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:18:35,288 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:18:39,136 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:18:42,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:18:46,740 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:18:48,011 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:18:48,517 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:18:48,518 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 10:18:48,518 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:19:13,924 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:19:17,693 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:19:21,513 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:19:25,269 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:19:28,998 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:19:32,777 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:19:34,841 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:19:35,337 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:19:35,337 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 10:19:35,337 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:19:59,398 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:20:03,222 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:20:07,073 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:20:10,892 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:20:14,711 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:20:18,546 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:20:21,508 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:20:21,993 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:20:21,993 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 10:20:21,993 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:20:44,627 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:21:43,141 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 10:21:43,142 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:21:43,158 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 10:21:43,160 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 10:21:43,160 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:22:13,043 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 10:22:13,043 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 10:22:17,953 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 10:22:17,953 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 10:22:17,958 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 10:22:17,958 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 10:22:17,960 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 10:22:17,960 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 10:22:17,960 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 10:22:17,960 - INFO - run_task_adaptation - text_b=None
2021-05-15 10:22:17,960 - INFO - run_task_adaptation - task=SST-2
2021-05-15 10:22:17,960 - INFO - run_task_adaptation - label=0
2021-05-15 10:22:17,960 - INFO - run_task_adaptation - **********************************
2021-05-15 10:22:20,360 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:22:48,558 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 10:22:48,558 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:22:48,662 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:22:54,963 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:23:01,236 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:23:07,615 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:23:13,985 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:23:20,198 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:23:26,420 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:23:28,834 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:23:30,292 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:23:30,292 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 10:23:30,292 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:23:57,219 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:03,343 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:09,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:15,746 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:21,889 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:28,131 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:31,793 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:24:33,270 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 10:24:33,270 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:24:35,798 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:42,040 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:48,319 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:24:54,515 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:00,789 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:07,037 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:11,962 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:25:13,368 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 10:25:13,369 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:25:14,603 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:20,773 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:27,015 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:33,297 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:39,534 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:45,772 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:52,050 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:25:53,503 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 10:25:53,503 - INFO - transprompt_wrapper2 - 3
2021-05-15 10:25:53,504 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:25:59,649 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:26:05,906 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:26:12,166 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:26:18,393 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:26:24,630 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:26:30,881 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:26:33,310 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:26:34,714 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:26:34,715 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 10:26:34,715 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:27:01,440 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:27:07,635 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:27:13,922 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:27:20,228 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:27:26,500 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:27:32,724 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:27:36,381 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:27:37,822 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:27:37,822 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 10:27:37,822 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:28:03,579 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:09,752 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:15,897 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:21,887 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:27,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:33,815 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:38,820 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:28:40,258 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:28:40,258 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:28:41,520 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:47,748 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:53,957 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:28:59,985 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:06,196 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:12,484 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:18,737 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:29:20,146 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 10:29:20,146 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:29:20,146 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:26,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:32,539 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:38,861 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:45,151 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:51,471 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:29:57,774 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:30:00,171 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:30:01,574 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 10:30:01,575 - INFO - transprompt_wrapper2 - 3
2021-05-15 10:30:05,396 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:30:11,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:30:17,981 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:30:24,237 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:30:30,414 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:30:36,687 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:30:40,419 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:30:41,855 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 10:30:41,855 - INFO - transprompt_wrapper2 - 4
2021-05-15 10:30:42,166 - INFO - modeling - Saving complete
2021-05-15 10:30:42,166 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 10:30:42,166 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 10:30:42,251 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:31:33,805 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 10:31:33,805 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 10:31:33,805 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 10:31:33,805 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:31:33,847 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:31:37,443 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:31:41,193 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:31:44,967 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:31:48,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:31:52,090 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:31:55,519 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:31:56,741 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:31:57,242 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 10:31:57,242 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 10:31:57,242 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:32:20,970 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:24,700 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:28,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:32,213 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:35,909 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:39,553 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:41,669 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:32:42,158 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 10:32:42,158 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:32:43,682 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:47,437 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:51,219 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:54,945 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:32:58,673 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:33:02,353 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:33:05,270 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:33:05,756 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 10:33:05,756 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:33:06,061 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:34:02,721 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 10:34:02,721 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:34:03,054 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 10:34:03,054 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 10:34:03,054 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:34:15,563 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 10:34:15,563 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 10:34:15,565 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 10:34:15,565 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:34:15,610 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:34:19,193 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:34:22,973 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:34:26,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:34:30,424 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:34:34,184 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:34:37,905 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:34:39,217 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:34:39,737 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 10:34:39,737 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 10:34:39,737 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:35:04,464 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:08,291 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:12,059 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:15,850 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:19,582 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:23,161 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:25,198 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:35:25,698 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:35:25,698 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:35:27,309 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:31,099 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:34,910 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:38,637 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:42,302 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:46,074 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:35:49,011 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:35:49,502 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:35:49,503 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:35:49,832 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:36:40,920 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 10:36:40,920 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:36:40,934 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 10:36:40,934 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 10:36:40,934 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:37:09,689 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 10:37:09,689 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 10:37:09,691 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 10:37:09,691 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:37:09,732 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:37:13,509 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:37:17,370 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:37:21,212 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:37:25,092 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:37:28,960 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:37:32,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:37:33,823 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:37:34,322 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:37:34,322 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 10:37:34,322 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:37:58,940 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:02,701 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:06,555 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:10,387 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:14,223 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:18,071 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:20,224 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:38:20,718 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:38:20,718 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 10:38:20,718 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:38:43,886 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:47,729 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:51,538 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:55,376 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:38:58,934 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:39:02,673 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:39:05,618 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:39:06,114 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:39:06,114 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 10:39:06,114 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:39:28,347 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:40:22,525 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 10:40:22,526 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:40:22,542 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 10:40:22,544 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 10:40:22,544 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:40:51,249 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 10:40:51,249 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 10:40:56,000 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 10:40:56,001 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 10:40:56,004 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 10:40:56,004 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 10:40:56,006 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 10:40:56,006 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 10:40:56,006 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 10:40:56,006 - INFO - run_task_adaptation - text_b=None
2021-05-15 10:40:56,006 - INFO - run_task_adaptation - task=SST-2
2021-05-15 10:40:56,006 - INFO - run_task_adaptation - label=0
2021-05-15 10:40:56,006 - INFO - run_task_adaptation - **********************************
2021-05-15 10:40:58,387 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:41:26,777 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 10:41:26,778 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:41:26,885 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:41:33,164 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:41:39,390 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:41:45,746 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:41:52,019 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:41:58,242 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:42:04,464 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:42:06,884 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:42:08,349 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:42:08,349 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 10:42:08,349 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:42:35,360 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:42:41,616 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:42:47,864 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:42:54,078 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:00,266 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:06,426 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:10,107 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:43:11,509 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 10:43:11,509 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:43:14,010 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:20,226 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:26,431 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:32,628 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:38,902 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:45,152 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:50,129 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:43:51,571 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 10:43:51,571 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:43:52,807 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:43:59,029 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:05,212 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:11,376 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:17,589 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:23,708 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:29,952 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:44:31,411 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 10:44:31,412 - INFO - transprompt_wrapper2 - 3
2021-05-15 10:44:31,412 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:37,652 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:43,896 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:50,122 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:44:56,363 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:45:02,663 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:45:08,950 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:45:11,384 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:45:12,795 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:45:12,795 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 10:45:12,795 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:45:39,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:45:45,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:45:51,801 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:45:58,058 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:46:04,328 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:46:10,485 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:46:14,115 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:46:15,525 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 10:46:15,525 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 10:46:15,525 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:46:41,353 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:46:47,627 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:46:53,842 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:00,089 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:06,301 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:12,547 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:17,484 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:47:18,903 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:47:18,903 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:47:20,156 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:26,370 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:32,632 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:38,846 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:45,048 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:51,253 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:47:57,550 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:47:58,981 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 10:47:58,981 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:47:58,981 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:05,177 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:11,395 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:17,521 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:23,813 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:30,107 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:36,282 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:38,698 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:48:40,157 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 10:48:40,158 - INFO - transprompt_wrapper2 - 3
2021-05-15 10:48:43,924 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:50,133 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:48:56,245 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:49:02,295 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:49:08,435 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:49:14,633 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:49:18,380 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:49:19,810 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 10:49:19,810 - INFO - transprompt_wrapper2 - 4
2021-05-15 10:49:20,118 - INFO - modeling - Saving complete
2021-05-15 10:49:20,118 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 10:49:20,118 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 10:49:20,203 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:50:10,667 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 10:50:10,667 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 10:50:10,668 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 10:50:10,668 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:50:10,708 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:50:14,657 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:50:18,444 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:50:22,216 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:50:25,981 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:50:29,774 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:50:33,509 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:50:34,723 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:50:35,237 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 10:50:35,238 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 10:50:35,238 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:50:58,770 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:02,556 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:06,162 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:09,602 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:13,371 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:17,180 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:19,280 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:51:19,779 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 10:51:19,779 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:51:21,407 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:25,166 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:28,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:32,646 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:36,230 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:40,021 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:51:42,989 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:51:43,505 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 10:51:43,505 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:51:43,854 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:52:36,749 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 10:52:36,749 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:52:37,043 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 10:52:37,043 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 10:52:37,043 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:52:49,535 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 10:52:49,535 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 10:52:49,588 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 10:52:49,588 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:52:49,632 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:52:53,321 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:52:57,115 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:00,911 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:04,603 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:08,360 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:12,118 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:13,391 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:53:13,894 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 10:53:13,895 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 10:53:13,895 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:53:36,952 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:40,682 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:44,468 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:48,238 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:51,903 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:55,686 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:53:57,810 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:53:58,313 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:53:58,313 - INFO - transprompt_wrapper2 - 1
2021-05-15 10:53:59,970 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:54:03,753 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:54:07,524 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:54:11,282 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:54:14,969 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:54:18,505 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:54:21,298 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:54:21,788 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 10:54:21,788 - INFO - transprompt_wrapper2 - 2
2021-05-15 10:54:22,130 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:55:11,546 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 10:55:11,546 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:55:11,563 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 10:55:11,564 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 10:55:11,564 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:55:40,662 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 10:55:40,662 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 10:55:40,665 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 10:55:40,665 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:55:40,707 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:55:44,331 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:55:48,138 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:55:51,858 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:55:55,624 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:55:59,365 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:56:02,805 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:56:04,107 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:56:04,627 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:56:04,627 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 10:56:04,627 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:56:29,153 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:56:32,884 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:56:36,724 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:56:40,546 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:56:44,422 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:56:48,267 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:56:50,397 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:56:50,895 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:56:50,896 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 10:56:50,896 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:57:15,471 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:57:19,304 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:57:23,127 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:57:26,948 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:57:30,585 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:57:34,118 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 10:57:37,144 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:57:37,639 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 10:57:37,639 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 10:57:37,639 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 10:58:00,896 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:58:53,088 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 10:58:53,088 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 10:58:53,121 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 10:58:53,124 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 10:58:53,124 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:59:22,041 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 10:59:22,041 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 10:59:26,378 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 10:59:26,378 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 10:59:26,382 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 10:59:26,382 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 10:59:26,384 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 10:59:26,384 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 10:59:26,384 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 10:59:26,384 - INFO - run_task_adaptation - text_b=None
2021-05-15 10:59:26,384 - INFO - run_task_adaptation - task=SST-2
2021-05-15 10:59:26,384 - INFO - run_task_adaptation - label=0
2021-05-15 10:59:26,384 - INFO - run_task_adaptation - **********************************
2021-05-15 10:59:28,736 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 10:59:57,097 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 10:59:57,098 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 10:59:57,201 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:00:03,256 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:00:09,249 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:00:15,546 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:00:21,759 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:00:27,953 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:00:33,944 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:00:36,287 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:00:37,698 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:00:37,699 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 11:00:37,699 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:01:04,290 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:01:10,300 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:01:16,280 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:01:22,262 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:01:28,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:01:34,305 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:01:38,003 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:01:39,417 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 11:01:39,417 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:01:41,929 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:01:48,149 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:01:54,417 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:00,683 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:06,951 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:13,213 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:18,153 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:02:19,579 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 11:02:19,579 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:02:20,811 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:26,960 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:33,195 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:39,451 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:45,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:51,905 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:02:58,155 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:02:59,611 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 11:02:59,611 - INFO - transprompt_wrapper2 - 3
2021-05-15 11:02:59,612 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:03:05,883 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:03:12,178 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:03:18,428 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:03:24,637 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:03:30,908 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:03:37,152 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:03:39,570 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:03:40,969 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:03:40,969 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 11:03:40,969 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:04:07,430 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:04:13,688 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:04:19,925 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:04:25,950 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:04:31,965 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:04:37,964 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:04:41,537 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:04:42,895 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:04:42,895 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 11:04:42,895 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:05:08,683 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:05:14,953 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:05:21,183 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:05:27,371 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:05:33,665 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:05:39,885 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:05:44,850 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:05:46,266 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:05:46,266 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:05:47,512 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:05:53,724 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:00,017 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:06,303 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:12,571 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:18,807 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:25,014 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:06:26,448 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 11:06:26,449 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:06:26,449 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:32,681 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:38,889 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:45,003 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:51,059 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:06:57,322 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:07:03,554 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:07:05,964 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:07:07,373 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 11:07:07,373 - INFO - transprompt_wrapper2 - 3
2021-05-15 11:07:11,141 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:07:17,370 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:07:23,615 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:07:29,833 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:07:36,024 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:07:42,239 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:07:45,931 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:07:47,366 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 11:07:47,366 - INFO - transprompt_wrapper2 - 4
2021-05-15 11:07:47,679 - INFO - modeling - Saving complete
2021-05-15 11:07:47,679 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 11:07:47,679 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 11:07:47,777 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:08:37,603 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 11:08:37,603 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 11:08:37,603 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 11:08:37,604 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:08:37,652 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:08:41,757 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:08:45,537 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:08:49,270 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:08:53,026 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:08:56,789 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:00,543 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:01,835 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:09:02,347 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 11:09:02,347 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 11:09:02,347 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:09:24,705 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:28,458 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:32,129 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:35,801 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:39,594 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:43,385 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:45,495 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:09:45,994 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 11:09:45,995 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:09:47,611 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:51,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:55,098 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:09:58,821 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:10:02,460 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:10:06,185 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:10:09,092 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:10:09,595 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 11:10:09,596 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:10:09,928 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:11:04,456 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 11:11:04,456 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:11:04,759 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 11:11:04,759 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 11:11:04,759 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:11:17,353 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 11:11:17,354 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 11:11:17,356 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 11:11:17,357 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:11:17,402 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:11:21,133 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:11:24,795 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:11:28,492 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:11:32,131 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:11:35,733 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:11:39,488 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:11:40,745 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:11:41,254 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 11:11:41,254 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 11:11:41,254 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:12:04,621 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:08,387 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:12,045 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:15,736 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:19,579 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:23,310 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:25,468 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:12:25,965 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:12:25,965 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:12:27,647 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:31,427 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:35,229 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:39,046 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:42,727 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:46,303 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:12:49,273 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:12:49,756 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:12:49,756 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:12:50,145 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:13:44,349 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 11:13:44,350 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:13:44,373 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 11:13:44,374 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 11:13:44,375 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:14:13,705 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 11:14:13,705 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 11:14:13,734 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 11:14:13,735 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:14:13,777 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:14:17,578 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:14:21,430 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:14:25,283 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:14:28,903 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:14:32,658 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:14:36,483 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:14:37,803 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:14:38,304 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:14:38,304 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 11:14:38,304 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:15:01,551 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:04,966 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:08,723 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:12,425 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:16,181 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:20,009 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:22,068 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:15:22,562 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:15:22,562 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 11:15:22,562 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:15:45,186 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:49,036 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:52,764 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:15:56,509 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:16:00,230 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:16:04,076 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:16:07,067 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:16:07,559 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:16:07,559 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 11:16:07,559 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:16:28,451 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:17:20,992 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 11:17:20,992 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:17:21,009 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 11:17:21,011 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 11:17:21,011 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:17:49,674 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 11:17:49,674 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 11:17:54,418 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 11:17:54,418 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 11:17:54,421 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 11:17:54,421 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 11:17:54,423 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 11:17:54,423 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 11:17:54,423 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 11:17:54,423 - INFO - run_task_adaptation - text_b=None
2021-05-15 11:17:54,423 - INFO - run_task_adaptation - task=SST-2
2021-05-15 11:17:54,423 - INFO - run_task_adaptation - label=0
2021-05-15 11:17:54,423 - INFO - run_task_adaptation - **********************************
2021-05-15 11:17:56,785 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:18:25,246 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 11:18:25,246 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:18:25,358 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:18:31,832 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:18:38,179 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:18:44,556 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:18:50,882 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:18:57,119 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:19:03,318 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:19:05,766 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:19:07,200 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:19:07,200 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 11:19:07,200 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:19:34,337 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:19:40,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:19:46,754 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:19:52,936 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:19:59,121 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:05,391 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:09,104 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:20:10,565 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 11:20:10,565 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:20:13,097 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:19,327 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:25,575 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:31,860 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:38,107 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:44,329 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:49,288 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:20:50,681 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 11:20:50,682 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:20:51,891 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:20:57,925 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:04,019 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:10,257 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:16,413 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:22,529 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:28,589 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:21:29,961 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 11:21:29,961 - INFO - transprompt_wrapper2 - 3
2021-05-15 11:21:29,962 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:35,975 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:41,957 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:47,946 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:21:53,970 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:22:00,233 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:22:06,478 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:22:08,914 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:22:10,332 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:22:10,332 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 11:22:10,332 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:22:36,827 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:22:43,111 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:22:49,385 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:22:55,614 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:23:01,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:23:07,665 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:23:11,226 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:23:12,597 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:23:12,597 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 11:23:12,597 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:23:38,382 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:23:44,550 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:23:50,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:23:56,905 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:03,123 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:09,324 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:14,324 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:24:15,745 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:24:15,745 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:24:16,982 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:23,225 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:29,454 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:35,680 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:41,721 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:47,685 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:24:53,649 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:24:55,004 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 11:24:55,004 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:24:55,005 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:00,903 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:06,820 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:12,783 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:18,750 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:24,673 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:30,596 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:32,937 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:25:34,286 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 11:25:34,286 - INFO - transprompt_wrapper2 - 3
2021-05-15 11:25:37,896 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:43,871 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:49,808 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:25:55,800 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:26:01,737 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:26:07,712 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:26:11,262 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:26:12,611 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 11:26:12,611 - INFO - transprompt_wrapper2 - 4
2021-05-15 11:26:12,904 - INFO - modeling - Saving complete
2021-05-15 11:26:12,904 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 11:26:12,904 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 11:26:12,988 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:27:02,922 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 11:27:02,923 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 11:27:02,923 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 11:27:02,923 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:27:02,963 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:06,665 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:10,388 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:14,134 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:17,915 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:21,662 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:25,436 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:26,649 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:27:27,189 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 11:27:27,189 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 11:27:27,189 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:27:50,774 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:54,560 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:27:58,299 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:02,089 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:05,762 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:09,471 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:11,538 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:28:12,072 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 11:28:12,072 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:28:13,698 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:17,318 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:21,059 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:24,834 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:28,541 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:32,275 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:28:35,216 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:28:35,719 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 11:28:35,719 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:28:36,051 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:29:30,044 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 11:29:30,044 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:29:30,353 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 11:29:30,354 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 11:29:30,354 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:29:42,800 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 11:29:42,800 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 11:29:42,802 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 11:29:42,802 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:29:42,847 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:29:46,636 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:29:50,400 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:29:54,107 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:29:57,785 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:01,470 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:05,236 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:06,525 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:30:07,037 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 11:30:07,037 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 11:30:07,037 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:30:29,873 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:33,496 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:37,277 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:41,039 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:44,836 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:48,634 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:50,741 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:30:51,234 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:30:51,235 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:30:52,874 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:30:56,595 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:31:00,216 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:31:03,982 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:31:07,703 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:31:11,503 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:31:14,410 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:31:14,897 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:31:14,897 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:31:15,228 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:32:05,205 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 11:32:05,205 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:32:05,217 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 11:32:05,218 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 11:32:05,218 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:32:33,623 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 11:32:33,624 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 11:32:33,625 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 11:32:33,626 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:32:33,667 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:32:37,385 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:32:41,082 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:32:44,924 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:32:48,725 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:32:52,604 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:32:56,455 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:32:57,731 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:32:58,241 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:32:58,241 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 11:32:58,241 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:33:21,358 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:33:25,207 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:33:29,024 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:33:32,860 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:33:36,707 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:33:40,441 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:33:42,345 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:33:42,874 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:33:42,874 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 11:33:42,874 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:34:05,845 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:34:09,638 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:34:13,307 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:34:17,119 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:34:20,871 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:34:24,704 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:34:27,677 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:34:28,173 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:34:28,173 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 11:34:28,173 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:34:50,178 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:35:40,840 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 11:35:40,840 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:35:40,855 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 11:35:40,856 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 11:35:40,856 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:36:09,481 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 11:36:09,482 - INFO - modeling - eval_results: {'acc': 0.91}
2021-05-15 11:36:14,021 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-05-15 11:36:14,022 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-05-15 11:36:14,025 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 11:36:14,025 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-05-15 11:36:14,027 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-05-15 11:36:14,027 - INFO - run_task_adaptation - ************Training Example:**************
2021-05-15 11:36:14,027 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-05-15 11:36:14,027 - INFO - run_task_adaptation - text_b=None
2021-05-15 11:36:14,027 - INFO - run_task_adaptation - task=SST-2
2021-05-15 11:36:14,027 - INFO - run_task_adaptation - label=0
2021-05-15 11:36:14,027 - INFO - run_task_adaptation - **********************************
2021-05-15 11:36:16,516 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:36:44,609 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-05-15 11:36:44,609 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:36:44,714 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:36:51,023 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:36:57,336 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:37:03,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:37:09,924 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:37:16,065 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:37:22,273 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:37:24,676 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:37:26,115 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:37:26,115 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-05-15 11:37:26,115 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:37:53,050 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:37:59,012 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:04,941 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:11,011 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:17,192 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:23,418 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:27,104 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:38:28,526 - INFO - transprompt_wrapper2 - {'acc': 0.90625}
2021-05-15 11:38:28,526 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:38:31,028 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:37,206 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:43,235 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:49,290 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:38:55,415 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:01,629 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:06,507 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:39:07,962 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 11:39:07,963 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:39:09,210 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:15,488 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:21,720 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:28,009 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:34,262 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:40,527 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:46,763 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:39:48,170 - INFO - transprompt_wrapper2 - {'acc': 0.8541666666666666}
2021-05-15 11:39:48,170 - INFO - transprompt_wrapper2 - 3
2021-05-15 11:39:48,171 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:39:54,411 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:40:00,627 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:40:06,875 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:40:13,181 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:40:19,423 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:40:25,681 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:40:28,087 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:40:29,482 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:40:29,482 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 500
2021-05-15 11:40:29,483 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:40:56,072 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:41:02,271 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:41:08,504 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:41:14,765 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:41:20,936 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:41:27,107 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:41:30,815 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:41:32,242 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-05-15 11:41:32,242 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 600
2021-05-15 11:41:32,242 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:41:57,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:03,971 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:10,228 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:16,479 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:22,718 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:28,944 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:33,895 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:42:35,326 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:42:35,326 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:42:36,533 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:42,671 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:48,821 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:42:54,971 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:01,215 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:07,469 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:13,678 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:43:15,089 - INFO - transprompt_wrapper2 - {'acc': 0.9166666666666666}
2021-05-15 11:43:15,089 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:43:15,090 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:21,289 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:27,545 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:33,793 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:40,035 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:46,257 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:52,447 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:43:54,891 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:43:56,322 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 11:43:56,322 - INFO - transprompt_wrapper2 - 3
2021-05-15 11:44:00,134 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:44:06,367 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:44:12,616 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:44:18,862 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:44:25,071 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:44:31,278 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:44:34,875 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:44:36,258 - INFO - transprompt_wrapper2 - {'acc': 0.9270833333333334}
2021-05-15 11:44:36,258 - INFO - transprompt_wrapper2 - 4
2021-05-15 11:44:36,552 - INFO - modeling - Saving complete
2021-05-15 11:44:36,552 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-05-15 11:44:36,552 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-05-15 11:44:36,642 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:45:26,276 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-05-15 11:45:26,276 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-05-15 11:45:26,276 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-05-15 11:45:26,276 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:45:26,316 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:45:30,222 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:45:33,901 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:45:37,649 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:45:41,283 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:45:44,800 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:45:48,380 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:45:49,642 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:45:50,148 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-05-15 11:45:50,148 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 11:45:50,148 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:46:12,003 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:15,670 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:19,349 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:22,995 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:26,582 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:30,305 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:32,386 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:46:32,881 - INFO - transprompt_wrapper2 - {'acc': 0.8125}
2021-05-15 11:46:32,881 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:46:34,503 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:38,228 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:41,822 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:45,607 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:49,314 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:52,931 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:46:55,917 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:46:56,416 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-05-15 11:46:56,416 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:46:56,722 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:47:51,312 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-05-15 11:47:51,313 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:47:51,651 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-05-15 11:47:51,651 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-05-15 11:47:51,651 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:48:04,103 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-05-15 11:48:04,103 - INFO - modeling - eval_results: {'acc': 0.9139908256880734}
2021-05-15 11:48:04,104 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-05-15 11:48:04,104 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:48:04,147 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:07,353 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:10,695 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:14,156 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:17,496 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:20,846 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:24,216 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:25,450 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:48:25,956 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-05-15 11:48:25,956 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 100
2021-05-15 11:48:25,956 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:48:48,687 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:52,389 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:48:56,271 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:00,042 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:03,818 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:07,556 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:09,664 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:49:10,155 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:49:10,155 - INFO - transprompt_wrapper2 - 1
2021-05-15 11:49:11,803 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:15,495 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:19,252 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:22,773 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:26,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:30,371 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:49:33,322 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:49:33,819 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-05-15 11:49:33,819 - INFO - transprompt_wrapper2 - 2
2021-05-15 11:49:34,141 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:50:27,991 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-05-15 11:50:27,992 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:50:28,009 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-05-15 11:50:28,010 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-05-15 11:50:28,010 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:50:56,390 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-05-15 11:50:56,390 - INFO - modeling - eval_results: {'acc': 0.86}
2021-05-15 11:50:56,391 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-05-15 11:50:56,392 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:50:56,432 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:00,147 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:03,885 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:07,527 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:11,368 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:15,158 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:18,988 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:20,316 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:51:20,833 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:51:20,833 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-05-15 11:51:20,833 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:51:44,821 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:48,709 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:52,548 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:51:56,381 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:00,402 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:04,204 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:06,234 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:52:06,737 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:52:06,737 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-05-15 11:52:06,737 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:52:30,119 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:33,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:36,951 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:40,186 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:43,564 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:46,888 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-05-15 11:52:49,447 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:52:49,904 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-05-15 11:52:49,904 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-05-15 11:52:49,904 - INFO - transprompt_wrapper2 - Saving models.
2021-05-15 11:53:11,917 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-05-15 11:54:09,535 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-05-15 11:54:09,535 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-05-15 11:54:09,554 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-05-15 11:54:09,556 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-05-15 11:54:09,556 - INFO - transprompt_wrapper2 - Writing example 0
2021-05-15 11:54:38,777 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-05-15 11:54:38,777 - INFO - modeling - eval_results: {'acc': 0.91}
2021-09-14 15:48:12,366 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-09-14 15:48:12,384 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-09-14 15:48:12,475 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-09-14 15:48:12,476 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-09-14 15:48:12,486 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-09-14 15:48:12,487 - INFO - run_task_adaptation - ************Training Example:**************
2021-09-14 15:48:12,487 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-09-14 15:48:12,487 - INFO - run_task_adaptation - text_b=None
2021-09-14 15:48:12,487 - INFO - run_task_adaptation - task=SST-2
2021-09-14 15:48:12,487 - INFO - run_task_adaptation - label=0
2021-09-14 15:48:12,487 - INFO - run_task_adaptation - **********************************
2021-09-14 15:48:14,975 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 15:48:53,129 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-09-14 15:48:53,130 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 15:48:53,328 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:49:00,954 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:49:07,275 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:49:13,581 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:49:19,926 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:49:26,185 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:49:32,447 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:49:34,857 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 15:49:36,602 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-09-14 15:49:36,602 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-09-14 15:49:36,602 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 15:49:58,587 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:50:04,777 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:50:11,126 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:50:17,271 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:50:23,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:50:30,868 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:52:40,051 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=0.0001, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-09-14 15:52:40,051 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-09-14 15:52:40,066 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-09-14 15:52:40,066 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-09-14 15:52:40,068 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-09-14 15:52:40,068 - INFO - run_task_adaptation - ************Training Example:**************
2021-09-14 15:52:40,068 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-09-14 15:52:40,068 - INFO - run_task_adaptation - text_b=None
2021-09-14 15:52:40,068 - INFO - run_task_adaptation - task=SST-2
2021-09-14 15:52:40,068 - INFO - run_task_adaptation - label=0
2021-09-14 15:52:40,068 - INFO - run_task_adaptation - **********************************
2021-09-14 15:52:42,370 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 15:53:13,540 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-09-14 15:53:13,541 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 15:53:13,688 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:53:21,016 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:53:27,270 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:53:33,516 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:53:39,792 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:53:46,019 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:53:52,337 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:53:54,763 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 15:54:00,303 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-09-14 15:54:00,304 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9271 | best_global_step: 100
2021-09-14 15:54:00,304 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 15:54:23,820 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:54:28,148 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=False, data_dir='data/k-shot-cross/g1/full-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=768, eval_every_step=600, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-base', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=1800, pet_max_meta_steps=7000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=32, pet_per_gpu_train_batch_size=64, pet_repetitions=3, prompt_encoder_type='lstm', scene='full', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=200, weight_decay=0.1)
2021-09-14 15:54:28,149 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=train)
2021-09-14 15:54:28,255 - INFO - task_processors - Returning 11965 train examples with label dist.: [(0, 5268), (1, 6697)]
2021-09-14 15:54:28,255 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/full-21 (num_examples=-1, set_type=dev)
2021-09-14 15:54:28,368 - INFO - task_processors - Returning 5392 dev examples with label dist.: [(0, 2741), (1, 2651)]
2021-09-14 15:54:28,368 - INFO - run_task_adaptation - ************Training Example:**************
2021-09-14 15:54:28,368 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-09-14 15:54:28,368 - INFO - run_task_adaptation - text_b=None
2021-09-14 15:54:28,368 - INFO - run_task_adaptation - task=SST-2
2021-09-14 15:54:28,368 - INFO - run_task_adaptation - label=0
2021-09-14 15:54:28,368 - INFO - run_task_adaptation - **********************************
2021-09-14 15:54:29,932 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:54:30,711 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 15:54:36,125 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:54:42,418 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:54:48,889 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:54:51,964 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-09-14 15:54:51,965 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 15:54:55,148 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:54:59,907 - INFO - transprompt_wrapper2 - Writing example 10000
2021-09-14 15:55:01,428 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:55:29,700 - INFO - run_task_adaptation - Parameters: Namespace(adam_epsilon=1e-08, alpha=0.9999, cache_dir='', cross_prompt=True, data_dir='data/k-shot-cross/g1/16-21', dev32_examples=-1, do_eval=True, do_train=True, embed_size=1024, eval_every_step=100, eval_examples=-1, eval_set='dev', k=16, learning_rate=1e-05, logging_steps=50, max_grad_norm=1.0, model_name_or_path='roberta-large', model_type='roberta', no_cuda=False, output_dir='output', overwrite_output_dir=True, pattern_ids=[1], pet_gradient_accumulation_steps=1, pet_max_adaptation_steps=300, pet_max_meta_steps=1000, pet_max_seq_length=128, pet_num_train_epochs=3, pet_per_gpu_eval_batch_size=2, pet_per_gpu_train_batch_size=6, pet_repetitions=3, prompt_encoder_type='lstm', scene='few-shot', seed=21, split_examples_evenly=False, task_name='g1', task_type='cross_task', train_examples=-1, warmup_steps=100, weight_decay=0.1)
2021-09-14 15:55:29,700 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=train)
2021-09-14 15:55:29,703 - INFO - task_processors - Returning 96 train examples with label dist.: [(0, 48), (1, 48)]
2021-09-14 15:55:29,703 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/g1/16-21 (num_examples=-1, set_type=dev)
2021-09-14 15:55:29,705 - INFO - task_processors - Returning 96 dev examples with label dist.: [(0, 48), (1, 48)]
2021-09-14 15:55:29,705 - INFO - run_task_adaptation - ************Training Example:**************
2021-09-14 15:55:29,705 - INFO - run_task_adaptation - text_a=but first , you have to give the audience a reason to want to put for that effort
2021-09-14 15:55:29,705 - INFO - run_task_adaptation - text_b=None
2021-09-14 15:55:29,705 - INFO - run_task_adaptation - task=SST-2
2021-09-14 15:55:29,705 - INFO - run_task_adaptation - label=0
2021-09-14 15:55:29,705 - INFO - run_task_adaptation - **********************************
2021-09-14 15:55:31,987 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 15:56:03,458 - INFO - modeling - ========= Stage1: Starting Fine-tuning Multi-Task Meta-Learner ... =========
2021-09-14 15:56:03,459 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 15:56:03,644 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:56:15,481 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:56:26,789 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:56:38,079 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:56:49,385 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:57:00,448 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:57:11,954 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:57:16,429 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 15:57:20,434 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1...
2021-09-14 15:57:20,434 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-09-14 15:57:20,434 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 15:57:53,203 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:58:04,439 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:58:15,978 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:58:27,085 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:58:38,476 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:58:49,162 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:58:55,806 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 15:58:58,924 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-09-14 15:58:58,944 - INFO - transprompt_wrapper2 - 1
2021-09-14 15:59:03,014 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:59:13,885 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:59:24,996 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:59:36,271 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:59:47,531 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 15:59:58,778 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:00:07,775 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:00:11,062 - INFO - transprompt_wrapper2 - {'acc': 0.8333333333333334}
2021-09-14 16:00:11,062 - INFO - transprompt_wrapper2 - 2
2021-09-14 16:00:13,230 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:00:24,455 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:00:35,625 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:00:46,878 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:00:58,172 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:01:09,323 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:01:20,792 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:01:23,555 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-09-14 16:01:23,555 - INFO - transprompt_wrapper2 - 3
2021-09-14 16:01:23,556 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:01:34,767 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:01:46,009 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:01:57,223 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:02:08,423 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:02:18,547 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:02:19,615 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:02:29,357 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:02:33,266 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:02:35,834 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-09-14 16:02:35,834 - INFO - transprompt_wrapper2 - 4
2021-09-14 16:02:41,665 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:02:51,382 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:03:01,139 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:03:10,672 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:03:20,134 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:03:29,648 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:03:35,253 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:03:37,700 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-09-14 16:03:37,700 - INFO - transprompt_wrapper2 - 5
2021-09-14 16:03:41,635 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:03:51,229 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:04:00,906 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:04:10,585 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:04:20,089 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:04:29,408 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:04:36,962 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:04:39,356 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-09-14 16:04:39,356 - INFO - transprompt_wrapper2 - 6
2021-09-14 16:04:41,260 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:04:50,623 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:05:01,403 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:05:12,726 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:05:24,026 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:05:35,174 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:05:46,598 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:05:49,407 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-09-14 16:05:49,407 - INFO - transprompt_wrapper2 - 7
2021-09-14 16:05:49,408 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:06:00,668 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:06:11,986 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:06:23,136 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:06:34,344 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:06:45,359 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:06:56,648 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:07:01,276 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:07:04,583 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-09-14 16:07:04,584 - INFO - transprompt_wrapper2 - 8
2021-09-14 16:07:11,256 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:07:22,511 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:07:33,829 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:07:44,904 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:07:56,285 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:08:07,383 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:08:14,249 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:08:17,402 - INFO - transprompt_wrapper2 - {'acc': 0.8854166666666666}
2021-09-14 16:08:17,402 - INFO - transprompt_wrapper2 - 9
2021-09-14 16:08:17,773 - INFO - modeling - Saving complete
2021-09-14 16:08:17,773 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-09-14 16:08:17,773 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-09-14 16:08:17,947 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 16:08:49,740 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-09-14 16:08:49,741 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-09-14 16:08:49,741 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-09-14 16:08:49,741 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:08:49,820 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:08:56,815 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:09:02,741 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:09:08,738 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:09:14,823 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:09:20,925 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:09:26,978 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:09:29,124 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:09:29,993 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/sst-2...
2021-09-14 16:09:29,993 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-09-14 16:09:29,993 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 16:09:52,954 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:09:59,000 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:05,104 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:11,153 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:17,205 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:22,735 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:26,058 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:10:27,374 - INFO - transprompt_wrapper2 - {'acc': 0.84375}
2021-09-14 16:10:27,374 - INFO - transprompt_wrapper2 - 1
2021-09-14 16:10:29,744 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:36,048 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:39,100 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:41,597 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:46,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:51,529 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:10:56,434 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:11:00,574 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:11:01,563 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-09-14 16:11:01,563 - INFO - transprompt_wrapper2 - 2
2021-09-14 16:11:01,845 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 16:11:30,445 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-09-14 16:11:30,446 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-09-14 16:11:30,535 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-09-14 16:11:30,535 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-09-14 16:11:30,535 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:11:53,708 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-09-14 16:11:53,709 - INFO - modeling - eval_results: {'acc': 0.9174311926605505}
2021-09-14 16:11:53,711 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-09-14 16:11:53,711 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:11:53,777 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:11:59,121 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:12:04,524 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:12:09,772 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:12:16,127 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:12:22,355 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:12:28,637 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:12:31,123 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:12:32,003 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-09-14 16:12:32,003 - INFO - transprompt_wrapper2 - best_dev_acc: 0.8750 | best_global_step: 100
2021-09-14 16:12:32,003 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 16:12:54,347 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:13:00,708 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:13:07,028 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:13:13,294 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:13:19,681 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:13:25,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:13:29,209 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:13:30,234 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/mr...
2021-09-14 16:13:30,234 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9062 | best_global_step: 200
2021-09-14 16:13:30,234 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 16:13:51,670 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:13:57,830 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:14:03,978 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:14:10,251 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:14:16,386 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:14:22,606 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:14:27,622 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:14:28,502 - INFO - transprompt_wrapper2 - {'acc': 0.875}
2021-09-14 16:14:28,502 - INFO - transprompt_wrapper2 - 1
2021-09-14 16:14:30,061 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 16:15:00,665 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-09-14 16:15:00,666 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-09-14 16:15:00,759 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-09-14 16:15:00,760 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-09-14 16:15:00,760 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:16:05,614 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-09-14 16:16:05,614 - INFO - modeling - eval_results: {'acc': 0.88}
2021-09-14 16:16:05,616 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-09-14 16:16:05,617 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:16:05,671 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:16:11,878 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:16:18,336 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:16:24,563 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:16:30,767 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:16:36,948 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:16:43,127 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:16:45,415 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:16:46,517 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-09-14 16:16:46,517 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 100
2021-09-14 16:16:46,518 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 16:16:58,474 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:17:08,449 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:17:13,892 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:17:19,440 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:17:25,021 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:17:30,528 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:17:36,354 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:17:39,406 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:17:40,390 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-09-14 16:17:40,390 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 200
2021-09-14 16:17:40,390 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 16:18:11,061 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:18:16,625 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:18:22,011 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:18:28,058 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:18:34,279 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:18:40,452 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:18:45,194 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:18:46,370 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/few-shot/adaptation/g1/cr...
2021-09-14 16:18:46,370 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9375 | best_global_step: 300
2021-09-14 16:18:46,370 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 16:19:07,615 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 16:19:14,328 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:19:37,593 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-09-14 16:19:37,593 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-09-14 16:19:37,655 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-09-14 16:19:37,657 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-09-14 16:19:37,657 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:19:47,051 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-09-14 16:19:47,052 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9152 | best_global_step: 600
2021-09-14 16:19:47,052 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 16:20:27,267 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-09-14 16:20:27,267 - INFO - modeling - eval_results: {'acc': 0.9035}
2021-09-14 16:22:37,004 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:26:37,339 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:30:43,660 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:32:59,966 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:33:27,875 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-09-14 16:33:27,876 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9225 | best_global_step: 1200
2021-09-14 16:33:27,876 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 16:35:29,288 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:39:37,713 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:43:42,348 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:46:38,297 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 16:47:06,204 - INFO - transprompt_wrapper2 - {'acc': 0.921179525222552}
2021-09-14 16:47:06,204 - INFO - transprompt_wrapper2 - 1
2021-09-14 16:48:16,158 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:52:18,811 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:56:20,501 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 16:59:53,467 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 17:00:21,172 - INFO - transprompt_wrapper2 - {'acc': 0.9215504451038575}
2021-09-14 17:00:21,172 - INFO - transprompt_wrapper2 - 2
2021-09-14 17:00:52,392 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:05:00,358 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:09:08,465 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:13:17,065 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:14:20,692 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 17:14:48,911 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1...
2021-09-14 17:14:48,911 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9227 | best_global_step: 3000
2021-09-14 17:14:48,911 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 17:18:12,687 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:22:22,316 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:26:33,336 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:28:22,176 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 17:28:50,154 - INFO - transprompt_wrapper2 - {'acc': 0.9224777448071216}
2021-09-14 17:28:50,155 - INFO - transprompt_wrapper2 - 1
2021-09-14 17:31:13,340 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:35:21,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:39:30,165 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:41:55,332 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 17:42:23,632 - INFO - transprompt_wrapper2 - {'acc': 0.9198813056379822}
2021-09-14 17:42:23,632 - INFO - transprompt_wrapper2 - 2
2021-09-14 17:44:06,755 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:48:18,074 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:52:21,831 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 17:55:31,340 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 17:55:59,137 - INFO - transprompt_wrapper2 - {'acc': 0.921179525222552}
2021-09-14 17:55:59,137 - INFO - transprompt_wrapper2 - 3
2021-09-14 17:57:03,776 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:01:12,698 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:05:21,637 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:09:06,921 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 18:09:34,728 - INFO - transprompt_wrapper2 - {'acc': 0.9209940652818991}
2021-09-14 18:09:34,729 - INFO - transprompt_wrapper2 - 4
2021-09-14 18:09:58,270 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:14:23,234 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:19:24,122 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:23:33,556 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:24:45,886 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 18:25:14,872 - INFO - transprompt_wrapper2 - {'acc': 0.9208086053412463}
2021-09-14 18:25:14,873 - INFO - transprompt_wrapper2 - 5
2021-09-14 18:28:08,851 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:32:18,311 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:36:26,781 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:38:20,033 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 18:38:48,653 - INFO - transprompt_wrapper2 - {'acc': 0.920066765578635}
2021-09-14 18:38:48,654 - INFO - transprompt_wrapper2 - 6
2021-09-14 18:41:04,719 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:45:13,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:47:32,833 - INFO - modeling - Saving complete
2021-09-14 18:47:32,833 - INFO - modeling - ========= Stage1: Finish Fine-tuning Multi-Task Meta-Learner =========
2021-09-14 18:47:32,833 - INFO - modeling - ========= Stage2: Starting Task Adaptation (Task-Specific Fine-tuning) ... =========
2021-09-14 18:47:33,155 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 18:47:56,023 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_train)
2021-09-14 18:47:56,028 - INFO - task_processors - Creating features from dataset file at None (num_examples=-1, set_type=spe_dev)
2021-09-14 18:47:56,031 - INFO - modeling - ========= Stage2.1: Specific fine-tuning on Task sst-2 =========
2021-09-14 18:47:56,031 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 18:48:00,350 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:49:55,202 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:51:49,464 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:53:44,362 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:55:12,553 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 18:55:22,185 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/sst-2...
2021-09-14 18:55:22,185 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9322 | best_global_step: 600
2021-09-14 18:55:22,185 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 18:55:55,499 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:57:49,953 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 18:59:43,365 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:01:36,121 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:02:37,257 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:02:46,713 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/sst-2...
2021-09-14 19:02:46,713 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9367 | best_global_step: 1200
2021-09-14 19:02:46,713 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 19:03:47,546 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:05:41,972 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:07:37,794 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:09:33,025 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:10:07,318 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:10:16,529 - INFO - transprompt_wrapper2 - {'acc': 0.93557582668187}
2021-09-14 19:10:16,530 - INFO - transprompt_wrapper2 - 1
2021-09-14 19:10:17,238 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 19:10:29,937 - INFO - modeling - ========= Stage2.1: Evaluating test set on Task sst-2
2021-09-14 19:10:29,937 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/SST-2/16-21 (num_examples=-1, set_type=test)
2021-09-14 19:10:30,283 - INFO - task_processors - Returning 872 test examples with label dist.: [(0, 428), (1, 444)]
2021-09-14 19:10:30,283 - INFO - modeling - Group g1: Task sst-2 's Test examples number: 872
2021-09-14 19:10:30,283 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:10:34,953 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=sst-2) ---
2021-09-14 19:10:34,953 - INFO - modeling - eval_results: {'acc': 0.9506880733944955}
2021-09-14 19:10:34,953 - INFO - modeling - ========= Stage2.2: Specific fine-tuning on Task mr =========
2021-09-14 19:10:34,954 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:10:38,715 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:12:36,877 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:14:35,654 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:16:34,488 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:17:56,038 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:18:14,199 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/mr...
2021-09-14 19:18:14,199 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9086 | best_global_step: 600
2021-09-14 19:18:14,200 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 19:18:57,639 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:20:53,055 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:22:50,867 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:24:48,787 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:25:34,339 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:25:52,295 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/mr...
2021-09-14 19:25:52,295 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9098 | best_global_step: 1200
2021-09-14 19:25:52,295 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 19:27:10,425 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:29:07,698 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:31:05,195 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:32:48,939 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:33:06,324 - INFO - transprompt_wrapper2 - {'acc': 0.9089020771513353}
2021-09-14 19:33:06,324 - INFO - transprompt_wrapper2 - 1
2021-09-14 19:33:06,932 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 19:33:23,931 - INFO - modeling - ========= Stage2.2: Evaluating test set on Task mr
2021-09-14 19:33:23,931 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/mr/16-21 (num_examples=-1, set_type=test)
2021-09-14 19:33:24,040 - INFO - task_processors - Returning 2000 test examples with label dist.: [(1, 1000), (0, 1000)]
2021-09-14 19:33:24,042 - INFO - modeling - Group g1: Task mr 's Test examples number: 2000
2021-09-14 19:33:24,042 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:33:34,980 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=mr) ---
2021-09-14 19:33:34,980 - INFO - modeling - eval_results: {'acc': 0.9025}
2021-09-14 19:33:34,981 - INFO - modeling - ========= Stage2.3: Specific fine-tuning on Task cr =========
2021-09-14 19:33:34,981 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:33:36,029 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:34:10,794 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:34:46,171 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:35:20,104 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:35:53,888 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:36:27,655 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:37:01,276 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:37:34,502 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:38:08,562 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:38:43,571 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:39:18,780 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:39:53,165 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:40:26,630 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:40:47,207 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:40:48,715 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/cr...
2021-09-14 19:40:48,716 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9179 | best_global_step: 600
2021-09-14 19:40:48,716 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 19:41:10,330 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:41:44,469 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:42:18,057 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:42:52,047 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:43:25,903 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:43:59,742 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:44:33,373 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:45:07,046 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:45:40,281 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:46:13,922 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:46:47,347 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:47:20,848 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:47:54,250 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:47:55,624 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/cr...
2021-09-14 19:47:55,625 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9440 | best_global_step: 1200
2021-09-14 19:47:55,625 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 19:48:10,069 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:48:43,716 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:49:17,312 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:49:50,458 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:50:24,228 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:50:57,886 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:51:31,113 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:52:04,863 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:52:38,445 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:53:12,090 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:53:46,098 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:54:20,376 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:54:51,702 - INFO - transprompt_wrapper2 - Calculating Prototype Embedding ...
2021-09-14 19:55:10,247 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:55:11,622 - INFO - transprompt_wrapper2 - Saving trained meta-leaner model at output/full/adaptation/g1/cr...
2021-09-14 19:55:11,622 - INFO - transprompt_wrapper2 - best_dev_acc: 0.9440 | best_global_step: 1800
2021-09-14 19:55:11,622 - INFO - transprompt_wrapper2 - Saving models.
2021-09-14 19:55:20,716 - INFO - transprompt_wrapper2 - ========= This is 'Multi-Task Prompt Encoder 2' =========
2021-09-14 19:55:34,975 - INFO - modeling - ========= Stage2.3: Evaluating test set on Task cr
2021-09-14 19:55:34,975 - INFO - task_processors - Creating features from dataset file at data/k-shot-cross/cr/16-21 (num_examples=-1, set_type=test)
2021-09-14 19:55:35,042 - INFO - task_processors - Returning 2000 test examples with label dist.: [(0, 1000), (1, 1000)]
2021-09-14 19:55:35,043 - INFO - modeling - Group g1: Task cr 's Test examples number: 2000
2021-09-14 19:55:35,043 - INFO - transprompt_wrapper2 - Writing example 0
2021-09-14 19:55:45,351 - INFO - modeling - --- Task Adaptation Result (pattern_id=1, Group=g1, Task=cr) ---
2021-09-14 19:55:45,351 - INFO - modeling - eval_results: {'acc': 0.9045}
